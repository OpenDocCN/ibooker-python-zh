<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 8. Prettification: Layout and Styling, and What to Test About It" data-type="chapter" epub:type="chapter"><div class="chapter" id="chapter_prettification">
<h1><span class="label">Chapter 8. </span>Prettification: Layout and Styling, and What to Test About It</h1>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id447">
<h1>A Note for Early Release Readers</h1>
<p>With Early Release ebooks, you get books in their earliest form—the author’s raw and unedited content as they write—so you can take advantage of these technologies long before the official release of these titles.</p>
<p>This will be the 8th chapter of the final book. The GitHub repo is available at <a class="bare" href="https://github.com/hjwp/book-example"><em class="hyperlink">https://github.com/hjwp/book-example</em></a>.</p>
<p>If you have comments about how we might improve the content and/or examples in this book, or if you notice missing material within this chapter, please reach out to the author at <a href="mailto:obeythetestinggoat@gmail.com">obeythetestinggoat@gmail.com</a>.</p>
</div></aside>
<p><a data-primary="layout" data-see="CSS; design and layout testing" data-type="indexterm" id="id448"/>
<a data-primary="style" data-see="CSS; design and layout testing" data-type="indexterm" id="id449"/>
We’re starting to think about releasing the first version of our site,
but we’re a bit embarrassed by how ugly it looks at the moment.
In this chapter, we’ll cover some of the basics of styling,
including integrating an HTML/CSS framework called Bootstrap.
We’ll learn how static files work in Django,
and what we need to do about testing them.</p>
<section data-pdf-bookmark="Testing Layout and Style" data-type="sect1"><div class="sect1" id="id61">
<h1>Testing Layout and Style</h1>
<p><a data-primary="design and layout testing" data-secondary="selecting test targets" data-type="indexterm" id="DLTtargets08"/>
Our site is undeniably a bit unattractive at the moment
(<a data-type="xref" href="#homepage-looking-ugly">Figure 8-1</a>).</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>If you spin up your dev server with <code>manage.py runserver</code>,
    you may run into a database error
    “table lists_item has no column named list_id”.
    You need to update your local database
    to reflect the changes we made in <em>models.py</em>.
    Use <code>manage.py migrate</code>.
    If it gives you any grief about <code>IntegrityErrors</code>,
    just delete the database file<sup><a data-type="noteref" href="ch08.xhtml#id450" id="id450-marker">1</a></sup>
    and try again.</p>
</div>
<p>We can’t be adding to Python’s reputation for being
<a href="http://grokcode.com/746/dear-python-why-are-you-so-ugly/">ugly</a>,
so let’s do a tiny bit of polishing.
Here’s a few things we might want:</p>
<ul>
<li>
<p>A nice large input field for adding new and existing lists</p>
</li>
<li>
<p>A large, attention-grabbing, centered box to put it in</p>
</li>
</ul>
<p><a data-primary="aesthetics, testing" data-seealso="design and layout testing" data-type="indexterm" id="id451"/>
How do we apply TDD to these things?
Most people will tell you you shouldn’t test aesthetics, and they’re right.
It’s a bit like testing a constant, in that tests usually wouldn’t add any value.</p>
<figure><div class="figure" id="homepage-looking-ugly">
<img alt="Our home page, looking a little ugly." height="1746" src="assets/ugly-homepage.png" width="2723"/>
<h6><span class="label">Figure 8-1. </span>Our home page, looking a little ugly…​</h6>
</div></figure>
<p><a data-primary="static files" data-secondary="challenges of" data-type="indexterm" id="id452"/>
<a data-primary="CSS (Cascading Style Sheets)" data-secondary="challenges of static files" data-type="indexterm" id="id453"/>
But we can test the essential <em>behaviour</em> of our aesthetics,
ie, that we have any at all.
All we want to do is reassure ourselves that things are working.
For example, we’re going to use Cascading Style Sheets (CSS) for our styling,
and they are loaded as static files.
Static files can be a bit tricky to configure
(especially, as we’ll see later, when you move off your own computer and onto a hosting site),
so we’ll want some kind of simple “smoke test” that the CSS has loaded.
We don’t have to test fonts and colours and every single pixel,
but we can do a quick check that the main input box is aligned the way we want it on each page,
and that will give us confidence that the rest of the styling for that page is probably loaded too.</p>
<p>Let’s add a new test method inside our functional test:</p>
<div class="sourcecode" data-type="example">
<p>functional_tests/tests.py (ch08l001)</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">class</code> <code class="nc">NewVisitorTest</code><code class="p">(</code><code class="n">LiveServerTestCase</code><code class="p">):</code>
    <code class="p">[</code><code class="o">...</code><code class="p">]</code>


    <code class="k">def</code> <code class="nf">test_layout_and_styling</code><code class="p">(</code><code class="bp">self</code><code class="p">):</code>
        <code class="c1"># Edith goes to the home page,</code>
        <code class="bp">self</code><code class="o">.</code><code class="n">browser</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="bp">self</code><code class="o">.</code><code class="n">live_server_url</code><code class="p">)</code>

        <code class="c1"># Her browser window is set to a very specific size</code>
        <code class="bp">self</code><code class="o">.</code><code class="n">browser</code><code class="o">.</code><code class="n">set_window_size</code><code class="p">(</code><code class="mi">1024</code><code class="p">,</code> <code class="mi">768</code><code class="p">)</code>

        <code class="c1"># She notices the input box is nicely centered</code>
        <code class="n">inputbox</code> <code class="o">=</code> <code class="bp">self</code><code class="o">.</code><code class="n">browser</code><code class="o">.</code><code class="n">find_element</code><code class="p">(</code><code class="n">By</code><code class="o">.</code><code class="n">ID</code><code class="p">,</code> <code class="s2">"id_new_item"</code><code class="p">)</code>
        <code class="bp">self</code><code class="o">.</code><code class="n">assertAlmostEqual</code><code class="p">(</code>
            <code class="n">inputbox</code><code class="o">.</code><code class="n">location</code><code class="p">[</code><code class="s2">"x"</code><code class="p">]</code> <code class="o">+</code> <code class="n">inputbox</code><code class="o">.</code><code class="n">size</code><code class="p">[</code><code class="s2">"width"</code><code class="p">]</code> <code class="o">/</code> <code class="mi">2</code><code class="p">,</code>
            <code class="mi">512</code><code class="p">,</code>
            <code class="n">delta</code><code class="o">=</code><code class="mi">10</code><code class="p">,</code>
        <code class="p">)</code></pre></div>
<p>A few new things here.
We start by setting the window size to a fixed size.
We then find the input element,
look at its size and location,
and do a little maths
to check whether it seems to be positioned in the middle of the page.
<code>assertAlmostEqual</code> helps us to deal with rounding errors
and the occasional weirdness due to scrollbars and the like,
by letting us specify that we want our arithmetic to work
to within plus or minus 10 pixels.</p>
<p>If we run the functional tests, we get:</p>
<pre data-type="programlisting">$ <strong>python manage.py test functional_tests</strong>
[...]
.F.
======================================================================
FAIL: test_layout_and_styling
(functional_tests.tests.NewVisitorTest.test_layout_and_styling)
 ---------------------------------------------------------------------
Traceback (most recent call last):
  File "...goat-book/functional_tests/tests.py", line 120, in
test_layout_and_styling
    self.assertAlmostEqual(
AssertionError: 103.333... != 512 within 10 delta (408.666...
difference)

 ---------------------------------------------------------------------
Ran 3 tests in 9.188s

FAILED (failures=1)</pre>
<p>That’s the expected failure.
Still, this kind of FT is easy to get wrong,
so let’s use a quick-and-dirty “cheat” solution,
to check that the FT definitely passes when the input box is centered.
We’ll delete this code again almost as soon as we’ve used it
to check the FT:</p>
<div class="sourcecode small-code" data-type="example">
<p>lists/templates/home.xhtml (ch08l002)</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">form</code> <code class="na">method</code><code class="o">=</code><code class="s">"POST"</code> <code class="na">action</code><code class="o">=</code><code class="s">"/lists/new"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">p</code> <code class="na">style</code><code class="o">=</code><code class="s">"text-align: center;"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">input</code> <code class="na">name</code><code class="o">=</code><code class="s">"item_text"</code> <code class="na">id</code><code class="o">=</code><code class="s">"id_new_item"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter a to-do item"</code> <code class="p">/&gt;</code>
  <code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>
  {% csrf_token %}
<code class="p">&lt;/</code><code class="nt">form</code><code class="p">&gt;</code></pre></div>
<p>That passes, which means the FT works.
Let’s extend it to make sure that the input box is also
center-aligned on the page for a new list:</p>
<div class="sourcecode" data-type="example">
<p>functional_tests/tests.py (ch08l003)</p>
<pre data-code-language="python" data-type="programlisting">    <code class="c1"># She starts a new list and sees the input is nicely</code>
    <code class="c1"># centered there too</code>
    <code class="n">inputbox</code><code class="o">.</code><code class="n">send_keys</code><code class="p">(</code><code class="s2">"testing"</code><code class="p">)</code>
    <code class="n">inputbox</code><code class="o">.</code><code class="n">send_keys</code><code class="p">(</code><code class="n">Keys</code><code class="o">.</code><code class="n">ENTER</code><code class="p">)</code>
    <code class="bp">self</code><code class="o">.</code><code class="n">wait_for_row_in_list_table</code><code class="p">(</code><code class="s2">"1: testing"</code><code class="p">)</code>
    <code class="n">inputbox</code> <code class="o">=</code> <code class="bp">self</code><code class="o">.</code><code class="n">browser</code><code class="o">.</code><code class="n">find_element</code><code class="p">(</code><code class="n">By</code><code class="o">.</code><code class="n">ID</code><code class="p">,</code> <code class="s2">"id_new_item"</code><code class="p">)</code>
    <code class="bp">self</code><code class="o">.</code><code class="n">assertAlmostEqual</code><code class="p">(</code>
        <code class="n">inputbox</code><code class="o">.</code><code class="n">location</code><code class="p">[</code><code class="s2">"x"</code><code class="p">]</code> <code class="o">+</code> <code class="n">inputbox</code><code class="o">.</code><code class="n">size</code><code class="p">[</code><code class="s2">"width"</code><code class="p">]</code> <code class="o">/</code> <code class="mi">2</code><code class="p">,</code>
        <code class="mi">512</code><code class="p">,</code>
        <code class="n">delta</code><code class="o">=</code><code class="mi">10</code><code class="p">,</code>
    <code class="p">)</code></pre></div>
<p>That gives us another test failure:</p>
<pre data-type="programlisting">  File "...goat-book/functional_tests/tests.py", line 132, in
test_layout_and_styling
    self.assertAlmostEqual(
AssertionError: 103.333... != 512 within 10 delta (408.666...</pre>
<p>Let’s commit just the FT:</p>
<pre data-type="programlisting">$ <strong>git add functional_tests/tests.py</strong>
$ <strong>git commit -m "first steps of FT for layout + styling"</strong></pre>
<p>Now it feels like we’re justified in finding a “proper” solution
to our need for some better styling for our site.
We can back out our hacky <code>text-align: center</code>:</p>
<pre data-type="programlisting">$ <strong>git reset --hard</strong></pre>
<p><a data-primary="Git" data-secondary="reset --hard" data-type="indexterm" id="id454"/>
WARNING: <code>git reset --hard</code>
    is the “take off and nuke the site from orbit”
    Git command, so be careful with it—​it
    blows away all your un-committed changes.
    Unlike almost everything else you can do with Git,
    there’s no way of going back after this one.
<a data-primary="" data-startref="DLTtargets08" data-type="indexterm" id="id455"/></p>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="Prettification: Using a CSS Framework" data-type="sect1"><div class="sect1" id="id62">
<h1>Prettification: Using a CSS Framework</h1>
<p><a data-primary="design and layout testing" data-secondary="CSS frameworks" data-type="indexterm" id="DLTcssframe08"/>
<a data-primary="CSS (Cascading Style Sheets)" data-secondary="CSS frameworks" data-type="indexterm" id="CSSframe08"/>
<a data-primary="Bootstrap" data-secondary="downloading" data-type="indexterm" id="id456"/>
UI design is hard,
and doubly so now that we have to deal with mobile, tablets, and so forth.
That’s why many programmers, particularly lazy ones like me,
turn to CSS frameworks to solve some of those problems for them.
There are lots of frameworks out there,
but one of the earliest and most popular still, is Twitter’s Bootstrap.
Let’s use that.</p>
<p>You can find bootstrap at <a class="bare" href="http://getbootstrap.com/"><em class="hyperlink">http://getbootstrap.com/</em></a>.</p>
<p>We’ll download it and put it in a new folder called <em>static</em> inside the <code>lists</code>
app:<sup><a data-type="noteref" href="ch08.xhtml#id457" id="id457-marker">2</a></sup></p>
<pre data-type="programlisting">$ <strong>wget -O bootstrap.zip https://github.com/twbs/bootstrap/releases/download/\
v5.3.0/bootstrap-5.3.0-dist.zip</strong>
$ <strong>unzip bootstrap.zip</strong>
$ <strong>mkdir lists/static</strong>
$ <strong>mv bootstrap-5.3.0-dist lists/static/bootstrap</strong>
$ <strong>rm bootstrap.zip</strong></pre>
<p>Bootstrap comes with a plain, uncustomised installation in the <em>dist</em> folder.
We’re going to use that for now,
but you should really never do this for a real site—​vanilla
Bootstrap is instantly recognisable,
and a big signal to anyone in the know
that you couldn’t be bothered to style your site.
Learn how to use Sass and change the font, if nothing else!
There is info in Bootstrap’s docs, or there’s an
<a class="bare" href="https://www.freecodecamp.org/news/how-to-customize-bootstrap-with-sass/"><em class="hyperlink">https://www.freecodecamp.org/news/how-to-customize-bootstrap-with-sass/</em></a>
[introductory guide here].</p>
<p>Our <em>lists</em> folder will end up looking like this:</p>
<pre data-type="programlisting">$ <strong>tree lists</strong>
lists
├── __init__.py
├── admin.py
├── apps.py
├── migrations
│   ├── [...]
├── models.py
├── static
│   └── bootstrap
│       ├── css
│       │   ├── bootstrap.css
│       │   ├── bootstrap.css.map
│       │   ├── [...]
│       │   └── bootstrap-utilities.rtl.min.css.map
│       └── js
│           ├── bootstrap.bundle.js
│           ├── bootstrap.bundle.js.map
│           ├── [...]
│           └── bootstrap.min.js.map
├── templates
│   ├── home.xhtml
│   └── list.xhtml
├── [...]</pre>
<p><a data-primary="Bootstrap" data-secondary="documentation" data-type="indexterm" id="id458"/>
Look at the “Getting Started” section of the
<a href="https://getbootstrap.com/docs/5.3/getting-started/introduction/">Bootstrap documentation</a>;
you’ll see it wants our HTML template to include something like this:</p>
<pre class="skipme" data-code-language="html" data-type="programlisting"><code class="cp">&lt;!doctype html&gt;</code>
<code class="p">&lt;</code><code class="nt">html</code> <code class="na">lang</code><code class="o">=</code><code class="s">"en"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">meta</code> <code class="na">name</code><code class="o">=</code><code class="s">"viewport"</code> <code class="na">content</code><code class="o">=</code><code class="s">"width=device-width, initial-scale=1"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">title</code><code class="p">&gt;</code>Bootstrap demo<code class="p">&lt;/</code><code class="nt">title</code><code class="p">&gt;</code>
  <code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>Hello, world!<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>
  <code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">html</code><code class="p">&gt;</code></pre>
<p>We already have two HTML templates.
We don’t want to be adding a whole load of boilerplate code to each,
so now feels like the right time to apply
the “Don’t repeat yourself” rule,
and bring all the common parts together.
Thankfully, the Django template language makes that easy using something
called template inheritance.
<a data-primary="" data-startref="DLTcssframe08" data-type="indexterm" id="id459"/>
<a data-primary="" data-startref="CSSframe08" data-type="indexterm" id="id460"/></p>
</div></section>
<section data-pdf-bookmark="Django Template Inheritance" data-type="sect1"><div class="sect1" id="id84">
<h1>Django Template Inheritance</h1>
<p><a data-primary="design and layout testing" data-secondary="Django template inheritance" data-type="indexterm" id="id461"/>
<a data-primary="templates" data-secondary="Django template inheritance" data-type="indexterm" id="id462"/>
<a data-primary="Django framework" data-secondary="template inheritance" data-type="indexterm" id="id463"/>
Let’s have a little review of what the differences are between <em>home.xhtml</em> and
<em>list.xhtml</em>:</p>
<pre data-type="programlisting">$ <strong>diff lists/templates/home.xhtml lists/templates/list.xhtml</strong>
&lt;     &lt;h1&gt;Start a new To-Do list&lt;/h1&gt;
&lt;     &lt;form method="POST" action="/lists/new"&gt;
---
&gt;     &lt;h1&gt;Your To-Do list&lt;/h1&gt;
&gt;     &lt;form method="POST" action="/lists/{{ list.id }}/add_item"&gt;
[...]
&gt;     &lt;table id="id_list_table"&gt;
&gt;       {% for item in list.item_set.all %}
&gt;         &lt;tr&gt;&lt;td&gt;{{ forloop.counter }}: {{ item.text }}&lt;/td&gt;&lt;/tr&gt;
&gt;       {% endfor %}
&gt;     &lt;/table&gt;</pre>
<p>They have different header texts, and their forms use different URLs. On top
of that, <em>list.xhtml</em> has the additional <code>&lt;table&gt;</code> element.</p>
<p>Now that we’re clear on what’s in common and what’s not, we can make the two
templates inherit from a common “superclass” template.  We’ll start by
making a copy of <em>list.xhtml</em>:</p>
<pre data-type="programlisting">$ <strong>cp lists/templates/list.xhtml lists/templates/base.xhtml</strong></pre>
<p>We make this into a base template which just contains the common boilerplate,
and mark out the “blocks”, places where child templates can customise it:</p>
<div class="sourcecode small-code" data-type="example">
<p>lists/templates/base.xhtml (ch08l007)</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">html</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">title</code><code class="p">&gt;</code>To-Do lists<code class="p">&lt;/</code><code class="nt">title</code><code class="p">&gt;</code>
  <code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>

  <code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>{% block header_text %}{% endblock %}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>

    <code class="p">&lt;</code><code class="nt">form</code> <code class="na">method</code><code class="o">=</code><code class="s">"POST"</code> <code class="na">action</code><code class="o">=</code><code class="s">"{% block form_action %}{% endblock %}"</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">input</code> <code class="na">name</code><code class="o">=</code><code class="s">"item_text"</code> <code class="na">id</code><code class="o">=</code><code class="s">"id_new_item"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter a to-do item"</code> <code class="p">/&gt;</code>
      {% csrf_token %}
    <code class="p">&lt;/</code><code class="nt">form</code><code class="p">&gt;</code>

    {% block table %}
    {% endblock %}
  <code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code>

<code class="p">&lt;/</code><code class="nt">html</code><code class="p">&gt;</code></pre></div>
<p>The base template defines a series of areas called “blocks”,
which will be places that other templates can hook in and add their own content.
Let’s see how that works in practice,
by changing <em>home.xhtml</em> so that it “inherits from” <em>base.xhtml</em>:</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/home.xhtml (ch08l008)</p>
<pre data-code-language="html" data-type="programlisting">{% extends 'base.xhtml' %}

{% block header_text %}Start a new To-Do list{% endblock %}

{% block form_action %}/lists/new{% endblock %}</pre></div>
<p>You can see that lots of the boilerplate HTML disappears,
and we just concentrate on the bits we want to customise.
We do the same for <em>list.xhtml</em>:</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/list.xhtml (ch08l009)</p>
<pre data-code-language="html" data-type="programlisting">{% extends 'base.xhtml' %}

{% block header_text %}Your To-Do list{% endblock %}

{% block form_action %}/lists/{{ list.id }}/add_item{% endblock %}

{% block table %}
  <code class="p">&lt;</code><code class="nt">table</code> <code class="na">id</code><code class="o">=</code><code class="s">"id_list_table"</code><code class="p">&gt;</code>
    {% for item in list.item_set.all %}
      <code class="p">&lt;</code><code class="nt">tr</code><code class="p">&gt;&lt;</code><code class="nt">td</code><code class="p">&gt;</code>{{ forloop.counter }}: {{ item.text }}<code class="p">&lt;/</code><code class="nt">td</code><code class="p">&gt;&lt;/</code><code class="nt">tr</code><code class="p">&gt;</code>
    {% endfor %}
  <code class="p">&lt;/</code><code class="nt">table</code><code class="p">&gt;</code>
{% endblock %}</pre></div>
<p>That’s a refactor of the way our templates work.
We rerun the FTs to make sure we haven’t broken anything…​</p>
<pre data-type="programlisting">AssertionError: 103.333... != 512 within 10 delta (408.666...</pre>
<p>Sure enough, they’re still getting to exactly where they were before.
That’s worthy of a commit:
<a data-primary="Git" data-secondary="diff -w" data-type="indexterm" id="id464"/></p>
<pre data-type="programlisting">$ <strong>git diff -w</strong>
# the -w means ignore whitespace, useful since we've changed some html indenting
$ <strong>git status</strong>
$ <strong>git add lists/templates</strong> # leave static, for now
$ <strong>git commit -m "refactor templates to use a base template"</strong></pre>
</div></section>
<section data-pdf-bookmark="Integrating Bootstrap" data-type="sect1"><div class="sect1" id="id85">
<h1>Integrating Bootstrap</h1>
<p><a data-primary="design and layout testing" data-secondary="Bootstrap integration" data-type="indexterm" id="id465"/>
<a data-primary="Bootstrap" data-secondary="integrating" data-type="indexterm" id="id466"/>
Now it’s much easier to integrate the boilerplate code that Bootstrap wants—​we
won’t add the JavaScript yet, just the CSS:</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/base.xhtml (ch08l010)</p>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!doctype html&gt;</code>
<code class="p">&lt;</code><code class="nt">html</code> <code class="na">lang</code><code class="o">=</code><code class="s">"en"</code><code class="p">&gt;</code>

  <code class="p">&lt;</code><code class="nt">head</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">title</code><code class="p">&gt;</code>To-Do lists<code class="p">&lt;/</code><code class="nt">title</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">meta</code> <code class="na">name</code><code class="o">=</code><code class="s">"viewport"</code> <code class="na">content</code><code class="o">=</code><code class="s">"width=device-width, initial-scale=1"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"css/bootstrap.min.css"</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code><code class="p">&gt;</code>
  <code class="p">&lt;/</code><code class="nt">head</code><code class="p">&gt;</code>
[...]</pre></div>
<section data-pdf-bookmark="Rows and Columns" data-type="sect2"><div class="sect2" id="id153">
<h2>Rows and Columns</h2>
<p>Finally, let’s actually use some of the Bootstrap magic!
You’ll have to read the documentation yourself,
but we should be able to use a combination
of the grid system and the <code>justify-content-center</code> class to get what we want:</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/base.xhtml (ch08l011)</p>
<pre data-code-language="html" data-type="programlisting">  <code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code><code class="p">&gt;</code>

      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"row justify-content-center"</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"col-lg-6 text-center"</code><code class="p">&gt;</code>
          <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>{% block header_text %}{% endblock %}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>

          <code class="p">&lt;</code><code class="nt">form</code> <code class="na">method</code><code class="o">=</code><code class="s">"POST"</code> <code class="na">action</code><code class="o">=</code><code class="s">"{% block form_action %}{% endblock %}"</code> <code class="p">&gt;</code>
            <code class="p">&lt;</code><code class="nt">input</code>
              <code class="na">name</code><code class="o">=</code><code class="s">"item_text"</code>
              <code class="na">id</code><code class="o">=</code><code class="s">"id_new_item"</code>
              <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter a to-do item"</code>
            <code class="p">/&gt;</code>
            {% csrf_token %}
          <code class="p">&lt;/</code><code class="nt">form</code><code class="p">&gt;</code>
        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
      <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"row justify-content-center"</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"col-lg-6"</code><code class="p">&gt;</code>
          {% block table %}
          {% endblock %}
        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
      <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
  <code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code></pre></div>
<p>(If you’ve never seen an HTML tag broken up over several lines,
that <code>&lt;input&gt;</code> may be a little shocking.
It is definitely valid,
but you don’t have to use it if you find it offensive. ;)</p>
<div data-type="tip"><h6>Tip</h6>
<p>Take the time to browse through the
    <a href="http://getbootstrap.com/">Bootstrap documentation</a>,
    if you’ve never seen it before.
    It’s a shopping trolley brimming full of useful tools
    to use in your site.</p>
</div>
<p>Does that work?</p>
<pre data-type="programlisting">AssertionError: 103.333... != 512 within 10 delta (408.666...</pre>
<p>Hmm. No.  Why isn’t our CSS loading?</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Static Files in Django" data-type="sect1"><div class="sect1" id="id86">
<h1>Static Files in Django</h1>
<p><a data-primary="Django framework" data-secondary="static files in" data-type="indexterm" id="DJFstatic08"/>
Django, and indeed any web server,
needs to know two things to deal with static files:</p>
<ol>
<li>
<p>How to tell when a URL request is for a static file,
as opposed to for some HTML
that’s going to be served via a view function</p>
</li>
<li>
<p>Where to find the static file the user wants</p>
</li>
</ol>
<p>In other words, static files are a mapping from URLs to files on disk.</p>
<p><a data-primary="static files" data-secondary="URL requests for" data-type="indexterm" id="id467"/>
For item 1, Django lets us define a URL “prefix”
to say that any URLs which start with that prefix
should be treated as requests for static files.
By default, the prefix is 
<span class="keep-together"><em>/static/</em></span>.
It’s defined in <em>settings.py</em>:</p>
<div class="sourcecode currentcontents" data-type="example">
<p>superlists/settings.py</p>
<pre data-code-language="python" data-type="programlisting"><code class="p">[</code><code class="o">...</code><code class="p">]</code>

<code class="c1"># Static files (CSS, JavaScript, Images)</code>
<code class="c1"># https://docs.djangoproject.com/en/4.2/howto/static-files/</code>

<code class="n">STATIC_URL</code> <code class="o">=</code> <code class="s2">"static/"</code></pre></div>
<p><a data-primary="static files" data-secondary="finding" data-type="indexterm" id="id468"/>
The rest of the settings we will add to this section
are all to do with item 2:
finding the actual static files on disk.</p>
<p>While we’re using the Django development server (<code>manage.py runserver</code>),
we can rely on Django to magically find static files for us—​it’ll
just look in any subfolder of one of our apps called <em>static</em>.</p>
<p>You now see why we put all the Bootstrap static files into <em>lists/static</em>.
So why are they not working at the moment?
It’s because we’re not using the <code>/static/</code> URL prefix.
Have another look at the link to the CSS in <em>base.xhtml</em>:</p>
<pre class="sourcecode currentcontents" data-code-language="html" data-type="programlisting">    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"css/bootstrap.min.css"</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code><code class="p">&gt;</code></pre>
<p>That <code>href</code> is just what happened to be in the bootstrap docs.
To get it to work, we need to change it to:</p>
<div class="sourcecode small-code" data-type="example">
<p>lists/templates/base.xhtml (ch08l012)</p>
<pre data-code-language="html" data-type="programlisting">    <code class="p">&lt;</code><code class="nt">link</code> <code class="na">href</code><code class="o">=</code><code class="s">"/static/bootstrap/css/bootstrap.min.css"</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code><code class="p">&gt;</code></pre></div>
<p>Now when <code>runserver</code> sees the request,
it knows that it’s for a static file because it begins with <code>/static/</code>.
It then tries to find a file called <em>bootstrap/css/bootstrap.min.css</em>,
looking in each of our app folders for subfolders called <em>static</em>,
and it should find it at <em>lists/static/bootstrap/css/bootstrap.min.css</em>.</p>
<p>So if you take a look manually, you should see it works,
as in <a data-type="xref" href="#list-page-centered">Figure 8-2</a>.</p>
<figure><div class="figure" id="list-page-centered">
<img alt="The list page with centered header." height="1662" src="assets/prettified-1.png" width="2673"/>
<h6><span class="label">Figure 8-2. </span>Our site starts to look a little better…​</h6>
</div></figure>
<section data-pdf-bookmark="Switching to StaticLiveServerTestCase" data-type="sect2"><div class="sect2" id="id63">
<h2>Switching to StaticLiveServerTestCase</h2>
<p><a data-primary="StaticLiveServerTestCase" data-type="indexterm" id="id469"/>
If you run the FT though, annoyingly, it still won’t pass:</p>
<pre data-type="programlisting">AssertionError: 103.333... != 512 within 10 delta (408.666...</pre>
<p>That’s because, although <code>runserver</code> automagically finds static files,
<code>LiveServerTestCase</code> doesn’t.
Never fear, though:
the Django developers have made an even more magical test class
called <code>StaticLiveServerTestCase</code>
(see <a href="https://docs.djangoproject.com/en/4.2/topics/testing/tools/#liveservertestcase">the docs</a>).</p>
<p>Let’s switch to that:</p>
<div class="sourcecode" data-type="example">
<p>functional_tests/tests.py (ch08l013)</p>
<pre data-code-language="diff" data-type="programlisting"><code class="gu">@@ -1,14 +1,14 @@</code><code class="w"/>
<code class="gd">-from django.test import LiveServerTestCase</code><code class="w"/>
<code class="gi">+from django.contrib.staticfiles.testing import StaticLiveServerTestCase</code><code class="w"/>
<code class="w"> </code>from selenium import webdriver<code class="w"/>
<code class="w"> </code>from selenium.common.exceptions import WebDriverException<code class="w"/>
<code class="w"> </code>from selenium.webdriver.common.keys import Keys<code class="w"/>
<code class="w"> </code>import time<code class="w"/>

<code class="w"> </code>MAX_WAIT = 10<code class="w"/>


<code class="gd">-class NewVisitorTest(LiveServerTestCase):</code><code class="w"/>
<code class="gi">+class NewVisitorTest(StaticLiveServerTestCase):</code><code class="w"/>

<code class="w"> </code>    def setUp(self):<code class="w"/></pre></div>
<p>And now it will find the new CSS, which will get our test to pass:
<a data-primary="" data-startref="DJFstatic08" data-type="indexterm" id="id470"/></p>
<pre data-type="programlisting">$ <strong>python manage.py test functional_tests</strong>
Creating test database for alias 'default'...
...
 ---------------------------------------------------------------------
Ran 3 tests in 9.764s</pre>
<p>Hooray!</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Using Bootstrap Components to Improve the Look of the Site" data-type="sect1"><div class="sect1" id="id87">
<h1>Using Bootstrap Components to Improve the Look of the Site</h1>
<p><a data-primary="design and layout testing" data-secondary="Bootstrap tools" data-type="indexterm" id="id471"/>Let’s
see if we can do even better, using some of the other tools in
Bootstrap’s panoply.</p>
<section data-pdf-bookmark="Jumbotron!" data-type="sect2"><div class="sect2" id="id154">
<h2>Jumbotron!</h2>
<p>The first version of Bootstrap used to ship with a class called <code>jumbotron</code>
for things that are meant to be particularly prominent on the page.
It doesn’t exit any more, but old-timers like me still pine for it,
so they have a specific page in the docs that tells you how to recreate it.</p>
<p>Essentially, we massively embiggen the main page header and the input form,
putting it into a grey box with nice rounded corners:</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/base.xhtml (ch08l014)</p>
<pre data-code-language="html" data-type="programlisting">  <code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code><code class="p">&gt;</code>

      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"row justify-content-center p-5 bg-body-tertiary rounded-3"</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"col-lg-6 text-center"</code><code class="p">&gt;</code>
          <code class="p">&lt;</code><code class="nt">h1</code> <code class="na">class</code><code class="o">=</code><code class="s">"display-1 mb-4"</code><code class="p">&gt;</code>{% block header_text %}{% endblock %}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>
          [...]</pre></div>
<p>That ends up looking something like <a data-type="xref" href="#jumbotron-header">Figure 8-3</a>:</p>
<figure><div class="figure" id="jumbotron-header">
<img alt="The homepage with a big grey box surrounding the title and input" height="1758" src="assets/prettified-2.png" width="2724"/>
<h6><span class="label">Figure 8-3. </span>A big grey box at the top of the page</h6>
</div></figure>
<div data-type="tip"><h6>Tip</h6>
<p>When hacking about with design and layout,
    it’s best to have a window open that we can hit refresh on, frequently.
    Use <code>python manage.py runserver</code> to spin up the dev server,
    and then browse to <em><a class="bare" href="http://localhost:8000"><em class="hyperlink">http://localhost:8000</em></a></em>
    to see your work as we go.</p>
</div>
</div></section>
<section data-pdf-bookmark="Large Inputs" data-type="sect2"><div class="sect2" id="id64">
<h2>Large Inputs</h2>
<p><a data-primary="Bootstrap" data-secondary="large inputs" data-type="indexterm" id="id472"/>
<a data-primary="form control classes (Bootstrap)" data-type="indexterm" id="id473"/>
The jumbotron is a good start,
but now the input box has tiny text compared to everything else.
Thankfully, Bootstrap’s form control classes offer an option
to set an input to be “large”:</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/base.xhtml (ch08l015)</p>
<pre data-code-language="html" data-type="programlisting">    <code class="p">&lt;</code><code class="nt">input</code>
      <code class="na">class</code><code class="o">=</code><code class="s">"form-control form-control-lg"</code>
      <code class="na">name</code><code class="o">=</code><code class="s">"item_text"</code>
      <code class="na">id</code><code class="o">=</code><code class="s">"id_new_item"</code>
      <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter a to-do item"</code>
    <code class="p">/&gt;</code></pre></div>
</div></section>
<section data-pdf-bookmark="Table Styling" data-type="sect2"><div class="sect2" id="id65">
<h2>Table Styling</h2>
<p><a data-primary="Bootstrap" data-secondary="table styling" data-type="indexterm" id="id474"/>
<a data-primary="table styling (Bootstrap)" data-type="indexterm" id="id475"/>
The table text also looks too small compared to the rest of the page now.
Adding the Bootstrap <code>table</code> class improves things, over in <em>list.xhtml</em>:</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/list.xhtml (ch08l016)</p>
<pre data-code-language="html" data-type="programlisting">  <code class="p">&lt;</code><code class="nt">table</code> <code class="na">class</code><code class="o">=</code><code class="s">"table"</code> <code class="na">id</code><code class="o">=</code><code class="s">"id_list_table"</code><code class="p">&gt;</code></pre></div>
</div></section>
<section data-pdf-bookmark="Dark Modeeeeeee" data-type="sect2"><div class="sect2" id="id155">
<h2>Dark Modeeeeeee</h2>
<p>In contrast to my greybeard nostalgia for the Jumbotron,
here’s something relatively new to Bootstrap, Dark Mode!</p>
<div class="sourcecode" data-type="example">
<p>lists/templates/base.xhtml (ch08l017)</p>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!doctype html&gt;</code>
<code class="p">&lt;</code><code class="nt">html</code> <code class="na">lang</code><code class="o">=</code><code class="s">"en"</code> <code class="na">data-bs-theme</code><code class="o">=</code><code class="s">"dark"</code><code class="p">&gt;</code></pre></div>
<p>Take a look at <a data-type="xref" href="#dark-modeee">Figure 8-4</a>.
I think that looks great!</p>
<figure><div class="figure" id="dark-modeee">
<img alt="Screenshot of lists page in dark mode. Cool." height="1760" src="assets/prettified-dark.png" width="2719"/>
<h6><span class="label">Figure 8-4. </span>The lists page goes dark</h6>
</div></figure>
<p>But it’s very much a matter of personal preference,
and my editor will kill me
if I make all the rest of my screenshots use so much ink,
so I’m going to revert it for now.
You feel free to keep it if you like!</p>
</div></section>
<section data-pdf-bookmark="A semi-decent page" data-type="sect2"><div class="sect2" id="id156">
<h2>A semi-decent page</h2>
<p>All that took me a few goes, but I’m reasonably happy with it now
(<a data-type="xref" href="#homepage-looking-better">Figure 8-5</a>).</p>
<figure><div class="figure" id="homepage-looking-better">
<img alt="Screenshot of lists page in light mode with decent styling." height="1773" src="assets/prettified-final.png" width="2729"/>
<h6><span class="label">Figure 8-5. </span>The lists page, looking good enough for now…​</h6>
</div></figure>
<p>If you want to go further with customising Bootstrap,
you need to get into compiling Sass.
I’ve said it already, but I <em>definitely</em> recommend
taking the time to do that some day.
Sass/SCSS is a great improvement on plain old CSS,
and a useful tool even if you don’t use Bootstrap.</p>
<p>A last run of the functional tests, to see if everything still works OK:</p>
<pre class="dofirst-ch08l018" data-type="programlisting">$ <strong>python manage.py test functional_tests</strong>
[...]
...
 ---------------------------------------------------------------------
Ran 3 tests in 10.084s

OK</pre>
<p>That’s it! Definitely time for a commit:</p>
<pre data-type="programlisting">$ <strong>git status</strong> # changes tests.py, base.xhtml, list.xhtml, settings.py, + untracked lists/static
$ <strong>git add .</strong>
$ <strong>git status</strong> # will now show all the bootstrap additions
$ <strong>git commit -m "Use Bootstrap to improve layout"</strong></pre>
</div></section>
</div></section>
<section data-pdf-bookmark="What We Glossed Over: collectstatic and Other Static Directories" data-type="sect1"><div class="sect1" id="id66">
<h1>What We Glossed Over: collectstatic and Other Static Directories</h1>
<p><a data-primary="design and layout testing" data-secondary="collecting static files for deployment" data-type="indexterm" id="DLTcollect08"/>
<a data-primary="static files" data-secondary="collecting for deployment" data-type="indexterm" id="SFcollect08"/>
<a data-primary="collectstatic command" data-type="indexterm" id="collect08"/>
We saw earlier that the Django dev server will magically find all your static files
inside app folders, and serve them for you.
That’s fine during development,
but when you’re running on a real web server,
you don’t want Django serving your static content—​using Python
to serve raw files is slow and inefficient,
and a web server like Apache or Nginx can do this all for you.
You might even decide to upload all your static files to a CDN,
instead of hosting them yourself.</p>
<p>For these reasons, you want to be able to gather up all your static files
from inside their various app folders,
and copy them into a single location, ready for deployment.
This is what the <code>collectstatic</code> command is for.</p>
<p>The destination, the place where the collected static files go, is defined in
<em>settings.py</em> as <code>STATIC_ROOT</code>. In the next chapter we’ll be doing some
deployment, so let’s actually experiment with that now.  A common and
straightforward place to put it is in a folder called “static” in the root
of our repo:</p>
<pre class="skipme" data-type="programlisting">.
├── db.sqlite3
├── functional_tests/
├── lists/
├── manage.py
├── static/
└── superlists/</pre>
<p>Here’s a neat way of specifying that folder,
making it relative to the location of the project base directory:</p>
<div class="sourcecode" data-type="example">
<p>superlists/settings.py (ch08l019)</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># Static files (CSS, JavaScript, Images)</code>
<code class="c1"># https://docs.djangoproject.com/en/4.2/howto/static-files/</code>

<code class="n">STATIC_URL</code> <code class="o">=</code> <code class="s2">"static/"</code>
<code class="n">STATIC_ROOT</code> <code class="o">=</code> <code class="n">BASE_DIR</code> <code class="o">/</code> <code class="s2">"static"</code></pre></div>
<p>Take a look at the top of the settings file,
and you’ll see how that <code>BASE_DIR</code> variable is helpfully defined for us,
using <code>pathlib.Path</code> and <code>__file__</code>
(both really nice Python builtins)<sup><a data-type="noteref" href="ch08.xhtml#id476" id="id476-marker">3</a></sup>.</p>
<p>Anyway, let’s try running <code>collectstatic</code>:</p>
<pre data-type="programlisting">$ <strong>python manage.py collectstatic</strong>

169 static files copied to '...goat-book/static'.</pre>
<p>And if we look in <em>./static</em>, we’ll find all our CSS files:</p>
<pre data-type="programlisting">$ <strong>tree -v static/</strong>
static/
├── admin
│   ├── css
│   │   ├── autocomplete.css
│   │   ├── [...]
[...]
│               └── xregexp.min.js
└── bootstrap
    ├── css
    │   ├── bootstrap-grid.css
    │   ├── [...]
    │   └── bootstrap.rtl.min.css.map
    └── js
        ├── bootstrap.bundle.js
        ├── [...]
        └── bootstrap.min.js.map

16 directories, 169 files</pre>
<p><code>collectstatic</code> has also picked up all the CSS for the admin site.
The admin site is one of Django’s powerful features,
but we don’t need it for our simple site, so let’s disable it for now:</p>
<div class="sourcecode" data-type="example">
<p>superlists/settings.py</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">INSTALLED_APPS</code> <code class="o">=</code> <code class="p">[</code>
    <code class="c1"># "django.contrib.admin",</code>
    <code class="s2">"django.contrib.auth"</code><code class="p">,</code>
    <code class="s2">"django.contrib.contenttypes"</code><code class="p">,</code>
    <code class="s2">"django.contrib.sessions"</code><code class="p">,</code>
    <code class="s2">"django.contrib.messages"</code><code class="p">,</code>
    <code class="s2">"django.contrib.staticfiles"</code><code class="p">,</code>
    <code class="s2">"lists"</code><code class="p">,</code>
<code class="p">]</code></pre></div>
<p class="pagebreak-before">And we try again:</p>
<pre data-type="programlisting">$ <strong>rm -rf static/</strong>
$ <strong>python manage.py collectstatic</strong>

44 static files copied to '...goat-book/static'.</pre>
<p>Much better.</p>
<p>Now we know how to collect all the static files into a single folder,
where it’s easy for a web server to find them.
We’ll find out all about that, including how to test it, in the next chapter!</p>
<p><a data-primary="" data-startref="DLTcollect08" data-type="indexterm" id="id477"/>
<a data-primary="" data-startref="SFcollect08" data-type="indexterm" id="id478"/>
<a data-primary="" data-startref="collect08" data-type="indexterm" id="id479"/>
For now let’s save our changes to <em>settings.py</em>.
We’ll also add the top-level static folder to our gitignore,
since it will only contain copies of files
we actually keep in individual apps’ static folders.</p>
<pre data-type="programlisting">$ <strong>git diff</strong> # should show changes in settings.py plus the new directory*
$ <strong>echo /static &gt;&gt; .gitignore</strong>
$ <strong>git commit -am "set STATIC_ROOT in settings and disable admin"</strong></pre>
</div></section>
<section data-pdf-bookmark="A Few Things That Didn’t Make It" data-type="sect1"><div class="sect1" id="id88">
<h1>A Few Things That Didn’t Make It</h1>
<p>Inevitably this was only a whirlwind tour of styling and CSS,
and there were several topics that I’d considered covering that didn’t make it.
Here are a few candidates for further study:</p>
<ul>
<li>
<p>The <code>{% static %}</code> template tag, for more DRY and fewer hardcoded URLs</p>
</li>
<li>
<p>Client-side packaging tools, like <code>npm</code> and <code>bower</code></p>
</li>
<li>
<p>And again, customising bootstrap with SASS</p>
</li>
</ul>
<aside class="pagebreak-before less_space" data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id480">
<h1>Recap: On Testing Design and Layout</h1>
<p><a data-primary="design and layout testing" data-secondary="best practices for" data-type="indexterm" id="id481"/>
The short answer is: you shouldn’t write tests for design and layout <em>per se</em>.
It’s too much like testing a constant,
and the tests you write are often brittle.</p>
<p>With that said,
the <em>implementation</em> of design and layout involves something quite tricky:
CSS and static files.
As a result, it is valuable to have some kind of minimal “smoke test”
which checks that your static files and CSS are working.
As we’ll see in the next chapter, it can help pick up problems
when you deploy your code to 
<span class="keep-together">production</span>.</p>
<p>Similarly, if a particular piece of styling required a lot of client-side JavaScript code
to get it to work
(dynamic resizing is one I’ve spent a bit of time on),
you’ll definitely want some tests for that.</p>
<p>Try to write the minimal tests that will give you confidence
that your design and layout is working,
without testing <em>what</em> it actually is.
Aim to leave yourself in a position
where you can freely make changes to the design and layout,
without having to go back and adjust tests all the time.</p>
</div></aside>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="id450"><sup><a href="ch08.xhtml#id450-marker">1</a></sup> What? Delete the database?  Are you crazy?  Not completely.     The local dev database often gets out of sync with its migrations as we     go back and forth in our development, and it doesn’t have any important     data in it, so it’s OK to blow it away now and again.  We’ll be much more     careful once we have a “production” database on the server.  More on this     in [Link to Come].</p><p data-type="footnote" id="id457"><sup><a href="ch08.xhtml#id457-marker">2</a></sup> On Windows, you may not have <code>wget</code> and <code>unzip</code>, but I’m sure you can figure out how to download Bootstrap, unzip it, and put the contents of the <em>dist</em> folder into the <em>lists/static/bootstrap</em> folder.</p><p data-type="footnote" id="id476"><sup><a href="ch08.xhtml#id476-marker">3</a></sup> Notice in the <code>Pathlib</code> wrangling of <code>__file__</code> that the <code>.resolve()</code> happens before anything else. Always follow this pattern when working with <code>__file__</code>, otherwise you can see unpredictable behaviours depending on how the file is imported. Thanks to <a href="https://github.com/CleanCut/green">Green Nathan</a> for that tip!</p></div></div></section></div>

<div id="sbo-rt-content"><section class="abouttheauthor" data-pdf-bookmark="About the Author" data-type="colophon" epub:type="colophon"><div class="colophon" id="id126">
<h1>About the Author</h1>
<p>After an idyllic childhood spent playing with BASIC on French 8-bit computers like the Thomson T-07 whose keys go “boop” when you press them, Harry spent a few years being deeply unhappy with economics and management consultancy.  Soon he rediscovered his true geek nature, and was lucky enough to fall in with a bunch of XP fanatics, working on the pioneering but sadly defunct Resolver One spreadsheet.  He now works at PythonAnywhere LLP, and spreads the gospel of TDD worldwide at talks, workshops, and conferences, with all the passion and enthusiasm of a recent convert.</p>
</div></section></div></body></html>