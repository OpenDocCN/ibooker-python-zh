<html><head></head><body><section data-pdf-bookmark="Chapter 9. Functions" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch_functions">&#13;
<h1><span class="label">Chapter 9. </span>Functions</h1>&#13;
&#13;
<blockquote>&#13;
<p><a data-primary="functions" data-seealso="methods; specific functions" data-type="indexterm" id="ix_ch09-functions-asciidoc0"/>The smaller the function, the greater the management.</p>&#13;
<p data-type="attribution">C. Northcote Parkinson</p>&#13;
</blockquote>&#13;
&#13;
<p>So far, all of our Python code examples have been little fragments.&#13;
These are good for small tasks,&#13;
but no one wants to retype fragments all the time.&#13;
We need some way&#13;
of organizing larger code into manageable pieces.</p>&#13;
&#13;
<p>The first step to code reuse is the <em>function</em>:&#13;
a named piece of code, separate from all others.&#13;
A function can take any number and type of input&#13;
<em>parameters</em>&#13;
and return any number and type of output <em>results</em>.</p>&#13;
&#13;
<p>You can do two things with a function:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><em>Define</em> it, with zero or more parameters</p>&#13;
</li>&#13;
<li>&#13;
<p><em>Call</em> it, and get zero or more results</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Define a Function with def" data-type="sect1"><div class="sect1" id="def">&#13;
<h1>Define a Function with def</h1>&#13;
&#13;
<p><a data-primary="functions" data-secondary="defining" data-type="indexterm" id="idm45795004314504"/>To define a Python function,&#13;
you type <code>def</code>, the function name,&#13;
parentheses enclosing any input <em>parameters</em>&#13;
to the function,&#13;
and then finally, a colon (<code>:</code>).&#13;
Function names have the same rules as variable names&#13;
(they must start with a letter or <code>_</code> and contain only&#13;
letters, numbers, or <code>_</code>).</p>&#13;
&#13;
<p>Let’s take things one step at a time,&#13;
and first define and call a function that has&#13;
no parameters.&#13;
Here’s the simplest Python function:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">do_nothing</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">pass</code></pre>&#13;
&#13;
<p>Even for a function with no parameters like this one,&#13;
you still need the parentheses&#13;
and the colon in its definition.&#13;
The next line needs to be indented,&#13;
just as you would indent code under an <code>if</code> statement.&#13;
Python requires the <code>pass</code> statement to show that&#13;
this function does nothing.&#13;
It’s the equivalent of&#13;
<em>This page intentionally left blank</em>&#13;
(even though it isn’t anymore).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Call a Function with Parentheses" data-type="sect1"><div class="sect1" id="idm45795004292072">&#13;
<h1>Call a Function with Parentheses</h1>&#13;
&#13;
<p><a data-primary="functions" data-secondary="calling with parenthesis" data-type="indexterm" id="idm45795004290536"/>You call this function just by typing its name&#13;
and parentheses.&#13;
It works as advertised,&#13;
doing nothing, but doing it very well:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">do_nothing</code><code class="p">()</code>&#13;
<code class="go">&gt;&gt;&gt;</code></pre>&#13;
&#13;
<p>Now let’s define and call another function&#13;
that has no parameters but prints a single word:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">make_a_sound</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'quack'</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">make_a_sound</code><code class="p">()</code>&#13;
<code class="go">quack</code></pre>&#13;
&#13;
<p>When you called the <code>make_a_sound()</code> function,&#13;
Python ran the code inside its definition.&#13;
In this case, it printed a single word&#13;
and returned to the main program.</p>&#13;
&#13;
<p>Let’s try&#13;
a function that has no parameters&#13;
but <em>returns</em> a value:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">agree</code><code class="p">():</code>&#13;
<code class="gp">... </code>   <code class="k">return</code> <code class="bp">True</code>&#13;
<code class="gp">...</code></pre>&#13;
&#13;
<p>You can call this function and test&#13;
its returned value by using <code>if</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">if</code> <code class="n">agree</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'Splendid!'</code><code class="p">)</code>&#13;
<code class="gp">... </code><code class="k">else</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'That was unexpected.'</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">Splendid!</code></pre>&#13;
&#13;
<p>You’ve just made a big step.&#13;
The combination of functions with tests such as <code>if</code>&#13;
and loops such as <code>while</code> make it possible for you to do things&#13;
that you could not do before.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Arguments and Parameters" data-type="sect1"><div class="sect1" id="arguments">&#13;
<h1>Arguments and Parameters</h1>&#13;
&#13;
<p><a data-primary="arguments" data-type="indexterm" id="ix_ch09-functions-asciidoc1"/><a data-primary="functions" data-secondary="arguments and parameters" data-type="indexterm" id="ix_ch09-functions-asciidoc2"/><a data-primary="values" data-secondary="arguments versus parameters" data-type="indexterm" id="ix_ch09-functions-asciidoc3"/>At this point, it’s time to put something between those&#13;
parentheses.&#13;
Let’s define the function <code>echo()</code> with one&#13;
parameter called <code>anything</code>.&#13;
It uses the <code>return</code> statement to&#13;
send the value of <code>anything</code> back to its caller&#13;
twice, with a space between:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">echo</code><code class="p">(</code><code class="n">anything</code><code class="p">):</code>&#13;
<code class="gp">... </code>   <code class="k">return</code> <code class="n">anything</code> <code class="o">+</code> <code class="s">' '</code> <code class="o">+</code> <code class="n">anything</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">&gt;&gt;&gt;</code></pre>&#13;
&#13;
<p>Now let’s call <code>echo()</code> with the string <code>'Rumplestiltskin'</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">echo</code><code class="p">(</code><code class="s">'Rumplestiltskin'</code><code class="p">)</code>&#13;
<code class="go">'Rumplestiltskin Rumplestiltskin'</code></pre>&#13;
&#13;
<p><a data-primary="arguments" data-secondary="defined" data-type="indexterm" id="idm45795004098808"/>The values you pass into the function when you call it&#13;
are known as <em>arguments</em>.&#13;
<a data-primary="parameters" data-secondary="defined" data-type="indexterm" id="idm45795004096888"/>When you call a function with arguments,&#13;
the values of those&#13;
arguments are copied to their corresponding <em>parameters</em>&#13;
inside the function.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Saying it another way:&#13;
they’re called <em>arguments</em> outside of the function,&#13;
but <em>parameters</em> inside.</p>&#13;
</div>&#13;
&#13;
<p>In the previous example,&#13;
the function <code>echo()</code> was called with the argument string&#13;
<code>'Rumplestiltskin'</code>.&#13;
This value was copied within <code>echo()</code> to the parameter&#13;
<code>anything</code>, and then returned&#13;
(in this case doubled, with a space)&#13;
to the caller.</p>&#13;
&#13;
<p>These function examples were pretty basic.&#13;
Let’s write a function that takes an input argument&#13;
and actually does something with it.&#13;
We’ll adapt the earlier code fragment that comments on a color.&#13;
Call it <code>commentary</code>&#13;
and have it take an input string parameter called <code>color</code>.&#13;
Make it return the string description to its caller,&#13;
which can decide what to do with it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">commentary</code><code class="p">(</code><code class="n">color</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="n">color</code> <code class="o">==</code> <code class="s">'red'</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="s">"It's a tomato."</code>&#13;
<code class="gp">... </code>    <code class="k">elif</code> <code class="n">color</code> <code class="o">==</code> <code class="s">"green"</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="s">"It's a green pepper."</code>&#13;
<code class="gp">... </code>    <code class="k">elif</code> <code class="n">color</code> <code class="o">==</code> <code class="s">'bee purple'</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="s">"I don't know what it is, but only bees can see it."</code>&#13;
<code class="gp">... </code>    <code class="k">else</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="s">"I've never heard of the color "</code>  <code class="o">+</code> <code class="n">color</code> <code class="o">+</code>  <code class="s">"."</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">&gt;&gt;&gt;</code></pre>&#13;
&#13;
<p>Call the function <code>commentary()</code>&#13;
with the string argument <code>'blue'</code>.</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">comment</code> <code class="o">=</code> <code class="n">commentary</code><code class="p">(</code><code class="s">'blue'</code><code class="p">)</code></pre>&#13;
&#13;
<p>The function does the following:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Assigns the value <code>'blue'</code> to the function’s&#13;
internal <code>color</code> parameter</p>&#13;
</li>&#13;
<li>&#13;
<p>Runs through the <code>if</code>-<code>elif</code>-<code>else</code> logic chain</p>&#13;
</li>&#13;
<li>&#13;
<p>Returns a string</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>The caller then assigns the string to the variable <code>comment</code>.</p>&#13;
&#13;
<p>What did we get back?</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="n">comment</code><code class="p">)</code>&#13;
<code class="go">I've never heard of the color blue.</code></pre>&#13;
&#13;
<p>A function can take any number of input arguments&#13;
(including zero) of any type.&#13;
It can return any number of output results&#13;
(also including zero) of any type.&#13;
If a function doesn’t call <code>return</code> explicitly,&#13;
the caller gets the result <code>None</code>.</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="n">do_nothing</code><code class="p">())</code>&#13;
<code class="go">None</code></pre>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="None Is Useful" data-type="sect2"><div class="sect2" id="none">&#13;
<h2>None Is Useful</h2>&#13;
&#13;
<p><a data-primary="arguments" data-secondary="None" data-type="indexterm" id="idm45795003990424"/><a data-primary="None value" data-type="indexterm" id="idm45795003989560"/><a data-primary="values" data-secondary="None" data-type="indexterm" id="idm45795003988888"/><code>None</code> is a special Python value that holds a place when there is&#13;
nothing to say.&#13;
It is not the same as the boolean value <code>False</code>,&#13;
although it looks false when evaluated as a boolean.&#13;
Here’s an example:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">thing</code> <code class="o">=</code> <code class="bp">None</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">if</code> <code class="n">thing</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">"It's some thing"</code><code class="p">)</code>&#13;
<code class="gp">... </code><code class="k">else</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">"It's no thing"</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">It's no thing</code></pre>&#13;
&#13;
<p><a data-primary="false values" data-type="indexterm" id="idm45795003911864"/><a data-primary="values" data-secondary="false" data-type="indexterm" id="idm45795003886696"/>To distinguish <code>None</code> from a boolean <code>False</code> value,&#13;
use Python’s <code>is</code> operator:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">thing</code> <code class="o">=</code> <code class="bp">None</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">if</code> <code class="n">thing</code> <code class="ow">is</code> <code class="bp">None</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">"It's nothing"</code><code class="p">)</code>&#13;
<code class="gp">... </code><code class="k">else</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">"It's something"</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">It's nothing</code></pre>&#13;
&#13;
<p>This seems like a subtle distinction, but it’s&#13;
important in Python.&#13;
You’ll need <code>None</code> to distinguish a missing value&#13;
from an empty value.&#13;
Remember that zero-valued integers or floats,&#13;
empty strings (<code>''</code>),&#13;
lists (<code>[]</code>),&#13;
tuples (<code>(,)</code>),&#13;
dictionaries (<code>{}</code>),&#13;
and sets (<code>set()</code>)&#13;
are all <code>False</code>,&#13;
but are not the same as <code>None</code>.</p>&#13;
&#13;
<p>Let’s write a quick function that&#13;
prints whether its argument is <code>None</code>,&#13;
<code>True</code>, or <code>False</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">whatis</code><code class="p">(</code><code class="n">thing</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="n">thing</code> <code class="ow">is</code> <code class="bp">None</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="n">thing</code><code class="p">,</code> <code class="s">"is None"</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">elif</code> <code class="n">thing</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="n">thing</code><code class="p">,</code> <code class="s">"is True"</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">else</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="n">thing</code><code class="p">,</code> <code class="s">"is False"</code><code class="p">)</code>&#13;
<code class="gp">...</code></pre>&#13;
&#13;
<p>Let’s run some sanity tests:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="bp">None</code><code class="p">)</code>&#13;
<code class="go">None is None</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="bp">True</code><code class="p">)</code>&#13;
<code class="go">True is True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="bp">False</code><code class="p">)</code>&#13;
<code class="go">False is False</code></pre>&#13;
&#13;
<p>How about some real values?</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>&#13;
<code class="go">0 is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="mf">0.0</code><code class="p">)</code>&#13;
<code class="go">0.0 is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="s">''</code><code class="p">)</code>&#13;
<code class="go"> is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="s">""</code><code class="p">)</code>&#13;
<code class="go"> is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="s">''''''</code><code class="p">)</code>&#13;
<code class="go"> is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(())</code>&#13;
<code class="go">() is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">([])</code>&#13;
<code class="go">[] is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">({})</code>&#13;
<code class="go">{} is False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="nb">set</code><code class="p">())</code>&#13;
<code class="go">set() is False</code></pre>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="mf">0.00001</code><code class="p">)</code>&#13;
<code class="go">1e-05 is True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">([</code><code class="mi">0</code><code class="p">])</code>&#13;
<code class="go">[0] is True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">([</code><code class="s">''</code><code class="p">])</code>&#13;
<code class="go">[''] is True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">whatis</code><code class="p">(</code><code class="s">' '</code><code class="p">)</code>&#13;
<code class="go">  is True</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Positional Arguments" data-type="sect2"><div class="sect2" id="positional_arguments">&#13;
<h2>Positional Arguments</h2>&#13;
&#13;
<p><a data-primary="arguments" data-secondary="positional" data-type="indexterm" id="idm45795003603656"/><a data-primary="functions" data-secondary="positional arguments and" data-type="indexterm" id="idm45795003602680"/><a data-primary="positional arguments" data-type="indexterm" id="idm45795003532296"/>Python handles function arguments in a manner that’s very&#13;
flexible, when compared to many languages.&#13;
The most familiar types of arguments are <em>positional arguments</em>,&#13;
whose values are copied to their corresponding parameters in order.</p>&#13;
&#13;
<p>This function builds a dictionary from its&#13;
positional input arguments and returns it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">menu</code><code class="p">(</code><code class="n">wine</code><code class="p">,</code> <code class="n">entree</code><code class="p">,</code> <code class="n">dessert</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="p">{</code><code class="s">'wine'</code><code class="p">:</code> <code class="n">wine</code><code class="p">,</code> <code class="s">'entree'</code><code class="p">:</code> <code class="n">entree</code><code class="p">,</code> <code class="s">'dessert'</code><code class="p">:</code> <code class="n">dessert</code><code class="p">}</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">menu</code><code class="p">(</code><code class="s">'chardonnay'</code><code class="p">,</code> <code class="s">'chicken'</code><code class="p">,</code> <code class="s">'cake'</code><code class="p">)</code>&#13;
<code class="go">{'wine': 'chardonnay', 'entree': 'chicken', 'dessert': 'cake'}</code></pre>&#13;
&#13;
<p>Although very common, a downside of positional&#13;
arguments is that you need to remember the&#13;
meaning of each position.&#13;
If we forgot and called <code>menu()</code>&#13;
with wine as the last argument instead of the first, the meal would be&#13;
very different:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">menu</code><code class="p">(</code><code class="s">'beef'</code><code class="p">,</code> <code class="s">'bagel'</code><code class="p">,</code> <code class="s">'bordeaux'</code><code class="p">)</code>&#13;
<code class="go">{'wine': 'beef', 'entree': 'bagel', 'dessert': 'bordeaux'}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Keyword Arguments" data-type="sect2"><div class="sect2" id="keyword_arguments">&#13;
<h2>Keyword Arguments</h2>&#13;
&#13;
<p><a data-primary="arguments" data-secondary="keyword" data-type="indexterm" id="idm45795003474600"/><a data-primary="functions" data-secondary="keyword arguments and" data-type="indexterm" id="idm45795003473624"/><a data-primary="keyword arguments" data-type="indexterm" id="idm45795003472680"/>To avoid positional argument confusion,&#13;
you can specify arguments&#13;
by the names of their corresponding parameters,&#13;
even in a different order from their definition&#13;
in the function:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">menu</code><code class="p">(</code><code class="n">entree</code><code class="o">=</code><code class="s">'beef'</code><code class="p">,</code> <code class="n">dessert</code><code class="o">=</code><code class="s">'bagel'</code><code class="p">,</code> <code class="n">wine</code><code class="o">=</code><code class="s">'bordeaux'</code><code class="p">)</code>&#13;
<code class="go">{'wine': 'bordeaux', 'entree': 'beef', 'dessert': 'bagel'}</code></pre>&#13;
&#13;
<p>You can mix positional and keyword arguments.&#13;
Let’s specify the wine first, but use keyword arguments&#13;
for the entree and dessert:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">menu</code><code class="p">(</code><code class="s">'frontenac'</code><code class="p">,</code> <code class="n">dessert</code><code class="o">=</code><code class="s">'flan'</code><code class="p">,</code> <code class="n">entree</code><code class="o">=</code><code class="s">'fish'</code><code class="p">)</code>&#13;
<code class="go">{'wine': 'frontenac', 'entree': 'fish', 'dessert': 'flan'}</code></pre>&#13;
&#13;
<p>If you call a function with both&#13;
positional and keyword arguments,&#13;
the positional arguments need to come first.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Specify Default Parameter Values" data-type="sect2"><div class="sect2" id="default_values">&#13;
<h2>Specify Default Parameter Values</h2>&#13;
&#13;
<p><a data-primary="arguments" data-secondary="default parameter values for" data-type="indexterm" id="idm45795003394968"/><a data-primary="functions" data-secondary="default parameter values" data-type="indexterm" id="idm45795003394024"/><a data-primary="parameters" data-secondary="default values for" data-type="indexterm" id="idm45795003393112"/><a data-primary="values" data-secondary="default parameter" data-type="indexterm" id="idm45795003392168"/>You can specify default values for parameters.&#13;
The default&#13;
is used if the caller does not provide a corresponding argument.&#13;
This bland-sounding feature can actually be quite useful.&#13;
Using the previous example:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">menu</code><code class="p">(</code><code class="n">wine</code><code class="p">,</code> <code class="n">entree</code><code class="p">,</code> <code class="n">dessert</code><code class="o">=</code><code class="s">'pudding'</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="p">{</code><code class="s">'wine'</code><code class="p">:</code> <code class="n">wine</code><code class="p">,</code> <code class="s">'entree'</code><code class="p">:</code> <code class="n">entree</code><code class="p">,</code> <code class="s">'dessert'</code><code class="p">:</code> <code class="n">dessert</code><code class="p">}</code></pre>&#13;
&#13;
<p>This time, try calling <code>menu()</code> without the <code>dessert</code> argument:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">menu</code><code class="p">(</code><code class="s">'chardonnay'</code><code class="p">,</code> <code class="s">'chicken'</code><code class="p">)</code>&#13;
<code class="go">{'wine': 'chardonnay', 'entree': 'chicken', 'dessert': 'pudding'}</code></pre>&#13;
&#13;
<p>If you do provide an argument, it’s used&#13;
instead of the default:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">menu</code><code class="p">(</code><code class="s">'dunkelfelder'</code><code class="p">,</code> <code class="s">'duck'</code><code class="p">,</code> <code class="s">'doughnut'</code><code class="p">)</code>&#13;
<code class="go">{'wine': 'dunkelfelder', 'entree': 'duck', 'dessert': 'doughnut'}</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Default parameter values are calculated when&#13;
the function is <em>defined</em>, not when it is run.&#13;
A common error with new (and sometimes not-so-new)&#13;
Python programmers is to use a mutable&#13;
data type such as a list or dictionary&#13;
as a default parameter.</p>&#13;
</div>&#13;
&#13;
<p>In the following test,&#13;
the <code>buggy()</code> function&#13;
is expected to run each time with a fresh&#13;
empty <code>result</code> list,&#13;
add the <code>arg</code> argument to it,&#13;
and then print a single-item list.&#13;
However, there’s a bug:&#13;
it’s empty only the first time it’s called.&#13;
The second time, <code>result</code> still has one item&#13;
from the previous call:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">buggy</code><code class="p">(</code><code class="n">arg</code><code class="p">,</code> <code class="n">result</code><code class="o">=</code><code class="p">[]):</code>&#13;
<code class="gp">... </code>    <code class="n">result</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">arg</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">result</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">buggy</code><code class="p">(</code><code class="s">'a'</code><code class="p">)</code>&#13;
<code class="go">['a']</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">buggy</code><code class="p">(</code><code class="s">'b'</code><code class="p">)</code>   <code class="c"># expect ['b']</code>&#13;
<code class="go">['a', 'b']</code></pre>&#13;
&#13;
<p>It would have worked if it had been written like this:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">works</code><code class="p">(</code><code class="n">arg</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="n">result</code> <code class="o">=</code> <code class="p">[]</code>&#13;
<code class="gp">... </code>    <code class="n">result</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">arg</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">result</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">works</code><code class="p">(</code><code class="s">'a'</code><code class="p">)</code>&#13;
<code class="go">['a']</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">works</code><code class="p">(</code><code class="s">'b'</code><code class="p">)</code>&#13;
<code class="go">['b']</code></pre>&#13;
&#13;
<p>The fix is to pass in something else to indicate&#13;
the first call:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">nonbuggy</code><code class="p">(</code><code class="n">arg</code><code class="p">,</code> <code class="n">result</code><code class="o">=</code><code class="bp">None</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="n">result</code> <code class="ow">is</code> <code class="bp">None</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="n">result</code> <code class="o">=</code> <code class="p">[]</code>&#13;
<code class="gp">... </code>    <code class="n">result</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">arg</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">result</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">nonbuggy</code><code class="p">(</code><code class="s">'a'</code><code class="p">)</code>&#13;
<code class="go">['a']</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">nonbuggy</code><code class="p">(</code><code class="s">'b'</code><code class="p">)</code>&#13;
<code class="go">['b']</code></pre>&#13;
&#13;
<p>This is sometimes a Python job interview question.&#13;
You’ve been warned.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Explode/Gather Positional Arguments with *" data-type="sect2"><div class="sect2" id="args">&#13;
<h2>Explode/Gather Positional Arguments with *</h2>&#13;
&#13;
<p><a data-primary="* (asterisk)" data-secondary="exploding/gathering positional arguments with" data-type="indexterm" id="ix_ch09-functions-asciidoc4"/><a data-primary="arguments" data-secondary="exploding/gathering positional arguments" data-type="indexterm" id="ix_ch09-functions-asciidoc5"/><a data-primary="asterisk (*)" data-secondary="exploding/gathering positional arguments with" data-type="indexterm" id="ix_ch09-functions-asciidoc6"/><a data-primary="positional arguments" data-type="indexterm" id="ix_ch09-functions-asciidoc7"/>If you’ve programmed in C or C++,&#13;
you might assume that&#13;
an asterisk (<code>*</code>) in a Python program&#13;
has something to do with a <em>pointer</em>.&#13;
Nope, Python doesn’t have pointers.</p>&#13;
&#13;
<p>When used inside the function with a parameter,&#13;
an asterisk groups a variable number of positional arguments&#13;
into a single tuple of parameter values.&#13;
In the following example, <code>args</code> is the parameter&#13;
tuple that resulted from zero or more arguments that were&#13;
passed to the function <code>print_args()</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">print_args</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'Positional tuple:'</code><code class="p">,</code> <code class="n">args</code><code class="p">)</code>&#13;
<code class="gp">...</code></pre>&#13;
&#13;
<p>If you call the function with no arguments,&#13;
you get nothing in <code>*args</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">print_args</code><code class="p">()</code>&#13;
<code class="go">Positional tuple: ()</code></pre>&#13;
&#13;
<p>Whatever you give it will be printed as the <code>args</code> tuple:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">print_args</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="s">'wait!'</code><code class="p">,</code> <code class="s">'uh...'</code><code class="p">)</code>&#13;
<code class="go">Positional tuple: (3, 2, 1, 'wait!', 'uh...')</code></pre>&#13;
&#13;
<p>This is useful for writing functions such as <code>print()</code> that accept&#13;
a variable number of arguments.&#13;
If your function has <em>required</em> positional arguments, as well,&#13;
put them first;&#13;
<code>*args</code> goes at the end and grabs all the rest:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">print_more</code><code class="p">(</code><code class="n">required1</code><code class="p">,</code> <code class="n">required2</code><code class="p">,</code> <code class="o">*</code><code class="n">args</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'Need this one:'</code><code class="p">,</code> <code class="n">required1</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'Need this one too:'</code><code class="p">,</code> <code class="n">required2</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'All the rest:'</code><code class="p">,</code> <code class="n">args</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_more</code><code class="p">(</code><code class="s">'cap'</code><code class="p">,</code> <code class="s">'gloves'</code><code class="p">,</code> <code class="s">'scarf'</code><code class="p">,</code> <code class="s">'monocle'</code><code class="p">,</code> <code class="s">'mustache wax'</code><code class="p">)</code>&#13;
<code class="go">Need this one: cap</code>&#13;
<code class="go">Need this one too: gloves</code>&#13;
<code class="go">All the rest: ('scarf', 'monocle', 'mustache wax')</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>When using <code>*</code>, you don’t need to call the tuple&#13;
argument <code>*args</code>, but it’s a common idiom in Python.&#13;
It’s also common to use <code>*args</code> inside the function,&#13;
as in the preceding example,&#13;
although technically it’s called a parameter&#13;
and could be referred to as <code>*params</code>.</p>&#13;
</div>&#13;
&#13;
<p>Summarizing:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>You can pass positional argument to a function,&#13;
which will match them inside to positional parameters.&#13;
This is what you’ve seen so far in this book.</p>&#13;
</li>&#13;
<li>&#13;
<p>You can pass a tuple argument to a function,&#13;
and inside it will be a tuple parameter.&#13;
This is a simple case of the preceding one.</p>&#13;
</li>&#13;
<li>&#13;
<p>You can pass positional arguments to a function,&#13;
and gather them inside as the parameter <code>*args</code>,&#13;
which resolves to the tuple <code>args</code>.&#13;
This was described in this <span class="keep-together">section.</span></p>&#13;
</li>&#13;
<li>&#13;
<p>You can also “explode” a tuple argument called <code>args</code>&#13;
to positional parameters <code>*args</code> inside the function, which will be regathered inside into&#13;
the tuple parameter <code>args</code>:</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">print_args</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">7</code><code class="p">,</code> <code class="s">'x'</code><code class="p">)</code>&#13;
<code class="go">Positional tuple: (2, 5, 7, 'x')</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">args</code> <code class="o">=</code> <code class="p">(</code><code class="mi">2</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">7</code><code class="p">,</code><code class="s">'x'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_args</code><code class="p">(</code><code class="n">args</code><code class="p">)</code>&#13;
<code class="go">Positional tuple: ((2, 5, 7, 'x'),)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_args</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">)</code>&#13;
<code class="go">Positional tuple: (2, 5, 7, 'x')</code></pre>&#13;
&#13;
<p>You can only use the <code>*</code> syntax&#13;
in a function call or definition:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="o">*</code><code class="n">args</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">1</code>&#13;
<code class="gr">SyntaxError</code>: <code class="n">can't use starred expression here</code></pre>&#13;
&#13;
<p>So:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Outside the function, <code>*args</code> explodes&#13;
the tuple <code>args</code> into comma-separated positional parameters.</p>&#13;
</li>&#13;
<li>&#13;
<p>Inside the function, <code>*args</code> gathers all of the positional&#13;
arguments into a single <code>args</code> tuple. You could use the names&#13;
<code>*params</code> and <code>params</code>, but it’s common practice to use <code>*args</code>&#13;
for both the outside argument and inside parameter.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Readers with synesthesia might also faintly hear <code>*args</code> as&#13;
<em>puff-args</em> on the outside and <em>inhale-args</em> on the inside,&#13;
as values are either exploded or gathered.<a data-startref="ix_ch09-functions-asciidoc7" data-type="indexterm" id="idm45795002768088"/><a data-startref="ix_ch09-functions-asciidoc6" data-type="indexterm" id="idm45795002767416"/><a data-startref="ix_ch09-functions-asciidoc5" data-type="indexterm" id="idm45795002766776"/><a data-startref="ix_ch09-functions-asciidoc4" data-type="indexterm" id="idm45795002766088"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Explode/Gather Keyword Arguments with **" data-type="sect2"><div class="sect2" id="kwargs">&#13;
<h2>Explode/Gather Keyword Arguments with **</h2>&#13;
&#13;
<p><a data-primary="** (asterisks)" data-secondary="keyword arguments with" data-type="indexterm" id="idm45795002740904"/><a data-primary="arguments" data-secondary="exploding/gathering keyword arguments" data-type="indexterm" id="idm45795002739928"/><a data-primary="asterisks (**)" data-secondary="keyword arguments with" data-type="indexterm" id="idm45795002739016"/><a data-primary="keyword arguments" data-secondary="exploding/gathering" data-type="indexterm" id="idm45795002738072"/>You can use two asterisks (<code>**</code>) to&#13;
group keyword arguments into a dictionary,&#13;
where the argument names are the keys,&#13;
and their values are the corresponding dictionary values.&#13;
The following example defines the function <code>print_kwargs()</code> to&#13;
print its keyword arguments:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">print_kwargs</code><code class="p">(</code><code class="o">**</code><code class="n">kwargs</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'Keyword arguments:'</code><code class="p">,</code> <code class="n">kwargs</code><code class="p">)</code>&#13;
<code class="gp">...</code></pre>&#13;
&#13;
<p>Now try calling it with some keyword arguments:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">print_kwargs</code><code class="p">()</code>&#13;
<code class="go">Keyword arguments: {}</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_kwargs</code><code class="p">(</code><code class="n">wine</code><code class="o">=</code><code class="s">'merlot'</code><code class="p">,</code> <code class="n">entree</code><code class="o">=</code><code class="s">'mutton'</code><code class="p">,</code> <code class="n">dessert</code><code class="o">=</code><code class="s">'macaroon'</code><code class="p">)</code>&#13;
<code class="go">Keyword arguments: {'dessert': 'macaroon', 'wine': 'merlot',</code>&#13;
<code class="go">'entree': 'mutton'}</code></pre>&#13;
&#13;
<p>Inside the function, <code>kwargs</code> is a dictionary parameter.</p>&#13;
&#13;
<p>Argument order is:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Required positional arguments</p>&#13;
</li>&#13;
<li>&#13;
<p>Optional positional arguments (<code>*args</code>)</p>&#13;
</li>&#13;
<li>&#13;
<p>Optional keyword arguments (<code>**kwargs</code>)</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>As with <code>args</code>,&#13;
you don’t need to call this keyword&#13;
argument <code>kwargs</code>,&#13;
but it’s common usage.<sup><a data-type="noteref" href="ch09.html#idm45795002646440" id="idm45795002646440-marker">1</a></sup></p>&#13;
&#13;
<p>The <code>**</code> syntax is valid only&#13;
in a function call or definition:<sup><a data-type="noteref" href="ch09.html#idm45795002644024" id="idm45795002644024-marker">2</a></sup></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="o">**</code><code class="n">kwparams</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">1</code>&#13;
    <code class="o">**</code><code class="n">kwparams</code>&#13;
     <code class="o">^</code>&#13;
<code class="gr">SyntaxError</code>: <code class="n">invalid syntax</code></pre>&#13;
&#13;
<p>Summarizing:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>You can pass keyword arguments to a function,&#13;
which will match them inside to keyword parameters.&#13;
This is what you’ve seen so far.</p>&#13;
</li>&#13;
<li>&#13;
<p>You can pass a dictionary argument to a function,&#13;
and inside it will be dictionary parameters.&#13;
This is a simple case of the preceding one.</p>&#13;
</li>&#13;
<li>&#13;
<p>You can pass one or more keyword arguments&#13;
(<em>name=value</em>) to a function,&#13;
and gather them inside as <code>**kwargs</code>,&#13;
which resolves to the dictionary parameter called <code>kwargs</code>.&#13;
This was described in this section.</p>&#13;
</li>&#13;
<li>&#13;
<p>Outside a function, <code>**kwargs</code> <em>explodes</em> a dictionary <code>kwargs</code> into <em>name=value</em> arguments.</p>&#13;
</li>&#13;
<li>&#13;
<p>Inside a function, <code>**kwargs</code> <em>gathers</em> <code>name=value</code> arguments&#13;
into the single dictionary parameter <code>kwargs</code>.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>If auditory hallucinations help,&#13;
imagine a puff for each asterisk exploding&#13;
outside the function,&#13;
and a little inhaling sound for each one gathering inside.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Keyword-Only Arguments" data-type="sect2"><div class="sect2" id="idm45795002742120">&#13;
<h2>Keyword-Only Arguments</h2>&#13;
&#13;
<p><a data-primary="arguments" data-secondary="keyword-only" data-type="indexterm" id="idm45795002591640"/><a data-primary="keyword-only arguments" data-type="indexterm" id="idm45795002590552"/>It’s possible to pass in a keyword argument that has&#13;
the same name as a positional parameter,&#13;
probably not resulting in what you want.&#13;
Python 3 lets you specify <em>keyword-only arguments</em>.&#13;
As the name says, they must be provided as <em>name=value</em>,&#13;
not positionally as <em>value</em>.&#13;
The single <code>*</code> in the function definition means&#13;
that the following parameters <code>start</code> and <code>end</code>&#13;
must be provided as named arguments if we don’t want&#13;
their default values:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">print_data</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="o">*</code><code class="p">,</code> <code class="n">start</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">end</code><code class="o">=</code><code class="mi">100</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">for</code> <code class="n">value</code> <code class="ow">in</code> <code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">start</code><code class="p">:</code><code class="n">end</code><code class="p">]):</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="n">value</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">data</code> <code class="o">=</code> <code class="p">[</code><code class="s">'a'</code><code class="p">,</code> <code class="s">'b'</code><code class="p">,</code> <code class="s">'c'</code><code class="p">,</code> <code class="s">'d'</code><code class="p">,</code> <code class="s">'e'</code><code class="p">,</code> <code class="s">'f'</code><code class="p">]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_data</code><code class="p">(</code><code class="n">data</code><code class="p">)</code>&#13;
<code class="go">a</code>&#13;
<code class="go">b</code>&#13;
<code class="go">c</code>&#13;
<code class="go">d</code>&#13;
<code class="go">e</code>&#13;
<code class="go">f</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_data</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">start</code><code class="o">=</code><code class="mi">4</code><code class="p">)</code>&#13;
<code class="go">e</code>&#13;
<code class="go">f</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_data</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">end</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code>&#13;
<code class="go">a</code>&#13;
<code class="go">b</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Mutable and Immutable Arguments" data-type="sect2"><div class="sect2" id="mutable_arguments">&#13;
<h2>Mutable and Immutable Arguments</h2>&#13;
&#13;
<p><a data-primary="arguments" data-secondary="mutable and immutable" data-type="indexterm" id="idm45795002481944"/>Remember that if you assigned the same list to two variables,&#13;
you could change it by using either one?&#13;
And that you could not if the variables both referred to something&#13;
like an integer or a string?&#13;
That was because the list was mutable and the integer and&#13;
string were immutable.</p>&#13;
&#13;
<p>You need to watch for the same behavior when passing arguments&#13;
to functions.&#13;
If an argument is mutable, its value can be changed <em>from inside the function</em>&#13;
via its corresponding parameter:<sup><a data-type="noteref" href="ch09.html#idm45795002479608" id="idm45795002479608-marker">3</a></sup></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">outside</code> <code class="o">=</code> <code class="p">[</code><code class="s">'one'</code><code class="p">,</code> <code class="s">'fine'</code><code class="p">,</code> <code class="s">'day'</code><code class="p">]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">mangle</code><code class="p">(</code><code class="n">arg</code><code class="p">):</code>&#13;
<code class="gp">... </code>   <code class="n">arg</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code> <code class="o">=</code> <code class="s">'terrible!'</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">outside</code>&#13;
<code class="go">['one', 'fine', 'day']</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">mangle</code><code class="p">(</code><code class="n">outside</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">outside</code>&#13;
<code class="go">['one', 'terrible!', 'day']</code></pre>&#13;
&#13;
<p>It’s good practice to, uh, not do this.<sup><a data-type="noteref" href="ch09.html#idm45795002478344" id="idm45795002478344-marker">4</a></sup>&#13;
Either document that an argument may be changed,&#13;
or <code>return</code> the new value.<a data-startref="ix_ch09-functions-asciidoc3" data-type="indexterm" id="idm45795002354632"/><a data-startref="ix_ch09-functions-asciidoc2" data-type="indexterm" id="idm45795002354024"/><a data-startref="ix_ch09-functions-asciidoc1" data-type="indexterm" id="idm45795002353384"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Docstrings" data-type="sect1"><div class="sect1" id="docstrings">&#13;
<h1>Docstrings</h1>&#13;
&#13;
<p><a data-primary="docstrings" data-type="indexterm" id="idm45795002351192"/><a data-primary="documentation" data-type="indexterm" id="idm45795002350488"/><a data-primary="functions" data-secondary="docstrings" data-type="indexterm" id="idm45795002349816"/><em>Readability counts</em>,&#13;
the Zen of Python verily saith.&#13;
You can attach documentation to a function definition&#13;
by including a string at the beginning of the function body.&#13;
This is the function’s <em>docstring</em>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">echo</code><code class="p">(</code><code class="n">anything</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="s">'echo returns its input argument'</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">anything</code></pre>&#13;
&#13;
<p>You can make a docstring quite long, and even add rich formatting&#13;
if you want:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="go">def print_if_true(thing, check):</code>&#13;
<code class="go">    '''</code>&#13;
<code class="go">    Prints the first argument if a second argument is true.</code>&#13;
<code class="go">    The operation is:</code>&#13;
<code class="go">        1. Check whether the *second* argument is true.</code>&#13;
<code class="go">        2. If it is, print the *first* argument.</code>&#13;
<code class="go">    '''</code>&#13;
<code class="go">    if check:</code>&#13;
<code class="go">        print(thing)</code></pre>&#13;
&#13;
<p>To print a function’s docstring,&#13;
call the Python <code>help()</code> function.&#13;
Pass the function’s name to get a&#13;
listing of arguments along with the nicely formatted docstring:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">help</code><code class="p">(</code><code class="n">echo</code><code class="p">)</code>&#13;
<code class="go">Help on function echo in module __main__:</code>&#13;
&#13;
<code class="go">echo(anything)</code>&#13;
<code class="go">    echo returns its input argument</code></pre>&#13;
&#13;
<p>If you want to see just the raw docstring, without the formatting:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="n">echo</code><code class="o">.</code><code class="n">__doc__</code><code class="p">)</code>&#13;
<code class="go">echo returns its input argument</code></pre>&#13;
&#13;
<p>That odd-looking <code>__doc__</code> is the internal name of the docstring&#13;
as a variable within the function.&#13;
<a data-primary="__ (double underscores)" data-type="indexterm" id="idm45795002422632"/><a data-primary="double underscore (__)" data-type="indexterm" id="idm45795002422136"/><a data-primary="dunder" data-seealso="double underscores (__)" data-type="indexterm" id="idm45795002421464"/>Double underscores (aka <em>dunder</em> in Python-speak)&#13;
are used in many places to name Python internal variables,&#13;
because programmers are unlikely to use them&#13;
in their own variable names.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Functions Are First-Class Citizens" data-type="sect1"><div class="sect1" id="idm45795002352440">&#13;
<h1>Functions Are First-Class Citizens</h1>&#13;
&#13;
<p><a data-primary="functions" data-secondary="as first-class citizens" data-type="indexterm" id="ix_ch09-functions-asciidoc8"/>I’ve mentioned the Python mantra,&#13;
<em>everything is an object</em>.&#13;
This includes&#13;
numbers, strings, tuples, lists, dictionaries—and functions, as well.&#13;
Functions are first-class citizens in Python.&#13;
You can assign them to variables,&#13;
use them as arguments to other functions,&#13;
and return them&#13;
from functions.&#13;
This gives you the capability to do some things in Python&#13;
that are difficult-to-impossible to carry out in many other <span class="keep-together">languages.</span></p>&#13;
&#13;
<p>To test this, let’s define a simple&#13;
function called <code>answer()</code>&#13;
that doesn’t have any arguments;&#13;
it just prints the number <code>42</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">answer</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="mi">42</code><code class="p">)</code></pre>&#13;
&#13;
<p>If you run this function, you know what you’ll get:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">answer</code><code class="p">()</code>&#13;
<code class="go">42</code></pre>&#13;
&#13;
<p>Now let’s define another function named&#13;
<code>run_something</code>.&#13;
It has one argument called <code>func</code>,&#13;
a function to run.&#13;
Once inside, it just calls the function:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">run_something</code><code class="p">(</code><code class="n">func</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="n">func</code><code class="p">()</code></pre>&#13;
&#13;
<p>If we pass <code>answer</code> to <code>run_something()</code>,&#13;
we’re using a function as data, just as with anything&#13;
else:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">run_something</code><code class="p">(</code><code class="n">answer</code><code class="p">)</code>&#13;
<code class="go">42</code></pre>&#13;
&#13;
<p>Notice that you passed <code>answer</code>, not <code>answer()</code>.&#13;
In Python, those parentheses mean&#13;
<em>call this function</em>.&#13;
With no parentheses,&#13;
Python just treats the function like any other object.&#13;
That’s because, like everything else in Python,&#13;
it <em>is</em> an object:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="nb">type</code><code class="p">(</code><code class="n">run_something</code><code class="p">)</code>&#13;
<code class="go">&lt;class 'function'&gt;</code></pre>&#13;
&#13;
<p>Let’s try running a function with arguments.&#13;
Define a function <code>add_args()</code> that&#13;
prints the sum of its two numeric arguments,&#13;
<code>arg1</code> and <code>arg2</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">add_args</code><code class="p">(</code><code class="n">arg1</code><code class="p">,</code> <code class="n">arg2</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">arg1</code> <code class="o">+</code> <code class="n">arg2</code><code class="p">)</code></pre>&#13;
&#13;
<p>And what is <code>add_args()</code>?</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="nb">type</code><code class="p">(</code><code class="n">add_args</code><code class="p">)</code>&#13;
<code class="go">&lt;class 'function'&gt;</code></pre>&#13;
&#13;
<p>At this point, let’s define a function&#13;
called <code>run_something_with_args()</code>&#13;
that takes three arguments:</p>&#13;
<dl>&#13;
<dt><code>func</code></dt>&#13;
<dd>&#13;
<p>The function to run</p>&#13;
</dd>&#13;
<dt><code>arg1</code></dt>&#13;
<dd>&#13;
<p>The first argument for <code>func</code></p>&#13;
</dd>&#13;
<dt><code>arg2</code></dt>&#13;
<dd>&#13;
<p>The second argument for <code>func</code></p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">run_something_with_args</code><code class="p">(</code><code class="n">func</code><code class="p">,</code> <code class="n">arg1</code><code class="p">,</code> <code class="n">arg2</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="n">func</code><code class="p">(</code><code class="n">arg1</code><code class="p">,</code> <code class="n">arg2</code><code class="p">)</code></pre>&#13;
&#13;
<p>When you call <code>run_something_with_args()</code>,&#13;
the function passed by the caller is assigned to the <code>func</code>&#13;
parameter,&#13;
whereas <code>arg1</code> and <code>arg2</code> get the values&#13;
that follow in the argument list.&#13;
Then, running <code>func(arg1, arg2)</code> executes that function&#13;
with those arguments&#13;
because the parentheses told Python to do so.</p>&#13;
&#13;
<p>Let’s test it by passing the function name <code>add_args</code>&#13;
and the arguments <code>5</code> and <code>9</code> to&#13;
<code>run_something_with_args()</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">run_something_with_args</code><code class="p">(</code><code class="n">add_args</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">9</code><code class="p">)</code>&#13;
<code class="go">14</code></pre>&#13;
&#13;
<p>Within the function <code>run_something_with_args()</code>,&#13;
the function name argument <code>add_args</code> was assigned&#13;
to the parameter <code>func</code>,&#13;
<code>5</code> to <code>arg1</code>,&#13;
and <code>9</code> to <code>arg2</code>.&#13;
This ended up running:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="go">add_args(5, 9)</code></pre>&#13;
&#13;
<p>You can combine this with the <code>*args</code> and <code>**kwargs</code>&#13;
techniques.</p>&#13;
&#13;
<p><a data-primary="sum() function" data-type="indexterm" id="idm45795001956440"/>Let’s define a test function that takes&#13;
any number of positional arguments,&#13;
calculates their sum by using the&#13;
<code>sum()</code> function,&#13;
and then returns that sum:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">sum_args</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">):</code>&#13;
<code class="gp">... </code>   <code class="k">return</code> <code class="nb">sum</code><code class="p">(</code><code class="n">args</code><code class="p">)</code></pre>&#13;
&#13;
<p>I haven’t mentioned <code>sum()</code> before.&#13;
It’s a built-in Python function&#13;
that calculates the sum of the values in&#13;
its iterable numeric&#13;
(int or float) argument.</p>&#13;
&#13;
<p>Let’s define the new function&#13;
<code>run_with_positional_args()</code>,&#13;
which takes a function&#13;
and any number of positional arguments&#13;
to pass to it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">run_with_positional_args</code><code class="p">(</code><code class="n">func</code><code class="p">,</code> <code class="o">*</code><code class="n">args</code><code class="p">):</code>&#13;
<code class="gp">... </code>   <code class="k">return</code> <code class="n">func</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">)</code></pre>&#13;
&#13;
<p>Now go ahead and call it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">run_with_positional_args</code><code class="p">(</code><code class="n">sum_args</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">)</code>&#13;
<code class="go">10</code></pre>&#13;
&#13;
<p>You can use functions as elements of lists, tuples,&#13;
sets, and dictionaries.&#13;
Functions are immutable, so you can also use them as&#13;
dictionary keys.<a data-startref="ix_ch09-functions-asciidoc8" data-type="indexterm" id="idm45795001856536"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Inner Functions" data-type="sect1"><div class="sect1" id="inner_functions">&#13;
<h1>Inner Functions</h1>&#13;
&#13;
<p><a data-primary="functions" data-secondary="inner functions" data-type="indexterm" id="ix_ch09-functions-asciidoc9"/><a data-primary="inner() function" data-type="indexterm" id="ix_ch09-functions-asciidoc10"/>You can define a function within another function:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">outer</code><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">def</code> <code class="nf">inner</code><code class="p">(</code><code class="n">c</code><code class="p">,</code> <code class="n">d</code><code class="p">):</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="n">c</code> <code class="o">+</code> <code class="n">d</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">inner</code><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">&gt;&gt;&gt;</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">outer</code><code class="p">(</code><code class="mi">4</code><code class="p">,</code> <code class="mi">7</code><code class="p">)</code>&#13;
<code class="go">11</code></pre>&#13;
&#13;
<p>An inner function can be useful when performing&#13;
some complex task more than once within another&#13;
function, to avoid loops or code duplication.&#13;
For a string example, this inner function&#13;
adds some text to its argument:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">knights</code><code class="p">(</code><code class="n">saying</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">def</code> <code class="nf">inner</code><code class="p">(</code><code class="n">quote</code><code class="p">):</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="s">"We are the knights who say: '</code><code class="si">%s</code><code class="s">'"</code> <code class="o">%</code> <code class="n">quote</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">inner</code><code class="p">(</code><code class="n">saying</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">knights</code><code class="p">(</code><code class="s">'Ni!'</code><code class="p">)</code>&#13;
<code class="go">"We are the knights who say: 'Ni!'"</code></pre>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Closures" data-type="sect2"><div class="sect2" id="closures">&#13;
<h2>Closures</h2>&#13;
&#13;
<p><a data-primary="closures" data-type="indexterm" id="idm45795001688904"/><a data-primary="functions" data-secondary="closures" data-type="indexterm" id="idm45795001688200"/><a data-primary="inner() function" data-type="indexterm" id="idm45795001687256"/>An inner function can act as a <em>closure</em>.&#13;
This is a function that is&#13;
dynamically generated by another function&#13;
and can both change and remember the values of variables that were created outside the function.</p>&#13;
&#13;
<p>The following example builds on the previous <code>knights()</code> example.&#13;
Let’s call the new one <code>knights2()</code>,&#13;
because we have no imagination,&#13;
and turn the <code>inner()</code> function into a closure&#13;
called <code>inner2()</code>.&#13;
Here are the differences:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>inner2()</code> uses the outer <code>saying</code> parameter directly instead of getting it as an argument.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>knights2()</code> returns the <code>inner2</code> function name instead of calling it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">knights2</code><code class="p">(</code><code class="n">saying</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">def</code> <code class="nf">inner2</code><code class="p">():</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="s">"We are the knights who say: '</code><code class="si">%s</code><code class="s">'"</code> <code class="o">%</code> <code class="n">saying</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">inner2</code>&#13;
<code class="gp">...</code></pre>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>The <code>inner2()</code> function knows the&#13;
value of <code>saying</code> that was passed in&#13;
and remembers it.&#13;
The line <code>return inner2</code> returns this&#13;
specialized copy of the <code>inner2</code> function&#13;
(but doesn’t call it).&#13;
That’s a kind of closure: a dynamically created&#13;
function that remembers where it came from.</p>&#13;
&#13;
<p>Let’s call <code>knights2()</code> twice,&#13;
with different arguments:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">a</code> <code class="o">=</code> <code class="n">knights2</code><code class="p">(</code><code class="s">'Duck'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">b</code> <code class="o">=</code> <code class="n">knights2</code><code class="p">(</code><code class="s">'Hasenpfeffer'</code><code class="p">)</code></pre>&#13;
&#13;
<p>Okay, so what are <code>a</code> and <code>b</code>?</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="nb">type</code><code class="p">(</code><code class="n">a</code><code class="p">)</code>&#13;
<code class="go">&lt;class 'function'&gt;</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">type</code><code class="p">(</code><code class="n">b</code><code class="p">)</code>&#13;
<code class="go">&lt;class 'function'&gt;</code></pre>&#13;
&#13;
<p>They’re functions, but they’re also closures:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">a</code>&#13;
<code class="go">&lt;function knights2.&lt;locals&gt;.inner2 at 0x10193e158&gt;</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">b</code>&#13;
<code class="go">&lt;function knights2.&lt;locals&gt;.inner2 at 0x10193e1e0&gt;</code></pre>&#13;
&#13;
<p>If we call them, they remember the <code>saying</code>&#13;
that was used when they were created&#13;
by <code>knights2</code>:<a data-startref="ix_ch09-functions-asciidoc10" data-type="indexterm" id="idm45795001543784"/><a data-startref="ix_ch09-functions-asciidoc9" data-type="indexterm" id="idm45795001543176"/></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">a</code><code class="p">()</code>&#13;
<code class="go">"We are the knights who say: 'Duck'"</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">b</code><code class="p">()</code>&#13;
<code class="go">"We are the knights who say: 'Hasenpfeffer'"</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Anonymous Functions: lambda" data-type="sect1"><div class="sect1" id="lamdba">&#13;
<h1>Anonymous Functions: lambda</h1>&#13;
&#13;
<p><a data-primary="anonymous functions" data-type="indexterm" id="idm45795001551448"/><a data-primary="functions" data-secondary="anonymous" data-type="indexterm" id="idm45795001550856"/><a data-primary="lambda functions" data-type="indexterm" id="idm45795001549912"/>A Python <em>lambda function</em> is an anonymous&#13;
function expressed as a single statement.&#13;
You can use it instead of a normal tiny function.</p>&#13;
&#13;
<p>To illustrate it, let’s first make an example&#13;
that uses normal functions.&#13;
To begin, let’s define the function <code>edit_story()</code>.&#13;
Its arguments are the following:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>words</code>—a list of words</p>&#13;
</li>&#13;
<li>&#13;
<p><code>func</code>—a function to apply to each word in <code>words</code></p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">edit_story</code><code class="p">(</code><code class="n">words</code><code class="p">,</code> <code class="n">func</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">for</code> <code class="n">word</code> <code class="ow">in</code> <code class="n">words</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="n">func</code><code class="p">(</code><code class="n">word</code><code class="p">))</code></pre>&#13;
&#13;
<p>Now we need a list of words and a function to apply to&#13;
each word.&#13;
For the words,&#13;
here’s a list of (hypothetical)&#13;
sounds made by my cat&#13;
if he (hypothetically) missed one of the stairs:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">stairs</code> <code class="o">=</code> <code class="p">[</code><code class="s">'thud'</code><code class="p">,</code> <code class="s">'meow'</code><code class="p">,</code> <code class="s">'thud'</code><code class="p">,</code> <code class="s">'hiss'</code><code class="p">]</code></pre>&#13;
&#13;
<p>And for the function,&#13;
this will capitalize each word and append&#13;
an exclamation point,&#13;
perfect for feline tabloid newspaper headlines:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">enliven</code><code class="p">(</code><code class="n">word</code><code class="p">):</code>   <code class="c"># give that prose more punch</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">word</code><code class="o">.</code><code class="n">capitalize</code><code class="p">()</code> <code class="o">+</code> <code class="s">'!'</code></pre>&#13;
&#13;
<p>Mixing our ingredients:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">edit_story</code><code class="p">(</code><code class="n">stairs</code><code class="p">,</code> <code class="n">enliven</code><code class="p">)</code>&#13;
<code class="go">Thud!</code>&#13;
<code class="go">Meow!</code>&#13;
<code class="go">Thud!</code>&#13;
<code class="go">Hiss!</code></pre>&#13;
&#13;
<p>Finally, we get to the lambda.&#13;
The <code>enliven()</code> function was so brief that we&#13;
could replace it with a lambda:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">edit_story</code><code class="p">(</code><code class="n">stairs</code><code class="p">,</code> <code class="k">lambda</code> <code class="n">word</code><code class="p">:</code> <code class="n">word</code><code class="o">.</code><code class="n">capitalize</code><code class="p">()</code> <code class="o">+</code> <code class="s">'!'</code><code class="p">)</code>&#13;
<code class="go">Thud!</code>&#13;
<code class="go">Meow!</code>&#13;
<code class="go">Thud!</code>&#13;
<code class="go">Hiss!</code></pre>&#13;
&#13;
<p>A lambda has zero or more comma-separated arguments,&#13;
followed by a colon (<code>:</code>),&#13;
and then the definition of the function.&#13;
We’re giving this lambda one argument, <code>word</code>.&#13;
You don’t use parentheses with <code>lambda</code> as&#13;
you would when calling a function created with <code>def</code>.</p>&#13;
&#13;
<p>Often, using real functions such as <code>enliven()</code>&#13;
is much clearer than using lambdas.&#13;
Lambdas are mostly useful for cases in which&#13;
you would otherwise need&#13;
to define many tiny functions&#13;
and remember what you called them all.&#13;
In particular, you can use lambdas in graphical user interfaces&#13;
to define&#13;
<em>callback functions</em>;&#13;
see <a data-type="xref" href="ch20.html#ch_art">Chapter 20</a> for examples.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Generators" data-type="sect1"><div class="sect1" id="generators">&#13;
<h1>Generators</h1>&#13;
&#13;
<p><a data-primary="generators" data-type="indexterm" id="idm45795001299832"/><a data-primary="sequences" data-secondary="creating with generators" data-type="indexterm" id="idm45795001298904"/>A <em>generator</em> is a Python sequence creation object.&#13;
With it, you can iterate through potentially huge sequences&#13;
without creating and storing the entire sequence in memory at once.&#13;
<a data-primary="iterators" data-type="indexterm" id="idm45795001297272"/>Generators are often the source of data for iterators.&#13;
If you recall, we already used one of them, <code>range()</code>,&#13;
in earlier code examples to generate a series of integers.&#13;
In Python 2, <code>range()</code> returns a list,&#13;
which limits it to fit in memory.&#13;
Python 2 also has the generator <code>xrange()</code>,&#13;
which became the normal <code>range()</code> in Python 3.&#13;
This example adds all the integers from 1 to 100:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="nb">sum</code><code class="p">(</code><code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">101</code><code class="p">))</code>&#13;
<code class="go">5050</code></pre>&#13;
&#13;
<p>Every time you iterate through a generator,&#13;
it keeps track of where it was the last time it was called&#13;
and returns the next value.&#13;
This is different from a normal function,&#13;
which has no memory of previous calls and always starts&#13;
at its first line with the same state.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Generator Functions" data-type="sect2"><div class="sect2" id="generator_functions">&#13;
<h2>Generator Functions</h2>&#13;
&#13;
<p><a data-primary="functions" data-secondary="generator functions" data-type="indexterm" id="idm45795001285480"/><a data-primary="generators" data-secondary="generator functions" data-type="indexterm" id="idm45795001284280"/>If you want to create a potentially large sequence,&#13;
you can&#13;
write a <em>generator function</em>.&#13;
It’s a normal function, but it&#13;
returns its value with a <code>yield</code>&#13;
statement rather than <code>return</code>.&#13;
Let’s write our own version of <code>range()</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">my_range</code><code class="p">(</code><code class="n">first</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">last</code><code class="o">=</code><code class="mi">10</code><code class="p">,</code> <code class="n">step</code><code class="o">=</code><code class="mi">1</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="n">number</code> <code class="o">=</code> <code class="n">first</code>&#13;
<code class="gp">... </code>    <code class="k">while</code> <code class="n">number</code> <code class="o">&lt;</code> <code class="n">last</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">yield</code> <code class="n">number</code>&#13;
<code class="gp">... </code>        <code class="n">number</code> <code class="o">+=</code> <code class="n">step</code>&#13;
<code class="gp">...</code></pre>&#13;
&#13;
<p>It’s a normal function:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">my_range</code>&#13;
<code class="go">&lt;function my_range at 0x10193e268&gt;</code></pre>&#13;
&#13;
<p>And it returns a generator object:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">ranger</code> <code class="o">=</code> <code class="n">my_range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">ranger</code>&#13;
<code class="go">&lt;generator object my_range at 0x101a0a168&gt;</code></pre>&#13;
&#13;
<p>We can iterate over this generator object:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">for</code> <code class="n">x</code> <code class="ow">in</code> <code class="n">ranger</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">1</code>&#13;
<code class="go">2</code>&#13;
<code class="go">3</code>&#13;
<code class="go">4</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>A generator can be run only once.&#13;
Lists, sets, strings, and dictionaries&#13;
exist in memory,&#13;
but a generator creates its values&#13;
on the fly and hands them out one at a time&#13;
through an iterator.&#13;
It doesn’t remember them,&#13;
so you can’t restart or back up a generator.</p>&#13;
</div>&#13;
&#13;
<p>If you try to iterate this generator again,&#13;
you’ll find that it’s tapped out:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">for</code> <code class="n">try_again</code> <code class="ow">in</code> <code class="n">ranger</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">try_again</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">&gt;&gt;&gt;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Generator Comprehensions" data-type="sect2"><div class="sect2" id="idm45795001287000">&#13;
<h2>Generator Comprehensions</h2>&#13;
&#13;
<p><a data-primary="comprehensions" data-secondary="generator" data-type="indexterm" id="idm45795001075464"/><a data-primary="generator comprehensions" data-type="indexterm" id="idm45795001074440"/><a data-primary="generators" data-secondary="generator comprehensions" data-type="indexterm" id="idm45795001073800"/>You’ve seen comprehensions for lists, dictionaries, and sets.&#13;
A <em>generator comprehension</em>&#13;
looks like those,&#13;
but is surrounded by parentheses instead of square or curly brackets.&#13;
It’s like a shorthand version of a generator function,&#13;
doing the <code>yield</code> invisibly,&#13;
and also returns a generator object:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">genobj</code> <code class="o">=</code> <code class="p">(</code><code class="n">pair</code> <code class="k">for</code> <code class="n">pair</code> <code class="ow">in</code> <code class="nb">zip</code><code class="p">([</code><code class="s">'a'</code><code class="p">,</code> <code class="s">'b'</code><code class="p">],</code> <code class="p">[</code><code class="s">'1'</code><code class="p">,</code> <code class="s">'2'</code><code class="p">]))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">genobj</code>&#13;
<code class="go">&lt;generator object &lt;genexpr&gt; at 0x10308fde0&gt;</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">for</code> <code class="n">thing</code> <code class="ow">in</code> <code class="n">genobj</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">thing</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">('a', '1')</code>&#13;
<code class="go">('b', '2')</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Decorators" data-type="sect1"><div class="sect1" id="decorators">&#13;
<h1>Decorators</h1>&#13;
&#13;
<p><a data-primary="decorators" data-type="indexterm" id="ix_ch09-functions-asciidoc11"/><a data-primary="functions" data-secondary="decorators and" data-type="indexterm" id="ix_ch09-functions-asciidoc12"/>Sometimes, you want to modify an existing function without&#13;
changing its source code.&#13;
A common example is adding a debugging statement&#13;
to see what arguments were <span class="keep-together">passed in.</span></p>&#13;
&#13;
<p>A <em>decorator</em> is a function that takes one function as input and returns another function.&#13;
Let’s dig into our bag of Python tricks and use the following:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>*args</code> and <code>**kwargs</code></p>&#13;
</li>&#13;
<li>&#13;
<p>Inner functions</p>&#13;
</li>&#13;
<li>&#13;
<p>Functions as arguments</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>The function <code>document_it()</code> defines a decorator&#13;
that will do the following:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Print the function’s name and the values of its arguments</p>&#13;
</li>&#13;
<li>&#13;
<p>Run the function with the arguments</p>&#13;
</li>&#13;
<li>&#13;
<p>Print the result</p>&#13;
</li>&#13;
<li>&#13;
<p>Return the modified function for use</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Here’s what the code looks like:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">document_it</code><code class="p">(</code><code class="n">func</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">def</code> <code class="nf">new_function</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">,</code> <code class="o">**</code><code class="n">kwargs</code><code class="p">):</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="s">'Running function:'</code><code class="p">,</code> <code class="n">func</code><code class="o">.</code><code class="n">__name__</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="s">'Positional arguments:'</code><code class="p">,</code> <code class="n">args</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="s">'Keyword arguments:'</code><code class="p">,</code> <code class="n">kwargs</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="n">result</code> <code class="o">=</code> <code class="n">func</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">,</code> <code class="o">**</code><code class="n">kwargs</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="s">'Result:'</code><code class="p">,</code> <code class="n">result</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="n">result</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">new_function</code></pre>&#13;
&#13;
<p>Whatever <code>func</code> you pass to <code>document_it()</code>,&#13;
you get a new function that includes the&#13;
extra statements that <code>document_it()</code> adds.&#13;
A decorator doesn’t actually&#13;
have to run any code from <code>func</code>,&#13;
but <code>document_it()</code> calls <code>func</code>&#13;
partway through so that you get the results of&#13;
<code>func</code> as well as all&#13;
the extras.</p>&#13;
&#13;
<p>So, how do you use this?&#13;
You can apply the decorator manually:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">add_ints</code><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">):</code>&#13;
<code class="gp">... </code>   <code class="k">return</code> <code class="n">a</code> <code class="o">+</code> <code class="n">b</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">add_ints</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>&#13;
<code class="go">8</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">cooler_add_ints</code> <code class="o">=</code> <code class="n">document_it</code><code class="p">(</code><code class="n">add_ints</code><code class="p">)</code>  <code class="c"># manual decorator assignment</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">cooler_add_ints</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>&#13;
<code class="go">Running function: add_ints</code>&#13;
<code class="go">Positional arguments: (3, 5)</code>&#13;
<code class="go">Keyword arguments: {}</code>&#13;
<code class="go">Result: 8</code>&#13;
<code class="go">8</code></pre>&#13;
&#13;
<p>As an alternative to the manual&#13;
decorator assignment we just looked at,&#13;
you can add <span class="keep-together">@<em><code>decorator_name</code></em></span> before&#13;
the function that you want to decorate:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="nd">@document_it</code>&#13;
<code class="gp">... </code><code class="k">def</code> <code class="nf">add_ints</code><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">a</code> <code class="o">+</code> <code class="n">b</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">add_ints</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>&#13;
<code class="go">Start function add_ints</code>&#13;
<code class="go">Positional arguments: (3, 5)</code>&#13;
<code class="go">Keyword arguments: {}</code>&#13;
<code class="go">Result: 8</code>&#13;
<code class="go">8</code></pre>&#13;
&#13;
<p>You can have more than one decorator for a function.&#13;
Let’s write another decorator called&#13;
<code>square_it()</code> that squares the result:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">square_it</code><code class="p">(</code><code class="n">func</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">def</code> <code class="nf">new_function</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">,</code> <code class="o">**</code><code class="n">kwargs</code><code class="p">):</code>&#13;
<code class="gp">... </code>        <code class="n">result</code> <code class="o">=</code> <code class="n">func</code><code class="p">(</code><code class="o">*</code><code class="n">args</code><code class="p">,</code> <code class="o">**</code><code class="n">kwargs</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="k">return</code> <code class="n">result</code> <code class="o">*</code> <code class="n">result</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">new_function</code>&#13;
<code class="gp">...</code></pre>&#13;
&#13;
<p>The decorator that’s used closest to the function&#13;
(just above the <code>def</code>)&#13;
runs first and&#13;
then the one above it.&#13;
Either order gives the same end result,&#13;
but you can see how the intermediate steps change:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="nd">@document_it</code>&#13;
<code class="gp">... </code><code class="nd">@square_it</code>&#13;
<code class="gp">... </code><code class="k">def</code> <code class="nf">add_ints</code><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">a</code> <code class="o">+</code> <code class="n">b</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">add_ints</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>&#13;
<code class="go">Running function: new_function</code>&#13;
<code class="go">Positional arguments: (3, 5)</code>&#13;
<code class="go">Keyword arguments: {}</code>&#13;
<code class="go">Result: 64</code>&#13;
<code class="go">64</code></pre>&#13;
&#13;
<p>Let’s try reversing the decorator order:<a data-startref="ix_ch09-functions-asciidoc12" data-type="indexterm" id="idm45795000640024"/><a data-startref="ix_ch09-functions-asciidoc11" data-type="indexterm" id="idm45795000599272"/></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="nd">@square_it</code>&#13;
<code class="gp">... </code><code class="nd">@document_it</code>&#13;
<code class="gp">... </code><code class="k">def</code> <code class="nf">add_ints</code><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">a</code> <code class="o">+</code> <code class="n">b</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">add_ints</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>&#13;
<code class="go">Running function: add_ints</code>&#13;
<code class="go">Positional arguments: (3, 5)</code>&#13;
<code class="go">Keyword arguments: {}</code>&#13;
<code class="go">Result: 8</code>&#13;
<code class="go">64</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Namespaces and Scope" data-type="sect1"><div class="sect1" id="scope">&#13;
<h1>Namespaces and Scope</h1>&#13;
<blockquote>&#13;
<p><a data-primary="functions" data-secondary="namespaces and scope" data-type="indexterm" id="ix_ch09-functions-asciidoc13"/><a data-primary="namespaces" data-type="indexterm" id="ix_ch09-functions-asciidoc14"/>Desiring this man’s art and that man’s scope</p>&#13;
<p data-type="attribution">William Shakespeare</p>&#13;
</blockquote>&#13;
&#13;
<p>A name can refer to different things,&#13;
depending on where it’s used.&#13;
Python programs have various <em>namespaces</em>—sections within&#13;
which a particular name is unique and unrelated to the same&#13;
name in other namespaces.</p>&#13;
&#13;
<p>Each function defines its own namespace.&#13;
If you define a variable called <code>x</code>&#13;
in a main program&#13;
and another variable called <code>x</code> in a function,&#13;
they refer to different things.&#13;
But the walls can be breached:&#13;
if you need to,&#13;
you can access names in other namespaces in various ways.</p>&#13;
&#13;
<p><a data-primary="global variables" data-type="indexterm" id="idm45795000534888"/>The main part of a program defines the <em>global</em> namespace;&#13;
thus, the variables in that namespace are <em>global variables</em>.</p>&#13;
&#13;
<p>You can get the value of a global variable&#13;
from within a function:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code> <code class="o">=</code> <code class="s">'fruitbat'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">print_global</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'inside print_global:'</code><code class="p">,</code> <code class="n">animal</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="s">'at the top level:'</code><code class="p">,</code> <code class="n">animal</code><code class="p">)</code>&#13;
<code class="go">at the top level: fruitbat</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">print_global</code><code class="p">()</code>&#13;
<code class="go">inside print_global: fruitbat</code></pre>&#13;
&#13;
<p>But if you try to get the value&#13;
of the global variable <em>and</em>&#13;
change it within the function,&#13;
you get an error:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">change_and_print_global</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'inside change_and_print_global:'</code><code class="p">,</code> <code class="n">animal</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="n">animal</code> <code class="o">=</code> <code class="s">'wombat'</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'after the change:'</code><code class="p">,</code> <code class="n">animal</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">change_and_print_global</code><code class="p">()</code>&#13;
<code class="gt">Traceback (most recent call last):</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">1</code>, in <code class="n">&lt;module&gt;</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">2</code>, in <code class="n">change_and_print_global</code>&#13;
<code class="gr">UnboundLocalError</code>: <code class="n">local variable 'animal' referenced before assignment</code></pre>&#13;
&#13;
<p>If you just change it,&#13;
it changes a different variable also named <code>animal</code>,&#13;
but this variable is inside the function:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">change_local</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="n">animal</code> <code class="o">=</code> <code class="s">'wombat'</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'inside change_local:'</code><code class="p">,</code> <code class="n">animal</code><code class="p">,</code> <code class="nb">id</code><code class="p">(</code><code class="n">animal</code><code class="p">))</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">change_local</code><code class="p">()</code>&#13;
<code class="go">inside change_local: wombat 4330406160</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code>&#13;
<code class="go">'fruitbat'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">id</code><code class="p">(</code><code class="n">animal</code><code class="p">)</code>&#13;
<code class="go">4330390832</code></pre>&#13;
&#13;
<p>What happened here?&#13;
The first line assigned the string <code>'fruitbat'</code>&#13;
to a global variable named <code>animal</code>.&#13;
The <code>change_local()</code> function also has a variable named <code>animal</code>,&#13;
but that’s in its local namespace.</p>&#13;
&#13;
<p>I used the Python function <code>id()</code> here to&#13;
print the unique value for each&#13;
object and prove that the variable <code>animal</code>&#13;
inside <code>change_local()</code>&#13;
is not the same as <code>animal</code> at the main level of the program.</p>&#13;
&#13;
<p>To access the global variable rather than the local one&#13;
within a function,&#13;
you need to be explicit&#13;
and use the <code>global</code> keyword&#13;
(you knew this was coming:&#13;
<em>explicit is better than implicit</em>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code> <code class="o">=</code> <code class="s">'fruitbat'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">change_and_print_global</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">global</code> <code class="n">animal</code>&#13;
<code class="gp">... </code>    <code class="n">animal</code> <code class="o">=</code> <code class="s">'wombat'</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'inside change_and_print_global:'</code><code class="p">,</code> <code class="n">animal</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code>&#13;
<code class="go">'fruitbat'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">change_and_print_global</code><code class="p">()</code>&#13;
<code class="go">inside change_and_print_global: wombat</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code>&#13;
<code class="go">'wombat'</code></pre>&#13;
&#13;
<p>If you don’t say <code>global</code> within a function,&#13;
Python uses the local namespace and the variable&#13;
is local.&#13;
It goes away after the function completes.</p>&#13;
&#13;
<p><a data-primary="globals() function" data-type="indexterm" id="idm45795000282712"/><a data-primary="locals() function" data-type="indexterm" id="idm45795000282072"/>Python provides two functions to access the contents&#13;
of your namespaces:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>locals()</code> returns a dictionary of the contents of the local namespace.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>globals()</code> returns a dictionary of the contents of the global namespace.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p class="pagebreak-before">And here they are in use:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code> <code class="o">=</code> <code class="s">'fruitbat'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">change_local</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="n">animal</code> <code class="o">=</code> <code class="s">'wombat'</code>  <code class="c"># local variable</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'locals:'</code><code class="p">,</code> <code class="nb">locals</code><code class="p">())</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code>&#13;
<code class="go">'fruitbat'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">change_local</code><code class="p">()</code>&#13;
<code class="go">locals: {'animal': 'wombat'}</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="s">'globals:'</code><code class="p">,</code> <code class="nb">globals</code><code class="p">())</code> <code class="c"># reformatted a little for presentation</code>&#13;
<code class="go">globals: {'animal': 'fruitbat',</code>&#13;
<code class="go">'__doc__': None,</code>&#13;
<code class="go">'change_local': &lt;function change_local at 0x1006c0170&gt;,</code>&#13;
<code class="go">'__package__': None,</code>&#13;
<code class="go">'__name__': '__main__',</code>&#13;
<code class="go">'__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;,</code>&#13;
<code class="go">'__builtins__': &lt;module 'builtins'&gt;}</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">animal</code>&#13;
<code class="go">'fruitbat'</code></pre>&#13;
&#13;
<p>The local namespace within <code>change_local()</code>&#13;
contained only the local variable <code class="keep-together">animal</code>.&#13;
The global namespace contained&#13;
the separate global variable <code>animal</code>&#13;
and a number of other things.<a data-startref="ix_ch09-functions-asciidoc14" data-type="indexterm" id="idm45795000194712"/><a data-startref="ix_ch09-functions-asciidoc13" data-type="indexterm" id="idm45795000193976"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Uses of _ and __ in Names" data-type="sect1"><div class="sect1" id="underscores">&#13;
<h1>Uses of _ and __ in Names</h1>&#13;
&#13;
<p><a data-primary="_ (underscore)" data-type="indexterm" id="idm45795000191992"/><a data-primary="_ (underscores)" data-type="indexterm" id="idm45795000191288"/><a data-primary="__ (double underscores)" data-type="indexterm" id="idm45795000190616"/><a data-primary="double underscore (__)" data-type="indexterm" id="idm45795000189944"/><a data-primary="underscore (_)" data-type="indexterm" id="idm45795000189272"/>Names that begin and end with two underscores (<code>__</code>)&#13;
are reserved for use within Python,&#13;
so you should not use them with your own variables.&#13;
This naming pattern was chosen because it seemed&#13;
unlikely to be selected by application&#13;
developers for their own variables.</p>&#13;
&#13;
<p>For instance, the name of a function&#13;
is in the system variable&#13;
<em><code>function</code></em><code>.__name__</code>,&#13;
and its documentation string is&#13;
<em><code>function</code></em><code>.__doc__</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">amazing</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="sd">'''This is the amazing function.</code>&#13;
<code class="gp">... </code><code class="sd">    Want to see it again?'''</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'This function is named:'</code><code class="p">,</code> <code class="n">amazing</code><code class="o">.</code><code class="n">__name__</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'And its docstring is:'</code><code class="p">,</code> <code class="n">amazing</code><code class="o">.</code><code class="n">__doc__</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">amazing</code><code class="p">()</code>&#13;
<code class="go">This function is named: amazing</code>&#13;
<code class="go">And its docstring is: This is the amazing function.</code>&#13;
<code class="go">    Want to see it again?</code></pre>&#13;
&#13;
<p>As you saw in the earlier <code>globals</code> printout,&#13;
the main program is assigned the special name&#13;
<code>__main__</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Recursion" data-type="sect1"><div class="sect1" id="recursion">&#13;
<h1>Recursion</h1>&#13;
&#13;
<p><a data-primary="functions" data-secondary="recursion with" data-type="indexterm" id="idm45795000113080"/><a data-primary="recursion" data-type="indexterm" id="idm45795000111880"/>So far, we’ve called functions that do some things directly,&#13;
and maybe call other functions.&#13;
But what if a function calls itself?<sup><a data-type="noteref" href="ch09.html#idm45795000110936" id="idm45795000110936-marker">5</a></sup>&#13;
This is called <em>recursion</em>.&#13;
Like an unbroken infinite loop with <code>while</code> or <code>for</code>,&#13;
you don’t want infinite recursion.&#13;
Do we still need to worry about cracks&#13;
in the space-time continuum?</p>&#13;
&#13;
<p>Python saves the universe again by&#13;
raising an exception if you get too deep:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">dive</code><code class="p">():</code>&#13;
<code class="gp">... </code>    <code class="k">return</code> <code class="n">dive</code><code class="p">()</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">dive</code><code class="p">()</code>&#13;
<code class="gt">Traceback (most recent call last):</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">1</code>, in <code class="n">&lt;module&gt;</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">2</code>, in <code class="n">dive</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">2</code>, in <code class="n">dive</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">2</code>, in <code class="n">dive</code>&#13;
<code class="gr">  [Previous line repeated 996 more times]</code>&#13;
<code class="gr">RecursionError</code>: <code class="n">maximum recursion depth exceeded</code></pre>&#13;
&#13;
<p>Recursion is useful when you’re dealing with “uneven” data,&#13;
like lists of lists of lists.&#13;
Suppose that you want to “flatten” all sublists&#13;
of a list,<sup><a data-type="noteref" href="ch09.html#idm45795000106696" id="idm45795000106696-marker">6</a></sup>&#13;
no matter how deeply nested.&#13;
A generator function is just the thing:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">flatten</code><code class="p">(</code><code class="n">lol</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">for</code> <code class="n">item</code> <code class="ow">in</code> <code class="n">lol</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">if</code> <code class="nb">isinstance</code><code class="p">(</code><code class="n">item</code><code class="p">,</code> <code class="nb">list</code><code class="p">):</code>&#13;
<code class="gp">... </code>            <code class="k">for</code> <code class="n">subitem</code> <code class="ow">in</code> <code class="n">flatten</code><code class="p">(</code><code class="n">item</code><code class="p">):</code>&#13;
<code class="gp">... </code>                <code class="k">yield</code> <code class="n">subitem</code>&#13;
<code class="gp">... </code>        <code class="k">else</code><code class="p">:</code>&#13;
<code class="gp">... </code>            <code class="k">yield</code> <code class="n">item</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">lol</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="p">[</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="mi">5</code><code class="p">],</code> <code class="p">[</code><code class="mi">6</code><code class="p">,[</code><code class="mi">7</code><code class="p">,</code><code class="mi">8</code><code class="p">,</code><code class="mi">9</code><code class="p">],</code> <code class="p">[]]]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">flatten</code><code class="p">(</code><code class="n">lol</code><code class="p">)</code>&#13;
<code class="go">&lt;generator object flatten at 0x10509a750&gt;</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">list</code><code class="p">(</code><code class="n">flatten</code><code class="p">(</code><code class="n">lol</code><code class="p">))</code>&#13;
<code class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9]</code></pre>&#13;
&#13;
<p>Python 3.3 added the <code>yield from</code> expression,&#13;
which lets a generator hand off some work to another generator.&#13;
We can use it to simplify <code>flatten()</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">def</code> <code class="nf">flatten</code><code class="p">(</code><code class="n">lol</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">for</code> <code class="n">item</code> <code class="ow">in</code> <code class="n">lol</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">if</code> <code class="nb">isinstance</code><code class="p">(</code><code class="n">item</code><code class="p">,</code> <code class="nb">list</code><code class="p">):</code>&#13;
<code class="gp">... </code>            <code class="k">yield from</code> <code class="n">flatten</code><code class="p">(</code><code class="n">item</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="k">else</code><code class="p">:</code>&#13;
<code class="gp">... </code>            <code class="k">yield</code> <code class="n">item</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">lol</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="p">[</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="mi">5</code><code class="p">],</code> <code class="p">[</code><code class="mi">6</code><code class="p">,[</code><code class="mi">7</code><code class="p">,</code><code class="mi">8</code><code class="p">,</code><code class="mi">9</code><code class="p">],</code> <code class="p">[]]]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">list</code><code class="p">(</code><code class="n">flatten</code><code class="p">(</code><code class="n">lol</code><code class="p">))</code>&#13;
<code class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9]</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Async Functions" data-type="sect1"><div class="sect1" id="idm45794999944696">&#13;
<h1>Async Functions</h1>&#13;
&#13;
<p><a data-primary="asynchronous functions" data-type="indexterm" id="idm45794999821608"/><a data-primary="functions" data-secondary="asynchronous" data-type="indexterm" id="idm45794999820904"/>The keywords <code>async</code> and <code>await</code> were added to Python 3.5&#13;
to define and run <em>asynchronous functions</em>.&#13;
They’re:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Relatively new</p>&#13;
</li>&#13;
<li>&#13;
<p>Different enough to be harder to understand</p>&#13;
</li>&#13;
<li>&#13;
<p>Will become more important and better known over time</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>For these reasons,&#13;
I’ve moved discussion of these and other&#13;
async topics to <span class="keep-together"><a data-type="href" href="app03.html#app_async">Appendix C</a></span>.</p>&#13;
&#13;
<p>For now, you need to know that if you see <code>async</code> before&#13;
the <code>def</code> line for a function, it’s an asynchronous&#13;
function.&#13;
Likewise, if you see <code>await</code> before a function call,&#13;
that function is asynchronous.</p>&#13;
&#13;
<p>The main difference between asynchronous and normal functions&#13;
is that async ones can “give up control” rather than&#13;
running to completion.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Exceptions" data-type="sect1"><div class="sect1" id="exceptions">&#13;
<h1>Exceptions</h1>&#13;
&#13;
<p><a data-primary="error handling" data-seealso="exceptions" data-type="indexterm" id="ix_ch09-functions-asciidoc15"/>In some languages,&#13;
errors are indicated by special function return values.&#13;
When things go south,<sup><a data-type="noteref" href="ch09.html#idm45794999807944" id="idm45794999807944-marker">7</a></sup>&#13;
Python uses <em>exceptions</em>:&#13;
code that is executed when an associated&#13;
error occurs.</p>&#13;
&#13;
<p>You’ve seen some of these already,&#13;
such as accessing a list or tuple&#13;
with an out-of-range position,&#13;
or a dictionary with a nonexistent key.&#13;
When you run code that might fail under some circumstances,&#13;
you also need appropriate <em>exception handlers</em> to intercept&#13;
any potential errors.</p>&#13;
&#13;
<p>It’s good practice to add exception handling anywhere&#13;
an exception might occur to let the user know what is happening.&#13;
You might not be able to fix the problem,&#13;
but at least you can&#13;
note the circumstances and&#13;
shut your program down gracefully.&#13;
If an exception occurs in some function and is not caught there, it&#13;
<em>bubbles up</em> until it is caught by a matching handler in some calling function.&#13;
If you don’t provide your own exception handler,&#13;
Python prints an error message and some information about where&#13;
the error occurred and then terminates the program, as demonstrated in the following snippet:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">short_list</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">position</code> <code class="o">=</code> <code class="mi">5</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">short_list</code><code class="p">[</code><code class="n">position</code><code class="p">]</code>&#13;
<code class="gt">Traceback (most recent call last):</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">1</code>, in <code class="n">&lt;module&gt;</code>&#13;
<code class="gr">IndexError</code>: <code class="n">list index out of range</code></pre>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Handle Errors with try and except" data-type="sect2"><div class="sect2" id="try_except">&#13;
<h2>Handle Errors with try and except</h2>&#13;
<blockquote>&#13;
<p><a data-primary="exceptions" data-secondary="handling errors with try and except" data-type="indexterm" id="idm45794999728968"/>Do, or do not. There is no try.</p>&#13;
<p data-type="attribution">Yoda</p>&#13;
</blockquote>&#13;
&#13;
<p>Rather than leaving things to chance,&#13;
use <code>try</code> to wrap your code,&#13;
and <code>except</code> to provide the error handling:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">short_list</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">position</code> <code class="o">=</code> <code class="mi">5</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">try</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="n">short_list</code><code class="p">[</code><code class="n">position</code><code class="p">]</code>&#13;
<code class="gp">... </code><code class="k">except</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'Need a position between 0 and'</code><code class="p">,</code> <code class="nb">len</code><code class="p">(</code><code class="n">short_list</code><code class="p">)</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="s">' but got'</code><code class="p">,</code>&#13;
<code class="gp">... </code>           <code class="n">position</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">Need a position between 0 and 2 but got 5</code></pre>&#13;
&#13;
<p>The code inside the <code>try</code> block is run.&#13;
If there is an error,&#13;
an exception is raised and&#13;
the code inside the <code>except</code> block runs.&#13;
If there are no errors,&#13;
the <code>except</code> block is <span class="keep-together">skipped.</span></p>&#13;
&#13;
<p>Specifying a plain <code>except</code> with no arguments,&#13;
as we did here,&#13;
is a catchall for any&#13;
exception type.&#13;
If more than one type of exception could occur,&#13;
it’s best to provide a separate exception handler for each.&#13;
No one forces you to do this;&#13;
you can use a bare <code>except</code> to catch all exceptions,&#13;
but your treatment of them would probably be generic&#13;
(something akin to printing <em>Some error occurred</em>).&#13;
You can use any number of specific exception handlers.</p>&#13;
&#13;
<p>Sometimes, you want exception details beyond the type.&#13;
You get the full exception object in the variable&#13;
<em>name</em> if you use the form:</p>&#13;
<pre>except <em><code>exceptiontype</code></em> as <em><code>name</code></em></pre>&#13;
&#13;
<p>The example that follows looks for an <code>IndexError</code> first,&#13;
because that’s the exception type raised&#13;
when you provide an illegal position to a sequence.&#13;
It saves an <code>IndexError</code> exception in the variable <code>err</code>,&#13;
and any other exception in the variable <code>other</code>.&#13;
The example prints everything stored in <code>other</code> to show what you get&#13;
in that object:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">short_list</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">while</code> <code class="bp">True</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="n">value</code> <code class="o">=</code> <code class="nb">input</code><code class="p">(</code><code class="s">'Position [q to quit]? '</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="n">value</code> <code class="o">==</code> <code class="s">'q'</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">break</code>&#13;
<code class="gp">... </code>    <code class="k">try</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="n">position</code> <code class="o">=</code> <code class="nb">int</code><code class="p">(</code><code class="n">value</code><code class="p">)</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="n">short_list</code><code class="p">[</code><code class="n">position</code><code class="p">])</code>&#13;
<code class="gp">... </code>    <code class="k">except</code> <code class="ne">IndexError</code> <code class="k">as</code> <code class="n">err</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="s">'Bad index:'</code><code class="p">,</code> <code class="n">position</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">except</code> <code class="ne">Exception</code> <code class="k">as</code> <code class="n">other</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">print</code><code class="p">(</code><code class="s">'Something else broke:'</code><code class="p">,</code> <code class="n">other</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">Position [q to quit]? 1</code>&#13;
<code class="go">2</code>&#13;
<code class="go">Position [q to quit]? 0</code>&#13;
<code class="go">1</code>&#13;
<code class="go">Position [q to quit]? 2</code>&#13;
<code class="go">3</code>&#13;
<code class="go">Position [q to quit]? 3</code>&#13;
<code class="go">Bad index: 3</code>&#13;
<code class="go">Position [q to quit]? 2</code>&#13;
<code class="go">3</code>&#13;
<code class="go">Position [q to quit]? two</code>&#13;
<code class="go">Something else broke: invalid literal for int() with base 10: 'two'</code>&#13;
<code class="go">Position [q to quit]? q</code></pre>&#13;
&#13;
<p>Inputting position <code>3</code> raised an <code>IndexError</code> as expected.&#13;
Entering <code>two</code> annoyed the <code>int()</code> function,&#13;
which we handled in our second, catchall <code>except</code> code.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Make Your Own Exceptions" data-type="sect2"><div class="sect2" id="exception_definition">&#13;
<h2>Make Your Own Exceptions</h2>&#13;
&#13;
<p><a data-primary="exceptions" data-secondary="defining exception types" data-type="indexterm" id="idm45794999522664"/>The previous section discussed handling exceptions,&#13;
but all of the exceptions (such as <code>IndexError</code>)&#13;
were predefined in Python or its standard library.&#13;
You can use any of these for your own purposes.&#13;
You can also define your own exception types to handle special situations that&#13;
might arise in your own programs.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This requires defining a new object type with a <em>class</em>—something we don’t get into until <a data-type="xref" href="ch10.html#ch_objects">Chapter 10</a>.&#13;
So, if you’re unfamiliar with classes,&#13;
you might want to return to this section later.</p>&#13;
</div>&#13;
&#13;
<p>An exception is a class. It is a child of the class <code>Exception</code>.&#13;
Let’s make an exception called <code>UppercaseException</code> and raise it when we&#13;
encounter an uppercase word in a string:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">class</code> <code class="nc">UppercaseException</code><code class="p">(</code><code class="ne">Exception</code><code class="p">):</code>&#13;
<code class="gp">... </code>    <code class="k">pass</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">words</code> <code class="o">=</code> <code class="p">[</code><code class="s">'eenie'</code><code class="p">,</code> <code class="s">'meenie'</code><code class="p">,</code> <code class="s">'miny'</code><code class="p">,</code> <code class="s">'MO'</code><code class="p">]</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">for</code> <code class="n">word</code> <code class="ow">in</code> <code class="n">words</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="n">word</code><code class="o">.</code><code class="n">isupper</code><code class="p">():</code>&#13;
<code class="gp">... </code>        <code class="k">raise</code> <code class="n">UppercaseException</code><code class="p">(</code><code class="n">word</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="gt">Traceback (most recent call last):</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">3</code>, in <code class="n">&lt;module&gt;</code>&#13;
<code class="gr">__main__.UppercaseException</code>: <code class="n">MO</code></pre>&#13;
&#13;
<p>We didn’t even define any behavior for <code>UppercaseException</code>&#13;
(notice we just used <code>pass</code>),&#13;
letting its parent class <code>Exception</code>&#13;
figure out what to print when the exception was raised.</p>&#13;
&#13;
<p>You can access the exception object itself and print it:<a data-startref="ix_ch09-functions-asciidoc15" data-type="indexterm" id="idm45794999423864"/></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">try</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">raise</code> <code class="n">OopsException</code><code class="p">(</code><code class="s">'panic'</code><code class="p">)</code>&#13;
<code class="gp">... </code><code class="k">except</code> <code class="n">OopsException</code> <code class="k">as</code> <code class="n">exc</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">exc</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">panic</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Coming Up" data-type="sect1"><div class="sect1" id="idm45794999372680">&#13;
<h1>Coming Up</h1>&#13;
&#13;
<p>Objects! We had to get to them sometime in a book&#13;
about an object-oriented <span class="keep-together">language.</span></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Things to Do" data-type="sect1"><div class="sect1" id="idm45794999366392">&#13;
<h1>Things to Do</h1>&#13;
&#13;
<p>9.1&#13;
<a data-primary="functions" data-secondary="practice exercises" data-type="indexterm" id="idm45794999364824"/>Define a function called <code>good()</code>&#13;
that returns the following list: <code>['Harry', 'Ron', 'Hermione']</code>.</p>&#13;
&#13;
<p>9.2&#13;
Define a generator function called <code>get_odds()</code>&#13;
that returns the odd numbers from <code>range(10)</code>.&#13;
Use a <code>for</code> loop to find and print the third value returned.</p>&#13;
&#13;
<p>9.3&#13;
Define a decorator called <code>test</code> that prints <code>'start'</code>&#13;
when a function is called, and <code>'end'</code> when it finishes.</p>&#13;
&#13;
<p>9.4&#13;
Define an exception called <code>OopsException</code>.&#13;
Raise this exception to see what happens.&#13;
Then, write the code to catch this exception and print&#13;
<code>'Caught an oops'</code>.<a data-startref="ix_ch09-functions-asciidoc0" data-type="indexterm" id="idm45794999476568"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45795002646440"><sup><a href="ch09.html#idm45795002646440-marker">1</a></sup> Although <em>Args</em> and <em>Kwargs</em> sound like the names of pirate parrots.</p><p data-type="footnote" id="idm45795002644024"><sup><a href="ch09.html#idm45795002644024-marker">2</a></sup> Or, as of Python 3.5, a dictionary merge of the form <code>{**a, **b}</code>, as you saw in <a data-type="xref" href="ch08.html#ch_dicts">Chapter 8</a>.</p><p data-type="footnote" id="idm45795002479608"><sup><a href="ch09.html#idm45795002479608-marker">3</a></sup> Like the teens-in-peril movies where they learn “The call’s coming from inside the house!”</p><p data-type="footnote" id="idm45795002478344"><sup><a href="ch09.html#idm45795002478344-marker">4</a></sup> Like the old doctor joke: “It hurts when I do this.” “Well, then don’t do that.”</p><p data-type="footnote" id="idm45795000110936"><sup><a href="ch09.html#idm45795000110936-marker">5</a></sup> It’s like saying, “I wish I had a dollar for every time I wished I had a dollar.”</p><p data-type="footnote" id="idm45795000106696"><sup><a href="ch09.html#idm45795000106696-marker">6</a></sup> Another Python interview question. Collect the whole set!</p><p data-type="footnote" id="idm45794999807944"><sup><a href="ch09.html#idm45794999807944-marker">7</a></sup> Is this northern hemispherism? Do Aussies and Kiwis say that things go “north” when they mess up?</p></div></div></section></body></html>