<html><head></head><body><section data-pdf-bookmark="Chapter 15. Files" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch15">&#13;
<h1><span class="label">Chapter 15. </span>Files</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Preview" data-type="sect1"><div class="sect1" id="id149">&#13;
<h1>Preview</h1>&#13;
&#13;
<p><a data-primary="files" data-type="indexterm" id="icd076"/>Besides fielding API requests and traditional content like HTML,&#13;
web servers are expected to handle file transfers in both directions.&#13;
Very large files may need to be transferred in <em>chunks</em>&#13;
that don’t use too much of the system’s memory. You can also provide access to a directory of files&#13;
(and subdirectories, to any depth)&#13;
with <code>Stati⁠c​Files</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Multipart Support" data-type="sect1"><div class="sect1" id="id150">&#13;
<h1>Multipart Support</h1>&#13;
&#13;
<p>To <a data-primary="files" data-secondary="multipart support" data-type="indexterm" id="id945"/>handle<a data-primary="Python-Multipart" data-type="indexterm" id="id946"/> large files, FastAPI’s uploading and downloading&#13;
features need these extra <a data-primary="aio-files" data-type="indexterm" id="id947"/>modules:</p>&#13;
<dl>&#13;
<dt><a href="https://oreil.ly/FUBk7">Python-Multipart</a></dt>&#13;
<dd>&#13;
<p><code>pip install python-multipart</code></p>&#13;
</dd>&#13;
<dt><a href="https://oreil.ly/OZYYR">aio-files</a></dt>&#13;
<dd>&#13;
<p><code>pip install aiofiles</code></p>&#13;
</dd>&#13;
</dl>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Uploading Files" data-type="sect1"><div class="sect1" id="id227">&#13;
<h1>Uploading Files</h1>&#13;
&#13;
<p><a data-primary="files" data-secondary="uploading" data-type="indexterm" id="icd077"/>FastAPI <a data-primary="FastAPI" data-secondary="uploading files" data-type="indexterm" id="icd080"/>targets API development,&#13;
and most of the examples in this book have used JSON requests&#13;
and responses.&#13;
But in the next chapter you’ll see forms, which are handled differently.&#13;
This chapter covers files, which are treated like forms in some ways.</p>&#13;
&#13;
<p>FastAPI offers two techniques for file uploads:&#13;
<code>File()</code> and <code>UploadFile</code>.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="File()" data-type="sect2"><div class="sect2" id="id151">&#13;
<h2>File()</h2>&#13;
&#13;
<p><code>File()</code> <a data-primary="File()" data-type="indexterm" id="id948"/>is used as the type for a direct file upload.&#13;
Your path function may be synchronous (<code>def</code>)&#13;
or asynchronous (<code>async def</code>),&#13;
but the asynchronous version is better because it won’t&#13;
tie up your web server while the file is uploading.</p>&#13;
&#13;
<p>FastAPI will pull up the file in chunks and reassemble it&#13;
in memory, so <code>File()</code> should be used for only&#13;
relatively small files.&#13;
Instead of assuming that the input is JSON,&#13;
<span class="keep-together">FastAPI</span> encodes a file as a form element.</p>&#13;
&#13;
<p>Let’s write the code to request a file and test it.&#13;
You can grab any file on your machine to test with,&#13;
or download one from a site like&#13;
<a href="https://oreil.ly/EnlH-">Fastest Fish</a>.<a data-primary="Fastest Fish" data-type="indexterm" id="id949"/>&#13;
I grabbed a 1 KB file from there&#13;
and saved it locally as <em>1KB.bin</em>.</p>&#13;
&#13;
<p>In <a data-type="xref" href="#ex-15-1">Example 15-1</a>,&#13;
add these lines to your top <em>main.py</em>.</p>&#13;
<div data-type="example" id="ex-15-1">&#13;
<h5><span class="label">Example 15-1. </span>Handle a small file upload with FastAPI</h5>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code> <code class="nn">fastapi</code> <code class="kn">import</code> <code class="n">File</code>&#13;
&#13;
<code class="nd">@app</code><code class="o">.</code><code class="n">post</code><code class="p">(</code><code class="s2">"/small"</code><code class="p">)</code>&#13;
<code class="k">async</code> <code class="k">def</code> <code class="nf">upload_small_file</code><code class="p">(</code><code class="n">small_file</code><code class="p">:</code> <code class="nb">bytes</code> <code class="o">=</code> <code class="n">File</code><code class="p">())</code> <code class="o">-&gt;</code> <code class="nb">str</code><code class="p">:</code>&#13;
    <code class="k">return</code> <code class="sa">f</code><code class="s2">"file size: </code><code class="si">{</code><code class="nb">len</code><code class="p">(</code><code class="n">small_file</code><code class="p">)</code><code class="si">}</code><code class="s2">"</code></pre></div>&#13;
&#13;
<p>After Uvicorn restarts, try an<a data-primary="HTTPie" data-secondary="uploading files" data-type="indexterm" id="id950"/> HTTPie test in <a data-type="xref" href="#ex-15-2">Example 15-2</a>.</p>&#13;
<div data-type="example" id="ex-15-2">&#13;
<h5><span class="label">Example 15-2. </span>Upload a small file with HTTPie</h5>&#13;
&#13;
<pre data-type="programlisting">$ <strong>http -f -b POST http://localhost:8000/small small_file@1KB.bin</strong>&#13;
"file size: 1000"</pre></div>&#13;
&#13;
<p>Here are a few notes on this test:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>You need to include <code>-f</code> (or <code>--form</code>), because files are uploaded like forms,&#13;
not as JSON text.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>small_file@1KB.bin</code>:</p>&#13;
<dl>&#13;
<dt><code>small_file</code></dt>&#13;
<dd>&#13;
<p>Matches the variable name <code>small_file</code> in the&#13;
FastAPI path function in <a data-type="xref" href="#ex-15-1">Example 15-1</a></p>&#13;
</dd>&#13;
<dt><code>@</code></dt>&#13;
<dd>&#13;
<p>HTTPie’s shorthand to make a form</p>&#13;
</dd>&#13;
<dt><code>1KB.bin</code></dt>&#13;
<dd>&#13;
<p>The file that is being uploaded</p>&#13;
</dd>&#13;
</dl>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p class="pagebreak-before"><a data-type="xref" href="#ex-15-3">Example 15-3</a> is an equivalent programmatic test.<a data-primary="Requests package" data-secondary="uploading files" data-type="indexterm" id="id951"/></p>&#13;
<div data-type="example" id="ex-15-3">&#13;
<h5><span class="label">Example 15-3. </span>Upload a small file with Requests</h5>&#13;
<pre data-type="programlisting">$ <strong>python</strong>&#13;
&gt;&gt;&gt; import requests&#13;
&gt;&gt;&gt; url = "http://localhost:8000/small"&#13;
&gt;&gt;&gt; files = {'small_file': open('1KB.bin', 'rb')}&#13;
&gt;&gt;&gt; resp = requests.post(url, files=files)&#13;
&gt;&gt;&gt; print(resp.json())&#13;
file size: 1000</pre>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="UploadFile" data-type="sect2"><div class="sect2" id="id152">&#13;
<h2>UploadFile</h2>&#13;
&#13;
<p><a data-primary="UploadFile" data-type="indexterm" id="id952"/>For large files, it’s better to use <code>UploadFile</code>.&#13;
This creates a Python&#13;
<code>SpooledTemporaryFile</code> object, mostly on the server’s disk&#13;
instead of in memory.&#13;
This is a Python <em>file-like</em> object,&#13;
which supports the methods&#13;
<code>read()</code>, <code>write()</code>, and <code>seek()</code>.&#13;
<a data-type="xref" href="#ex-15-4">Example 15-4</a> shows this,&#13;
and also uses <code>async def</code> instead of <code>def</code>&#13;
to avoid blocking the web server while file&#13;
pieces are uploading.</p>&#13;
<div data-type="example" id="ex-15-4">&#13;
<h5><span class="label">Example 15-4. </span>Upload a big file with FastAPI (add to <span class="plain">main.py</span>)</h5>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code> <code class="nn">fastapi</code> <code class="kn">import</code> <code class="n">UploadFile</code>&#13;
&#13;
<code class="nd">@app</code><code class="o">.</code><code class="n">post</code><code class="p">(</code><code class="s2">"/big"</code><code class="p">)</code>&#13;
<code class="k">async</code> <code class="k">def</code> <code class="nf">upload_big_file</code><code class="p">(</code><code class="n">big_file</code><code class="p">:</code> <code class="n">UploadFile</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="nb">str</code><code class="p">:</code>&#13;
    <code class="k">return</code> <code class="sa">f</code><code class="s2">"file size: </code><code class="si">{</code><code class="n">big_file</code><code class="o">.</code><code class="n">size</code><code class="si">}</code><code class="s2">, name: </code><code class="si">{</code><code class="n">big_file</code><code class="o">.</code><code class="n">filename</code><code class="si">}</code><code class="s2">"</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><code>File()</code> created a <code>bytes</code> object and needed the parentheses.&#13;
<code>UploadFile</code> is a different class of object.</p>&#13;
</div>&#13;
&#13;
<p>If Uvicorn’s starter motor isn’t worn out yet,&#13;
it’s test time.&#13;
This time, Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex-15-5">15-5</a> through&#13;
<a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex-15-6">15-6</a> use&#13;
a 1 GB file (<em>1GB.bin</em>)&#13;
that I grabbed from Fastest Fish.<a data-primary="files" data-secondary="uploading" data-startref="icd077" data-type="indexterm" id="id953"/><a data-primary="FastAPI" data-secondary="uploading files" data-startref="icd080" data-type="indexterm" id="id954"/></p>&#13;
<div data-type="example" id="ex-15-5">&#13;
<h5><span class="label">Example 15-5. </span>Test a big file upload with <a data-primary="HTTPie" data-secondary="uploading files" data-type="indexterm" id="id955"/>HTTPie</h5>&#13;
&#13;
<pre data-type="programlisting">$ <strong>http -f -b POST http://localhost:8000/big big_file@1GB.bin</strong>&#13;
"file size: 1000000000, name: 1GB.bin"</pre></div>&#13;
<div class="pagebreak-before less_space" data-type="example" id="ex-15-6">&#13;
<h5><span class="label">Example 15-6. </span>Test a big file upload with Requests</h5>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="o">&gt;&gt;&gt;</code> <code class="kn">import</code> <code class="nn">requests</code>&#13;
<code class="o">&gt;&gt;&gt;</code> <code class="n">url</code> <code class="o">=</code> <code class="s2">"http://localhost:8000/big"</code>&#13;
<code class="o">&gt;&gt;&gt;</code> <code class="n">files</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'big_file'</code><code class="p">:</code> <code class="nb">open</code><code class="p">(</code><code class="s1">'1GB.bin'</code><code class="p">,</code> <code class="s1">'rb'</code><code class="p">)}</code>&#13;
<code class="o">&gt;&gt;&gt;</code> <code class="n">resp</code> <code class="o">=</code> <code class="n">requests</code><code class="o">.</code><code class="n">post</code><code class="p">(</code><code class="n">url</code><code class="p">,</code> <code class="n">files</code><code class="o">=</code><code class="n">files</code><code class="p">)</code>&#13;
<code class="o">&gt;&gt;&gt;</code> <code class="nb">print</code><code class="p">(</code><code class="n">resp</code><code class="o">.</code><code class="n">json</code><code class="p">())</code>&#13;
<code class="n">file</code> <code class="n">size</code><code class="p">:</code> <code class="mi">1000000000</code><code class="p">,</code> <code class="n">name</code><code class="p">:</code> <code class="mi">1</code><code class="n">GB</code><code class="o">.</code><code class="n">bin</code></pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Downloading Files" data-type="sect1"><div class="sect1" id="id228">&#13;
<h1>Downloading Files</h1>&#13;
&#13;
<p>Sadly,<a data-primary="files" data-secondary="downloading" data-type="indexterm" id="icd078"/> gravity<a data-primary="FastAPI" data-secondary="downloading files" data-type="indexterm" id="icd081"/> doesn’t make files download faster.&#13;
Instead, we’ll use equivalents of the upload methods.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="FileResponse" data-type="sect2"><div class="sect2" id="id153">&#13;
<h2>FileResponse</h2>&#13;
&#13;
<p>First,<a data-primary="FileResponse" data-type="indexterm" id="id956"/> in <a data-type="xref" href="#ex-15-7">Example 15-7</a>,&#13;
is the all-at-once version,&#13;
<code>FileResponse</code>.</p>&#13;
<div data-type="example" id="ex-15-7">&#13;
<h5><span class="label">Example 15-7. </span>Download a small file with <code>FileResponse</code> (add to <span class="plain">main.py</span>)</h5>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code> <code class="nn">fastapi.responses</code> <code class="kn">import</code> <code class="n">FileResponse</code>&#13;
&#13;
<code class="nd">@app</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="s2">"/small/</code><code class="si">{name}</code><code class="s2">"</code><code class="p">)</code>&#13;
<code class="k">async</code> <code class="k">def</code> <code class="nf">download_small_file</code><code class="p">(</code><code class="n">name</code><code class="p">):</code>&#13;
    <code class="k">return</code> <code class="n">FileResponse</code><code class="p">(</code><code class="n">name</code><code class="p">)</code></pre></div>&#13;
&#13;
<p>There’s a test around here somewhere.&#13;
First, put the file <em>1KB.bin</em> in the same directory as <em>main.py</em>.&#13;
Now, run <a data-type="xref" href="#ex-15-8">Example 15-8</a>.</p>&#13;
<div data-type="example" id="ex-15-8">&#13;
<h5><span class="label">Example 15-8. </span>Download a small file with <a data-primary="HTTPie" data-secondary="downloading files" data-type="indexterm" id="id957"/>HTTPie</h5>&#13;
&#13;
<pre data-type="programlisting">$ <strong>http -b http://localhost:8000/small/1KB.bin</strong>&#13;
&#13;
<code>-----------------------------------------</code>&#13;
| NOTE: binary data not shown in terminal |&#13;
<code>-----------------------------------------</code></pre></div>&#13;
&#13;
<p>If you don’t trust that suppression message,&#13;
<a data-type="xref" href="#ex-15-9">Example 15-9</a> pipes the output to&#13;
a utility like <code>wc</code> to ensure that you got 1,000 bytes back.</p>&#13;
<div class="pagebreak-before less_space" data-type="example" id="ex-15-9">&#13;
<h5><span class="label">Example 15-9. </span>Download a small file with HTTPie, with byte count</h5>&#13;
&#13;
<pre data-type="programlisting">$ <strong>http -b http://localhost:8000/small/1KB.bin | wc -c</strong>&#13;
    1000</pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="StreamingResponse" data-type="sect2"><div class="sect2" id="id154">&#13;
<h2>StreamingResponse</h2>&#13;
&#13;
<p>Similar<a data-primary="StreamingResponse" data-type="indexterm" id="id958"/> to <code>FileUpload</code>, it’s better to download large files&#13;
with <code>StreamingResponse</code>,&#13;
which returns the file in chunks.&#13;
<a data-type="xref" href="#ex-15-10">Example 15-10</a> shows this, with an <code>async def</code>&#13;
path function to avoid blocking when the CPU isn’t being used.&#13;
I’m skipping error checking for now; if the file <code>path</code>&#13;
doesn’t exist, the <code>open()</code> call will raise an exception.</p>&#13;
<div data-type="example" id="ex-15-10">&#13;
<h5><span class="label">Example 15-10. </span>Return a big file with <code>StreamingResponse</code> (add to <span class="plain">main.py</span>)</h5>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code> <code class="nn">pathlib</code> <code class="kn">import</code> <code class="n">path</code>&#13;
<code class="kn">from</code> <code class="nn">typing</code> <code class="kn">import</code> <code class="n">Generator</code>&#13;
<code class="kn">from</code> <code class="nn">fastapi.responses</code> <code class="kn">import</code> <code class="n">StreamingResponse</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">gen_file</code><code class="p">(</code><code class="n">path</code><code class="p">:</code> <code class="nb">str</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Generator</code><code class="p">:</code>&#13;
    <code class="k">with</code> <code class="nb">open</code><code class="p">(</code><code class="n">file</code><code class="o">=</code><code class="n">path</code><code class="p">,</code> <code class="n">mode</code><code class="o">=</code><code class="s2">"rb"</code><code class="p">)</code> <code class="k">as</code> <code class="n">file</code><code class="p">:</code>&#13;
        <code class="k">yield</code> <code class="n">file</code><code class="o">.</code><code class="n">read</code><code class="p">()</code>&#13;
&#13;
<code class="nd">@app</code><code class="o">.</code><code class="n">get</code><code class="p">(</code><code class="s2">"/download_big/</code><code class="si">{name}</code><code class="s2">"</code><code class="p">)</code>&#13;
<code class="k">async</code> <code class="k">def</code> <code class="nf">download_big_file</code><code class="p">(</code><code class="n">name</code><code class="p">:</code><code class="nb">str</code><code class="p">):</code>&#13;
    <code class="n">gen_expr</code> <code class="o">=</code> <code class="n">gen_file</code><code class="p">(</code><code class="n">file_path</code><code class="o">=</code><code class="n">path</code><code class="p">)</code>&#13;
    <code class="n">response</code> <code class="o">=</code> <code class="n">StreamingResponse</code><code class="p">(</code>&#13;
        <code class="n">content</code><code class="o">=</code><code class="n">gen_expr</code><code class="p">,</code>&#13;
        <code class="n">status_code</code><code class="o">=</code><code class="mi">200</code><code class="p">,</code>&#13;
    <code class="p">)</code>&#13;
    <code class="k">return</code> <code class="n">response</code></pre></div>&#13;
&#13;
<p><code>gen_expr</code> is the <em>generator expression</em>&#13;
returned by the <em>generator function</em> <code>gen_file()</code>.&#13;
<code>StreamingResponse</code> uses it for its&#13;
iterable <code>content</code> argument,&#13;
so it can download the file in chunks.</p>&#13;
&#13;
<p><a data-type="xref" href="#ex-15-11">Example 15-11</a> is the accompanying test.&#13;
(This first needs the file <em>1GB.bin</em> alongside <em>main.py</em>,&#13;
and will take a <em>little</em> longer.)<a data-primary="files" data-secondary="downloading" data-startref="icd078" data-type="indexterm" id="id959"/><a data-primary="FastAPI" data-secondary="downloading files" data-startref="icd081" data-type="indexterm" id="id960"/></p>&#13;
<div data-type="example" id="ex-15-11">&#13;
<h5><span class="label">Example 15-11. </span>Download a big file with <a data-primary="HTTPie" data-secondary="downloading files" data-type="indexterm" id="id961"/>HTTPie</h5>&#13;
&#13;
<pre data-type="programlisting">$ <strong>http -b http://localhost:8000/big/1GB.bin | wc -c</strong>&#13;
 1000000000</pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Serving Static Files" data-type="sect1"><div class="sect1" id="id155">&#13;
<h1>Serving Static Files</h1>&#13;
&#13;
<p>Traditional<a data-primary="files" data-secondary="static files" data-type="indexterm" id="icd079"/> web<a data-primary="static files" data-type="indexterm" id="icd082"/> servers can treat server files&#13;
as though they were on a normal <span class="keep-together">filesystem</span>.&#13;
FastAPI lets you do this&#13;
with <code>StaticFiles</code>.</p>&#13;
&#13;
<p class="pagebreak-before">For this example, let’s make a directory of&#13;
(boring) free files&#13;
for users to download:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Make a directory called <em>static</em>,&#13;
at the same level as <em>main.py</em>.&#13;
(This can have any name; I’m calling it <em>static</em> only to help remember why I made it.)</p>&#13;
</li>&#13;
<li>&#13;
<p>Put a text file called <em>abc.txt</em> in it,&#13;
with the text contents <code>abc :)</code>.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p><a data-type="xref" href="#ex-15-12">Example 15-12</a> will serve any URL that starts with <em>/static</em>&#13;
(you could also have used any text string here)&#13;
with files from the <em>static</em> directory.</p>&#13;
<div data-type="example" id="ex-15-12">&#13;
<h5><span class="label">Example 15-12. </span>Serve everything in a directory with <code>StaticFiles</code> (add to <span class="plain">main.py</span>)</h5>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code> <code class="nn">pathlib</code> <code class="kn">import</code> <code class="n">Path</code>&#13;
<code class="kn">from</code> <code class="nn">fastapi</code> <code class="kn">import</code> <code class="n">FastAPI</code>&#13;
<code class="kn">from</code> <code class="nn">fastapi.staticfiles</code> <code class="kn">import</code> <code class="n">StaticFiles</code>&#13;
&#13;
<code class="c1"># Directory containing main.py:</code>&#13;
<code class="n">top</code> <code class="o">=</code> <code class="n">Path</code><code class="p">(</code><code class="vm">__file__</code><code class="p">)</code><code class="o">.</code><code class="n">resolve</code><code class="o">.</code><code class="n">parent</code>&#13;
&#13;
<code class="n">app</code><code class="o">.</code><code class="n">mount</code><code class="p">(</code><code class="s2">"/static"</code><code class="p">,</code>&#13;
    <code class="n">StaticFiles</code><code class="p">(</code><code class="n">directory</code><code class="o">=</code><code class="sa">f</code><code class="s2">"</code><code class="si">{</code><code class="n">top</code><code class="si">}</code><code class="s2">/static"</code><code class="p">,</code> <code class="n">html</code><code class="o">=</code><code class="kc">True</code><code class="p">),</code>&#13;
    <code class="n">name</code><code class="o">=</code><code class="s2">"free"</code><code class="p">)</code></pre></div>&#13;
&#13;
<p>That <code>top</code> calculation ensures that you put <code>static</code> alongside&#13;
<em>main.py</em>.&#13;
The <code>__file__</code> variable is the full&#13;
pathname of this file (<em>main.py</em>).</p>&#13;
&#13;
<p><a data-type="xref" href="#ex-15-13">Example 15-13</a> is one way to manually test <a data-type="xref" href="#ex-15-12">Example 15-12</a>.</p>&#13;
<div data-type="example" id="ex-15-13">&#13;
<h5><span class="label">Example 15-13. </span>Get a static file</h5>&#13;
&#13;
<pre data-type="programlisting">$ <strong>http -b localhost:8000/static/abc.txt</strong>&#13;
abc :)</pre></div>&#13;
&#13;
<p>What about that <code>html=True</code> argument that you passed to&#13;
<code>StaticFiles()</code>?&#13;
That makes it work a little more like a traditional server,&#13;
returning an <em>index.html</em> file if one exists in that directory,&#13;
but you didn’t ask for <em>index.html</em> explicitly in the URL.&#13;
So, let’s create an <em>index.html</em> file in the <em>static</em> directory&#13;
with the contents <code>Oh. Hi!</code>, and then test with <a data-type="xref" href="#ex-15-14">Example 15-14</a>.</p>&#13;
<div data-type="example" id="ex-15-14">&#13;
<h5><span class="label">Example 15-14. </span>Get an <span class="plain">index.html</span> file from <span class="plain">/static</span></h5>&#13;
&#13;
<pre data-type="programlisting">$ <strong>http -b localhost:8000/static/</strong>&#13;
Oh. Hi!</pre></div>&#13;
&#13;
<p class="pagebreak-before">You can have as many files (and subdirectories with files, etc.)&#13;
as you want.&#13;
Make a subdirectory <em>xyz</em> under <em>static</em> and put two files there:</p>&#13;
<dl>&#13;
<dt><em>xyx.txt</em></dt>&#13;
<dd>&#13;
<p>Contains the text <code>xyz :(</code>.</p>&#13;
</dd>&#13;
<dt><em>index.html</em></dt>&#13;
<dd>&#13;
<p>Contains the text <code>How did you find me?</code></p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>I won’t include the examples here.&#13;
Try them yourself, with I hope more naming <a data-primary="static files" data-startref="icd082" data-type="indexterm" id="id962"/><span class="keep-together">imagination</span><a data-primary="files" data-secondary="static files" data-startref="icd079" data-type="indexterm" id="id963"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Review" data-type="sect1"><div class="sect1" id="id156">&#13;
<h1>Review</h1>&#13;
&#13;
<p>This chapter showed how to upload and download files—small, large, even gigantiferous.&#13;
Plus, you learned how to serve <em>static files</em> in nostalgic (non-API) web style&#13;
from a directory<a data-primary="files" data-startref="icd076" data-type="indexterm" id="id964"/>.</p>&#13;
</div></section>&#13;
</div></section></body></html>