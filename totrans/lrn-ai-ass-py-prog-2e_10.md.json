["```py\ndef clean_word(word):\n '''\n word is a string.\n\n Return a version of word in which all letters have been\n converted to lowercase, and punctuation characters have been\n stripped from both ends. Inner punctuation is left untouched.\n\n >>> clean_word('Pearl!')\n 'pearl'\n >>> clean_word('card-board')\n 'card-board'\n '''\n    word = word.lower()                #1\n    word = word.strip(string.punctuation)   #2\n    return word\n```", "```py\nimport string\n```", "```py\nimport string\ndef clean_word(word):\n '''\n word is a string.\n\n Return a version of word in which all letters have been\n converted to lowercase, and punctuation characters have \n been stripped from both ends. Inner punctuation is left\n untouched.\n\n >>> clean_word('Pearl!')\n 'pearl'\n >>> clean_word('card-board')\n 'card-board'\n '''\n    word = word.lower() \n    word = word.strip(string.punctuation) \n    return word\n```", "```py\ndef average_word_length(text):\n '''\n text is a string of text.\n\n Return the average word length of the words in text.\n Do not count empty words as words.\n Do not include surrounding punctuation.\n\n >>> average_word_length('A pearl! Pearl! Lustrous pearl! \\\nRare. What a nice find.')\n 4.1\n '''\n    words = text.split()        #1\n    total = 0                      #2\n    count = 0                #3\n    for word in words:        #4\n        word = clean_word(word)       #5\n        if word != '':              #6\n            total += len(word)     #7\n            count += 1            #8\n    return total / count        #9\n```", "```py\ndef different_to_total(text):\n '''\n text is a string of text.\n\n Return the number of unique words in text\n divided by the total number of words in text.\n Do not count empty words as words.\n Do not include surrounding punctuation.\n >>> different_to_total('A pearl! Pearl! Lustrous pearl! \\\nRare. What a nice find.')\n 0.7\n '''\n    words = text.split()     #1\n    total = 0                     #2\n    unique = set()               #3\n    for word in words:\n        word = clean_word(word)     #4\n        if word != '':\n            total += 1\n            unique.add(word)      #5\n    return len(unique) / total      #6\n```", "```py\ndef exactly_once_to_total(text):\n '''\n text is a string of text.\n\n Return the number of words that show up exactly once in text\n divided by the total number of words in text.\n Do not count empty words as words.\n Do not include surrounding punctuation.\n\n >>> exactly_once_to_total('A pearl! Pearl! Lustrous pearl! \\\nRare. What a nice find.')\n 0.5\n '''\n    words = text.split()\n    unique = set()\n    total = 0\n    for word in words:\n        word = clean_word(word)\n        if word != '':\n            if word not in unique:\n                unique.add(word)\n            else:\n                unique.remove(word)   #1\n            total += 1\n    return len(unique) / total\n```", "```py\ndef exactly_once_to_total(text):\n '''\n text is a string of text.\n\n Return the number of words that show up exactly once in text\n divided by the total number of words in text.\n Do not count empty words as words.\n Do not include surrounding punctuation.\n\n >>> exactly_once_to_total('A pearl! Pearl! Lustrous pearl! \\\nRare. What a nice find.')\n 0.5\n '''\n    words = text.split()\n    total = 0\n    unique = set()             #1\n    once = set()             #2\n    for word in words:\n        word = clean_word(word)\n        if word != '':\n            total += 1\n            if word in unique:     #3\n                once.discard(word)     #4\n            else:\n                unique.add(word)     #5\n                once.add(word)        #6\n    return len(once) / total        #7\n```", "```py\ndef split_string(text, separators):\n '''\n text is a string of text.\n separators is a string of separator characters.\n\n Split the text into a list using any of the one-character\n separators and return the result.\n Remove spaces from beginning and end\n of a string before adding it to the list.\n Do not include empty strings in the list.\n\n >>> split_string('one*two[three', '*[')\n ['one', 'two', 'three']\n >>> split_string('A pearl! Pearl! Lustrous pearl! Rare. \\\nWhat a nice find.', '.?!') \n ['A pearl', 'Pearl', 'Lustrous pearl', 'Rare', \\\n'What a nice find']\n '''\n    words = []        #1\n    word = ''             **#2\n    for char in text:\n        if char in separators:    #3\n            word = word.strip()      #4\n            if word != '':          #5\n                words.append(word)      #6\n            word = ''                 #7\n        else:\n            word += char           #8\n    word = word.strip()      #9\n    if word != '':          **\n        words.append(word)  ** #9\n    return words #9******\n```", "```py\ndef get_sentences(text):\n '''\n text is a string of text.\n\n Return a list of the sentences from text.\n Sentences are separated by a '.', '?' or '!'.\n\n >>> get_sentences('A pearl! Pearl! Lustrous pearl! Rare. \\\nWhat a nice find.')\n ['A pearl', 'Pearl', 'Lustrous pearl', 'Rare', \\\n'What a nice find']\n '''\n    return split_string(text, '.?!')     #1\n```", "```py\ndef average_sentence_length(text):\n '''\n text is a string of text.\n\n Return the average number of words per sentence in text.\n Do not count empty words as words.\n\n >>> average_sentence_length('A pearl! Pearl! Lustrous pearl! \\\nRare. What a nice find.')\n 2.0\n '''\n    sentences = get_sentences(text)    #1\n    total = 0\n    for sentence in sentences:        #2\n        words = sentence.split()     #3\n        for word in words:       #4\n            if word != '':\n                total += 1\n    return total / len(sentences)     #5\n```", "```py\ndef get_phrases(sentence):\n '''\n sentence is a sentence string.\n\n Return a list of the phrases from sentence.\n Phrases are separated by a ',', ';' or ':'.\n\n >>> get_phrases('Lustrous pearl, Rare, What a nice find')\n ['Lustrous pearl', 'Rare', 'What a nice find']\n '''\n    return split_string(sentence, ',;:')    #1\n```", "```py\ndef average_sentence_complexity(text):\n '''\n text is a string of text.\n\n Return the average number of phrases per sentence in text.\n\n >>> average_sentence_complexity('A pearl! Pearl! Lustrous \\\npearl! Rare. What a nice find.')\n 1.0\n >>> average_sentence_complexity('A pearl! Pearl! Lustrous \\\npearl! Rare, what a nice find.')\n 1.25 **#1\n **'''**\n    sentences = get_sentences(text)     #2\n    total = 0\n    for sentence in sentences:               #3\n        phrases = get_phrases(sentence)       #4\n        total += len(phrases)             #5\n    return total / len(sentences)      #6**\n```", "```py\ndef make_signature(text):\n '''\n The signature for text is a list of five elements:\n average word length, different words divided by total words, \n words used exactly once divided by total words,\n average sentence length, and average sentence complexity.\n\n Return the signature for text. \n\n >>> make_signature('A pearl! Pearl! Lustrous pearl! \\\nRare, what a nice find.')\n [4.1, 0.7, 0.5, 2.5, 1.25]\n '''\n    return [average_word_length(text),            #1\n            different_to_total(text),            ** #1\n            exactly_once_to_total(text),         ** #1\n            average_sentence_length(text),        #1\n            average_sentence_complexity(text)]   ** #1******\n```", "```py\ndef get_all_signatures(known_dir):\n '''\n known_dir is the name of a directory of books.\n For each file in directory known_dir, determine its signature.\n\n Return a dictionary where each key is\n the name of a file, and the value is its signature.\n '''\n    signatures = {}                                 #1\n    for filename in os.listdir(known_dir):             #2\n        with open(os.path.join(known_dir,           #3\n                               filename)) as f:    ** #3\n            text = f.read()                            #4\n            signatures[filename] = make_signature(text)   #5\n    return signatures**\n```", "```py\n>>> get_all_signatures('known_authors')\n```", "```py\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"C:\\repos\\book_code\\ch11\\authorship.py\", line 207, \n  in get_all_signatures\n    for filename in os.listdir(known_dir):\n                    ^^\nNameError: name 'os' is not defined\n```", "```py\nimport os\n```", "```py\n>>> get_all_signatures('known_authors')\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"C:\\repos\\book_code\\ch11\\authorship.py\", line 209, \n  in get_all_signatures\n    text = f.read()\n           ^^^^^^^^\n  File \"â€¦\\Lib\\encodings\\cp1252.py\", line 23, in decode\n    return codecs.charmap_decode(input,self.errors,decoding_table)[0]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nUnicodeDecodeError: 'charmap' codec can't decode byte 0x9d in \nposition 2913: character maps to <undefined>\n```", "```py\nimport os\n\ndef get_all_signatures(known_dir):\n '''\n known_dir is the name of a directory of books.\n For each file in directory known_dir, determine its signature.\n\n Return a dictionary where each key is\n the name of a file, and the value is its signature.\n '''\n    signatures = {}\n # Fix UnicodeDecodeError **#1\n    for filename in os.listdir(known_dir):\n        with open(os.path.join(known_dir, filename), \n                  encoding='utf-8') as f:\n            text = f.read()\n            signatures[filename] = make_signature(text)\n    return signatures**\n```", "```py\n>>> get_all_signatures('known_authors')\n{'Arthur_Conan_Doyle.txt': [4.3745884086670195, \n0.1547122890234636, 0.09005503235165442, \n15.48943661971831, 2.082394366197183], \n'Charles_Dickens.txt': [4.229579999566339, \n0.0796743207788547, 0.041821158307855766, \n17.286386709736963, 2.698477157360406], \n'Frances_Hodgson_Burnett.txt': [4.230464334694739, \n0.08356818832607418, 0.04201769324672584, \n13.881251286272896, 1.9267338958633464], \n'Jane_Austen.txt': [4.492473405509028, \n0.06848572461149259, 0.03249477538065084, \n17.507478923035084, 2.607560511286375], \n'Mark_Twain.txt': [4.372851190055795, \n0.1350377851543188, 0.07780210466840878, \n14.395167731629392, 2.16194089456869]}\n```", "```py\ndef get_score(signature1, signature2, weights):\n '''\n signature1 and signature2 are signatures.\n weights is a list of five weights.\n\n Return the score for signature1 and signature2.\n\n >>> get_score([4.6, 0.1, 0.05, 10, 2],\\\n [4.3, 0.1, 0.04, 16, 4],\\\n [11, 33, 50, 0.4, 4]) **#1\n **14.2**\n **'''**\n    score = 0\n    for i in range(len(signature1)):                #2\n        score += abs(signature1[i] - signature2[i]) \\   #3\n                 * weights[i]                           #3\n    return score**\n```", "```py\ndef lowest_score(signatures_dict, unknown_signature, weights):\n '''\n signatures_dict is a dictionary mapping keys to signatures.\n unknown_signature is a signature.\n weights is a list of five weights.\n Return the key whose signature value has the lowest \n score with unknown_signature.\n\n >>> d = {'Dan': [1, 1, 1, 1, 1],\\ **#1\n **'Leo': [3, 3, 3, 3, 3]}** #1\n **>>> unknown = [1, 0.8, 0.9, 1.3, 1.4]**\n **>>> weights = [11, 33, 50, 0.4, 4]**\n **>>> lowest_score(d, unknown, weights)** **#2\n **'Dan'**\n **'''**\n    lowest = None\n    for key in signatures_dict:           **#3\n        score = get_score(signatures_dict[key],           #4\n                          unknown_signature, weights) \n        if lowest is None or score < lowest[1]:      #5\n            lowest = (key, score)       #6\n    return lowest[0]   #7******\n```", "```py\ndef process_data(mystery_filename, known_dir):\n '''\n mystery_filename is the filename of a mystery book whose \n author we want to know.\n known_dir is the name of a directory of books.\n\n Return the name of the signature closest to \n the signature of the text of mystery_filename.\n '''\n    signatures = get_all_signatures(known_dir)           #1\n    with open(mystery_filename, encoding='utf-8') as f:    #2\n        text = f.read()                                #3\n        unknown_signature = make_signature(text)         #4\n    return lowest_score(signatures, unknown_signature,    #5\n                        [11, 33, 50, 0.4, 4])             #5\n```", "```py\n>>> process_data('unknown1.txt', 'known_authors')\n'Arthur_Conan_Doyle.txt'\n```", "```py\ndef make_guess(known_dir):\n '''\n Ask user for a filename.\n Get all known signatures from known_dir,\n and print the name of the one that has the lowest score \n with the user's filename.\n '''\n    filename = input('Enter filename: ')       #1\n    print(process_data(filename, known_dir))     #2\n```", "```py\nmake_guess('known_authors')\n```", "```py\nEnter filename: unknown1.txt       \nArthur_Conan_Doyle.txt\n```"]