["```py\npip install \"ray[rllib, serve, tune]\"==1.9.0\n```", "```py\nimport ray\nray.init()\n```", "```py\n... INFO services.py:1263 -- View the Ray dashboard at http://127.0.0.1:8265\n{'node_ip_address': '192.168.1.41',\n 'raylet_ip_address': '192.168.1.41',\n 'redis_address': '192.168.1.41:6379',\n 'object_store_address': '.../sockets/plasma_store',\n 'raylet_socket_name': '.../sockets/raylet',\n 'webui_url': '127.0.0.1:8265',\n 'session_dir': '...',\n 'metrics_export_port': 61794,\n 'node_id': '...'}\n```", "```py\nimport ray\n\nitems = [{\"name\": str(i), \"data\": i} for i in range(10000)]\nds = ray.data.from_items(items)   ![1](assets/1.png)\nds.show(5)  ![2](assets/2.png)\n```", "```py\nArrowRow({'name': '0', 'data': 0})\nArrowRow({'name': '1', 'data': 1})\nArrowRow({'name': '2', 'data': 2})\nArrowRow({'name': '3', 'data': 3})\nArrowRow({'name': '4', 'data': 4})\n```", "```py\nsquares = ds.map(lambda x: x[\"data\"] ** 2)  ![1](assets/1.png)\n\nevens = squares.filter(lambda x: x % 2 == 0)  ![2](assets/2.png)\nevens.count()\n\ncubes = evens.flat_map(lambda x: [x, x**3])  ![3](assets/3.png)\nsample = cubes.take(10)  ![4](assets/4.png)\nprint(sample)\n```", "```py\npipe = ds.window()  ![1](assets/1.png)\nresult = pipe\\\n    .map(lambda x: x[\"data\"] ** 2)\\\n    .filter(lambda x: x % 2 == 0)\\\n    .flat_map(lambda x: [x, x**3])  ![2](assets/2.png)\nresult.show(10)\n```", "```py\n# pendulum.yml\npendulumppo:\n    env: Pendulum-v1  ![1](assets/1.png)\n    run: PPO  ![2](assets/2.png)\n    checkpoint_freq: 5  ![3](assets/3.png)\n    stop:\n        episode_reward_mean: 800  ![4](assets/4.png)\n    config:\n        lambda: 0.1  ![5](assets/5.png)\n        gamma: 0.95\n        lr: 0.0003\n        num_sgd_iter: 6\n```", "```py\nrllib train -f pendulum.yml\n```", "```py\ncurl https://raw.githubusercontent.com/maxpumperla/learning_ray/main/notebooks/pendulum.yml -o pendulum.yml\nrllib train -f pendulum.yml\n```", "```py\n ~/ray_results/pendulum-ppo/PPO_Pendulum-v1_20cbf_00000_0_2021-09-24_15-20-03/checkpoint_000029/checkpoint-29\n```", "```py\nrllib evaluate \\\n  ~/ray_results/pendulum-ppo/PPO_Pendulum-v1_<experiment_id>/checkpoint_0000<cp-id>/checkpoint-<cp-id> \\\n  --run PPO --env Pendulum-v1 --steps 2000\n```", "```py\nfrom ray.train import Trainer\n\ndef training_function():  ![1](assets/1.png)\n    pass\n\ntrainer = Trainer(backend=\"tensorflow\", num_workers=4)  ![2](assets/2.png)\ntrainer.start()\n\nresults = trainer.run(training_function)  ![3](assets/3.png)\ntrainer.shutdown()\n```", "```py\nfrom ray import tune\nimport math\nimport time\n\ndef training_function(config):  ![1](assets/1.png)\n    x, y = config[\"x\"], config[\"y\"]\n    time.sleep(10)\n    score = objective(x, y)\n    tune.report(score=score)  ![2](assets/2.png)\n\ndef objective(x, y):\n    return math.sqrt((x**2 + y**2)/2)  ![3](assets/3.png)\n\nresult = tune.run(  ![4](assets/4.png)\n    training_function,\n    config={\n        \"x\": tune.grid_search([-1, -.5, 0, .5, 1]),  ![5](assets/5.png)\n        \"y\": tune.grid_search([-1, -.5, 0, .5, 1])\n    })\n\nprint(result.get_best_config(metric=\"score\", mode=\"min\"))\n```", "```py\nfrom ray import serve\nfrom transformers import pipeline\nimport requests\n\nserve.start()  ![1](assets/1.png)\n\n@serve.deployment  ![2](assets/2.png)\ndef model(request):\n    language_model = pipeline(\"text-generation\", model=\"gpt2\")  ![3](assets/3.png)\n    query = request.query_params[\"query\"]\n    return language_model(query, max_length=100)  ![4](assets/4.png)\n\nmodel.deploy()  ![5](assets/5.png)\n\nquery = \"What's the meaning of life?\"\nresponse = requests.get(f\"http://localhost:8000/model?query={query}\")  ![6](assets/6.png)\nprint(response.text)\n```", "```py\n[{\n    \"generated_text\": \"What's the meaning of life?\\n\\n\n     Is there one way or another of living?\\n\\n\n     How does it feel to be trapped in a relationship?\\n\\n\n     How can it be changed before it's too late?\n     What did we call it in our time?\\n\\n\n     Where do we fit within this world and what are we going to live for?\\n\\n\n     My life as a person has been shaped by the love I've received from others.\"\n}]\n```"]