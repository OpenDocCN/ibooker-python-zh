<html><head></head><body>
<div id="sbo-rt-content"><section data-nutshell-tab="The Python Language" data-pdf-bookmark="Chapter 3. The Python Language" data-type="chapter" epub:type="chapter"><div class="chapter" id="the_python_language">
<h1><span class="label">Chapter 3. </span>The Python Language</h1>
<p>This chapter is a guide to the Python language. To learn Python from scratch, we suggest you start with the appropriate links from the<a contenteditable="false" data-primary="Python language" data-secondary="documentation" data-type="indexterm" id="idm44924594549440"/> <a href="https://oreil.ly/lVDFK">online docs</a> and the resources mentioned in <a data-type="xref" href="ch01.xhtml#python_documentation_for_nonprogrammers">“Python documentation for nonprogrammers”</a>. If you already know at least one other programming language well, and just want to learn specifics about Python, this chapter is for you. However, we’re not trying to teach Python: we cover a lot of ground at a pretty fast pace. We focus on the rules, and only secondarily point out best practices and style; as your<a contenteditable="false" data-primary="Python language" data-secondary="style guide" data-type="indexterm" id="idm44924594546288"/> Python style guide, use <a href="https://oreil.ly/biw1p">PEP 8</a> (optionally augmented by extra guidelines such as those of <a href="https://oreil.ly/gKFLA">“The Hitchhiker’s Guide to Python”</a>, <a href="https://oreil.ly/0nj5h">CKAN</a>, and <a href="https://oreil.ly/q9_k_">Google</a>).</p>
<section data-pdf-bookmark="Lexical Structure" data-type="sect1"><div class="sect1" id="lexical_structure">
<h1>Lexical Structure</h1>
<p>The<a contenteditable="false" data-primary="Python language" data-secondary="lexical structure" data-type="indexterm" id="PLlex03"/><a contenteditable="false" data-primary="lexical structure" data-type="indexterm" id="lexst03"/><a contenteditable="false" data-primary="lexical structure" data-secondary="definition of term" data-type="indexterm" id="idm44924594537104"/> <em>lexical structure</em> of a programming language is the set of basic rules that govern how you write programs in that language. It is the lowest-level syntax of the language, specifying such things as what variable names look like and how to denote comments. Each Python source file, like any other text file, is a sequence of characters. You can also usefully consider it a sequence of lines, tokens, or statements. These different lexical views complement each other. Python is very particular about program layout, especially lines and indentation: pay attention to this information if you are coming to Python from another language.</p>
<section data-pdf-bookmark="Lines and Indentation" data-type="sect2"><div class="sect2" id="lines_and_indentation">
<h2>Lines and Indentation</h2>
<p>A<a contenteditable="false" data-primary="lexical structure" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594532512"/><a contenteditable="false" data-primary="lines" data-type="indexterm" id="idm44924594531104"/><a contenteditable="false" data-primary="logical lines" data-type="indexterm" id="idm44924594530000"/><a contenteditable="false" data-primary="physical lines" data-type="indexterm" id="idm44924594528896"/><a contenteditable="false" data-primary="indentation" data-type="indexterm" id="idm44924594527792"/> Python program is a sequence of <em>logical lines</em>, each made up of one or more <em>physical lines</em>. Each physical line may end with a comment. A<a contenteditable="false" data-primary="hash sign (#)" data-type="indexterm" id="idm44924594525728"/><a contenteditable="false" data-primary="# (hash sign)" data-type="indexterm" id="idm44924594524624"/> hash sign (<span class="code">#</span>) that is not inside a string literal starts a comment. All characters after the <span class="code">#</span>, up to but excluding the line end, are the comment: Python ignores them. A line containing only whitespace, possibly with a comment, is a<a contenteditable="false" data-primary="blank lines" data-type="indexterm" id="idm44924594521984"/> <em>blank line</em>: Python ignores it. In an interactive interpreter session, you must enter an<a contenteditable="false" data-primary="empty lines" data-type="indexterm" id="idm44924594520304"/> empty physical line (without any whitespace or comment) to terminate a multiline statement.</p>
<p>In Python, the end of a physical line marks the end of most statements. Unlike in other languages, you don’t normally terminate Python statements with a delimiter, such as a<a contenteditable="false" data-primary="semicolon (;)" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594518832"/><a contenteditable="false" data-primary="; (semicolon)" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594517072"/> semicolon (<span class="code">;</span>). When a statement is too long to fit on a physical line, you can join two adjacent physical lines into a logical line by ensuring that the first physical line does not contain a comment and ends with a<a contenteditable="false" data-primary="backslash (\)" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594514848"/><a contenteditable="false" data-primary="\ (backslash)" data-primary-sortas="{\(backslash)" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594513472"/> backslash (<span class="code">\</span>). More elegantly, Python also automatically joins adjacent physical lines into one logical line if an open<a contenteditable="false" data-primary="parentheses (())" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594510848"/><a contenteditable="false" data-primary="() (parentheses)" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594509472"/><a contenteditable="false" data-primary="brackets ([])" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594508096"/><a contenteditable="false" data-primary="[] (brackets)" data-primary-sortas="|[] brackets" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594506720"/><a contenteditable="false" data-primary="braces ({})" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594505072"/><a contenteditable="false" data-primary="{} (braces)" data-secondary="lines and indentation" data-type="indexterm" id="idm44924594503696"/> parenthesis (<span class="code">(</span>), bracket (<span class="code">[</span>), or brace (<span class="code">{</span>) has not yet been closed: take advantage of this mechanism to produce more readable code than you’d get with backslashes at line ends. Triple-quoted string literals can also span physical lines. Physical lines after the first one in a logical line are known<a contenteditable="false" data-primary="continuation lines" data-type="indexterm" id="idm44924594500032"/> as <em>continuation lines</em>. Indentation rules apply to the first physical line of each logical line, not to continuation lines.</p>
<p>Python uses indentation to express the<a contenteditable="false" data-primary="block structure" data-type="indexterm" id="idm44924594497888"/><a contenteditable="false" data-primary="programs" data-secondary="block structure of" data-type="indexterm" id="idm44924594496784"/> block structure of a program. Python does not use braces, or other begin/end delimiters, around blocks of statements; indentation is the only way to denote blocks. Each logical line in a Python program is <em>indented</em> by the<a contenteditable="false" data-primary="whitespace" data-type="indexterm" id="idm44924594494864"/> whitespace on its left. A <em>block</em> is a contiguous sequence of logical lines, all indented by the same amount; a logical line with less indentation ends the block. All statements in a block must have the same indentation, as must all clauses in a compound statement. The first statement in a source file must have no indentation (i.e., must not begin with any whitespace). Statements that you type at the interactive interpreter primary prompt, <span class="code">&gt;&gt;&gt;</span> (covered in <a data-type="xref" href="ch02.xhtml#interactive_sessions">“Interactive Sessions”</a>), must also have no indentation.</p>
<p>Python treats each<a contenteditable="false" data-primary="tabs" data-type="indexterm" id="idm44924594491168"/> tab as if it was up to 8 spaces, so that the next character after the tab falls into logical column 9, 17, 25, and so on. Standard Python style is to use four spaces (<em>never</em> tabs) per indentation level.</p>
<p>If you must use tabs, Python does not allow mixing tabs and<a contenteditable="false" data-primary="spaces" data-type="indexterm" id="idm44924594489072"/> spaces for indentation.</p>
<div data-type="tip">
<h1>Use Spaces, Not Tabs</h1>
<p>Configure your favorite editor to expand a Tab keypress to four spaces, so that all Python source code you write contains just spaces, not tabs. This way, all tools, including Python itself, are consistent in handling indentation in your Python source files. Optimal Python style is to indent blocks by exactly four spaces; use no tab characters.</p>
</div>
</div></section>
<section data-pdf-bookmark="Character Sets" data-type="sect2"><div class="sect2" id="character_sets">
<h2>Character Sets</h2>
<p>A<a contenteditable="false" data-primary="lexical structure" data-secondary="character sets" data-type="indexterm" id="idm44924578452816"/><a contenteditable="false" data-primary="character sets" data-type="indexterm" id="idm44924578451408"/> Python source file can use any Unicode character, encoded by default as<a contenteditable="false" data-primary="UTF-8 encoding" data-type="indexterm" id="idm44924578450176"/> UTF-8. (Characters with codes between 0 and 127, the 7-bit<a contenteditable="false" data-primary="ASCII characters" data-type="indexterm" id="idm44924578448944"/> <em>ASCII characters</em>, encode in UTF-8 into the respective single bytes, so an ASCII text file is a fine Python source file, too.)</p>
<p>You may choose to tell Python that a certain source file is written in a different encoding. In this case, Python uses that encoding to read the file. To let Python know that a source file is written with a nonstandard encoding, start your source file with a comment whose form must be, for example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="c1"># coding: iso-8859-1</code></pre>
<p>After <span class="code">coding:</span>, write the name of an ASCII-compatible codec from the <span class="code">codecs</span> module, such as <span class="code">utf-8</span> or <span class="code">iso-8859-1</span>. Note that this<a contenteditable="false" data-primary="coding directive comments" data-type="indexterm" id="idm44924578436368"/> <em>coding directive</em> comment (also known as an<a contenteditable="false" data-primary="encoding declarations" data-type="indexterm" id="idm44924596684560"/> <em>encoding declaration</em>) is taken as such only if it is at the start of a source file (possibly after the<a contenteditable="false" data-primary="shebang (#!)" data-type="indexterm" id="idm44924596678720"/><a contenteditable="false" data-primary="#! (shebang)" data-type="indexterm" id="idm44924596677728"/> “shebang line” covered in <a data-type="xref" href="ch02.xhtml#running_python_programs">“Running Python Programs”</a>). Best practice is to use <span class="code">utf-8</span> for all of your text files, including Python source files.</p>
</div></section>
<section data-pdf-bookmark="Tokens" data-type="sect2"><div class="sect2" id="tokens">
<h2>Tokens</h2>
<p>Python<a contenteditable="false" data-primary="lexical structure" data-secondary="tokens" data-type="indexterm" id="idm44924597054464"/><a contenteditable="false" data-primary="tokens" data-type="indexterm" id="tokens03"/> breaks each logical line into a sequence of elementary lexical components known as <em>tokens</em>. Each token corresponds to a substring of the logical line. The normal<a contenteditable="false" data-primary="tokens" data-secondary="types of" data-type="indexterm" id="idm44924578440512"/> token types are <em>identifiers</em>, <em>keywords</em>, <em>operators</em>, <em>delimiters</em>, and <em>literals</em>, which we cover in the following sections. You may freely use whitespace between tokens to separate them. Some whitespace separation is necessary between logically adjacent identifiers or keywords; otherwise, Python would parse them as a single longer identifier. For example, <span class="code">ifx</span> is a single identifier; to write the keyword <span class="code"><strong>if</strong></span> followed by the identifier <span class="code">x</span>, you need to insert some whitespace (typically only one space character, i.e., <span class="code"><strong>if</strong></span> <span class="code">x</span>).</p>
<section data-pdf-bookmark="Identifiers" data-type="sect3"><div class="sect3" id="identifiers">
<h3>Identifiers</h3>
<p>An<a contenteditable="false" data-primary="tokens" data-secondary="identifiers" data-type="indexterm" id="idm44924565220320"/><a contenteditable="false" data-primary="identifiers" data-type="indexterm" id="idm44924565218912"/> <em>identifier</em> is a name used to specify a variable, function, class, module, or other object. An identifier starts with a letter (that is, any character that Unicode classifies as a letter) or an<a contenteditable="false" data-primary="underscore (_)" data-secondary="in identifiers" data-secondary-sortas="identifiers" data-type="indexterm" id="idm44924565217232"/><a contenteditable="false" data-primary="_ (underscore)" data-secondary="in identifiers" data-secondary-sortas="identifiers" data-type="indexterm" id="idm44924565215584"/> underscore (<span class="code">_</span>), followed by zero or more letters, underscores, digits, or other characters that Unicode classifies as letters, digits, or combining marks (as defined in <a href="https://oreil.ly/iL3qY">Unicode Standard Annex #31</a>).</p>
<p>For example, in the Unicode Latin-1 character range, the valid leading characters for an identifier are:</p>
<pre data-type="programlisting">
ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz
ªµºÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõöøùúûüýþÿ</pre>
<p>After the leading character, the valid identifier body characters are just the same, plus the digits and<a contenteditable="false" data-primary="· (middle dot)" data-type="indexterm" id="idm44924565210624"/><a contenteditable="false" data-primary="middle dot (·)" data-type="indexterm" id="idm44924565209520"/> <span class="code">·</span> (Unicode MIDDLE DOT) character:</p>
<pre data-type="programlisting">
0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz
ªµ·ºÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõöøùúûüýþÿ</pre>
<p>Case<a contenteditable="false" data-primary="case" data-secondary="in identifier names" data-type="indexterm" id="idm44924565206240"/><a contenteditable="false" data-primary="lowercase letters" data-type="indexterm" id="lcletter03"/><a contenteditable="false" data-primary="uppercase letters" data-secondary="in identifier names" data-type="indexterm" id="idm44924565203456"/><a contenteditable="false" data-primary="names and naming" data-secondary="of identifiers" data-type="indexterm" id="idm44924565202080"/> is significant: lowercase and uppercase letters are distinct. Punctuation characters<a contenteditable="false" data-primary="$ (dollar sign)" data-type="indexterm" id="idm44924565200576"/><a contenteditable="false" data-primary="dollar sign ($)" data-type="indexterm" id="idm44924565199472"/><a contenteditable="false" data-primary="! (exclamation point)" data-type="indexterm" id="idm44924565198368"/><a contenteditable="false" data-primary="exclamation point (!)" data-type="indexterm" id="idm44924565197264"/> such as <span class="code">@</span>, <span class="code">$</span>, and <span class="code">!</span> are not allowed in identifiers.</p>
<div data-type="warning" epub:type="warning">
<h1>Beware of Using Unicode Characters That Are Homoglyphs</h1>
<p>Some<a contenteditable="false" data-primary="Unicode characters" data-secondary="avoiding homoglyphs" data-type="indexterm" id="idm44924565192336"/> Unicode characters look very similar to, if not indistinguishable from, other characters. Such character pairs are called<a contenteditable="false" data-primary="homoglyphs" data-type="indexterm" id="idm44924578434224"/> <em>homoglyphs</em>. For instance, compare the capital letter A and the capital Greek letter alpha (Α). These are actually two different letters that just look very similar (or identical) in most fonts. In Python, they define two different variables:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">A</code><code> </code><code class="o">=</code><code> </code><code class="mi">100</code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><em><code class="c1"># this variable is GREEK CAPITAL LETTER ALPHA:</code></em><em><code>
</code></em><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">Α</code><code> </code><code class="o">=</code><code> </code><code class="mi">200</code><code>  </code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">A</code><code class="p">,</code><code> </code><code class="n">Α</code><code class="p">)</code></pre>
<pre data-type="programlisting">
<strong>100 200</strong></pre>
<p>If<a contenteditable="false" data-primary="English language" data-type="indexterm" id="idm44924578404352"/> you want to make your Python code widely usable, we recommend a policy that all identifiers, comments, and documentation are written in English, avoiding, in particular, non-English homoglyph characters. For more information, see <a href="https://oreil.ly/jVK5H">PEP 3131</a>.</p>
</div>
<p>Unicode<a contenteditable="false" data-primary="Unicode characters" data-secondary="normalization strategies" data-type="indexterm" id="idm44924578401728"/> normalization strategies add further complexities (Python<a contenteditable="false" data-primary="NFKC normalization" data-type="indexterm" id="idm44924578400224"/><a contenteditable="false" data-primary="normalization strategies" data-type="indexterm" id="idm44924578399120"/> uses <a href="https://oreil.ly/q944n">NFKC normalization</a> when parsing identifiers containing Unicode characters). See Jukka K. Korpela’s <a class="orm:hideurl" href="https://learning.oreilly.com/library/view/unicode-explained/059610121X"><em>Unicode Explained</em></a> (O’Reilly) and other technical information provided on the <a href="https://unicode.org">Unicode website</a> and in the <a href="https://oreil.ly/92fm2">books that site references</a> for more information.</p>
<div data-type="warning" epub:type="warning">
<h1>Avoid Normalizable Unicode Characters in Identifiers</h1>
<p>Python may create unintended aliases between variables when names contain certain Unicode characters, by internally converting the name as shown in the Python script to one using normalized characters. For example, the letters ª and º normalize to the ASCII lowercase letters a and o, so variables using these letters could clash with other variables:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;&gt;</code> <code class="n">a</code><code class="p">,</code> <code class="n">o</code> <code class="o">=</code> <code class="mi">100</code><code class="p">,</code> <code class="mi">101</code>
<code class="o">&gt;&gt;&gt;</code> <code class="n">ª</code><code class="p">,</code> <code class="n">º</code> <code class="o">=</code> <code class="mi">200</code><code class="p">,</code> <code class="mi">201</code>
<code class="o">&gt;&gt;&gt;</code> <code class="nb">print</code><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">o</code><code class="p">,</code> <code class="n">ª</code><code class="p">,</code> <code class="n">º</code><code class="p">)</code></pre>
<pre data-type="programlisting">
<strong>200 201 200 201</strong>  <em># expected "100 101 200 201"</em></pre>
<p>It is best to avoid using normalizable Unicode characters in your Python identifiers.</p>
</div>
<p>Normal Python style is to start<a contenteditable="false" data-primary="class names" data-type="indexterm" id="idm44924578360112"/><a contenteditable="false" data-primary="names and naming" data-secondary="of classes" data-type="indexterm" id="idm44924578358624"/><a contenteditable="false" data-primary="case" data-secondary="in class names" data-type="indexterm" id="idm44924578357248"/><a contenteditable="false" data-primary="uppercase letters" data-secondary="in class names" data-type="indexterm" id="idm44924578355872"/> class names with an uppercase letter, and most<sup><a data-type="noteref" href="ch03.xhtml#ch01fn20" id="ch01fn20-marker">1</a></sup> other identifiers with a lowercase letter. Starting an identifier with a single leading underscore indicates by convention that the identifier is meant to be private. Starting an identifier with two leading underscores indicates a<a contenteditable="false" data-primary="strongly private identifiers" data-type="indexterm" id="idm44924591636688"/> <em>strongly private</em> identifier; if the identifier also <em>ends</em> with two trailing underscores, however, this means that it’s a language-defined special name. Identifiers composed of multiple words should be all lowercase with underscores between words, as in <span class="code">login_password</span>. This is sometimes referred to as<a contenteditable="false" data-primary="snake case" data-type="indexterm" id="idm44924591634080"/><a contenteditable="false" data-primary="" data-startref="lcletter03" data-type="indexterm" id="idm44924591632976"/> <em>snake case</em>.</p>
<div data-type="tip">
<h1>The Single Underscore (_) in the Interactive Interpreter</h1>
<p>The<a contenteditable="false" data-primary="python program" data-secondary="interactive sessions" data-type="indexterm" id="idm44924591629888"/><a contenteditable="false" data-primary="underscore (_)" data-secondary="in interactive interpreter" data-secondary-sortas="interactive interpreter" data-type="indexterm" id="idm44924591628480"/><a contenteditable="false" data-primary="_ (underscore)" data-secondary="in interactive interpreter" data-secondary-sortas="interactive interpreter" data-type="indexterm" id="idm44924591626864"/> identifier <strong><span class="code">_</span></strong> (a single underscore) is special in interactive interpreter sessions: the interpreter binds <strong><span class="code">_</span></strong> to the result of the last expression statement it has evaluated interactively, if any.</p>
</div>
</div></section>
<section data-pdf-bookmark="Keywords" data-type="sect3"><div class="sect3" id="keywords">
<h3>Keywords</h3>
<p>Python<a contenteditable="false" data-primary="standard library modules" data-secondary="keyword" data-type="indexterm" id="idm44924591621152"/><a contenteditable="false" data-primary="tokens" data-secondary="keywords" data-type="indexterm" id="idm44924591619776"/><a contenteditable="false" data-primary="keyword module" data-type="indexterm" id="idm44924591618400"/><a contenteditable="false" data-primary="reserved words" data-type="indexterm" id="idm44924591617296"/> has 35 <em>keywords</em>, or identifiers that it reserves for special syntactic uses. Like identifiers, keywords are case-sensitive. You cannot use keywords as regular identifiers (thus, they’re sometimes known as “reserved words”). Some keywords begin simple statements or clauses of compound statements, while other keywords are operators. We cover all the keywords in detail in this book, either in this chapter or in Chapters <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch04.xhtml#object_oriented_python">4</a>, <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch06.xhtml#exceptions">6</a>, and <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch07.xhtml#modules_and_packages">7</a>. The keywords in Python are:</p>
<table class="border no-lines">
<tbody>
<tr>
<td><span class="code"><strong>and</strong></span></td>
<td><span class="code"><strong>break</strong></span></td>
<td><span class="code"><strong>elif</strong></span></td>
<td><span class="code"><strong>from</strong></span></td>
<td><span class="code"><strong>is</strong></span></td>
<td><span class="code"><strong>pass</strong></span></td>
<td><span class="code"><strong>with</strong></span></td>
</tr>
<tr>
<td><span class="code"><strong>as</strong></span></td>
<td><span class="code"><strong>class</strong></span></td>
<td><span class="code"><strong>else</strong></span></td>
<td><span class="code"><strong>global</strong></span></td>
<td><span class="code"><strong>lambda</strong></span></td>
<td><span class="code"><strong>raise</strong></span></td>
<td><span class="code"><strong>yield</strong></span></td>
</tr>
<tr>
<td><span class="code"><strong>assert</strong></span></td>
<td><span class="code"><strong>continue</strong></span></td>
<td><span class="code"><strong>except</strong></span></td>
<td><span class="code"><strong>if</strong></span></td>
<td><span class="code"><strong>nonlocal</strong></span></td>
<td><span class="code"><strong>return</strong></span></td>
<td><span class="code"><strong>False</strong></span></td>
</tr>
<tr>
<td><span class="code"><strong>async</strong></span></td>
<td><span class="code"><strong>def</strong></span></td>
<td><span class="code"><strong>finally</strong></span></td>
<td><span class="code"><strong>import</strong></span></td>
<td><span class="code"><strong>not</strong></span></td>
<td><span class="code"><strong>try</strong></span></td>
<td><span class="code"><strong>None</strong></span></td>
</tr>
<tr>
<td><span class="code"><strong>await</strong></span></td>
<td><span class="code"><strong>del</strong></span></td>
<td><span class="code"><strong>for</strong></span></td>
<td><span class="code"><strong>in</strong></span></td>
<td><span class="code"><strong>or</strong></span></td>
<td><span class="code"><strong>while</strong></span></td>
<td><span class="code"><strong>True</strong></span></td>
</tr>
</tbody>
</table>
<p>You can list them by importing the <span class="code">keyword</span> module and printing <span class="code">keyword.kwlist</span>.</p>
<p><span class="version">3.9+</span> In addition, Python 3.9 introduced the concept of<a contenteditable="false" data-primary="soft keywords" data-type="indexterm" id="idm44924591570960"/> <em>soft keywords</em>, which are keywords that are context sensitive. That is, they are language keywords for some specific syntax constructs, but outside of those constructs they may be used as variable or function names, so they are not <em>reserved</em> words. No soft keywords were defined in Python 3.9, but Python 3.10 introduced the following<a contenteditable="false" data-primary="case soft keyword" data-type="indexterm" id="idm44924591568752"/> soft keywords:</p>
<table class="border no-lines">
<tbody>
<tr>
<td><span class="code"><strong>_</strong></span></td>
<td><span class="code"><strong>case</strong></span></td>
<td><span class="code"><strong>match</strong></span></td>
</tr>
</tbody>
</table>
<p>You can list them from the <span class="code">keyword</span> module by printing <span class="code">keyword.softkwlist</span>.</p>
</div></section>
<section data-pdf-bookmark="Operators" data-type="sect3"><div class="sect3" id="operators">
<h3>Operators</h3>
<p>Python uses nonalphanumeric characters and character combinations as operators. Python recognizes the following operators, which are covered in detail in <a data-type="xref" href="#expressions_and_operators">“Expressions and Operators”</a>:</p>
<pre data-type="programlisting">
+  -  *  /  %   **  //  &lt;&lt;  &gt;&gt;  &amp;   @

|  ^  ~  &lt;  &lt;=  &gt;   &gt;=  !=  ==  @=  :=</pre>
<p>You can use<a contenteditable="false" data-primary="" data-type="indexterm" id="idm44924591557120"/> <span class="code">@</span> as an operator (in matrix multiplication, covered in <a data-type="xref" href="ch16.xhtml#numeric_processing">Chapter 16</a>), although (pedantically speaking!) the character is actually a delimiter.</p>
</div></section>
<section data-pdf-bookmark="Delimiters" data-type="sect3"><div class="sect3" id="delimiters">
<h3>Delimiters</h3>
<p>Python<a contenteditable="false" data-primary="delimiters" data-type="indexterm" id="idm44924591552080"/><a contenteditable="false" data-primary="{} (braces)" data-secondary="delimiters" data-type="indexterm" id="idm44924591550624"/><a contenteditable="false" data-primary="braces ({})" data-secondary="delimiters" data-type="indexterm" id="idm44924591549248"/><a contenteditable="false" data-primary=", (comma)" data-secondary="delimiters" data-type="indexterm" id="idm44924591547872"/><a contenteditable="false" data-primary=": (colon)" data-type="indexterm" id="idm44924591546496"/><a contenteditable="false" data-primary="colon (:)" data-type="indexterm" id="idm44924591545392"/><a contenteditable="false" data-primary="= (equal sign)" data-secondary="delimiters" data-type="indexterm" id="idm44924591544288"/><a contenteditable="false" data-primary="equal sign (=)" data-secondary="delimiters" data-type="indexterm" id="idm44924591542912"/><a contenteditable="false" data-primary="at sign (@)" data-secondary="delimiters" data-type="indexterm" id="idm44924591541536"/><a contenteditable="false" data-primary="+= character" data-type="indexterm" id="idm44924591540160"/><a contenteditable="false" data-primary="-= operator" data-type="indexterm" id="idm44924591539056"/><a contenteditable="false" data-primary="*= character" data-type="indexterm" id="idm44924591537952"/><a contenteditable="false" data-primary="/= character" data-type="indexterm" id="idm44924591536848"/><a contenteditable="false" data-primary="//= character" data-type="indexterm" id="idm44924591535744"/><a contenteditable="false" data-primary="%= character" data-type="indexterm" id="idm44924591534640"/><a contenteditable="false" data-primary="&amp;= character" data-type="indexterm" id="idm44924591533536"/><a contenteditable="false" data-primary="|= character" data-type="indexterm" id="idm44924591532432"/><a contenteditable="false" data-primary="^= character" data-type="indexterm" id="idm44924591531328"/><a contenteditable="false" data-primary="&gt;&gt;= operator" data-type="indexterm" id="idm44924591530224"/><a contenteditable="false" data-primary="**= character" data-type="indexterm" id="idm44924591529120"/> uses the following characters and combinations as delimiters in various statements, expressions, and list, dictionary, and set literals and comprehensions, among other purposes:</p>
<pre data-type="programlisting">
(    )    [    ]    {    }

,    :    .    =    ;    @

+=   -=   *=   /=   //=  %=

&amp;=   |=   ^=   &gt;&gt;=  &lt;&lt;=  **=</pre>
<p>The period (<span class="code">.</span>) can also appear in floating-point literals (e.g., <span class="code">2.3</span>) and imaginary literals (e.g., <span class="code">2.3j</span>). The last two rows are the augmented assignment operators, which are delimiters but also perform operations. We discuss the syntax for the various delimiters when we introduce the objects or statements using them.</p>
<p>The<a contenteditable="false" data-primary="' (single quote)" data-type="indexterm" id="idm44924591524208"/><a contenteditable="false" data-primary="&quot; (double quote)" data-type="indexterm" id="idm44924591523072"/><a contenteditable="false" data-primary="# (hash sign)" data-type="indexterm" id="idm44924591521968"/><a contenteditable="false" data-primary="backslash (\)" data-secondary="special meaning of in tokens" data-type="indexterm" id="idm44924591520864"/><a contenteditable="false" data-primary="\ (backslash)" data-primary-sortas="{\(backslash)" data-secondary="special meaning of in tokens" data-type="indexterm" id="idm44924591519520"/><a contenteditable="false" data-primary="single quote (')" data-type="indexterm" id="idm44924591517856"/><a contenteditable="false" data-primary="double quote (&quot;)" data-type="indexterm" id="idm44924591516752"/><a contenteditable="false" data-primary="hash sign (#)" data-type="indexterm" id="idm44924591515648"/><a contenteditable="false" data-primary="quotes" data-secondary="single quote (')" data-type="indexterm" id="idm44924591514544"/><a contenteditable="false" data-primary="quotes" data-secondary="double quote (&quot;)" data-type="indexterm" id="idm44924591513168"/><a contenteditable="false" data-primary="$ (dollar sign)" data-type="indexterm" id="idm44924591511792"/><a contenteditable="false" data-primary="dollar sign ($)" data-type="indexterm" id="idm44924591510688"/><a contenteditable="false" data-primary="control characters" data-type="indexterm" id="idm44924591509584"/> following characters have special meanings as part of other tokens:</p>
<pre data-type="programlisting">
'  "  #  \</pre>
<p><span class="code">'</span> and <span class="code">"</span> surround string literals. <span class="code">#</span> outside of a string starts a comment, which ends at the end of the current line. <span class="code">\</span> at the end of a physical line joins the following physical line with it into one logical line; <span class="code">\</span> is also an escape character in strings. The characters <span class="code">$</span> and <span class="code">?</span>, and all control characters<sup><a data-type="noteref" href="ch03.xhtml#ch01fn21" id="ch01fn21-marker">2</a></sup> except<a contenteditable="false" data-primary="whitespace" data-type="indexterm" id="idm44924591498416"/> whitespace, can never be part of the text of a Python program, except in comments or string literals.</p>
</div></section>
<section data-pdf-bookmark="Literals" data-type="sect3"><div class="sect3" id="literals">
<h3>Literals</h3>
<p>A<a contenteditable="false" data-primary="literals" data-type="indexterm" id="idm44924591495392"/> <em>literal</em> is the direct denotation in a program of a data value (a number, string, or container). The following are number and string literals in Python:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="mi">42</code><code>                     </code><em><code class="c1"># Integer literal</code></em><code>
</code><code class="mf">3.14</code><code>                   </code><em><code class="c1"># Floating-point literal</code></em><code>
</code><code class="mf">1.0j</code><code>                   </code><em><code class="c1"># Imaginary literal</code></em><code>
</code><code class="s1">'</code><code class="s1">hello</code><code class="s1">'</code><code>                </code><em><code class="c1"># String literal</code></em><code>
</code><code class="s2">"</code><code class="s2">world</code><code class="s2">"</code><code>                </code><em><code class="c1"># Another string literal</code></em><code>
</code><em><code class="sd">"""Good</code></em><code class="sd">
</code><em><code class="sd">night"""</code><code>               </code><code class="c1"># Triple-quoted string literal, spanning 2 lines</code></em></pre>
<p class="pagebreak-before">Combining number and string literals with the appropriate delimiters, you can directly build many container types with those literals as values:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">[</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="mf">3.14</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">hello</code><code class="s1">'</code><code class="p">]</code><code>     </code><em><code class="c1"># List</code></em><code>
</code><code class="p">[</code><code class="p">]</code><code>                      </code><em><code class="c1"># Empty list</code></em><code>
</code><code class="mi">100</code><code class="p">,</code><code> </code><code class="mi">200</code><code class="p">,</code><code> </code><code class="mi">300</code><code>           </code><em><code class="c1"># Tuple</code></em><code>
</code><code class="p">(</code><code class="mi">100</code><code class="p">,</code><code> </code><code class="mi">200</code><code class="p">,</code><code> </code><code class="mi">300</code><code class="p">)</code><code>         </code><em><code class="c1"># Tuple</code></em><code>
</code><code class="p">(</code><code class="p">)</code><code>                      </code><em><code class="c1"># Empty tuple</code></em><code>
</code><code class="p">{</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">:</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">y</code><code class="s1">'</code><code class="p">:</code><code class="mf">3.14</code><code class="p">}</code><code>      </code><em><code class="c1"># Dictionary</code></em><code>
</code><code class="p">{</code><code class="p">}</code><code>                      </code><em><code class="c1"># Empty dictionary</code></em><code>
</code><code class="p">{</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">8</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">string</code><code class="s1">'</code><code class="p">}</code><code>  </code><em><code class="c1"># Set</code></em><code>
</code><em><code class="c1"># There is no literal form to denote an empty set; use set() instead</code></em></pre>
<p>We cover the syntax for such container literals<sup><a data-type="noteref" href="ch03.xhtml#ch01fn22" id="ch01fn22-marker">3</a></sup> in detail in <a data-type="xref" href="#data_types">“Data Types”</a>, when we discuss the various data types Python supports. We refer to these expressions as literals throughout this book, as they describe literal (i.e., not requiring additional evaluation) values in the source code.<a contenteditable="false" data-primary="" data-startref="tokens03" data-type="indexterm" id="idm44924578268000"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Statements" data-type="sect2"><div class="sect2" id="statements">
<h2>Statements</h2>
<p>You<a contenteditable="false" data-primary="lexical structure" data-secondary="statements" data-type="indexterm" id="idm44924578264720"/><a contenteditable="false" data-primary="statements" data-type="indexterm" id="idm44924578263312"/> can look at a Python source file as a sequence of simple and compound statements.</p>
<section data-pdf-bookmark="Simple statements" data-type="sect3"><div class="sect3" id="simple_statements">
<h3>Simple statements</h3>
<p>A<a contenteditable="false" data-primary="simple statements" data-type="indexterm" id="idm44924578224912"/> <em>simple statement</em> is one that contains no other statements. A simple statement lies entirely within a logical line. As in many other languages, you may place more than one simple statement on a single logical line, with a<a contenteditable="false" data-primary="; (semicolon)" data-secondary="in simple statements" data-type="indexterm" id="idm44924578223200"/><a contenteditable="false" data-primary="semicolon (;)" data-secondary="in simple statements" data-type="indexterm" id="idm44924578221824"/> semicolon (<span class="code">;</span>) as the separator. However, using one statement per line is the usual and recommended Python style, and it makes programs more readable.</p>
<p>Any<a contenteditable="false" data-primary="expressions and operators" data-secondary="expressions as simple statements" data-type="indexterm" id="idm44924578218800"/> <em>expression</em> can stand on its own as a simple statement (we discuss expressions in <a data-type="xref" href="#expressions_and_operators">“Expressions and Operators”</a>). When you’re working interactively, the interpreter shows the result of an expression statement you enter at the<a contenteditable="false" data-primary="prompt (˃˃˃)" data-type="indexterm" id="idm44924578215824"/><a contenteditable="false" data-primary="˃˃˃ (prompt)" data-type="indexterm" id="idm44924578214752"/> prompt (<span class="code">&gt;&gt;&gt;</span>) and binds the result to a global variable named<a contenteditable="false" data-primary="underscore (_)" data-secondary="simple statements" data-type="indexterm" id="idm44924578212800"/><a contenteditable="false" data-primary="_ (underscore)" data-secondary="simple statements" data-type="indexterm" id="idm44924578211424"/> <span class="code">_</span> (underscore). Apart from interactive sessions, expression statements are useful only to call functions (and other <em>callables</em>) that have side effects (e.g., perform output, change arguments or global variables, or raise exceptions).</p>
<p>An<a contenteditable="false" data-primary="assignment statements" data-type="indexterm" id="idm44924578208240"/> <em>assignment</em> is a simple statement that assigns values to variables, as we discuss in <a data-type="xref" href="#assignment_statements">“Assignment Statements”</a>. An<a contenteditable="false" data-primary=":= (assignment operator)" data-secondary="simple statements" data-type="indexterm" id="idm44924578205184"/><a contenteditable="false" data-primary="walrus operator (:=)" data-secondary="simple statements" data-type="indexterm" id="idm44924578203808"/><a contenteditable="false" data-primary="assignment operator (:=)" data-secondary="simple statements" data-type="indexterm" id="idm44924578202432"/><a contenteditable="false" data-primary="= (equal sign)" data-secondary="assignment statements" data-type="indexterm" id="idm44924578201088"/><a contenteditable="false" data-primary="equal sign (=)" data-secondary="assignment statements" data-type="indexterm" id="idm44924578199712"/> assignment in Python using the <span class="code">=</span> operator is a statement and can never be part of an expression. To perform an assignment as part of an expression, you must use the <span class="code">:=</span> (known as the “walrus”) operator. You’ll see some examples of using <span class="code">:=</span> in <a data-type="xref" href="#assignment_expressions">“Assignment Expressions”</a>.</p>
</div></section>
<section data-pdf-bookmark="Compound statements" data-type="sect3"><div class="sect3" id="compound_statements">
<h3>Compound statements</h3>
<p>A<a contenteditable="false" data-primary="compound statements" data-type="indexterm" id="idm44924578193712"/> <em>compound statement</em> contains one or more other statements and controls their execution. A compound statement has one or more <em>clauses</em>, aligned at the same indentation. Each clause has a<a contenteditable="false" data-primary="headers" data-type="indexterm" id="idm44924578191072"/> <em>header</em> starting with a keyword and ending<a contenteditable="false" data-primary=": (colon)" data-type="indexterm" id="idm44924578189392"/><a contenteditable="false" data-primary="colon (:)" data-type="indexterm" id="idm44924578188288"/> with a colon (<span class="code">:</span>), followed by a<a contenteditable="false" data-primary="bodies" data-type="indexterm" id="idm44924578186336"/> <em>body</em>, which is a sequence of one or more statements. Normally, these statements, also known as a<a contenteditable="false" data-primary="blocks" data-type="indexterm" id="idm44924578184512"/> <em>block</em>, are on separate logical lines after the header line, indented four spaces rightward. The block lexically ends when the indentation returns to that of the clause header (or further left from there, to the indentation of some enclosing compound statement). Alternatively, the body can be a single simple statement following the <span class="code">:</span> on the same logical line as the header. The body may also consist of several simple statements on the same line with semicolons between them, but, as we’ve already mentioned, this is not good Python style.<a contenteditable="false" data-primary="" data-startref="lexst03" data-type="indexterm" id="idm44924578182144"/><a contenteditable="false" data-primary="" data-startref="PLlex03" data-type="indexterm" id="idm44924578180768"/></p>
</div></section>
</div></section>
</div></section>
<section data-pdf-bookmark="Data Types" data-type="sect1"><div class="sect1" id="data_types">
<h1>Data Types</h1>
<p>The<a contenteditable="false" data-primary="Python language" data-secondary="data types" data-type="indexterm" id="PLdtypes03"/><a contenteditable="false" data-primary="data types" data-type="indexterm" id="dtypes03"/> operation of a Python program hinges on the data it handles. Data values in Python are known as<a contenteditable="false" data-primary="objects" data-secondary="mutable and immutable" data-type="indexterm" id="idm44924578173840"/><a contenteditable="false" data-primary="types" data-type="indexterm" id="idm44924578172464"/> <em>objects</em>; each object, aka <em>value</em>, has a <em>type</em>. An object’s type determines which operations the object supports (in other words, which operations you can perform on the value). The type also determines the object’s<a contenteditable="false" data-primary="attributes" data-secondary="mutability" data-type="indexterm" id="idm44924578169888"/><a contenteditable="false" data-primary="items" data-type="indexterm" id="idm44924578168512"/> <em>attributes</em> and <em>items</em> (if any) and whether the object can be altered. An object that can be altered is known as a<a contenteditable="false" data-primary="mutable objects" data-type="indexterm" id="idm44924578166272"/> <em>mutable object</em>, while one that cannot be altered is an<a contenteditable="false" data-primary="immutable objects" data-type="indexterm" id="idm44924578164592"/> <em>immutable object</em>. We cover object attributes and items in <a data-type="xref" href="#object_attributes_and_items">“Object attributes and items”</a>.</p>
<p>The built-in <span class="code">type</span><span class="code">(<em>obj</em>)</span> function accepts any object as its argument and returns the type object that is the type of <span class="code"><em>obj</em></span>. The built-in function <span class="code">isinstance</span><span class="code">(<em>obj</em>,</span> <span class="code"><em>type</em></span><span class="code">)</span> returns <span class="code"><strong>True</strong></span> when object <span class="code"><em>obj</em></span> has type <span class="code"><em>type</em></span> (or any subclass thereof); otherwise, it returns <span class="code"><strong>False</strong></span>. The <span class="code"><em>type</em></span> argument of <span class="code">isinstance</span> may also be a tuple of types (<span class="version">3.10+</span> or multiple types joined with the <span class="code">|</span> operator), in which case it returns<a contenteditable="false" data-primary="True" data-type="indexterm" id="idm44924578149408"/> <span class="code"><strong>True</strong></span> if the type of <span class="code"><em>obj</em></span> matches any of the given types, or any subclasses of those types.</p>
<p>Python has built-in types for fundamental data types such as numbers, strings, tuples, lists, dictionaries, and sets, as covered in the following sections. You can also create user-defined types, known as <em>classes</em>, as discussed in <a data-type="xref" href="ch04.xhtml#classes_and_instances">“Classes and Instances”</a>.</p>
<section data-pdf-bookmark="Numbers" data-type="sect2"><div class="sect2" id="numbers">
<h2>Numbers</h2>
<p>The<a contenteditable="false" data-primary="data types" data-secondary="numbers" data-type="indexterm" id="idm44924578142912"/><a contenteditable="false" data-primary="numbers" data-type="indexterm" id="numb03"/> built-in numeric types in Python include integers, floating-point numbers, and complex numbers. The standard library also offers decimal floating-point numbers, covered in <a data-type="xref" href="ch16.xhtml#the_decimal_module">“The decimal Module”</a>, and fractions, covered in <a data-type="xref" href="ch16.xhtml#the_fractions_module">“The fractions Module”</a>. All numbers in Python are immutable objects; therefore, when you perform an operation on a number object, you produce a new number object. We cover operations on numbers, also known as arithmetic operations, in <a data-type="xref" href="#numeric_operations">“Numeric Operations”</a>.</p>
<p>Numeric literals do not include a sign: a leading <span class="code">+</span> or <span class="code">-</span>, if present, is a separate operator, as discussed in <a data-type="xref" href="#arithmetic_operations">“Arithmetic Operations”</a>.</p>
<section data-pdf-bookmark="Integer numbers" data-type="sect3"><div class="sect3" id="integer_numbers">
<h3>Integer numbers</h3>
<p>Integer literals<a contenteditable="false" data-primary="integer numbers" data-type="indexterm" id="idm44924578132304"/> can be decimal, binary, octal, or hexadecimal. A<a contenteditable="false" data-primary="decimal literals" data-type="indexterm" id="idm44924578130720"/> decimal literal is a sequence of digits in which the first digit is nonzero. A<a contenteditable="false" data-primary="binary literals" data-type="indexterm" id="idm44924578129488"/> binary literal is <span class="code">0b</span> followed by a sequence of binary digits (<span class="code">0</span> or <span class="code">1</span>). An octal literal is <span class="code">0o</span> followed by a sequence of octal digits (<span class="code">0</span> to <span class="code">7</span>). A<a contenteditable="false" data-primary="hexadecimal literals" data-type="indexterm" id="idm44924578123872"/> hexadecimal literal is <span class="code">0x</span> followed by a sequence of hexadecimal digits (<span class="code">0</span> to <span class="code">9</span> and <span class="code">A</span> to <span class="code">F</span>, in either upper- or lowercase). For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">23</code><code class="p">,</code><code> </code><code class="mi">3493</code><code>                    </code><em><code class="c1"># Decimal integer literals</code></em><code>
</code><code class="mi">0b010101</code><code class="p">,</code><code> </code><code class="mi">0b110010</code><code class="p">,</code><code> </code><code class="mi">0B01</code><code>       </code><em><code class="c1"># Binary integer literals</code></em><code>
</code><code class="mo">0o1</code><code class="p">,</code><code> </code><code class="mo">0o27</code><code class="p">,</code><code> </code><code class="mo">0o6645</code><code class="p">,</code><code> </code><code class="mo">0O777</code><code>       </code><em><code class="c1"># Octal integer literals</code></em><code>
</code><code class="mh">0x1</code><code class="p">,</code><code> </code><code class="mh">0x17</code><code class="p">,</code><code> </code><code class="mh">0xDA5</code><code class="p">,</code><code> </code><code class="mh">0xda5</code><code class="p">,</code><code> </code><code class="mh">0Xff</code><code>  </code><em><code class="c1"># Hexadecimal integer literals</code></em></pre>
<p>Integers can represent values in the range <span class="code">±2**sys.maxsize</span>, or roughly ±10<sup>2.8e18</sup>.</p>
<p><a data-type="xref" href="#int_methods">Table 3-1</a> lists<a contenteditable="false" data-primary="int type" data-secondary="int methods" data-type="indexterm" id="idm44924582199424"/> the methods supported by an <span class="code">int</span> object <span class="code"><em>i</em></span>.</p>
<table class="border" id="int_methods">
<caption><span class="label">Table 3-1. </span><span class="code">int</span> methods</caption>
<tbody>
<tr>
<td class="width-15"><span class="code">as_inte⁠g⁠e⁠r⁠_​r⁠a⁠t⁠i⁠o</span></td>
<td><span class="code"><em>i</em></span><span class="code">.as_integer_ratio()</span><br/>
<span class="version">3.8+</span> Returns<a contenteditable="false" data-primary="as_integer_ratio (int method)" data-type="indexterm" id="idm44924582189648"/> a tuple of two <span class="code">int</span>s, whose exact ratio is the original integer value. (Since <span class="code"><em>i</em></span> is always <span class="code">int</span>, the tuple is always <span class="code">(<em>i</em>, 1)</span>; compare with <span class="code">float.as_integer_ratio</span>.)</td>
</tr>
<tr>
<td><span class="code">bit_count</span></td>
<td><span class="code"><em>i</em></span><span class="code">.bit_count()</span><br/>
<span class="version">3.10+</span> Returns<a contenteditable="false" data-primary="bit_count (int method)" data-type="indexterm" id="idm44924582180560"/> the number of ones in the binary representation of <span class="code">abs(<em>i</em>)</span>.</td>
</tr>
<tr>
<td><span class="code">bit_length</span></td>
<td><span class="code"><em>i</em></span><span class="code">.bit_length()</span><br/>
			Returns<a contenteditable="false" data-primary="bit_length (int method)" data-type="indexterm" id="idm44924582174720"/> the minimum number of bits needed to represent <span class="code"><em>i</em></span>. Equivalent to the length of the binary representation of <span class="code">abs(<em>i</em>)</span>, after removing <span class="code">'b'</span> and all leading zeros. <span class="code">(0).bit_length()</span> returns <span class="code">0</span>.</td>
</tr>
<tr>
<td><span class="code">from_bytes</span></td>
<td><span class="code">int.from_bytes(<em>bytes_value</em>,</span> <span class="code"><em>byteorder</em></span><span class="code">, *,</span> <span class="code"><em>signed</em></span><span class="code">=<strong>False</strong>)</span><br/>
			Returns<a contenteditable="false" data-primary="from_bytes (int method)" data-type="indexterm" id="idm44924582162896"/> an <span class="code">int</span> from the bytes in <span class="code"><em>bytes_value</em></span> following the same argument usage as in <span class="code">to_bytes</span>. (Note that <span class="code">from_bytes</span> is a class method of <span class="code">int</span>.)</td>
</tr>
<tr>
<td><span class="code">to_bytes</span></td>
<td><span class="code"><em>i</em></span><span class="code">.to_bytes(<em>length</em>,</span> <span class="code"><em>byteorder</em></span><span class="code">, *,</span> <span class="code"><em>signed</em></span><span class="code">=<strong>False</strong>)</span><br/>
			Returns<a contenteditable="false" data-primary="to_bytes (int method)" data-type="indexterm" id="idm44924582150640"/> a <span class="code">bytes</span> value <span class="code"><em>length</em></span> bytes in size representing the binary value of <span class="code"><em>i</em></span>. <span class="code"><em>byteorder</em></span> must be the <span class="code">str</span> value <span class="code">'big'</span> or <span class="code">'little'</span>, indicating whether the return value should be big-endian (most significant byte first) or little-endian (least significant byte first). For example, <span class="code">(258).to_bytes(2, 'big')</span> returns <span class="code">b'\x01\x02'</span>, and <span class="code">(258).to_bytes(2, 'little')</span> returns <span class="code">b'\x02\x01'</span>. When <span class="code"><em>i</em></span> <span class="code">&lt; 0</span> and <span class="code"><em>signed</em></span> is <span class="code"><strong>True</strong></span>, <span class="code">to_bytes</span> returns the bytes of <span class="code"><em>i</em></span> represented in two’s complement. When <span class="code"><em>i</em></span> <span class="code">&lt; 0</span> and <span class="code"><em>signed</em></span> is <span class="code"><strong>False</strong></span>, <span class="code">to_bytes</span> raises <span class="code">OverflowError</span>.</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Floating-point numbers" data-type="sect3"><div class="sect3" id="floating_point_numbers">
<h3>Floating-point numbers</h3>
<p>A<a contenteditable="false" data-primary="floating-point numbers" data-secondary="basics of" data-type="indexterm" id="idm44924582129824"/><a contenteditable="false" data-primary=". (period)" data-secondary="floating-point numbers" data-type="indexterm" id="idm44924582128032"/><a contenteditable="false" data-primary="period (.)" data-secondary="floating-point numbers" data-type="indexterm" id="idm44924582126656"/> floating-point literal is a sequence of decimal digits that includes a decimal point (<span class="code">.</span>), an exponent suffix (<span class="code">e</span> or <span class="code">E</span>, optionally followed by <span class="code">+</span> or <span class="code">-</span>, followed by one or more digits), or both. The leading character of a floating-point literal cannot be <span class="code">e</span> or <span class="code">E</span>; it may be any digit or a period (<span class="code">.</span>) followed by a digit. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="mf">0.</code><code class="p">,</code><code> </code><code class="mf">0.0</code><code class="p">,</code><code> </code><code class="mf">.0</code><code class="p">,</code><code> </code><code class="mf">1.</code><code class="p">,</code><code> </code><code class="mf">1.0</code><code class="p">,</code><code> </code><code class="mf">1e0</code><code class="p">,</code><code> </code><code class="mf">1.e0</code><code class="p">,</code><code> </code><code class="mf">1.0E0</code><code>  </code><em><code class="c1"># Floating-point literals</code></em></pre>
<p>A Python floating-point value corresponds to a C <span class="code">double</span> and shares its limits of range and precision: typically 53 bits—about 15 digits—of precision on modern platforms. (For the exact range and precision of floating-point values on the platform where the code is running, and many other details, see the online documentation on <a href="https://oreil.ly/kEa6H"><span class="code">sys.float_info</span></a>.)</p>
<p><a data-type="xref" href="#float_methods">Table 3-2</a> lists<a contenteditable="false" data-primary="float methods" data-type="indexterm" id="idm44924582097952"/> the methods supported by a <span class="code">float</span> object <span class="code"><em>f</em></span>.</p>
<table class="border" id="float_methods">
<caption><span class="label">Table 3-2. </span><span class="code">float</span> methods</caption>
<tbody>
<tr>
<td class="width-15"><span class="code">as_inte⁠g⁠e⁠r⁠_​r⁠a⁠t⁠i⁠o</span></td>
<td>
<p><span class="code"><em>f</em></span><span class="code">.as_integer_ratio()</span><br/>
			Returns<a contenteditable="false" data-primary="as_integer_ratio (float method)" data-type="indexterm" id="idm44924582066240"/> a tuple of two <span class="code">int</span>s, a numerator and a denominator, whose exact ratio is the original float value, <span class="code"><em>f</em></span>. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;&gt;</code> <code class="n">f</code><code class="o">=</code><code class="mf">2.5</code>
<code class="o">&gt;&gt;&gt;</code> <code class="n">f</code><code class="o">.</code><code class="n">as_integer_ratio</code><code class="p">()</code></pre>
<pre data-type="programlisting">
<strong>(5, 2)</strong></pre>
</td>
</tr>
<tr>
<td><span class="code">from_hex</span></td>
<td><span class="code">float.from_hex(<em>s</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="from_hex (float method)" data-type="indexterm" id="idm44924582016656"/> a <span class="code">float</span> value from the hexadecimal <span class="code">str</span> value <span class="code"><em>s</em></span>. <span class="code"><em>s</em></span> can be of the form returned by <span class="code">f.hex()</span>, or simply a string of hexadecimal digits. When the latter is the case, <span class="code">from_hex</span> returns <span class="code">float(int(<em>s</em>, 16))</span>.</td>
</tr>
<tr>
<td><span class="code">hex</span></td>
<td><span class="code"><em>f</em></span><span class="code">.hex()</span><br/>
			Returns<a contenteditable="false" data-primary="hex (float method)" data-type="indexterm" id="idm44924582042352"/> a hexadecimal representation of <span class="code"><em>f</em></span>, with leading <span class="code">0x</span> and trailing <span class="code">p</span> and exponent. For example, <span class="code">(99.0).hex()</span> returns <span class="code">'0x1.8c00000000000p+6'</span>.</td>
</tr>
<tr>
<td><span class="code">is_integer</span></td>
<td><span class="code"><em>f</em></span><span class="code">.is_integer()</span><br/>
			Returns<a contenteditable="false" data-primary="is_integer (float method)" data-type="indexterm" id="idm44924582034240"/> a <span class="code">bool</span> value indicating if <span class="code"><em>f</em></span> is an integer value. Equivalent to <span class="code">int(<em>f</em>) ==</span> <span class="code"><em>f</em></span>.</td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Complex numbers" data-type="sect3"><div class="sect3" id="complex_numbers">
<h3>Complex numbers</h3>
<p>A<a contenteditable="false" data-primary="complex numbers" data-type="indexterm" id="idm44924570961840"/> complex number is made up of two floating-point values, one each for the real and imaginary parts. You can access the parts of a complex object <span class="code"><em>z</em></span> as read-only attributes <span class="code"><em>z</em></span><span class="code">.real</span> and <span class="code"><em>z</em></span><span class="code">.imag</span>. You can specify an imaginary literal as any floating-point or integer decimal literal followed by a <span class="code">j</span> or <span class="code">J</span>:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="mi">0j</code><code class="p">,</code> <code class="mf">0.j</code><code class="p">,</code> <code class="mf">0.0j</code><code class="p">,</code> <code class="mf">.0j</code><code class="p">,</code> <code class="mi">1j</code><code class="p">,</code> <code class="mf">1.j</code><code class="p">,</code> <code class="mf">1.0j</code><code class="p">,</code> <code class="mf">1e0j</code><code class="p">,</code> <code class="mf">1.e0j</code><code class="p">,</code> <code class="mf">1.0e0j</code></pre>
<p>The <span class="code">j</span> at the end of the literal indicates the square root of <span class="code">-1</span>, as commonly used in electrical engineering (some other disciplines use <span class="code">i</span> for this purpose, but Python uses <span class="code">j</span>). There are no other complex literals. To denote any constant complex number, add or subtract a floating-point (or integer) literal and an imaginary one. For example, to denote the complex number that equals 1, use expressions like <span class="code">1+0j</span> or <span class="code">1.0+0.0j</span>. Python performs the addition at compile time, so there’s no need to worry about overhead.</p>
<p class="pagebreak-before">A <span class="code">complex</span> object <span class="code"><em>c</em></span> supports a single method:</p>
<table class="border">
<tbody>
<tr>
<td class="width-15"><span class="code">conjugate</span></td>
<td><span class="code"><em>c</em></span><span class="code">.conjugate()</span><br/>
			Returns<a contenteditable="false" data-primary="conjugate" data-type="indexterm" id="idm44924570930880"/> a new complex number <span class="code">complex(<em>c</em>.real, -<em>c</em>.imag)</span> (i.e., the return value has <span class="code"><em>c</em></span>’s <span class="code">imag</span> attribute with a sign change).</td>
</tr>
</tbody>
</table>
<p>See <a data-type="xref" href="ch16.xhtml#the_math_and_cmath_modules">“The math and cmath Modules”</a> for several other functions that use floats and complex numbers.</p>
</div></section>
<section data-pdf-bookmark="Underscores in numeric literals" data-type="sect3"><div class="sect3" id="underscores_in_numeric_literals">
<h3>Underscores in numeric literals</h3>
<p>To<a contenteditable="false" data-primary="_ (underscore)" data-secondary="numeric literals" data-type="indexterm" id="idm44924570922960"/><a contenteditable="false" data-primary="underscore (_)" data-secondary="numeric literals" data-type="indexterm" id="idm44924570921552"/> aid with visual assessment of the magnitude of a number, numeric literals can include single underscore (<span class="code">_</span>) characters between digits or after any base specifier. It’s not only decimal numeric constants that can benefit from this notational freedom, however, as these examples show:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="mf">100_000.000_0001</code><code class="p">,</code><code> </code><code class="mf">0x_FF_FF</code><code class="p">,</code><code> </code><code class="mf">0o7_777</code><code class="p">,</code><code> </code><code class="mf">0b_1010_1010</code></pre>
<pre data-type="programlisting">
<strong>(100000.0000001, 65535, 4095, 170)</strong></pre>
<p>There is no enforcement of location of the underscores (except that two may not occur consecutively), so <span class="code">123_456</span> and <span class="code">12_34_56</span> both represent the same <span class="code">int</span> value as <span class="code">123456</span>.<a contenteditable="false" data-primary="" data-startref="numb03" data-type="indexterm" id="idm44924570907616"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Sequences" data-type="sect2"><div class="sect2" id="sequence">
<h2>Sequences</h2>
<p>A<a contenteditable="false" data-primary="data types" data-secondary="sequences" data-type="indexterm" id="idm44924570904016"/><a contenteditable="false" data-primary="sequences" data-type="indexterm" id="seq03"/> <em>sequence</em> is an ordered container of items, indexed by integers. Python has built-in sequence types known as strings (<span class="code">bytes</span> or <span class="code">str</span>), tuples, and lists. Library and extension modules provide other sequence types, and you can write others yourself (as discussed in <a data-type="xref" href="#sequence">“Sequences”</a>”). You can manipulate sequences in a variety of ways, as discussed in <a data-type="xref" href="#sequence_operations">“Sequence Operations”</a>.</p>
<section data-pdf-bookmark="Iterables" data-type="sect3"><div class="sect3" id="iterables">
<h3>Iterables</h3>
<p>A<a contenteditable="false" data-primary="iterables" data-type="indexterm" id="idm44924570895568"/> Python concept that captures in abstract the iteration behavior of sequences is that of <em>iterables</em>, covered in <a data-type="xref" href="#the_for_statement">“The for Statement”</a>. All sequences are iterable: whenever we say you can use an iterable, you can use a sequence (for example, a list).</p>
<p>Also, when we say that you can use an iterable we usually mean a<a contenteditable="false" data-primary="bounded iterables" data-type="indexterm" id="idm44924570892240"/> <em>bounded</em> iterable: an iterable that eventually stops yielding items. In general, sequences are bounded. Iterables can be unbounded, but if you try to use an unbounded iterable without special precautions, you could produce a program that never terminates, or one that exhausts all available memory.</p>
</div></section>
<section data-pdf-bookmark="Strings" data-type="sect3"><div class="sect3" id="string">
<h3>Strings</h3>
<p>Python<a contenteditable="false" data-primary="strings" data-secondary="built-in string types" data-type="indexterm" id="strings03"/> has two built-in string types, <span class="code">str</span> and <span class="code">bytes</span>.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn23" id="ch01fn23-marker">4</a></sup> A <span class="code">str</span> object is a sequence of characters used to store and represent text-based information. A <span class="code">bytes</span> object stores and represents arbitrary sequences of binary bytes. Strings of both types in Python are<a contenteditable="false" data-primary="immutable strings" data-type="indexterm" id="idm44924570880160"/> <em>immutable</em>: when you perform an operation on strings, you always produce a new string object of the same type, rather than mutating an existing string. String objects provide many methods, as discussed in detail in <a data-type="xref" href="ch09.xhtml#methods_of_string_objects">“Methods of String Objects”</a>.</p>
<p>A<a contenteditable="false" data-primary="' (single quote)" data-type="indexterm" id="idm44924570876944"/><a contenteditable="false" data-primary="&quot; (double quote)" data-type="indexterm" id="idm44924570875808"/><a contenteditable="false" data-primary="single quote (')" data-type="indexterm" id="idm44924570874704"/><a contenteditable="false" data-primary="double quote (&quot;)" data-type="indexterm" id="idm44924570873600"/><a contenteditable="false" data-primary="quotes" data-secondary="single quote (')" data-type="indexterm" id="idm44924570872496"/><a contenteditable="false" data-primary="quotes" data-secondary="double quote (&quot;)" data-type="indexterm" id="idm44924570871120"/> string literal can be quoted or triple-quoted. A quoted string is a sequence of zero or more characters within matching quotes, single (<span class="code">'</span>) or double (<span class="code">"</span>). For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="s1">'This is a literal string'</code>
<code class="s2">"This is another string"</code></pre>
<p>The two different kinds of quotes function identically; having both lets you include one kind of quote inside of a string specified with the other kind, with no need to escape quote characters with the<a contenteditable="false" data-primary="backslash (\)" data-secondary="strings" data-type="indexterm" id="backstringa03"/><a contenteditable="false" data-primary="\ (backslash)" data-primary-sortas="{\(backslash)" data-secondary="strings" data-type="indexterm" id="slashbackstring03"/> backslash character (<span class="code">\</span>):</p>
<pre data-code-language="python" data-type="programlisting">
<code class="s1">'</code><code class="s1">I</code><code class="se">\'</code><code class="s1">m a Python fanatic</code><code class="s1">'</code><code>     </code><em><code class="c1"># You can escape a quote</code></em><code>
</code><code class="s2">"</code><code class="s2">I</code><code class="s2">'</code><code class="s2">m a Python fanatic</code><code class="s2">"</code><code>      </code><em><code class="c1"># This way may be more readable</code></em></pre>
<p>Many (but far from all) style guides that pronounce on the subject suggest that you use single quotes when the choice is otherwise indifferent. The popular code formatter<a contenteditable="false" data-primary="black tool" data-type="indexterm" id="idm44924570826464"/> <span class="code">black</span> prefers double quotes; this choice is controversial enough to have been the main inspiration for a<a contenteditable="false" data-primary="blue tool" data-type="indexterm" id="idm44924570824608"/> “fork,” <span class="code">blue</span>, whose main difference from <span class="code">black</span> is to prefer single quotes instead, as most of this book’s authors do.</p>
<p>To have a string literal span multiple physical lines, you can use a <span class="code">\</span> as the last character of a line to indicate that the next line is a continuation:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="s1">'</code><code class="s1">A not very long string </code><code class="se">\
</code><code class="s1">that spans two lines</code><code class="s1">'</code><code>       </code><em><code class="c1"># Comment not allowed on previous line</code></em></pre>
<p>You can also embed a newline in the string to make it contain two lines rather than just one:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="s1">'</code><code class="s1">A not very long string</code><code class="se">\n</code><code class="se">\
</code><code class="s1">that prints on two lines</code><code class="s1">'</code><code>   </code><em><code class="c1"># Comment not allowed on previous line</code></em></pre>
<p>A better approach, however, is to use a<a contenteditable="false" data-primary="triple single quotes (''')" data-type="indexterm" id="idm44924570763440"/><a contenteditable="false" data-primary="''' (triple single quotes)" data-type="indexterm" id="idm44924570762576"/><a contenteditable="false" data-primary="quotes" data-secondary="triple single quotes (''')" data-type="indexterm" id="idm44924570761504"/><a contenteditable="false" data-primary="&quot;&quot;&quot; (triple double quotes)" data-type="indexterm" id="idm44924570760160"/><a contenteditable="false" data-primary="triple double quotes (&quot;&quot;&quot;)" data-type="indexterm" id="idm44924570759088"/><a contenteditable="false" data-primary="quotes" data-secondary="triple double quotes (&quot;&quot;&quot;)" data-type="indexterm" id="idm44924570758016"/> triple-quoted string, enclosed by matching triplets of quote characters (<span class="code">'''</span>, or better, as mandated by <a href="https://oreil.ly/RmvLN">PEP 8</a>, <span class="code">"</span><span class="code">"</span><span class="code">"</span>). In a triple-quoted string literal, line breaks in the literal remain as newline characters in the resulting string object:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="sd">"""</code></em><em><code class="sd">An even bigger</code></em><code class="sd">
</code><em><code class="sd">string that spans
three lines"""</code></em><code>              </code><em><code class="c1"># Comments not allowed on previous lines</code></em></pre>
<p>You can start a triple-quoted literal with an escaped newline, to avoid having the first line of the literal string’s content at a different indentation level from the rest. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">the_text</code><code> </code><code class="o">=</code><code> </code><code class="s2">"""</code><code class="se">\
</code><code class="s2">First line</code><code class="s2">
</code><code class="s2">Second line</code><code class="s2">
</code><code class="s2">"""</code><code>      </code><em><code class="c1"># The same as "First line\nSecond line\n" but more readable</code></em></pre>
<p>The only character that cannot be part of a triple-quoted string literal is an unescaped backslash, while a single-quoted string literal cannot contain unescaped backslashes, nor line ends, nor the quote character that encloses it. The backslash character starts an<a contenteditable="false" data-primary="escape sequences" data-type="indexterm" id="idm44924587827936"/> <em>escape sequence</em>, which lets you introduce any character in either kind of string literal. See <a data-type="xref" href="#string_escape_sequences">Table 3-3</a> for a list of all of Python’s<a contenteditable="false" data-primary="\&lt;newline&gt; (ignore end of line)" data-type="indexterm" id="idm44924587825120"/><a contenteditable="false" data-primary="ignore end of line (\&lt;newline&gt;)" data-type="indexterm" id="idm44924587824080"/><a contenteditable="false" data-primary="\\ (backslash escaped)" data-type="indexterm" id="idm44924587823008"/><a contenteditable="false" data-primary="backslash escaped (\\)" data-type="indexterm" id="idm44924587821904"/><a contenteditable="false" data-primary="quotes" data-secondary="single quote escaped (\&quot;)" data-type="indexterm" id="idm44924587820800"/><a contenteditable="false" data-primary="quotes" data-secondary="double quote escaped (\&quot;)" data-type="indexterm" id="idm44924587797712"/><a contenteditable="false" data-primary="\' (single quote escaped)" data-type="indexterm" id="idm44924587796368"/><a contenteditable="false" data-primary="single quote (')" data-secondary="escaped (\')" data-type="indexterm" id="idm44924587795248"/><a contenteditable="false" data-primary="\&quot; (double quote escaped)" data-type="indexterm" id="idm44924587793872"/><a contenteditable="false" data-primary="double quote escaped (\&quot;)" data-type="indexterm" id="idm44924587792752"/><a contenteditable="false" data-primary="\a (bell)" data-type="indexterm" id="idm44924587791632"/><a contenteditable="false" data-primary="\b (backspace)" data-type="indexterm" id="idm44924587790528"/><a contenteditable="false" data-primary="bell (\a)" data-type="indexterm" id="idm44924587789424"/><a contenteditable="false" data-primary="backspace (\b)" data-type="indexterm" id="idm44924587788320"/><a contenteditable="false" data-primary="\f (form feed)" data-type="indexterm" id="idm44924587787216"/><a contenteditable="false" data-primary="form feed (\f)" data-type="indexterm" id="idm44924587786112"/><a contenteditable="false" data-primary="\n (newline)" data-type="indexterm" id="idm44924587785008"/><a contenteditable="false" data-primary="newline (\n)" data-type="indexterm" id="idm44924587783904"/><a contenteditable="false" data-primary="\r (carriage return)" data-type="indexterm" id="idm44924587782800"/><a contenteditable="false" data-primary="carriage return (\r)" data-type="indexterm" id="idm44924587781696"/><a contenteditable="false" data-primary="\t (tab)" data-type="indexterm" id="idm44924587780592"/><a contenteditable="false" data-primary="tab (\t)" data-type="indexterm" id="idm44924587779488"/><a contenteditable="false" data-primary="\v (vertical tab)" data-type="indexterm" id="idm44924587778384"/><a contenteditable="false" data-primary="vertical tab (\v)" data-type="indexterm" id="idm44924587777280"/><a contenteditable="false" data-primary="\DDD (octal value escape sequence in strings)" data-type="indexterm" id="idm44924587776176"/><a contenteditable="false" data-primary="octal value (\DDD escape sequence in strings)" data-type="indexterm" id="idm44924587775104"/><a contenteditable="false" data-primary="hexadecimal literals" data-secondary="escape sequence (\x XX)" data-type="indexterm" id="idm44924587774032"/><a contenteditable="false" data-primary="\x XX (hexadecimal escape sequence)" data-type="indexterm" id="idm44924587772656"/><a contenteditable="false" data-primary="\N{name} (Unicode character)" data-type="indexterm" id="idm44924587771536"/><a contenteditable="false" data-primary="Unicode characters" data-secondary="escaped Unicode character (\{name})" data-type="indexterm" id="idm44924587770416"/> string escape <span class="keep-together">sequences</span>.</p>
<table class="border" id="string_escape_sequences">
<caption><span class="label">Table 3-3. </span>String escape sequences</caption>
<thead>
<tr>
<th>Sequence</th>
<th>Meaning</th>
<th>ASCII / ISO code</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="code">\</span><span class="code"><em>&lt;newline&gt;</em></span></td>
<td>Ignore end of line</td>
<td>None</td>
</tr>
<tr>
<td><span class="code">\\</span></td>
<td>Backslash</td>
<td><span class="code">0x5c</span></td>
</tr>
<tr>
<td><span class="code">\'</span></td>
<td>Single quote</td>
<td><span class="code">0x27</span></td>
</tr>
<tr>
<td><span class="code">\"</span></td>
<td>Double quote</td>
<td><span class="code">0x22</span></td>
</tr>
<tr>
<td><span class="code">\a</span></td>
<td>Bell</td>
<td><span class="code">0x07</span></td>
</tr>
<tr>
<td><span class="code">\b</span></td>
<td>Backspace</td>
<td><span class="code">0x08</span></td>
</tr>
<tr>
<td><span class="code">\f</span></td>
<td>Form feed</td>
<td><span class="code">0x0c</span></td>
</tr>
<tr>
<td><span class="code">\n</span></td>
<td>Newline</td>
<td><span class="code">0x0a</span></td>
</tr>
<tr>
<td><span class="code">\r</span></td>
<td>Carriage return</td>
<td><span class="code">0x0d</span></td>
</tr>
<tr>
<td><span class="code">\t</span></td>
<td>Tab</td>
<td><span class="code">0x09</span></td>
</tr>
<tr>
<td><span class="code">\v</span></td>
<td>Vertical tab</td>
<td><span class="code">0x0b</span></td>
</tr>
<tr>
<td><span class="code">\</span> <span class="code"><em>DDD</em></span></td>
<td>Octal value <span class="code"><em>DDD</em></span></td>
<td>As given</td>
</tr>
<tr>
<td><span class="code">\x</span> <span class="code"><em>XX</em></span></td>
<td>Hexadecimal value <span class="code"><em>XX</em></span></td>
<td>As given</td>
</tr>
<tr>
<td><span class="code">\N{<em>name</em>}</span></td>
<td>Unicode character</td>
<td>As given</td>
</tr>
<tr>
<td><span class="code">\</span> <span class="code"><em>o</em></span></td>
<td>Any other character <span class="code"><em>o</em></span>: a two-character string</td>
<td><span class="code">0x5c</span> + as given</td>
</tr>
</tbody>
</table>
<p>A variant of a string literal is a<a contenteditable="false" data-primary="raw string literals" data-type="indexterm" id="idm44924587720256"/> <em>raw string literal</em>. The syntax is the same as for quoted or triple-quoted string literals, except that an <span class="code">r</span> or <span class="code">R</span> immediately precedes the leading quote. In raw string literals, escape sequences are not interpreted as in <a data-type="xref" href="#string_escape_sequences">Table 3-3</a>, but are literally copied into the string, including backslashes and newline characters. Raw string literal syntax is handy for strings that include many backslashes, especially regular expression patterns (see <a data-type="xref" href="ch10.xhtml#pattern_string_syntax">“Pattern String Syntax”</a>) and Windows absolute filenames (which use backslashes as directory separators). A raw string literal cannot end with an odd number of backslashes: the last one would be taken as escaping the terminating quote.<a contenteditable="false" data-primary="" data-startref="backstringa03" data-type="indexterm" id="idm44924587715024"/><a contenteditable="false" data-primary="" data-startref="slashbackstring03" data-type="indexterm" id="idm44924587713648"/></p>
<div data-type="note" epub:type="note">
<h1>Raw and Triple-Quoted String Literals Are Not Different Types</h1>
<p>Raw and triple-quoted string literals are <em>not</em> types different from other strings; they are just alternative syntaxes for literals of the usual two string types, <span class="code">bytes</span> and <span class="code">str</span>.</p>
</div>
<p>In<a contenteditable="false" data-primary="Unicode characters" data-secondary="in string literals" data-secondary-sortas="string literals" data-type="indexterm" id="idm44924587708448"/><a contenteditable="false" data-primary="\u (four hex digits)" data-type="indexterm" id="idm44924587706384"/><a contenteditable="false" data-primary="\U (eight hex digits)" data-type="indexterm" id="idm44924587705280"/><a contenteditable="false" data-primary="Unicode characters" data-secondary="\U (eight hex digits)" data-type="indexterm" id="idm44924587704176"/><a contenteditable="false" data-primary="Unicode characters" data-secondary="\u (four hex digits)" data-type="indexterm" id="idm44924587702800"/> <span class="code">str</span> literals, you can use <span class="code">\u</span> followed by four hex digits, or <span class="code">\U</span> followed by eight hex digits, to denote Unicode characters; you can also include the escape sequences listed in <a data-type="xref" href="#string_escape_sequences">Table 3-3</a>. <span class="code">str</span> literals can also include Unicode characters using the escape sequence <span class="code">\N{<em>name</em>}</span>, where <span class="code"><em>name</em></span> is a standard <a href="http://www.unicode.org/charts">Unicode name</a>. For example, <span class="code">\N{Copyright Sign}</span> indicates a Unicode copyright sign character (<span class="code">©</span>).</p>
<p><em>Formatted string literals</em> (commonly called <em>f-strings</em>)<a contenteditable="false" data-primary="formatted string literals (f-strings)" data-type="indexterm" id="idm44924587692336"/><a contenteditable="false" data-primary="f-strings (formatted string literals)" data-type="indexterm" id="idm44924587691184"/> let you inject formatted expressions into your string “literals,” which are therefore no longer constant, but rather are subject to evaluation at execution time. The formatting process is described in <a data-type="xref" href="ch09.xhtml#string_formatting">“String Formatting”</a>. From a purely syntactic point of view, these new literals can be regarded as just another kind of string literal.</p>
<p>Multiple string literals of any kind—quoted, triple-quoted, raw, bytes, formatted—can be adjacent, with optional whitespace in between (as long as you do not mix strings containing text and bytes). The compiler concatenates such adjacent string literals into a single string object. Writing a long string literal in this way lets you present it readably across multiple physical lines and gives you an opportunity to insert comments about parts of the string. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">marypop</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">supercali</code><code class="s1">'</code><code>       </code><em><code class="c1"># '(' begins logical line,</code></em><code>
</code><code>           </code><code class="s1">'</code><code class="s1">fragilistic</code><code class="s1">'</code><code>     </code><em><code class="c1"># indentation is ignored</code></em><code>
</code><code>           </code><code class="s1">'</code><code class="s1">expialidocious</code><code class="s1">'</code><code class="p">)</code><code> </code><em><code class="c1"># until closing ')'</code></em></pre>
<p>The string assigned to <span class="code">marypop</span> is a single word of 34 characters.<a contenteditable="false" data-primary="" data-startref="strings03" data-type="indexterm" id="idm44924587661472"/></p>
</div></section>
<section data-pdf-bookmark="bytes objects" data-type="sect3"><div class="sect3" id="bytes_objects">
<h3>bytes objects</h3>
<p>A<a contenteditable="false" data-primary="bytes objects" data-type="indexterm" id="idm44924587658416"/> <span class="code">bytes</span> object is an ordered sequence of <span class="code">int</span>s from <span class="code">0</span> to <span class="code">255</span>. <span class="code">bytes</span> objects are usually encountered when reading data from or writing data to a binary source (e.g, a file, a socket, or a network resource).</p>
<p>A <span class="code">bytes</span> object can be initialized from a list of <span class="code">int</span>s or from a string of characters. A <span class="code">bytes</span> literal has the same syntax as a <span class="code">str</span> literal, prefixed with <span class="code">'b'</span>:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="sa">b</code><code class="s1">'</code><code class="s1">abc</code><code class="s1">'</code><code>
</code><code class="nb">bytes</code><code class="p">(</code><code class="p">[</code><code class="mi">97</code><code class="p">,</code><code> </code><code class="mi">98</code><code class="p">,</code><code> </code><code class="mi">99</code><code class="p">]</code><code class="p">)</code><code>           </code><em><code class="c1"># Same as the previous line</code></em><code>
</code><code class="sa">rb</code><code class="s1">'</code><code class="s1">\</code><code class="s1"> = solidus</code><code class="s1">'</code><code>               </code><em><code class="c1"># A raw bytes literal, containing a '\'</code></em></pre>
<p>To<a contenteditable="false" data-primary="decode method (bytes type)" data-type="indexterm" id="idm44924587613760"/> convert a <span class="code">bytes</span> object to a <span class="code">str</span>, use the <span class="code">bytes.decode</span> method. To convert a <span class="code">str</span> object to a <span class="code">bytes</span> object, use the <span class="code">str.encode</span> method, as described in detail in <a data-type="xref" href="ch09.xhtml#strings_and_things">Chapter 9</a>.</p>
</div></section>
<section data-pdf-bookmark="bytearray objects" data-type="sect3"><div class="sect3" id="bytearray_objects">
<h3>bytearray objects</h3>
<p>A<a contenteditable="false" data-primary="bytearray objects" data-type="indexterm" id="idm44924587605968"/> <span class="code">bytearray</span> is a <em>mutable</em> ordered sequence of <span class="code">int</span>s from <span class="code">0</span> to <span class="code">255</span>; like a <span class="code">bytes</span> object, you can construct it from a sequence of <span class="code">int</span>s or characters. In fact, apart from mutability, it is just like a <span class="code">bytes</span> object. As they are mutable, <span class="code">bytearray</span> objects support methods and operators that modify elements within the array of byte values:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">ba</code><code> </code><code class="o">=</code><code> </code><code class="nb">bytearray</code><code class="p">(</code><code class="p">[</code><code class="mi">97</code><code class="p">,</code><code> </code><code class="mi">98</code><code class="p">,</code><code> </code><code class="mi">99</code><code class="p">]</code><code class="p">)</code><code>  </code><em><code class="c1"># Like bytes, can take a sequence of ints</code></em><code>
</code><code class="n">ba</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">97</code><code>                    </code><em><code class="c1"># Unlike bytes, contents can be modified</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">ba</code><code class="o">.</code><code class="n">decode</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code>            </code><em><code class="c1"># Prints 'aac'</code></em></pre>
<p><a data-type="xref" href="ch09.xhtml#strings_and_things">Chapter 9</a> has additional material on creating and working with <span class="code">bytearray</span> objects.</p>
</div></section>
<section data-pdf-bookmark="Tuples" data-type="sect3"><div class="sect3" id="tuple">
<h3>Tuples</h3>
<p>A<a contenteditable="false" data-primary="data types" data-secondary="tuples" data-type="indexterm" id="idm44924576732384"/><a contenteditable="false" data-primary="tuples" data-type="indexterm" id="idm44924576730976"/> <em>tuple</em> is an immutable ordered sequence of items. The items of a tuple are arbitrary objects and may be of different types. You can use mutable objects (such as lists) as tuple items, but best practice is generally to avoid doing so.</p>
<p>To denote a tuple, use a series of expressions (the items of the tuple) separated<a contenteditable="false" data-primary="comma (,)" data-secondary="in tuples" data-secondary-sortas="tuples" data-type="indexterm" id="idm44924576728656"/><a contenteditable="false" data-primary=", (comma)" data-secondary="in tuples" data-secondary-sortas="tuples" data-type="indexterm" id="idm44924576699728"/> by commas (<span class="code">,</span>);<sup><a data-type="noteref" href="ch03.xhtml#ch01fn24" id="ch01fn24-marker">5</a></sup> if every item is a literal, the whole construct is a <em>tuple literal</em>. You may optionally place a redundant comma after the last item. You can group tuple items within parentheses, but the parentheses are necessary only where the commas would otherwise have another meaning (e.g., in function calls), or to denote empty or nested tuples. A tuple with exactly two items is also known as<a contenteditable="false" data-primary="pairs" data-type="indexterm" id="idm44924576695856"/> a <em>pair</em>. To create a tuple of one item, add a comma to the end of the expression. To denote an empty tuple, use an empty pair of parentheses. Here are some tuple literals, the second of which uses optional parentheses:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="mi">100</code><code class="p">,</code><code> </code><code class="mi">200</code><code class="p">,</code><code> </code><code class="mi">300</code><code>        </code><em><code class="c1"># Tuple with three items</code></em><code>
</code><code class="p">(</code><code class="mf">3.14</code><code class="p">,</code><code class="p">)</code><code>              </code><em><code class="c1"># Tuple with one item, needs trailing comma</code></em><code>
</code><code class="p">(</code><code class="p">)</code><code>                   </code><em><code class="c1"># Empty tuple (parentheses NOT optional)</code></em></pre>
<p>You can also call the built-in type <span class="code">tuple</span> to create a tuple. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="nb">tuple</code><code class="p">(</code><code class="s1">'wow'</code><code class="p">)</code></pre>
<p>This builds a tuple equal to that denoted by the tuple literal:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">(</code><code class="s1">'w'</code><code class="p">,</code> <code class="s1">'o'</code><code class="p">,</code> <code class="s1">'w'</code><code class="p">)</code></pre>
<p><span class="code">tuple()</span> without arguments creates and returns an empty tuple, like <span class="code">()</span>. When <span class="code"><em>x</em></span> is iterable, <span class="code">tuple(<em>x</em>)</span> returns a tuple whose items are the same as those in <span class="code"><em>x</em></span>.</p>
</div></section>
<section data-pdf-bookmark="Lists" data-type="sect3"><div class="sect3" id="list">
<h3>Lists</h3>
<p>A<a contenteditable="false" data-primary="lists" data-secondary="basics of" data-type="indexterm" id="idm44924586884224"/> <em>list</em> is a mutable ordered sequence of items. The items of a list are arbitrary objects and may be of different types. To denote a list, use a series of expressions (the items of the list) separated by<a contenteditable="false" data-primary="brackets ([])" data-secondary="in lists" data-secondary-sortas="lists" data-type="indexterm" id="idm44924586882240"/><a contenteditable="false" data-primary="[] (brackets)" data-primary-sortas="|[] brackets" data-secondary="in lists" data-secondary-sortas="lists" data-type="indexterm" id="idm44924586880592"/><a contenteditable="false" data-primary="comma (,)" data-secondary="in lists" data-secondary-sortas="lists" data-type="indexterm" id="idm44924586878672"/><a contenteditable="false" data-primary=", (comma)" data-secondary="in lists" data-secondary-sortas="lists" data-type="indexterm" id="idm44924586860528"/> commas (<span class="code">,</span>), within brackets (<span class="code">[]</span>);<sup><a data-type="noteref" href="ch03.xhtml#ch01fn25" id="ch01fn25-marker">6</a></sup> if every item is a literal, the whole construct is a <em>list literal</em>. You may optionally place a redundant comma after the last item. To denote an empty list, use an empty pair of brackets. Here are some examples of list literals:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">[</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="mf">3.14</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">hello</code><code class="s1">'</code><code class="p">]</code><code>  </code><em><code class="c1"># List with three items</code></em><code>
</code><code class="p">[</code><code class="mi">100</code><code class="p">]</code><code>                </code><em><code class="c1"># List with one item</code></em><code>
</code><code class="p">[</code><code class="p">]</code><code>                   </code><em><code class="c1"># Empty list</code></em></pre>
<p>You can also call the built-in type <span class="code">list</span> to create a list. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="nb">list</code><code class="p">(</code><code class="s1">'wow'</code><code class="p">)</code></pre>
<p>This builds a list equal to that denoted by the list literal:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">[</code><code class="s1">'w'</code><code class="p">,</code> <code class="s1">'o'</code><code class="p">,</code> <code class="s1">'w'</code><code class="p">]</code></pre>
<p><span class="code">list()</span> without arguments creates and returns an empty list, like <span class="code">[]</span>. When <span class="code"><em>x</em></span> is iterable, <span class="code">list(<em>x</em>)</span> returns a list whose items are the same as those in <span class="code"><em>x</em></span>.</p>
<p>You can also build lists with list comprehensions, covered in <a data-type="xref" href="#list_comprehensions">“List comprehensions”</a>.<a contenteditable="false" data-primary="" data-startref="seq03" data-type="indexterm" id="idm44924586771968"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Sets" data-type="sect2"><div class="sect2" id="sets">
<h2>Sets</h2>
<p>Python<a contenteditable="false" data-primary="data types" data-secondary="sets" data-type="indexterm" id="idm44924586768752"/><a contenteditable="false" data-primary="sets" data-type="indexterm" id="idm44924586766960"/> has two built-in set types, <span class="code">set</span> and <span class="code">frozenset</span>, to represent arbitrarily ordered collections of unique items. Items in a set may be of different types, but they must all be<a contenteditable="false" data-primary="hashing" data-secondary="hashable items (sets)" data-type="indexterm" id="idm44924586747856"/> <em>hashable</em> (see <span class="code">hash</span> in <a data-type="xref" href="ch08.xhtml#pythonapostrophes_core_built_in_functio">Table 8-2</a>). Instances of type <span class="code">set</span> are mutable, and thus not hashable; instances of type <span class="code">frozenset</span> are immutable and hashable. You can’t have a set whose items are sets, but you can have a set (or frozenset) whose items are<a contenteditable="false" data-primary="frozensets" data-type="indexterm" id="idm44924586742848"/><a contenteditable="false" data-primary="data types" data-secondary="frozensets" data-type="indexterm" id="idm44924586741744"/> frozensets. Sets and frozensets are <em>not</em> ordered.</p>
<p>To create a set, you can call the built-in type <span class="code">set</span> with no argument (this means an empty set) or one argument that is iterable (this means a set whose items are those of the iterable). You can similarly build a frozenset by calling <span class="code">frozenset</span>.</p>
<p>Alternatively, to denote a (nonfrozen, nonempty) set, use a series of expressions (the items of the set) separated by commas (<span class="code">,</span>) within<a contenteditable="false" data-primary="{} (braces)" data-secondary="in sets" data-secondary-sortas="sets" data-type="indexterm" id="idm44924586736960"/><a contenteditable="false" data-primary="braces ({})" data-secondary="in sets" data-secondary-sortas="sets" data-type="indexterm" id="idm44924586735280"/> braces (<span class="code">{}</span>);<sup><a data-type="noteref" href="ch03.xhtml#ch01fn26" id="ch01fn26-marker">7</a></sup> if every item is a literal, the whole assembly is a <em>set literal</em>. You may optionally place a redundant comma after the last item. Here are some example sets (two literals, one not):</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">{</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="mf">3.14</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">hello</code><code class="s1">'</code><code class="p">}</code><code>  </code><em><code class="c1"># Literal for a set with three items</code></em><code>
</code><code class="p">{</code><code class="mi">100</code><code class="p">}</code><code>                </code><em><code class="c1"># Literal for a set with one item</code></em><code>
</code><code class="nb">set</code><code class="p">(</code><code class="p">)</code><code>                </code><em><code class="c1"># Empty set - no literal for empty set</code></em><code>
</code><code>                     </code><em><code class="c1"># {} is an empty dict!</code></em></pre>
<p>You can also build nonfrozen sets with set comprehensions, as discussed in <a data-type="xref" href="#set_comprehensions">“Set comprehensions”</a>.</p>
<p>Note that two sets or frozensets (or a set and a frozenset) may compare as equal, but since they are unordered, iterating over them can return their contents in differing order.</p>
</div></section>
<section data-pdf-bookmark="Dictionaries" data-type="sect2"><div class="sect2" id="dictionaries">
<h2>Dictionaries</h2>
<p>A<a contenteditable="false" data-primary="data types" data-secondary="dictionaries" data-type="indexterm" id="idm44924586693456"/><a contenteditable="false" data-primary="dictionaries" data-type="indexterm" id="dict03"/> <em>mapping</em> is<a contenteditable="false" data-primary="mappings" data-secondary="in dictionaries" data-type="indexterm" id="idm44924586725456"/><a contenteditable="false" data-primary="keys" data-type="indexterm" id="idm44924586724048"/> an arbitrary collection of objects indexed by nearly<sup><a data-type="noteref" href="ch03.xhtml#ch01fn27" id="ch01fn27-marker">8</a></sup> arbitrary values called <em>keys</em>. Mappings are mutable and, like sets but unlike sequences, are <em>not</em> (necessarily) ordered.</p>
<p>Python provides a single built-in mapping type: the dictionary type <span class="code">dict</span>. Library and extension modules provide other mapping types, and you can write others yourself (as discussed in <a data-type="xref" href="ch04.xhtml#mappings">“Mappings”</a>). Keys in a dictionary may be of different types, but they must be<a contenteditable="false" data-primary="hashing" data-secondary="hashable keys" data-type="indexterm" id="idm44924589019456"/> <em>hashable</em> (see <span class="code">hash</span> in <a data-type="xref" href="ch08.xhtml#pythonapostrophes_core_built_in_functio">Table 8-2</a>). Values in a dictionary are arbitrary objects and may be of any type. An item in a dictionary is a key/value pair. You can think of a dictionary as an associative array (known in some other languages as a “map,” “hash table,” or “hash”).</p>
<p>To denote a dictionary, you can use a series of<a contenteditable="false" data-primary="colon (:)" data-type="indexterm" id="idm44924589015568"/><a contenteditable="false" data-primary=": (colon)" data-type="indexterm" id="idm44924589014080"/><a contenteditable="false" data-primary="comma (,)" data-secondary="in dictionaries" data-secondary-sortas="dictionaries" data-type="indexterm" id="idm44924589012976"/><a contenteditable="false" data-primary=", (comma)" data-secondary="in dictionaries" data-secondary-sortas="dictionaries" data-type="indexterm" id="idm44924589011328"/><a contenteditable="false" data-primary="braces ({})" data-secondary="in dictionaries" data-secondary-sortas="dictionaries" data-type="indexterm" id="idm44924589009680"/><a contenteditable="false" data-primary="{} (braces)" data-secondary="in dictionaries" data-secondary-sortas="dictionaries" data-type="indexterm" id="idm44924589008032"/> colon-separated pairs of expressions (the pairs are the items of the dictionary) separated by commas (<span class="code">,</span>) within braces (<span class="code">{}</span>);<sup><a data-type="noteref" href="ch03.xhtml#ch01fn28" id="ch01fn28-marker">9</a></sup> if every expression is a literal, the whole construct is a <em>dictionary literal</em>. You may optionally place a redundant comma after the last item. Each item in a dictionary is written<a contenteditable="false" data-primary="key value pairs" data-type="indexterm" id="idm44924589003152"/> as <span class="code"><em>key</em></span><span class="code">:</span><span class="code"><em>value</em></span>, where <span class="code"><em>key</em></span> is an expression giving the item’s key and <span class="code"><em>value</em></span> is an expression giving the item’s value. If a key’s value appears more than once in a dictionary expression, only an arbitrary one of the items with that key is kept in the resulting dictionary object—dictionaries do not support duplicate keys. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">{</code><code class="mi">1</code><code class="p">:</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">:</code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">:</code><code class="mi">5</code><code class="p">}</code><code>  </code><em><code class="c1"># The value of this dictionary is {1:5, 3:4}</code></em></pre>
<p>To denote an empty dictionary, use an empty pair of braces.</p>
<p>Here are some dictionary literals:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">{</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">:</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">y</code><code class="s1">'</code><code class="p">:</code><code class="mf">3.14</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">z</code><code class="s1">'</code><code class="p">:</code><code class="mi">7</code><code class="p">}</code><code>    </code><em><code class="c1"># Dictionary with three items, str keys</code></em><code>
</code><code class="p">{</code><code class="mi">1</code><code class="p">:</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">:</code><code class="mi">4</code><code class="p">}</code><code>                   </code><em><code class="c1"># Dictionary with two items, int keys</code></em><code>
</code><code class="p">{</code><code class="mi">1</code><code class="p">:</code><code class="s1">'</code><code class="s1">za</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">br</code><code class="s1">'</code><code class="p">:</code><code class="mi">23</code><code class="p">}</code><code>            </code><em><code class="c1"># Dictionary with different key types</code></em><code>
</code><code class="p">{</code><code class="p">}</code><code>                           </code><em><code class="c1"># Empty dictionary</code></em></pre>
<p>You can also call the built-in type <span class="code">dict</span> to create a dictionary in a way that, while less concise, can sometimes be more readable. For example, the <span class="code">dict</span>s in the preceding snippet can also be written as:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="nb">dict</code><code class="p">(</code><code class="n">x</code><code class="o">=</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="n">y</code><code class="o">=</code><code class="mf">3.14</code><code class="p">,</code><code> </code><code class="n">z</code><code class="o">=</code><code class="mi">7</code><code class="p">)</code><code>      </code><em><code class="c1"># Dictionary with three items, str keys</code></em><code>
</code><code class="nb">dict</code><code class="p">(</code><code class="p">[</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">)</code><code class="p">]</code><code class="p">)</code><code>       </code><em><code class="c1"># Dictionary with two items, int keys</code></em><code>
</code><code class="nb">dict</code><code class="p">(</code><code class="p">[</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="s1">'</code><code class="s1">za</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">br</code><code class="s1">'</code><code class="p">,</code><code class="mi">23</code><code class="p">)</code><code class="p">]</code><code class="p">)</code><code>  </code><em><code class="c1"># Dictionary with different key types</code></em><code>
</code><code class="nb">dict</code><code class="p">(</code><code class="p">)</code><code>                       </code><em><code class="c1"># Empty dictionary</code></em></pre>
<p><span class="code">dict()</span> without arguments creates and returns an empty dictionary, like <span class="code">{}</span>. When the argument <span class="code"><em>x</em></span> to <span class="code">dict</span> is a mapping, <span class="code">dict</span> returns a new dictionary object with the same keys and values as <span class="code"><em>x</em></span>. When <span class="code"><em>x</em></span> is iterable, the items in <span class="code"><em>x</em></span> must be pairs, and <span class="code">dict(<em>x</em>)</span> returns a dictionary whose items (key/value pairs) are the same as the items in <span class="code"><em>x</em></span>. If a key value appears more than once in <span class="code"><em>x</em></span>, only the <em>last</em> item from <span class="code"><em>x</em></span> with that key value is kept in the resulting dictionary.</p>
<p>When you call <span class="code">dict</span> in addition to or instead of the positional argument <span class="code"><em>x</em></span>, you may pass<a contenteditable="false" data-primary="named arguments" data-type="indexterm" id="idm44924588783120"/> <em>named arguments</em>, each with the syntax <span class="code"><em>name=value</em></span>, where <span class="code"><em>name</em></span> is an identifier to use as an item’s key and <span class="code"><em>value</em></span> is an expression giving the item’s value. When you call <span class="code">dict</span> and pass both a positional argument and one or more named arguments, if a key appears both in the positional argument and as a named argument, Python associates to that key the named argument’s value (i.e., the named argument “wins”).</p>
<p>You<a contenteditable="false" data-primary="** (double star) operator" data-secondary="dict unpacking" data-type="indexterm" id="idm44924588777952"/><a contenteditable="false" data-primary="double star (**) operator" data-secondary="dict unpacking" data-type="indexterm" id="idm44924588776576"/> can unpack a dict’s contents into another dict using the <span class="code">**</span> operator.</p>
<pre data-code-language="python" data-type="program-listing">
<code class="n">d1</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'a'</code><code class="p">:</code><code class="mi">1</code><code class="p">,</code> <code class="s1">'x'</code><code class="p">:</code> <code class="mi">0</code><code class="p">}</code>
<code class="n">d2</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'c'</code><code class="p">:</code> <code class="mi">2</code><code class="p">,</code> <code class="s1">'x'</code><code class="p">:</code> <code class="mi">5</code><code class="p">}</code>
<code class="n">d3</code> <code class="o">=</code> <code class="p">{</code><code class="o">**</code><code class="n">d1</code><code class="p">,</code> <code class="o">**</code><code class="n">d2</code><code class="p">}</code>  <code class="c1"># result is {'a':1, 'x': 5, 'c': 2}</code></pre>
<p><span class="version">3.9+</span> As of Python 3.9, this same operation can be performed using<a contenteditable="false" data-primary="| (vertical bar)" data-type="indexterm" id="idm44924588752624"/><a contenteditable="false" data-primary="vertical bar (|)" data-type="indexterm" id="idm44924588751648"/> the | operator.</p>
<pre data-code-language="python" data-type="program-listing">
<code class="n">d4</code> <code class="o">=</code> <code class="n">d1</code> <code class="o">|</code> <code class="n">d2</code>  <code class="c1"># same result as d3</code></pre>
<p>You can also create a dictionary by calling <span class="code">dict.fromkeys</span>. The first argument is an iterable whose items become the keys of the dictionary; the second argument is the value that corresponds to each and every key (all keys initially map to the same value). If you omit the second argument, it defaults to <span class="code"><strong>None</strong></span>. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="nb">dict</code><code class="o">.</code><code class="n">fromkeys</code><code class="p">(</code><code class="s1">'</code><code class="s1">hello</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">)</code><code>    </code><em><code class="c1"># Same as {'h':2, 'e':2, 'l':2, 'o':2}</code></em><code>
</code><code class="nb">dict</code><code class="o">.</code><code class="n">fromkeys</code><code class="p">(</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">]</code><code class="p">)</code><code>     </code><em><code class="c1"># Same as {1:</code></em><em><code class="c1">None</code></em><em><code class="c1">, 2:</code></em><em><code class="c1">None</code></em><em><code class="c1">, 3:</code></em><em><code class="c1">None</code></em><em><code class="c1">}</code></em></pre>
<p>You can also build a <span class="code">dict</span> using a dictionary comprehension, as discussed in <a data-type="xref" href="#dictionary_comprehensions">“Dictionary comprehensions”</a>.</p>
<p>When comparing two <span class="code">dict</span>s for equality, they will evaluate as equal if they have the same keys and corresponding values, even if the keys are not in the same order.<a contenteditable="false" data-primary="" data-startref="dict03" data-type="indexterm" id="idm44924589356176"/></p>
</div></section>
<section data-pdf-bookmark="None" data-type="sect2"><div class="sect2" id="none">
<h2>None</h2>
<p>The<a contenteditable="false" data-primary="data types" data-secondary="None" data-type="indexterm" id="idm44924589353280"/><a contenteditable="false" data-primary="None" data-type="indexterm" id="idm44924589351872"/><a contenteditable="false" data-primary="null objects (none)" data-type="indexterm" id="idm44924589350768"/><a contenteditable="false" data-primary="objects" data-secondary="null objects" data-type="indexterm" id="idm44924589321968"/> built-in <span class="code"><strong>None</strong></span> denotes a null object. <span class="code"><strong>None</strong></span> has no methods or other attributes. You can use <span class="code"><strong>None</strong></span> as a placeholder when you need a reference but you don’t care what object you refer to, or when you need to indicate that no object is there. Functions return <span class="code"><strong>None</strong></span> as their result unless they have specific <span class="code"><strong>return</strong></span> statements coded to return other values. <span class="code"><strong>None</strong></span> is hashable and can be used as a <span class="code">dict</span> key.</p>
</div></section>
<section data-pdf-bookmark="Ellipsis (...)" data-type="sect2"><div class="sect2" id="ellipsis_left_parenthesisdotdotdotright">
<h2>Ellipsis (...)</h2>
<p>The<a contenteditable="false" data-primary="data types" data-secondary="Ellipsis (…)" data-type="indexterm" id="idm44924589312992"/><a contenteditable="false" data-primary="ellipsis (...)" data-type="indexterm" id="idm44924589311200"/><a contenteditable="false" data-primary="... (ellipsis)" data-type="indexterm" id="idm44924589310096"/> <span class="code">Ellipsis</span>, written as three periods with no intervening spaces, <span class="code">...</span>, is a special object in Python used in numerical applications,<sup><a data-type="noteref" href="ch03.xhtml#ch01fn29" id="ch01fn29-marker">10</a></sup> or as an alternative to <span class="code"><strong>None</strong></span> when <span class="code"><strong>None</strong></span> is a valid entry. For instance, to initialize a <span class="code">dict</span> that may take <span class="code"><strong>None</strong></span> as a legitimate value, you can initialize it with <span class="code">...</span> as an indicator of “no value supplied, not even <span class="code"><strong>None</strong></span>.” <span class="code">Ellipsis</span> is hashable and so can be used as a <span class="code">dict</span> key:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">tally</code><code> </code><code class="o">=</code><code> </code><code class="nb">dict</code><code class="o">.</code><code class="n">fromkeys</code><code class="p">(</code><code class="p">[</code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">B</code><code class="s1">'</code><code class="p">,</code><code> </code><strong><code class="kc">None</code></strong><code class="p">,</code><code> </code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code class="p">]</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code></pre>
</div></section>
<section data-pdf-bookmark="Callables" data-type="sect2"><div class="sect2" id="callables">
<h2>Callables</h2>
<p>In<a contenteditable="false" data-primary="data types" data-secondary="callables" data-type="indexterm" id="idm44924589274544"/><a contenteditable="false" data-primary="callables" data-type="indexterm" id="idm44924589273136"/> Python, callable types are those whose instances support the function call operation (see <a data-type="xref" href="#calling_functions">“Calling Functions”</a>). Functions are callable. Python provides numerous built-in functions (see <a data-type="xref" href="ch08.xhtml#built_in_functions">“Built-in Functions”</a>) and supports user-defined functions (see <a data-type="xref" href="#defining_functions_the_def_statement">“Defining Functions: The def Statement”</a>). Generators are also callable (see <a data-type="xref" href="#generators">“Generators”</a>).</p>
<p>Types are callable too, as we saw for the <span class="code">dict</span>, <span class="code">list</span>, <span class="code">set</span>, and <span class="code">tuple</span> built-in types. (See <a data-type="xref" href="ch08.xhtml#built_in_types">“Built-in Types”</a> for a complete list of built-in types.) As we discuss in <a data-type="xref" href="ch04.xhtml#python_classes">“Python Classes”</a>, <span class="code"><strong>class</strong></span> objects (user-defined types) are also callable. Calling a type usually creates and returns a new instance of that type.</p>
<p>Other callables include<a contenteditable="false" data-primary="methods" data-secondary="special methods" data-type="indexterm" id="idm44924589236752"/> <em>methods</em>, which are functions bound as class attributes, and instances of classes that supply a special method named <span class="code">__call__</span>.</p>
</div></section>
<section data-pdf-bookmark="Boolean Values" data-type="sect2"><div class="sect2" id="boolean_values">
<h2>Boolean Values</h2>
<p>Any<sup><a data-type="noteref" href="ch03.xhtml#ch01fn30" id="ch01fn30-marker">11</a></sup> data<a contenteditable="false" data-primary="data types" data-secondary="Boolean values" data-type="indexterm" id="idm44924589229328"/><a contenteditable="false" data-primary="Boolean values" data-type="indexterm" id="idm44924589227920"/> value in Python can be used as a truth value: true or false. Any nonzero number or nonempty container (e.g., string, tuple, list, set, or dictionary) is true. Zero (<span class="code">0</span>, of any numeric type), <span class="code"><strong>None</strong></span>, and empty containers are false. You may see the terms<a contenteditable="false" data-primary="truthy" data-type="indexterm" id="idm44924589225152"/><a contenteditable="false" data-primary="falsy" data-secondary="definition of term" data-type="indexterm" id="idm44924589224080"/> “truthy” and “falsy” used to indicate values that evaluate as either true or false.</p>
<div data-type="warning" epub:type="warning">
<h1>Beware Using a Float as a Truth Value</h1>
<p>Be careful about using a floating-point number as a truth value: that’s like comparing the number for exact equality with zero, and floating-point numbers should almost never be compared for exact equality.</p>
</div>
<p>The<a contenteditable="false" data-primary="bool (built-in type)" data-type="indexterm" id="idm44924589220496"/> built-in type <span class="code">bool</span> is a subclass of <span class="code">int</span>. The only two values of type <span class="code">bool</span> are <span class="code"><strong>True</strong></span><a contenteditable="false" data-primary="True" data-type="indexterm" id="idm44924589216000"/> and <span class="code"><strong>False</strong></span>, which have string representations of <span class="code"><strong>'True'</strong></span> and <span class="code"><strong>'False'</strong></span>, but also numerical values of <span class="code">1</span> and <span class="code">0</span>, respectively. Several built-in functions return <span class="code">bool</span> results, as do comparison operators.</p>
<p>You can call <span class="code">bool(<em>x</em>)</span> with any<sup><a data-type="noteref" href="ch03.xhtml#ch01fn31" id="ch01fn31-marker">12</a></sup> <span class="code"><em>x</em></span> as the argument. The result is <span class="code"><strong>True</strong></span> when <span class="code"><em>x</em></span> is true and <span class="code"><strong>False</strong></span> when <span class="code"><em>x</em></span> is false. Good Python style is not to use such calls when they are redundant, as they most often are: <em>always</em> write <span class="code"><strong>if</strong></span> <span class="code"><em>x</em></span><span class="code">:</span>, <em>never</em> any of <span class="code"><strong>if</strong></span> <span class="code">bool(<em>x</em>):</span>, <span class="code"><strong>if</strong></span> <span class="code"><em>x</em></span> <span class="code"><strong>is</strong></span> <span class="code"><strong>True</strong></span><span class="code">:</span>, <span class="code"><strong>if</strong></span> <span class="code"><em>x</em></span> <span class="code">==</span> <span class="code"><strong>True</strong></span><span class="code">:</span>, or <span class="code"><strong>if</strong></span> <span class="code">bool(<em>x</em>) ==</span> <span class="code"><strong>True</strong></span><span class="code">:</span>. However, you <em>can</em> use <span class="code">bool(<em>x</em>)</span> to count the number of true items in a sequence. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">count_trues</code><code class="p">(</code><em><code class="n">seq</code></em><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="nb">sum</code><code class="p">(</code><code class="nb">bool</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">seq</code><code class="p">)</code></pre>
<p>In this example, the <span class="code">bool</span> call ensures each item of <span class="code"><em>seq</em></span> is counted as <span class="code">0</span> (if false) or <span class="code">1</span> (if true), so <span class="code">count_trues</span> is more general than <span class="code">sum(<em>seq</em>)</span> would be.</p>
<p>When<a contenteditable="false" data-primary="expression is true/false" data-type="indexterm" id="idm44924589157696"/> we say “<span class="code"><em>expression</em></span> is true” we mean that <span class="code">bool(<em>expression</em>)</span> would return <span class="code"><strong>True</strong></span>. As we mentioned, this is also known as “<span class="code"><em>expression</em></span> being <em>truthy”</em> (the other possibility is that “<span class="code"><em>expression</em></span> is <em>falsy”</em>).<a contenteditable="false" data-primary="" data-startref="dtypes03" data-type="indexterm" id="idm44924589127952"/><a contenteditable="false" data-primary="" data-startref="dtypes03" data-type="indexterm" id="idm44924589126544"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Variables and Other References" data-type="sect1"><div class="sect1" id="variables_and_other_references">
<h1>Variables and Other References</h1>
<p>A Python program accesses data values through<a contenteditable="false" data-primary="references" data-secondary="definition of term" data-type="indexterm" id="idm44924589123552"/> <em>references</em>. A reference is a “name” that refers to a value (object). References take the form of variables, attributes, and items. In Python, a variable or other reference has no intrinsic type. The object to which a reference is bound at a given time always has a type, but a given reference may be bound to objects of various types in the course of the program’s execution.</p>
<section data-pdf-bookmark="Variables" data-type="sect2"><div class="sect2" id="variables">
<h2>Variables</h2>
<p>In<a contenteditable="false" data-primary="variables and other references" data-secondary="variables" data-type="indexterm" id="idm44924589119408"/> Python, there are no “declarations.” The existence of a variable begins with a statement that<a contenteditable="false" data-primary="binding" data-secondary="variables" data-type="indexterm" id="binding03"/> <em>binds</em> the variable (in other words, sets a name to hold a reference to some object). You can also<a contenteditable="false" data-primary="unbinding" data-type="indexterm" id="idm44924589115456"/> <em>unbind</em> a variable, resetting the name so it no longer holds a reference. Assignment statements are the usual way to bind variables and other references. The <span class="code"><strong>del</strong></span> statement unbinds a variable reference, although doing so is rare.</p>
<p>Binding a reference that was already bound is also known as<a contenteditable="false" data-primary="rebinding" data-type="indexterm" id="idm44924589112512"/> <em>rebinding</em> it. Whenever we mention binding, we implicitly include rebinding (except where we explicitly exclude it). Rebinding or unbinding a reference has no effect on the object to which the reference was bound, except that an object goes away when nothing refers to it. The cleanup of objects with no references is known as<a contenteditable="false" data-primary="garbage collection" data-type="indexterm" id="idm44924589110832"/> <em>garbage collection</em>.</p>
<p>You can name a variable with any identifier except the 30-plus that are reserved as Python’s keywords (see <a data-type="xref" href="#keywords">“Keywords”</a>). A variable can be global or local. A<a contenteditable="false" data-primary="global variables" data-type="indexterm" id="idm44924595564544"/> <em>global variable</em> is an attribute of a module object (see <a data-type="xref" href="ch07.xhtml#modules_and_packages">Chapter 7</a>). A<a contenteditable="false" data-primary="local variables" data-type="indexterm" id="idm44924595561904"/> <em>local variable</em> lives in a function’s local namespace (see <a data-type="xref" href="#namespaces">“Namespaces”</a>).</p>
<section data-pdf-bookmark="Object attributes and items" data-type="sect3"><div class="sect3" id="object_attributes_and_items">
<h3>Object attributes and items</h3>
<p>The<a contenteditable="false" data-primary="objects" data-secondary="attributes of" data-type="indexterm" id="idm44924595557168"/> main distinction between the attributes and items of an object is in the syntax you use to access them. To denote an<a contenteditable="false" data-primary="attributes" data-secondary="denoting" data-type="indexterm" id="idm44924595555504"/> <em>attribute</em> of an object, use a reference to the object, followed by a<a contenteditable="false" data-primary=". (period)" data-secondary="object attributes" data-type="indexterm" id="idm44924595553552"/><a contenteditable="false" data-primary="period (.)" data-secondary="object attributes" data-type="indexterm" id="idm44924595552176"/> period (<span class="code">.</span>), followed by an identifier known as the <em>attribute name</em>. For example, <span class="code"><em>x.y</em></span> refers to one of the attributes of the object bound to name <span class="code"><em>x</em></span>; specifically, that attribute whose name is <span class="code">'<em>y</em>'</span>.</p>
<p>To denote an<a contenteditable="false" data-primary="objects" data-secondary="items of" data-type="indexterm" id="idm44924595545744"/><a contenteditable="false" data-primary="items" data-type="indexterm" id="idm44924595544336"/> <em>item</em> of an object, use a reference to the object, followed by an expression within brackets []. The expression in brackets is known as the item’s<a contenteditable="false" data-primary="indexing" data-secondary="index" data-type="indexterm" id="idm44924595542496"/><a contenteditable="false" data-primary="keys" data-type="indexterm" id="idm44924595541120"/> <em>index</em> or <em>key</em>, and the object is known as the item’s<a contenteditable="false" data-primary="containers" data-secondary="object attributes and" data-type="indexterm" id="idm44924595538992"/> <em>container</em>. For example, <span class="code"><em>x</em></span><span class="code">[<em>y</em>]</span> refers to the item at the key or index bound to name <span class="code"><em>y</em></span>, within the container object bound to name <span class="code"><em>x</em></span>.</p>
<p>Attributes that are callable are also known as<a contenteditable="false" data-primary="methods" data-secondary="definition of term" data-type="indexterm" id="idm44924595533200"/> <em>methods</em>. Python draws no strong distinctions between callable and noncallable attributes, as some other languages do. All general rules about attributes also apply to<a contenteditable="false" data-primary="callable attributes" data-type="indexterm" id="idm44924595531248"/> callable attributes (methods).</p>
</div></section>
<section data-pdf-bookmark="Accessing nonexistent references" data-type="sect3"><div class="sect3" id="accessing_nonexistent_references">
<h3>Accessing nonexistent references</h3>
<p>A<a contenteditable="false" data-primary="references" data-secondary="accessing nonexistent" data-type="indexterm" id="idm44924595527904"/> common programming error is to access a reference that does not exist. For example, a variable may be unbound, or an attribute name or item index may not be valid for the object to which you apply it. The<a contenteditable="false" data-primary="errors" data-secondary="diagnosing" data-type="indexterm" id="idm44924595526368"/> Python compiler, when it analyzes and compiles source code, diagnoses only<a contenteditable="false" data-primary="syntax errors" data-type="indexterm" id="idm44924595524864"/> syntax errors. Compilation does not diagnose<a contenteditable="false" data-primary="semantic errors" data-type="indexterm" id="idm44924595523568"/> semantic errors, such as trying to access an unbound attribute, item, or variable. Python diagnoses semantic errors only when the<a contenteditable="false" data-primary="runtime errors" data-type="indexterm" id="idm44924595522336"/> errant code executes—that is, <em>at runtime</em>. When an operation is a Python semantic error, attempting it raises an exception (see <a data-type="xref" href="ch06.xhtml#exceptions">Chapter 6</a>). Accessing a nonexistent variable, attribute, or item—just like any other semantic error—raises an exception.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Assignment Statements" data-type="sect2"><div class="sect2" id="assignment_statements">
<h2>Assignment Statements</h2>
<p>Assignment statements<a contenteditable="false" data-primary="variables and other references" data-secondary="assignment statement" data-type="indexterm" id="idm44924595517632"/><a contenteditable="false" data-primary="assignment statements" data-type="indexterm" id="assstate03"/> can be plain or augmented. Plain assignment to a variable (e.g., <span class="code"><em>name = value</em></span>) is how you create a new variable or rebind an existing variable to a new value. Plain assignment to an object attribute (e.g., <span class="code"><em>x.attr</em></span> <span class="code">=</span> <span class="code"><em>value</em></span>) is a request to object <span class="code"><em>x</em></span> to create or rebind the attribute named <span class="code">'<em>attr</em>'</span>. Plain assignment to an item in a container (e.g., <span class="code"><em>x</em></span><span class="code">[<em>k</em>]</span> <span class="code"><em>= value</em></span>) is a request to container <span class="code"><em>x</em></span> to create or rebind the item with index or key <span class="code"><em>k</em></span>.</p>
<p>Augmented assignment<a contenteditable="false" data-primary="references" data-secondary="creating new" data-type="indexterm" id="idm44924595504624"/> (e.g., <span class="code"><em>name</em></span> <span class="code">+=</span> <span class="code"><em>value</em></span>) cannot, per se, create new references. Augmented assignment can rebind a variable, ask an object to rebind one of its existing attributes or items, or request the target object to modify itself. When you make any kind of request to an object, it is up to the object to decide whether and how to honor the request, and whether to raise an exception.</p>
<section data-pdf-bookmark="Plain assignment" data-type="sect3"><div class="sect3" id="plain_assignment">
<h3>Plain assignment</h3>
<p>A<a contenteditable="false" data-primary="plain assignment statements" data-type="indexterm" id="idm44924595498176"/> plain assignment statement in the simplest form has the syntax:</p>
<pre data-type="programlisting">
<em>target</em> = <em>expression</em></pre>
<p>The<a contenteditable="false" data-primary="targets" data-type="indexterm" id="idm44924595494912"/> target is known as the<a contenteditable="false" data-primary="lefthand side (LHS)" data-type="indexterm" id="idm44924595493648"/><a contenteditable="false" data-primary="LHS (lefthand side)" data-type="indexterm" id="idm44924595492512"/> lefthand side (LHS), and the expression<a contenteditable="false" data-primary="RHS (righthand side)" data-type="indexterm" id="idm44924595491216"/><a contenteditable="false" data-primary="righthand side (RHS)" data-type="indexterm" id="idm44924595490112"/> is the righthand side (RHS). When the assignment executes, Python evaluates the RHS expression, then binds the expression’s value to the LHS target. The binding never depends on the type of the value. In particular, Python draws no strong distinction between callable and noncallable objects, as some other languages do, so you can bind functions, methods, types, and other callables to variables, just as you can numbers, strings, lists, and so on. This is part of functions and other callables<a contenteditable="false" data-primary="first-class objects" data-type="indexterm" id="idm44924595488880"/><a contenteditable="false" data-primary="objects" data-secondary="first-class objects" data-type="indexterm" id="idm44924595487776"/> being <em>first-class objects</em>.</p>
<p>Details of the binding do depend on the kind of target. The target in an assignment may be an identifier, an attribute reference, an indexing, or a slicing, where:</p>
<dl>
<dt>An identifier</dt>
<dd>Is<a contenteditable="false" data-primary="identifiers" data-type="indexterm" id="idm44924595483968"/> a variable name. Assigning to an identifier binds the variable with this name.</dd>
<dt>An attribute reference</dt>
<dd>Has<a contenteditable="false" data-primary="attributes" data-secondary="attribute references" data-type="indexterm" id="idm44924595481616"/> the syntax <span class="code"><em>obj.name</em></span>. <span class="code"><em>obj</em></span> is an arbitrary expression, and <span class="code"><em>name</em></span> is an identifier, known as an <em>attribute name</em> of the object. Assigning to an attribute reference asks the object <span class="code"><em>obj</em></span> to bind its attribute named <span class="code">'<em>name</em>'</span>.</dd>
<dt>An indexing</dt>
<dd>Has<a contenteditable="false" data-primary="indexing" data-secondary="in plain assignment" data-secondary-sortas="plain assignment" data-type="indexterm" id="idm44924595474160"/> the syntax <span class="code"><em>obj</em></span><span class="code">[<em>expr</em>]</span>. <span class="code"><em>obj</em></span> and <span class="code"><em>expr</em></span> are arbitrary expressions. Assigning to an indexing asks the container <span class="code"><em>obj</em></span> to bind its item indicated by the value of <span class="code"><em>expr</em></span>, also known as the index or key of the item in the container (an <em>indexing</em> is an index <em>applied to</em> a<a contenteditable="false" data-primary="containers" data-secondary="indexing and" data-type="indexterm" id="idm44924595466160"/> container).</dd>
<dt>A slicing</dt>
<dd>Has<a contenteditable="false" data-primary="slicing" data-secondary="plain assignment and" data-type="indexterm" id="idm44924595463856"/> the syntax <span class="code"><em>obj</em></span><span class="code">[<em>start</em>:<em>stop</em>]</span> or <span class="code"><em>obj</em></span><span class="code">[<em>start</em>:<em>stop</em>:<em>stride</em>]</span>. <span class="code"><em>obj</em></span>, <span class="code"><em>start</em></span>, <span class="code"><em>stop</em></span>, and <span class="code"><em>stride</em></span> are arbitrary expressions. <span class="code"><em>start</em></span>, <span class="code"><em>stop</em></span>, and <span class="code"><em>stride</em></span> are all optional (i.e., <span class="code"><em>obj</em></span><span class="code">[:<em>stop</em>:]</span> and <span class="code"><em>obj</em></span><span class="code">[:<em>stop</em>]</span> are also syntactically correct slicings, each being equivalent to <span class="code"><em>obj</em></span><span class="code">[<strong>None</strong>:<em>stop</em>:<strong>None</strong>]</span>). Assigning to a slicing asks the container <span class="code"><em>obj</em></span> to bind or unbind some of its items. Assigning to a slicing such as <span class="code"><em>obj</em></span><span class="code">[<em>start</em>:<em>stop</em>:<em>stride</em>]</span> is equivalent to assigning to the indexing <span class="code"><em>obj</em></span><span class="code">[slice(<em>start</em>,</span> <span class="code"><em>stop</em></span><span class="code">,</span> <span class="code"><em>stride</em></span><span class="code">)]</span>. See Python’s built-in type <span class="code">slice</span> in (<a data-type="xref" href="ch08.xhtml#pythonapostrophes_core_built_in_types">Table 8-1</a>), whose instances represent slices (a <em>slicing</em> is a slice <em>applied to</em> a container).<a contenteditable="false" data-primary="" data-startref="binding03" data-type="indexterm" id="idm44924595433120"/></dd>
</dl>
<p>We’ll get back to indexing and slicing targets when we discuss operations on lists in <a data-type="xref" href="#modifying_a_list">“Modifying a list”</a>, and on dictionaries in <a data-type="xref" href="#indexing_a_dictionary">“Indexing a Dictionary”</a>.</p>
<p>When the target of the assignment is an identifier, the assignment statement specifies the binding of a variable. This is <em>never</em> disallowed: when you request it, it takes place. In all other cases, the assignment statement denotes a request to an object to bind one or more of its attributes or items. An object may refuse to create or rebind some (or all) attributes or items, raising an exception if you attempt a disallowed creation or rebinding (see also <span class="code">__setattr__</span> in <a data-type="xref" href="ch04.xhtml#general_purpose_special_methods">Table 4-1</a> and <span class="code">__setitem__</span> in <a data-type="xref" href="ch04.xhtml#container_method">“Container methods”</a>).</p>
<p>A plain assignment can use multiple targets and<a contenteditable="false" data-primary="= (equal sign)" data-secodary-sortas="plain assignemnt" data-secondary="in plain assignment" data-type="indexterm" id="idm44924595425168"/><a contenteditable="false" data-primary="equal sign (=)" data-secondary="in plain assignment" data-secondary-sortas="plain assignement" data-type="indexterm" id="idm44924595423520"/> equals signs (<span class="code">=</span>). For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">a</code> <code class="o">=</code> <code class="n">b</code> <code class="o">=</code> <code class="n">c</code> <code class="o">=</code> <code class="mi">0</code></pre>
<p>binds variables <span class="code">a</span>, <span class="code">b</span>, and <span class="code">c</span> to the same value, <span class="code">0</span>. Each time the statement executes, the RHS expression evaluates just once, no matter how many targets are in the statement. Each target, left to right, is bound to the one object returned by the expression, just as if several simple assignments executed one after the other.</p>
<p>The target in a plain assignment can list two or more references separated by commas, optionally enclosed in parentheses or brackets. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">,</code> <code class="n">c</code> <code class="o">=</code> <code class="n">x</code></pre>
<p>This statement requires <span class="code">x</span> to be an iterable with exactly three items, and binds <span class="code">a</span> to the first item, <span class="code">b</span> to the second, and <span class="code">c</span> to the third. This kind of assignment is known as an<a contenteditable="false" data-primary="unpacking assignment" data-type="indexterm" id="idm44924595393440"/> <em>unpacking assignment</em>. The RHS expression must be an iterable with exactly as many items as there are references in the target; otherwise, Python raises an exception. Python binds each reference in the target to the corresponding item in the RHS. You can use an unpacking assignment, for example, to swap references:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">a</code><code class="p">,</code> <code class="n">b</code> <code class="o">=</code> <code class="n">b</code><code class="p">,</code> <code class="n">a</code></pre>
<p>This assignment statement rebinds name <span class="code">a</span> to what name <span class="code">b</span> was bound to, and vice versa. Exactly one of the multiple targets of an unpacking assignment may be preceded<a contenteditable="false" data-primary="* (asterisk)" data-secondary="extended unpacking" data-type="indexterm" id="idm44924595342992"/><a contenteditable="false" data-primary="asterisk (*)" data-secondary="extended unpacking" data-type="indexterm" id="idm44924595341648"/> by <span class="code">*</span>. That<a contenteditable="false" data-primary="starred targets" data-type="indexterm" id="idm44924595339424"/> <em>starred</em> target, if present, is bound to a list of all items, if any, that were not assigned to other targets. For example, when <span class="code">x</span> is a list, this:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">first</code><code class="p">,</code> <code class="o">*</code><code class="n">middle</code><code class="p">,</code> <code class="n">last</code> <code class="o">=</code> <code class="n">x</code></pre>
<p>is the same as (but more concise, clearer, more general, and faster than) this:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">first</code><code class="p">,</code> <code class="n">middle</code><code class="p">,</code> <code class="n">last</code> <code class="o">=</code> <code class="n">x</code><code class="p">[</code><code class="mi">0</code><code class="p">],</code> <code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="o">-</code><code class="mi">1</code><code class="p">],</code> <code class="n">x</code><code class="p">[</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code></pre>
<p>Each of these forms requires <span class="code">x</span> to have at least two items. This feature is known as <em>extended unpacking</em>.</p>
</div></section>
<section data-pdf-bookmark="Augmented assignment" data-type="sect3"><div class="sect3" id="augmented_assignment">
<h3>Augmented assignment</h3>
<p>An<a contenteditable="false" data-primary="augmented assignment" data-type="indexterm" id="idm44924595255424"/> <em>augmented assignment</em> (sometimes called an<a contenteditable="false" data-primary="in-place assignment" data-type="indexterm" id="idm44924595266608"/> <em>in-place assignment</em>) differs from a plain assignment in that, instead of an equals sign (<span class="code">=</span>) between the target and the expression, it uses an<a contenteditable="false" data-primary="augmented operators" data-type="indexterm" id="idm44924595264208"/> <em>augmented operator</em>, which is a binary operator followed by <span class="code">=</span>. The<a contenteditable="false" data-primary="+= character" data-type="indexterm" id="idm44924595261840"/><a contenteditable="false" data-primary="-= operator" data-type="indexterm" id="idm44924592669760"/><a contenteditable="false" data-primary="*= character" data-type="indexterm" id="idm44924592668656"/><a contenteditable="false" data-primary="/= character" data-type="indexterm" id="idm44924592667552"/><a contenteditable="false" data-primary="//= character" data-type="indexterm" id="idm44924592666448"/><a contenteditable="false" data-primary="%= character" data-type="indexterm" id="idm44924592665344"/><a contenteditable="false" data-primary="**= character" data-type="indexterm" id="idm44924592664240"/><a contenteditable="false" data-primary="|= character" data-type="indexterm" id="idm44924592663136"/><a contenteditable="false" data-primary="&gt;&gt;= operator" data-type="indexterm" id="idm44924592662032"/><a contenteditable="false" data-primary="&lt;&lt;= character" data-type="indexterm" id="idm44924592660928"/><a contenteditable="false" data-primary="&amp;= character" data-type="indexterm" id="idm44924592659824"/><a contenteditable="false" data-primary="^= character" data-type="indexterm" id="idm44924592658720"/><a contenteditable="false" data-primary="@= (matrix multiplication assignment operator)" data-type="indexterm" id="idm44924592635056"/><a contenteditable="false" data-primary="at sign (@)" data-secondary="matrix multiplication assignment operator" data-type="indexterm" id="idm44924592633984"/> augmented operators are <span class="code">+=</span>, <span class="code">-=</span>, <span class="code">*=</span>, <span class="code">/=</span>, <span class="code">//=</span>, <span class="code">%=</span>, <span class="code">**=</span>, <span class="code">|=</span>, <span class="code">&gt;&gt;=</span>, <span class="code">&lt;&lt;=</span>, <span class="code">&amp;=</span>, <span class="code">^=</span>, and <span class="code">@=</span>. An augmented assignment can have only one target on the LHS; augmented assignment does not support multiple targets.</p>
<p>In an augmented assignment, like in a plain one, Python first evaluates the RHS expression. Then, when the LHS refers to an object that has a special method for the appropriate <em>in-place</em> version of the operator, Python calls the method with the RHS value as its argument (it is up to the method to modify the LHS object appropriately and return the modified object; <a data-type="xref" href="ch04.xhtml#special_methods">“Special Methods”</a> covers special methods). When the LHS object has no applicable in-place special method, Python uses the corresponding binary operator on the LHS and RHS objects, then rebinds the target to the result. For example, <span class="code"><em>x</em></span> <span class="code">+=</span> <span class="code"><em>y</em></span> is like <span class="code"><em>x</em></span> <span class="code">=</span> <span class="code"><em>x</em></span><span class="code">.__iadd_(<em>y</em>)</span> when <span class="code"><em>x</em></span> has the special method <span class="code">__iadd__</span> for “in-place addition”; otherwise, <span class="code"><em>x</em></span> <span class="code">+=</span> <span class="code"><em>y</em></span> is like <span class="code"><em>x</em></span> <span class="code">=</span> <span class="code"><em>x</em></span> <span class="code">+</span> <span class="code"><em>y</em></span>.</p>
<p>Augmented assignment never creates its target reference; the target must already be bound when augmented assignment executes. Augmented assignment can rebind the target reference to a new object, or modify the same object to which the target reference was already bound. Plain assignment, in contrast, can create or rebind the LHS target reference, but it never modifies the object, if any, to which the target reference was previously bound. The distinction between objects and references to objects is crucial here. For example, <span class="code"><em>x</em></span> <span class="code">=</span> <span class="code"><em>x</em></span> <span class="code">+</span> <span class="code"><em>y</em></span> never modifies the object to which <span class="code"><em>x</em></span> was originally bound, if any. Rather, it rebinds <span class="code"><em>x</em></span> to refer to a new object. <span class="code"><em>x</em></span> <span class="code">+=</span> <span class="code"><em>y</em></span>, <span class="keep-together">in contrast</span>, modifies the object to which the name <span class="code"><em>x</em></span> is bound, when that object has the special method <span class="code">__iadd__</span>; otherwise, <span class="code"><em>x</em></span> <span class="code">+=</span> <span class="code"><em>y</em></span> rebinds <span class="code"><em>x</em></span> to a new object, just like <span class="keep-together"><span class="code"><em>x</em></span> <span class="code">=</span> <span class="code"><em>x</em></span> <span class="code">+</span> <span class="code"><em>y</em></span></span>.<a contenteditable="false" data-primary="" data-startref="assstate03" data-type="indexterm" id="idm44924592589248"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="del Statements" data-type="sect2"><div class="sect2" id="del_statements">
<h2>del Statements</h2>
<p>Despite<a contenteditable="false" data-primary="unbinding" data-type="indexterm" id="idm44924592586000"/><a contenteditable="false" data-primary="variables and other references" data-secondary="del statement" data-type="indexterm" id="idm44924592584864"/><a contenteditable="false" data-primary="del statement" data-type="indexterm" id="idm44924592583520"/> its name, a <span class="code"><strong>del</strong></span> statement<a contenteditable="false" data-primary="binding" data-secondary="unbinding with del" data-type="indexterm" id="idm44924592581408"/><a contenteditable="false" data-primary="references" data-secondary="unbinding" data-type="indexterm" id="idm44924592580032"/> <em>unbinds references</em>—it does <em>not</em>, per se, <em>delete</em> objects. Object deletion<a contenteditable="false" data-primary="objects" data-secondary="deleting" data-type="indexterm" id="idm44924592577184"/><a contenteditable="false" data-primary="garbage collection" data-type="indexterm" id="idm44924592575808"/> may automatically follow, by garbage collection, when no more references to an object exist.</p>
<p>A <span class="code"><strong>del</strong></span> statement consists of the keyword <span class="code"><strong>del</strong></span>, followed by one or more target references separated by<a contenteditable="false" data-primary="comma (,)" data-secondary="in delete statements" data-secondary-sortas="delete statements" data-type="indexterm" id="idm44924592572256"/><a contenteditable="false" data-primary=", (comma)" data-secondary="in delete statements" data-secondary-sortas="delete statements" data-type="indexterm" id="idm44924592570640"/> commas (<span class="code">,</span>). Each target can be a variable, attribute reference, indexing, or slicing, just like for assignment statements, and must be bound at the time <span class="code"><strong>del</strong></span> executes. When a <span class="code"><strong>del</strong></span> target is an identifier, the <span class="code"><strong>del</strong></span> statement means to unbind the variable. If the identifier was bound, unbinding it is never disallowed; when requested, it takes place.</p>
<p>In all other cases, the <span class="code"><strong>del</strong></span> statement specifies a request to an object to unbind one or more of its attributes or items. An object may refuse to unbind some (or all) attributes or items, raising an exception if you attempt a disallowed unbinding (see also <span class="code">__delattr__</span> in <a data-type="xref" href="ch04.xhtml#general_purpose_special_method">“General-Purpose Special Methods”</a> and <span class="code">__delitem__</span> in <a data-type="xref" href="ch04.xhtml#container_method">“Container methods”</a>). Unbinding a slicing normally has the same effect as assigning an empty sequence to that slicing, but it is up to the container object to implement this equivalence.</p>
<p>Containers are also allowed to have <span class="code"><strong>del</strong></span> cause side effects. For example, assuming <span class="code"><strong>del</strong></span> <span class="code"><em>C</em></span><span class="code">[2]</span> succeeds, when <span class="code"><em>C</em></span> is a dictionary, this makes future references to <span class="code"><em>C</em></span><span class="code">[2]</span> invalid (raising <span class="code">KeyError</span>) until and unless you assign to <span class="code"><em>C</em></span><span class="code">[2]</span> again; but when <span class="code"><em>C</em></span> is a list, <span class="code"><strong>del</strong></span> <span class="code"><em>C</em></span><span class="code">[2]</span> implies that every following item of <span class="code"><em>C</em></span> “shifts left by one”—so, if <span class="code"><em>C</em></span> is long enough, future references to <span class="code"><em>C</em></span><span class="code">[2]</span> are still valid, but denote a different item than they did before the <span class="code"><strong>del</strong></span> (generally, what you’d have used <span class="code"><em>C</em></span><span class="code">[3]</span> to refer to, before the <span class="code"><strong>del</strong></span> statement).<a contenteditable="false" data-primary="" data-startref="PLvar03" data-type="indexterm" id="idm44924592543328"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Expressions and Operators" data-type="sect1"><div class="sect1" id="expressions_and_operators">
<h1>Expressions and Operators</h1>
<p>An<a contenteditable="false" data-primary="Python language" data-secondary="expressions and operators" data-type="indexterm" id="PLexp03"/><a contenteditable="false" data-primary="operators" data-secondary="precedence (in expressions)" data-type="indexterm" id="idm44924592538640"/> expression is a “phrase” of code, which Python evaluates to produce a value. The simplest expressions are literals and identifiers. You build other expressions by joining subexpressions with the operators and/or delimiters listed in <a data-type="xref" href="#operator_precedence_in_expressions">Table 3-4</a>. <span class="keep-together">This table</span> lists operators in decreasing order of precedence, higher precedence before lower. Operators listed together have the same precedence. The third column lists the associativity of the operator: L (left-to-right), R (right-to-left), or NA <span class="keep-together">(nonassociative)</span>.</p>
<table class="border" id="operator_precedence_in_expressions">
<caption><span class="label">Table 3-4. </span>Operator precedence in expressions</caption>
<thead>
<tr>
<th>Operator</th>
<th>Description</th>
<th>Associativity</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="code">{</span> <span class="code"><em>key</em></span> <span class="code">:</span> <span class="code"><em>expr</em></span><span class="code">, ... }</span></td>
<td>Dictionary creation</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code">{</span> <span class="code"><em>expr</em></span><span class="code">, ... }</span></td>
<td>Set creation</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code">[</span> <span class="code"><em>expr</em></span><span class="code">, ... ]</span></td>
<td>List creation</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code">(</span> <span class="code"><em>expr</em></span><span class="code">, ... )</span></td>
<td>Tuple creation (parentheses recommended, but not always required; at least one comma required), or just parentheses</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code"><em>f</em></span> <span class="code">(</span> <span class="code"><em>expr</em></span><span class="code">, ... )</span></td>
<td>Function call</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">[</span> <span class="code"><em>index</em></span><span class="code">:</span> <span class="code"><em>index: step</em></span> <span class="code">]</span></td>
<td>Slicing</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">[</span> <span class="code"><em>index</em></span> <span class="code">]</span></td>
<td>Indexing</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">.</span> <span class="code"><em>attr</em></span></td>
<td>Attribute reference</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">** y</span></td>
<td>Exponentiation (<span class="code"><em>x</em></span> to the <span class="code"><em>y</em></span>th power)</td>
<td class="center">R</td>
</tr>
<tr>
<td><span class="code">~</span> <span class="code"><em>x</em></span>, <span class="code">+</span> <span class="code"><em>x</em></span>, <span class="code">-</span> <span class="code"><em>x</em></span></td>
<td>Bitwise NOT, unary<a contenteditable="false" data-primary="~ (tilde)" data-type="indexterm" id="idm44924592482320"/><a contenteditable="false" data-primary="tilde (~)" data-type="indexterm" id="idm44924592481184"/> plus and minus</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">*</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">@</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">/</span> <span class="code"><em>y</em></span>,<br/>
<span class="code"><em>x</em></span> <span class="code">//</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">%</span> <span class="code"><em>y</em></span></td>
<td>Multiplication, matrix multiplication, division, floor division, remainder</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">+</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">-</span> <span class="code"><em>y</em></span></td>
<td>Addition, subtraction</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">&lt;&lt;</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">&gt;&gt;</span> <span class="code"><em>y</em></span></td>
<td>Left-shift, right-shift</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">&amp;</span> <span class="code"><em>y</em></span></td>
<td>Bitwise AND<a contenteditable="false" data-primary="&amp; (bitwise AND operator)" data-type="indexterm" id="idm44924592448352"/><a contenteditable="false" data-primary="bitwise AND operator (&amp;)" data-type="indexterm" id="idm44924592447248"/></td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">^</span> <span class="code"><em>y</em></span></td>
<td>Bitwise XOR</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">|</span> <span class="code"><em>y</em></span></td>
<td>Bitwise OR</td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code">&lt;</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">&lt;=</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">&gt;</span> <span class="code"><em>y</em></span>,<br/>
<span class="code"><em>x</em></span> <span class="code">&gt;=</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">!=</span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code">==</span> <span class="code"><em>y</em></span></td>
<td>Comparisons (less than, less than or equal, greater than, greater than or equal, inequality, equality)</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code"><strong>is</strong></span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code"><strong>is not</strong></span> <span class="code"><em>y</em></span></td>
<td>Identity tests</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>y</em></span>, <span class="code"><em>x</em></span> <span class="code"><strong>not in</strong></span> <span class="code"><em>y</em></span></td>
<td>Membership tests<a contenteditable="false" data-primary="in keyword" data-secondary="membership testing" data-type="indexterm" id="idm44924592407408"/></td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code"><strong>not</strong></span> <span class="code"><em>x</em></span></td>
<td>Boolean NOT<a contenteditable="false" data-primary="not" data-type="indexterm" id="idm44924592402592"/></td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code"><strong>and</strong></span> <span class="code"><em>y</em></span></td>
<td>Boolean AND<a contenteditable="false" data-primary="and keyword" data-type="indexterm" id="and03"/></td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code"><strong>or</strong></span> <span class="code"><em>y</em></span></td>
<td>Boolean OR<a contenteditable="false" data-primary="or" data-type="indexterm" id="idm44924592391536"/></td>
<td class="center">L</td>
</tr>
<tr>
<td><span class="code"><em>x</em></span> <span class="code"><strong>if</strong></span> <span class="code"><em>expr</em></span> <span class="code"><strong>else</strong></span> <span class="code"><em>y</em></span></td>
<td>Conditional expression (or<a contenteditable="false" data-primary="ternary operator" data-seealso="if/else" data-type="indexterm" id="idm44924592384448"/> ternary operator)</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code"><strong>lambda</strong></span> <span class="code"><em>arg</em></span><span class="code">, ...:</span> <span class="code"><em>expr</em></span></td>
<td>Anonymous<a contenteditable="false" data-primary="lambda" data-type="indexterm" id="idm44924592378096"/> simple function</td>
<td class="center">NA</td>
</tr>
<tr>
<td><span class="code">(</span> <span class="code"><em>ident</em></span> <span class="code">:=</span> <span class="code"><em>expr</em></span> <span class="code">)</span></td>
<td>Assignment expression (parentheses recommended, but not always required)</td>
<td class="center">NA</td>
</tr>
</tbody>
</table>
<p>In this table, <span class="code"><em>expr</em></span>, <span class="code"><em>key</em></span>, <span class="code"><em>f</em></span>, <span class="code"><em>index</em></span>, <span class="code"><em>x</em></span>, and <span class="code"><em>y</em></span> mean any expression, while <span class="code"><em>attr</em></span>, <span class="code"><em>arg</em></span>, and <span class="code"><em>ident</em></span> mean any identifier. The notation <span class="code"><em>, ...</em></span> means commas join zero or more repetitions; in such cases, a trailing comma is optional and innocuous.<a contenteditable="false" data-primary="" data-startref="and03" data-type="indexterm" id="idm44924592361392"/></p>
<section data-pdf-bookmark="Comparison Chaining" data-type="sect2"><div class="sect2" id="comparison_chaining">
<h2>Comparison Chaining</h2>
<p>You<a contenteditable="false" data-primary="expressions and operators" data-secondary="comparison chaining" data-type="indexterm" id="idm44924592358368"/><a contenteditable="false" data-primary="comparison" data-secondary="comparison chaining" data-type="indexterm" id="idm44924592356992"/><a contenteditable="false" data-primary="if statement" data-secondary="if/else conditional expression" data-type="indexterm" id="IFiselse03"/> can chain comparisons, implying a logical <span class="code"><strong>and</strong></span>. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="n">a</code></em><code> </code><code class="o">&lt;</code><code> </code><em><code class="n">b</code></em><code> </code><code class="o">&lt;</code><code class="o">=</code><code> </code><em><code class="n">c</code></em><code> </code><code class="o">&lt;</code><code> </code><em><code class="n">d</code></em></pre>
<p>where <span class="code"><em>a</em></span>, <span class="code"><em>b</em></span>, <span class="code"><em>c</em></span>, and <span class="code"><em>d</em></span> are arbitrary expressions, has (in the absence of evaluation side effects) the same value as:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="n">a</code></em><code> </code><code class="o">&lt;</code><code> </code><em><code class="n">b</code></em><code> </code><strong><code class="ow">and</code></strong><code> </code><em><code class="n">b</code></em><code> </code><code class="o">&lt;</code><code class="o">=</code><code> </code><em><code class="n">c</code></em><code> </code><strong><code class="ow">and</code></strong><code> </code><em><code class="n">c</code></em><code> </code><code class="o">&lt;</code><code> </code><em><code class="n">d</code></em></pre>
<p>The chained form is more readable, and evaluates each subexpression at most once.</p>
</div></section>
<section data-pdf-bookmark="Short-Circuiting Operators" data-type="sect2"><div class="sect2" id="short_circuiting_operators">
<h2>Short-Circuiting Operators</h2>
<p>The<a contenteditable="false" data-primary="expressions and operators" data-secondary="short-circuiting operators" data-type="indexterm" id="idm44924592970688"/><a contenteditable="false" data-primary="short-circuiting operators" data-type="indexterm" id="idm44924592969472"/><a contenteditable="false" data-primary="operators" data-secondary="short-circuiting operators" data-type="indexterm" id="idm44924592968400"/> <span class="code"><strong>and</strong></span> and <span class="code"><strong>or</strong></span> operators <em>short-circuit</em> their operands’ evaluation: the righthand operand evaluates only when its value is needed to get the truth value of the entire <span class="code"><strong>and</strong></span> or <span class="code"><strong>or</strong></span> operation.</p>
<p>In other words, <span class="code"><em>x</em></span> <span class="code"><strong>and</strong></span> <span class="code"><em>y</em></span> first evaluates <span class="code"><em>x</em></span>. When <span class="code"><em>x</em></span> is false, the result is <span class="code"><em>x</em></span>; otherwise, the result is <span class="code"><em>y</em></span>. Similarly, <span class="code"><em>x</em></span> <span class="code"><strong>or</strong></span> <span class="code"><em>y</em></span> first evaluates <span class="code"><em>x</em></span>. When <span class="code"><em>x</em></span> is true, the result is <span class="code"><em>x</em></span>; otherwise, the result is <span class="code"><em>y</em></span>.</p>
<p><span class="code"><strong>and</strong></span> and <span class="code"><strong>or</strong></span> don’t force their results to be <span class="code"><strong>True</strong></span> or <span class="code"><strong>False</strong></span>, but rather return one or the other of their operands. This lets you use these operators more generally, not just in Boolean contexts. <span class="code"><strong>and</strong></span> and <span class="code"><strong>or</strong></span>, because of their short-circuiting semantics, differ from other operators, which fully evaluate all operands before performing the operation. <span class="code"><strong>and</strong></span> and <span class="code"><strong>or</strong></span> let the left operand act as a<a contenteditable="false" data-primary="guards" data-type="indexterm" id="idm44924592926784"/> <em>guard</em> for the right operand.</p>
<section data-pdf-bookmark="The conditional operator" data-type="sect3"><div class="sect3" id="the_conditional_operator">
<h3>The conditional operator</h3>
<p>Another<a contenteditable="false" data-primary="conditional operator" data-type="indexterm" id="idm44924592923328"/> short-circuiting operator is the conditional<sup><a data-type="noteref" href="ch03.xhtml#ch01fn32" id="ch01fn32-marker">13</a></sup> operator <span class="code"><strong>if</strong></span><span class="code">/</span><span class="code"><strong>else</strong></span>:</p>
<pre data-type="programlisting">
<em>when_true</em> <strong>if</strong> <em>condition</em> <strong>else</strong> <em>when_false</em></pre>
<p>Each of <span class="code"><em>when_true</em></span>, <span class="code"><em>when_false</em></span>, and <span class="code"><em>condition</em></span> is an arbitrary expression. <span class="code"><em>condition</em></span> evaluates first. When <span class="code"><em>condition</em></span> is true, the result is <span class="code"><em>when_true</em></span>; otherwise, the result is <span class="code"><em>when_false</em></span>. Only one of the subexpressions <span class="code"><em>when_true</em></span> and <span class="code"><em>when_false</em></span> evaluates, depending on the truth value of <span class="code"><em>condition</em></span>.</p>
<p>The order of the subexpressions in this conditional operator may be a bit confusing. The recommended style is to always place parentheses around the whole expression.<a contenteditable="false" data-primary="" data-startref="IFiselse03" data-type="indexterm" id="idm44924592906464"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Assignment Expressions" data-type="sect2"><div class="sect2" id="assignment_expressions">
<h2>Assignment Expressions</h2>
<p><span class="version">3.8+</span> You can combine evaluation<a contenteditable="false" data-primary="expressions and operators" data-secondary="assignment expressions" data-type="indexterm" id="idm44924592902208"/><a contenteditable="false" data-primary="assignment expressions" data-type="indexterm" id="idm44924592900864"/> of an expression and the assignment of its result using the<a contenteditable="false" data-primary=":= (assignment operator)" data-secondary="assignment expressions" data-type="indexterm" id="idm44924592899632"/><a contenteditable="false" data-primary="assignment operator (:=)" data-secondary="assignment expressions" data-type="indexterm" id="idm44924592898240"/><a contenteditable="false" data-primary="walrus operator (:=)" data-secondary="assignment expressions" data-type="indexterm" id="idm44924592896848"/> <span class="code">:=</span> operator. There are several common cases where this is useful.</p>
<section data-pdf-bookmark=":= in an if/elif statement" data-type="sect3"><div class="sect3" id="equals_in_an_ifsoliduselif_statement">
<h3>:= in an if/elif statement</h3>
<p>Code that assigns a value and then checks it can be collapsed using <span class="code">:=</span>:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">re_match</code><code> </code><code class="o">=</code><code> </code><code class="n">re</code><code class="o">.</code><code class="n">match</code><code class="p">(</code><code class="sa">r</code><code class="s1">'</code><code class="s1">Name: (</code><code class="s1">\</code><code class="s1">S)</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">input_string</code><code class="p">)</code><code>
</code><strong><code class="k">if</code></strong><code> </code><code class="n">re_match</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="n">re_match</code><code class="o">.</code><code class="n">groups</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><em><code class="c1"># collapsed version using :=</code></em><code>
</code><strong><code class="k">if</code></strong><code> </code><code class="p">(</code><code class="n">re_match</code><code> </code><code class="o">:=</code><code> </code><code class="n">re</code><code class="o">.</code><code class="n">match</code><code class="p">(</code><code class="sa">r</code><code class="s1">'</code><code class="s1">Name: (</code><code class="s1">\</code><code class="s1">S)</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">input_string</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="n">re_match</code><code class="o">.</code><code class="n">groups</code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="p">)</code></pre>
<p>This is especially helpful when writing a sequence of <span class="code"><strong>if</strong></span><span class="code">/</span><span class="code"><strong>elif</strong></span> blocks (you’ll find a more extended example in <a data-type="xref" href="ch10.xhtml#regular_expressions">Chapter 10</a>).</p>
</div></section>
<section data-pdf-bookmark=":= in a while statement" data-type="sect3"><div class="sect3" id="equals_in_a_while_statement">
<h3>:= in a while statement</h3>
<p>Use<a contenteditable="false" data-primary="while statement" data-type="indexterm" id="idm44924592832416"/> <span class="code">:=</span> to simplify code that uses a variable as its <span class="code"><strong>while</strong></span> condition. Consider this code that works with a sequence of values returned by some function <span class="code">get_next_value</span>, which returns <span class="code"><strong>None</strong></span> when there are no more values to process:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">current_value</code><code> </code><code class="o">=</code><code> </code><code class="n">get_next_value</code><code class="p">(</code><code class="p">)</code><code>
</code><strong><code class="k">while</code></strong><code> </code><code class="n">current_value</code><code> </code><strong><code class="ow">is</code><code> </code><code class="ow">not</code><code> </code><code class="kc">None</code></strong><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code><code> </code><code class="ow">not</code></strong><code> </code><code class="n">filter_condition</code><code class="p">(</code><code class="n">current_value</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">continue</code></strong><code>   </code><em><code class="c1"># BUG! Current_value is not advanced to next</code></em><code>
</code><em><code>    </code><code class="c1"># ... do some work with current_value ...</code></em><code>
</code><code>    </code><code class="n">current_value</code><code> </code><code class="o">=</code><code> </code><code class="n">get_next_value</code><code class="p">(</code><code class="p">)</code></pre>
<p>This code has a couple of problems. First, there is the duplicated call to <span class="code">get_next_value</span>, which carries extra maintenance costs when <span class="code">get_next_value</span> changes. But more seriously, there is a bug when an early exiting filter is added: the <span class="code"><strong>continue</strong></span> statement jumps directly back to the <span class="code"><strong>while</strong></span> statement without advancing to the next value, creating an infinite loop.</p>
<p>When we use <span class="code">:=</span> to incorporate the assignment into the <span class="code"><strong>while</strong></span> statement itself, we fix the duplication problem, and calling <span class="code"><strong>continue</strong></span> does not cause an infinite loop:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">while</code></strong><code> </code><code class="p">(</code><code class="n">current_value</code><code> </code><code class="o">:=</code><code> </code><code class="n">get_next_value</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code> </code><strong><code class="ow">is</code><code> </code><code class="ow">not</code><code> </code><code class="kc">None</code></strong><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code><code> </code><code class="ow">not</code></strong><code> </code><code class="n">filter_condition</code><code class="p">(</code><code class="n">current_value</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">continue</code></strong><code>   </code><em><code class="c1"># no bug, current_value advances in while statement</code></em><code>
</code><em><code>    </code><code class="c1"># ... do some work with current_value ...</code></em></pre>
</div></section>
<section data-pdf-bookmark=":= in a list comprehension filter" data-type="sect3"><div class="sect3" id="equals_in_a_list_comprehension_filter">
<h3>:= in a list comprehension filter</h3>
<p>A<a contenteditable="false" data-primary="list comprehension filters" data-type="indexterm" id="idm44924592717600"/> list comprehension that converts an input item but must filter out some items based on their converted values can use <span class="code">:=</span> to do the conversion only once. In this example, a function to convert <span class="code">str</span>s to <span class="code">int</span>s returns <span class="code"><strong>None</strong></span> for invalid values. Without <span class="code">:=</span>, the list comprehension must call <span class="code">safe_int</span> twice for valid values, once to check for <span class="code"><strong>None</strong></span> and then again to add the actual <span class="code">int</span> value to the list:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">safe_int</code><code class="p">(</code><code class="n">s</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">try</code></strong><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">return</code></strong><code> </code><code class="nb">int</code><code class="p">(</code><code class="n">s</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">except</code></strong><code> </code><code class="ne">Exception</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">return</code><code> </code><code class="kc">None</code></strong><code>
</code><code>
</code><code class="n">input_strings</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">1</code><code class="s1">'</code><code class="p">,</code><code class="s1">'</code><code class="s1">2</code><code class="s1">'</code><code class="p">,</code><code class="s1">'</code><code class="s1">a</code><code class="s1">'</code><code class="p">,</code><code class="s1">'</code><code class="s1">11</code><code class="s1">'</code><code class="p">]</code><code>
</code><code>
</code><code class="n">valid_int_strings</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">safe_int</code><code class="p">(</code><code class="n">s</code><code class="p">)</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">s</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">input_strings</code><code> </code><code>
</code><code>                     </code><strong><code class="k">if</code></strong><code> </code><code class="n">safe_int</code><code class="p">(</code><code class="n">s</code><code class="p">)</code><code> </code><strong><code class="ow">is</code><code> </code><code class="ow">not</code></strong><code> </code><strong><code class="kc">None</code></strong><code class="p">]</code></pre>
<p>If we use an assignment expression in the condition part of the list comprehension, <span class="code">safe_int</span> only gets called once for each value in <span class="code">input_strings</span>:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">valid_int_strings</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">int_s</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">s</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">input_strings</code><code>
</code><code>                     </code><strong><code class="k">if</code></strong><code> </code><code class="p">(</code><code class="n">int_s</code><code> </code><code class="o">:=</code><code> </code><code class="n">safe_int</code><code class="p">(</code><code class="n">s</code><code class="p">)</code><code class="p">)</code><code> </code><strong><code class="ow">is</code><code> </code><code class="ow">not</code><code> </code><code class="kc">None</code></strong><code class="p">]</code></pre>
<p>You<a contenteditable="false" data-primary="" data-startref="PLexp03" data-type="indexterm" id="idm44924591302688"/> can find more examples in the original PEP for this feature, <a href="https://oreil.ly/1YhRm">PEP 572</a>.</p>
</div></section>
</div></section>
</div></section>
<section data-pdf-bookmark="Numeric Operations" data-type="sect1"><div class="sect1" id="numeric_operations">
<h1>Numeric Operations</h1>
<p>Python<a contenteditable="false" data-primary="Python language" data-secondary="numeric operations" data-type="indexterm" id="PLnumop03"/><a contenteditable="false" data-primary="numeric operations" data-type="indexterm" id="numop03"/> offers the usual numeric operations, as we’ve just seen in <a data-type="xref" href="#operator_precedence_in_expressions">Table 3-4</a>. Numbers are immutable objects: when you perform operations on number objects, you always produce new objects and never modify existing ones. You can access the parts of a complex object <span class="code"><em>z</em></span> as read-only attributes <span class="code"><em>z.</em></span><span class="code">real</span> and <span class="code"><em>z.</em></span><span class="code">imag</span>. Trying to rebind these attributes raises an exception.</p>
<p>A number’s optional <span class="code">+</span> or <span class="code">-</span> sign, and the <span class="code">+</span> or <span class="code">-</span> that joins a floating-point literal to an imaginary one to make a complex number, are not part of the literals’ syntax. They are ordinary operators, subject to normal operator precedence rules (see <a data-type="xref" href="#operator_precedence_in_expressions">Table 3-4</a>). For example, <span class="code">-2 ** 2</span> evaluates to <span class="code">-4</span>: exponentiation has higher precedence than unary minus, so the whole expression parses as <span class="code">-(2 ** 2)</span>, not as <span class="code">(-2) ** 2</span>. (Again, parentheses are recommended, to avoid confusing a reader of the code.)</p>
<section data-pdf-bookmark="Numeric Conversions" data-type="sect2"><div class="sect2" id="numeric_conversions">
<h2>Numeric Conversions</h2>
<p>You<a contenteditable="false" data-primary="numeric operations" data-secondary="numeric conversions" data-type="indexterm" id="idm44924591258528"/><a contenteditable="false" data-primary="numeric conversions" data-type="indexterm" id="idm44924591256736"/> can perform arithmetic operations and comparisons between any two numbers of Python built-in types (integers, floating-point numbers, and complex numbers). If the operands’ types differ, Python converts the operand with the “narrower” type to the “wider” type.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn33" id="ch01fn33-marker">14</a></sup> The built-in numeric types, in order from narrowest to widest, are <span class="code">int</span>, <span class="code">float</span>, and <span class="code">complex</span>. You can request an explicit conversion by passing a noncomplex numeric argument to any of these types. <span class="code">int</span> drops its argument’s fractional part, if any (e.g., <span class="code">int(9.8)</span> is <span class="code">9</span>). You can also call <span class="code">complex</span> with two numeric arguments, giving real and imaginary parts. You cannot convert a <span class="code">complex</span> to another numeric type in this way, because there is no single unambiguous way to convert a complex number into, for example, a <span class="code">float</span>.</p>
<p>You can also call each built-in numeric type with a string argument with the syntax of an appropriate numeric literal, with small extensions: the argument string may have leading and/or trailing whitespace, may start with a sign, and—for complex numbers—may sum or subtract a real part and an imaginary one. <span class="code">int</span> can also be called with two arguments: the first one a string to convert, and the second the <em>radix</em>, an integer between 2 and 36 to use as the base for the conversion (e.g., <span class="code">int('101', 2)</span> returns <span class="code">5</span>, the value of <span class="code">'101'</span> in base 2). For radices larger than 10, the appropriate subset of ASCII letters from the start of the alphabet (in either lower- or uppercase) are the extra needed “digits.”<sup><a data-type="noteref" href="ch03.xhtml#ch01fn34" id="ch01fn34-marker">15</a></sup></p>
</div></section>
<section data-pdf-bookmark="Arithmetic Operations" data-type="sect2"><div class="sect2" id="arithmetic_operations">
<h2>Arithmetic Operations</h2>
<p>Arithmetic operations<a contenteditable="false" data-primary="numeric operations" data-secondary="arithmetic operations" data-type="indexterm" id="idm44924591241424"/><a contenteditable="false" data-primary="arithmetic operations" data-type="indexterm" id="idm44924591240016"/> in Python behave in rather obvious ways, with the possible exception of division and exponentiation.</p>
<section data-pdf-bookmark="Division" data-type="sect3"><div class="sect3" id="division">
<h3>Division</h3>
<p>When<a contenteditable="false" data-primary="division" data-type="indexterm" id="idm44924591236096"/> the right operand<a contenteditable="false" data-primary="slash (/)" data-secondary="in arithmetic operations" data-secondary-sortas="arithmetic operations" data-type="indexterm" id="idm44924591234832"/><a contenteditable="false" data-primary="/ (slash)" data-secondary="in arithmetic operations" data-secondary-sortas="arithmetic operations" data-type="indexterm" id="idm44924591233184"/><a contenteditable="false" data-primary="% (percent sign)" data-secondary="modulus division operator" data-type="indexterm" id="idm44924591231568"/><a contenteditable="false" data-primary="percent sign (%)" data-secondary="modulus division operator" data-type="indexterm" id="idm44924591230176"/> of <span class="code">/</span>, <span class="code">//</span>, or <span class="code">%</span> is <span class="code">0</span>, Python raises an exception at runtime. Otherwise, the <span class="code">/</span> operator performs<a contenteditable="false" data-primary="true division" data-type="indexterm" id="idm44924591225088"/> <em>true</em> division, returning the floating-point result of division of the two operands (or a complex result if either operand is a complex number). In contrast, the<a contenteditable="false" data-primary="// (floor division operator)" data-type="indexterm" id="idm44924591223376"/><a contenteditable="false" data-primary="floor division operator (//)" data-type="indexterm" id="idm44924591222256"/> <span class="code">//</span> operator performs <em>floor</em> division, which means it returns an integer result (converted to the same type as the wider operand) that’s the largest integer less than or equal to the true division result (ignoring the remainder, if any); e.g., <span class="code">5.0 // 2 = 2.0</span> (not <span class="code">2</span>). The <span class="code">%</span> operator returns the remainder of the (floor) division, i.e., the integer such that <span class="code">(x // y) * y + (x % y) == x</span>.</p>
<div data-type="warning" epub:type="warning">
<h1>–x // y Is Not the Same as int(–x / y)</h1>
<p>Take care not to think of <span class="code">//</span> as a truncating or integer form of division; this is only the case for operands of the same sign. When operands are of different signs, the largest integer less than or equal to the true division result will actually be a more negative value than the result from true division (for example, <span class="code">-5 / 2</span> returns <span class="code">-2.5</span>, so <span class="code">-5 // 2</span> returns <span class="code">-3</span>, not <span class="code">-2</span>).</p>
</div>
<p>The<a contenteditable="false" data-primary="divmod (built-in function)" data-type="indexterm" id="idm44924591210832"/> built-in <span class="code">divmod</span> function takes two numeric arguments and returns a pair whose items are the quotient and remainder, so you don’t have to use both <span class="code">//</span> for the quotient and <span class="code">%</span> for the remainder.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn35" id="ch01fn35-marker">16</a></sup></p>
</div></section>
<section data-pdf-bookmark="Exponentiation" data-type="sect3"><div class="sect3" id="exponentiation">
<h3>Exponentiation</h3>
<p>The<a contenteditable="false" data-primary="raise to power operator (**)" data-type="indexterm" id="idm44924591201632"/><a contenteditable="false" data-primary="** (double star) operator" data-secondary="exponentiation operator" data-type="indexterm" id="idm44924591199760"/><a contenteditable="false" data-primary="double star (**) operator" data-secondary="exponentiation operator" data-type="indexterm" id="idm44924591198368"/> exponentiation (“raise to power”) operation, when <span class="code"><em>a</em></span> is less than zero and <span class="code"><em>b</em></span> is a floating-point value with a nonzero fractional part, returns a complex number. The built-in <span class="code">pow(<em>a</em>,</span> <span class="code"><em>b</em></span><span class="code">)</span> function returns the same result as <span class="code"><em>a</em></span> <span class="code">**</span> <span class="code"><em>b</em></span>. With three arguments, <span class="code">pow(<em>a</em>,</span> <span class="code"><em>b</em></span><span class="code">,</span> <span class="code"><em>c</em></span><span class="code">)</span> returns the same result as <span class="code">(<em>a</em></span> <span class="code">**</span> <span class="code"><em>b</em>) %</span> <span class="code"><em>c</em></span> but may sometimes be faster. Note that, unlike other arithmetic operations, exponentiation evaluates right to left: in other words, <span class="code"><em>a</em></span> <span class="code">**</span> <span class="code"><em>b</em></span> <span class="code">**</span> <span class="code"><em>c</em></span> evaluates as <span class="code"><em>a</em></span> <span class="code">** (<em>b</em></span> <span class="code">**</span> <span class="code"><em>c</em>)</span>.</p>
</div></section>
<section data-pdf-bookmark="Comparisons" data-type="sect3"><div class="sect3" id="comparisons">
<h3>Comparisons</h3>
<p>All<a contenteditable="false" data-primary="comparison" data-secondary="comparison operators" data-type="indexterm" id="idm44924591173840"/> objects, including numbers, can be compared for<a contenteditable="false" data-primary="== (equal to operator)" data-type="indexterm" id="idm44924591171984"/><a contenteditable="false" data-primary="equal to operator (==)" data-type="indexterm" id="idm44924591170880"/> equality (<span class="code">==</span>) and inequality<a contenteditable="false" data-primary="!= (not equal to operator)" data-type="indexterm" id="idm44924591168928"/><a contenteditable="false" data-primary="not equal to operator (!=)" data-type="indexterm" id="idm44924591167776"/><a contenteditable="false" data-primary="inequality operator (!=)" data-type="indexterm" id="idm44924591166656"/> (<span class="code">!=</span>). Comparisons requiring order<a contenteditable="false" data-primary="less than symbol (&lt;)" data-secondary="comparison operator" data-type="indexterm" id="idm44924591164688"/><a contenteditable="false" data-primary="less than or equal to operator (&lt;=)" data-type="indexterm" id="idm44924591163312"/><a contenteditable="false" data-primary="&lt; (less than symbol)" data-secondary="comparisons" data-type="indexterm" id="idm44924591162144"/><a contenteditable="false" data-primary="&lt;= (less than or equal to operator)" data-type="indexterm" id="idm44924591160768"/><a contenteditable="false" data-primary="&gt; (greater than symbol)" data-secondary="comparison operator" data-type="indexterm" id="idm44924591159648"/><a contenteditable="false" data-primary="&gt;= (greater than or equal to operator)" data-type="indexterm" id="idm44924591158272"/> (<span class="code">&lt;</span>, <span class="code">&lt;=</span>, <span class="code">&gt;</span>, <span class="code">&gt;=</span>) may be used between any two numbers unless either operand is complex, in which case they raise exceptions at runtime. All these operators return Boolean values (<span class="code"><strong>True</strong></span> or <span class="code"><strong>False</strong></span>). Be careful when comparing<a contenteditable="false" data-primary="floating-point numbers" data-secondary="comparing for equality" data-type="indexterm" id="idm44924591152448"/> floating-point numbers for equality, however, as discussed in <a data-type="xref" href="ch16.xhtml#numeric_processing">Chapter 16</a> and the <a href="https://oreil.ly/TSWCX">online tutorial on floating-point arithmetic</a>.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Bitwise Operations on Integers" data-type="sect2"><div class="sect2" id="bitwise_operations_on_integers">
<h2>Bitwise Operations on Integers</h2>
<p><span class="code">int</span>s can<a contenteditable="false" data-primary="numeric operations" data-secondary="bitwise operations on integers" data-type="indexterm" id="idm44924591146816"/><a contenteditable="false" data-primary="bitwise operations on integers" data-type="indexterm" id="idm44924591145392"/> be interpreted as strings of bits and used with the bitwise operations shown in <a data-type="xref" href="#operator_precedence_in_expressions">Table 3-4</a>. Bitwise operators have lower priority than arithmetic operators. Positive <span class="code">int</span>s are conceptually extended by an unbounded string of bits on the left, each bit being <span class="code">0</span>. Negative <span class="code">int</span>s, as they’re held in two’s complement representation, are conceptually extended by an unbounded string of bits on the left, each bit <span class="keep-together">being <span class="code">1</span></span>.<a contenteditable="false" data-primary="" data-startref="numop03" data-type="indexterm" id="idm44924591139664"/><a contenteditable="false" data-primary="" data-startref="PLnumop03" data-type="indexterm" id="idm44924591138288"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Sequence Operations" data-type="sect1"><div class="sect1" id="sequence_operations">
<h1>Sequence Operations</h1>
<p>Python<a contenteditable="false" data-primary="Python language" data-secondary="sequence operations" data-type="indexterm" id="PLseq03"/><a contenteditable="false" data-primary="sequence operations" data-type="indexterm" id="seqop03"/> supports a variety of operations applicable to all sequences, including strings, lists, and tuples. Some sequence operations apply to all containers (including sets and dictionaries, which are not sequences); some apply to all iterables (meaning “any object over which you can loop”—all containers, be they sequences or not, are iterable, and so are many objects that are not containers, such as files, covered in <a data-type="xref" href="ch11.xhtml#the_io_module">“The io Module”</a>, and generators, covered in <a data-type="xref" href="#generators">“Generators”</a>). In the following we use the terms <em>sequence</em>, <em>container</em>, and <em>iterable</em> quite precisely, to indicate exactly which operations apply to each category.</p>
<section data-pdf-bookmark="Sequences in General" data-type="sect2"><div class="sect2" id="sequences_in_general">
<h2>Sequences in General</h2>
<p>Sequences<a contenteditable="false" data-primary="sequence operations" data-secondary="sequences in general" data-type="indexterm" id="idm44924591126304"/> are ordered containers with items that are accessible by indexing and slicing.</p>
<p>The built-in<a contenteditable="false" data-primary="len (built-in function)" data-type="indexterm" id="idm44924591124352"/> <span class="code">len</span> function takes any container as an argument and returns the number of items in the container.</p>
<p>The built-in<a contenteditable="false" data-primary="min (built-in function)" data-type="indexterm" id="idm44924591121616"/><a contenteditable="false" data-primary="max (built-in function)" data-type="indexterm" id="idm44924591120480"/> <span class="code">min</span> and <span class="code">max</span> functions take one argument, an iterable whose items are comparable, and return the smallest and largest items, respectively. You can also call <span class="code">min</span> and <span class="code">max</span> with multiple arguments, in which case they return the smallest and largest arguments, respectively.</p>
<p><span class="code">min</span> and <span class="code">max</span> also accept two keyword-only optional arguments: <span class="code">key</span><a contenteditable="false" data-primary="key argument" data-secondary="sequence comparisons" data-type="indexterm" id="idm44924591113776"/>, a callable to apply to each item (the comparisons are then performed on the callable’s results rather than on the items themselves); and <span class="code">default</span>, the value to return when the iterable is empty (when the iterable is empty and you supply no default argument, the function raises<a contenteditable="false" data-primary="ValueError" data-type="indexterm" id="idm44924591111424"/><a contenteditable="false" data-primary="errors" data-secondary="ValueError" data-type="indexterm" id="idm44924591110320"/> <span class="code">ValueError</span>). For example, <span class="code">max('who', 'why', 'what', key=len)</span> returns <span class="code">'what'</span>.</p>
<p>The built-in <span class="code">sum</span> function takes one argument, an iterable whose items are numbers, and returns the sum of the numbers.</p>
<section data-pdf-bookmark="Sequence conversions" data-type="sect3"><div class="sect3" id="sequence_conversions">
<h3>Sequence conversions</h3>
<p>There is no implicit conversion between different sequence types. You can call the built-ins <span class="code">tuple</span> and <span class="code">list</span> with a single argument (any iterable) to get a new instance of the type you’re calling, with the same items, in the same order, as in the argument.</p>
</div></section>
<section data-pdf-bookmark="Concatenation and repetition" data-type="sect3"><div class="sect3" id="concatenation_and_repetition">
<h3>Concatenation and repetition</h3>
<p>You<a contenteditable="false" data-primary="concatenation" data-type="indexterm" id="idm44924591100336"/><a contenteditable="false" data-primary="repetition" data-type="indexterm" id="idm44924591098816"/> can concatenate sequences of the same type with the<a contenteditable="false" data-primary="+ (plus sign)" data-type="indexterm" id="idm44924591097584"/><a contenteditable="false" data-primary="plus sign (+)" data-type="indexterm" id="idm44924591096480"/> <span class="code">+</span> operator. You can multiply a sequence <span class="code"><em>S</em></span> by an integer <span class="code"><em>n</em></span> with the<a contenteditable="false" data-primary="* (asterisk)" data-secondary="concatenation and repetition" data-type="indexterm" id="idm44924591092832"/><a contenteditable="false" data-primary="asterisk (*)" data-secondary="concatenation and repetition" data-type="indexterm" id="idm44924591091440"/> <span class="code">*</span> operator. <span class="code"><em>S</em></span><span class="code">*</span><span class="code"><em>n</em></span> is the concatenation of <span class="code"><em>n</em></span> copies of <span class="code"><em>S</em></span>. When <span class="code"><em>n</em></span> <span class="code">&lt;=</span> <span class="code">0</span>, <span class="code"><em>S</em></span> <span class="code">*</span> <span class="code"><em>n</em></span> is an empty sequence of the same type as <span class="code"><em>S</em></span>.</p>
</div></section>
<section data-pdf-bookmark="Membership testing" data-type="sect3"><div class="sect3" id="membership_testing">
<h3>Membership testing</h3>
<p>The<a contenteditable="false" data-primary="membership testing" data-type="indexterm" id="idm44924571319712"/><a contenteditable="false" data-primary="in keyword" data-secondary="membership testing" data-type="indexterm" id="idm44924571317856"/> <span class="code"><em>x</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em></span> operator tests to check whether the object <span class="code"><em>x</em></span> equals any item in the sequence (or other kind of container or iterable) <span class="code"><em>S</em></span>. It returns <span class="code"><strong>True</strong></span> when it does and <span class="code"><strong>False</strong></span> when it doesn’t. The <span class="code"><em>x</em></span> <span class="code"><strong>not in</strong></span> <span class="code"><em>S</em></span> operator is equivalent to <span class="code"><strong>not</strong></span> <span class="code">(<em>x</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em>)</span>. For dictionaries, <span class="code"><em>x</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em></span> tests for the presence of <span class="code"><em>x</em></span> as a key. In the specific case of strings, <span class="code"><em>x</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em></span> may match more than expected; in this case, <span class="code"><em>x</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em></span> tests whether <span class="code"><em>x</em></span> equals any <em>substring</em> of <span class="code"><em>S</em></span>, not just any single character.</p>
</div></section>
<section data-pdf-bookmark="Indexing a sequence" data-type="sect3"><div class="sect3" id="indexing_a_sequence">
<h3>Indexing a sequence</h3>
<p>To<a contenteditable="false" data-primary="indexing" data-secondary="sequences" data-type="indexterm" id="idm44924571292208"/> denote the <span class="code"><em>n</em></span>th item of a sequence <span class="code"><em>S</em></span>, use indexing: <span class="code"><em>S</em></span><span class="code">[<em>n</em>]</span>. Indexing is zero-based: <span class="code"><em>S</em></span>’s first item is <span class="code"><em>S</em></span><span class="code">[0]</span>. If <span class="code"><em>S</em></span> has <span class="code"><em>L</em></span> items, the index <span class="code"><em>n</em></span> may be <span class="code">0</span>, <span class="code">1</span>… up to and including <span class="code"><em>L</em></span><span class="code">-1</span>, but no larger. <span class="code"><em>n</em></span> may also be <span class="code">–1</span>, <span class="code">–2</span>… down to and including <span class="code"><em>-L</em></span>, but no smaller. A negative <span class="code"><em>n</em></span> (e.g., <span class="code">–1</span>) denotes the same item in <span class="code"><em>S</em></span> as <span class="code"><em>L</em></span><span class="code">+<em>n</em></span> (e.g., <span class="code"><em>L</em></span><span class="code">-1</span>) does. In other words, <span class="code"><em>S</em>[-1]</span>, like <span class="code">S[<em>L</em>-1]</span>, is the last element of <span class="code"><em>S</em></span>, <span class="code"><em>S</em></span><span class="code">[-2]</span> is the next-to-last one, and so on. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">20</code><code class="p">,</code><code> </code><code class="mi">30</code><code class="p">,</code><code> </code><code class="mi">40</code><code class="p">]</code><code>
</code><code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code>                  </code><em><code class="c1"># 20</code></em><code>
</code><code class="n">x</code><code class="p">[</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code><code>                 </code><em><code class="c1"># 40</code></em></pre>
<p>Using an index <span class="code">&gt;=</span><span class="code"><em>L</em></span> or <span class="code">&lt;-</span><span class="code"><em>L</em></span> raises an exception. Assigning to an item with an invalid index also raises an exception. You can add elements to a list, but to do so you assign to a slice, not to an item, as we’ll discuss shortly.</p>
</div></section>
<section data-pdf-bookmark="Slicing a sequence" data-type="sect3"><div class="sect3" id="slicing_a_sequence">
<h3>Slicing a sequence</h3>
<p>To<a contenteditable="false" data-primary="slicing" data-secondary="sequences" data-type="indexterm" id="idm44924571236816"/> indicate a subsequence of <span class="code"><em>S</em></span>, you can use slicing, with the<a contenteditable="false" data-primary="[] (brackets)" data-primary-sortas="|[] brackets" data-secondary="slicing a sequence" data-type="indexterm" id="idm44924571209296"/><a contenteditable="false" data-primary="brackets ([])" data-secondary="slicing a sequence" data-type="indexterm" id="idm44924571207680"/> syntax <span class="code">S[<em>i</em>:<em>j</em>]</span>, where <span class="code"><em>i</em></span> and <span class="code"><em>j</em></span> are integers. <span class="code">S[<em>i</em>:<em>j</em>]</span> is the subsequence of <span class="code"><em>S</em></span> from the <span class="code"><em>i</em></span>th item, included, to the <span class="code"><em>j</em></span>th item, excluded (in Python, ranges always include the lower bound and exclude the upper bound). A slice is an empty subsequence when <span class="code"><em>j</em></span> is less than or equal to <span class="code"><em>i</em></span>, or when <span class="code"><em>i</em></span> is greater than or equal to <span class="code"><em>L</em></span>, the length of <span class="code"><em>S</em></span>. You can omit <span class="code"><em>i</em></span> when it is equal to <span class="code">0</span>, so that the slice begins from the start of <span class="code"><em>S</em></span>. You can omit <span class="code"><em>j</em></span> when it is greater than or equal to <span class="code"><em>L</em></span>, so that the slice extends all the way to the end of <span class="code"><em>S</em></span>. You can even omit both indices, to mean a shallow copy of the entire sequence: <span class="code"><em>S</em></span><span class="code">[:]</span>. Either or both indices may be less than zero. Here are some examples:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">20</code><code class="p">,</code><code> </code><code class="mi">30</code><code class="p">,</code><code> </code><code class="mi">40</code><code class="p">]</code><code>
</code><code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="mi">3</code><code class="p">]</code><code>                   </code><em><code class="c1"># [20, 30]</code></em><code>
</code><code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="p">]</code><code>                    </code><em><code class="c1"># [20, 30, 40]</code></em><code>
</code><code class="n">x</code><code class="p">[</code><code class="p">:</code><code class="mi">2</code><code class="p">]</code><code>                    </code><em><code class="c1"># [10, 20]</code></em></pre>
<p>A negative index <span class="code"><em>n</em></span> in slicing indicates the same spot in <span class="code"><em>S</em></span> as <span class="code"><em>L</em></span><span class="code">+</span><span class="code"><em>n</em></span>, just like it does in indexing. An index greater than or equal to <span class="code"><em>L</em></span> means the end of <span class="code"><em>S</em></span>, while a negative index less than or equal to <span class="code"><em>-L</em></span> means the start of <span class="code"><em>S</em></span>.</p>
<p class="pagebreak-before">Slicing can use the extended syntax <span class="code"><em>S</em></span><span class="code">[<em>i</em>:<em>j</em>:<em>k</em>]</span>. <span class="code"><em>k</em></span> is the <em>stride</em> of the slice, meaning the distance between successive indices. <span class="code"><em>S</em></span><span class="code">[<em>i</em>:<em>j</em>]</span> is equivalent to <span class="code"><em>S</em></span><span class="code">[<em>i</em>:<em>j</em>:<em>1</em>]</span>, <span class="code"><em>S</em></span><span class="code">[::2]</span> is the subsequence of <span class="code"><em>S</em></span> that includes all items that have an even index in <span class="code"><em>S</em></span>, and <span class="code"><em>S</em></span><span class="code">[::-1]</span> is a slicing, also whimsically known as “the Martian smiley,” with the same items as <span class="code"><em>S</em></span> but in reverse order. With a negative stride, in order to have a nonempty slice, the second (“stop”) index needs to be <em>smaller</em> than the first (“start”) one—the reverse of the condition that must hold when the stride is positive. A stride of <span class="code">0</span> raises an exception. Here are some examples:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="nb">list</code><code class="p">(</code><code class="nb">range</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code class="p">)</code><code>  </code><em><code class="c1"># values from 0-9</code></em><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">y</code><code class="p">[</code><code class="o">-</code><code class="mi">5</code><code class="p">:</code><code class="p">]</code><code>               </code><em><code class="c1"># last five items</code></em></pre>
<pre data-type="programlisting">
<strong>[5, 6, 7, 8, 9]</strong></pre>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">y</code><code class="p">[</code><code class="p">:</code><code class="p">:</code><code class="mi">2</code><code class="p">]</code><code>               </code><em><code class="c1"># every other item</code></em></pre>
<pre data-type="programlisting">
<strong>[0, 2, 4, 6, 8]</strong></pre>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">y</code><code class="p">[</code><code class="mi">10</code><code class="p">:</code><code class="mi">0</code><code class="p">:</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code><code>           </code><em><code class="c1"># every other item, in reverse order</code></em></pre>
<pre data-type="programlisting">
<strong>[9, 7, 5, 3, 1]</strong></pre>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">y</code><code class="p">[</code><code class="p">:</code><code class="mi">0</code><code class="p">:</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code><code>             </code><em><code class="c1"># every other item, in reverse order (simpler)</code></em></pre>
<pre data-type="programlisting">
<strong>[9, 7, 5, 3, 1]</strong></pre>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">y</code><code class="p">[</code><code class="p">:</code><code class="p">:</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code><code>              </code><em><code class="c1"># every other item, in reverse order (best)</code></em></pre>
<pre data-type="programlisting">
<strong>[9, 7, 5, 3, 1]</strong></pre>
</div></section>
</div></section>
<section data-pdf-bookmark="Strings" data-type="sect2"><div class="sect2" id="strings">
<h2>Strings</h2>
<p>String objects<a contenteditable="false" data-primary="sequence operations" data-secondary="strings" data-type="indexterm" id="idm44924576635152"/><a contenteditable="false" data-primary="strings" data-secondary="sequence operations" data-type="indexterm" id="idm44924576633360"/> (both <span class="code">str</span> and <span class="code">bytes</span>) are immutable: attempting to rebind or delete an item or slice of a string raises an exception. (Python also has a built-in type that is mutable but otherwise equivalent to <span class="code">bytes</span>: <span class="code">bytearray</span> (see <a data-type="xref" href="#bytearray_objects">“bytearray objects”</a>). The items of a text string (each of the characters in the string) are themselves text strings, each of length 1—Python has no special data type for “single characters” (the items of a <span class="code">bytes</span> or <span class="code">bytearray</span> object are <span class="code">int</span>s). All slices of a string are strings of the same kind. String objects have many methods, covered in <a data-type="xref" href="ch09.xhtml#methods_of_string_objects">“Methods of String Objects”</a>.</p>
</div></section>
<section data-pdf-bookmark="Tuples" data-type="sect2"><div class="sect2" id="tuples">
<h2>Tuples</h2>
<p>Tuple<a contenteditable="false" data-primary="sequence operations" data-secondary="tuples" data-type="indexterm" id="idm44924576603872"/><a contenteditable="false" data-primary="tuples" data-type="indexterm" id="idm44924576602464"/><a contenteditable="false" data-primary="data types" data-secondary="tuples" data-type="indexterm" id="idm44924576601360"/> objects are immutable: therefore, attempting to rebind or delete an item or slice of a tuple raises an exception. The items of a tuple are arbitrary objects and may be of different types; tuple items may be mutable, but we recommend not mutating them, as doing so can be confusing. The slices of a tuple are also tuples. Tuples have no normal (nonspecial) methods, except<a contenteditable="false" data-primary="count method" data-secondary="tuple type" data-type="indexterm" id="idm44924576599856"/> <span class="code">count</span> and <span class="code">index</span>, with the same meanings as for lists; they do have many of the special methods covered in <a data-type="xref" href="ch04.xhtml#special_methods">“Special Methods”</a>.</p>
</div></section>
<section data-pdf-bookmark="Lists" data-type="sect2"><div class="sect2" id="lists">
<h2>Lists</h2>
<p>List<a contenteditable="false" data-primary="sequence operations" data-secondary="lists" data-type="indexterm" id="idm44924576593840"/> objects are mutable: you may rebind or delete items and slices of a list. Items of a list are arbitrary objects and may be of different types. Slices of a list are lists.</p>
<section data-pdf-bookmark="Modifying a list" data-type="sect3"><div class="sect3" id="modifying_a_list">
<h3>Modifying a list</h3>
<p>You<a contenteditable="false" data-primary="lists" data-secondary="modifying" data-type="indexterm" id="idm44924576590176"/> can modify (rebind) a single item in a list by assigning to an indexing. For instance:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">]</code><code>
</code><code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">42</code><code>                </code><em><code class="c1"># x is now [1, 42, 3, 4]</code></em></pre>
<p>Another way to modify a list object <span class="code"><em>L</em></span> is to use a slice of <span class="code"><em>L</em></span> as the target (LHS) of an assignment statement. The RHS of the assignment must be an iterable. When the LHS slice is in extended form (i.e., the slicing specifies a stride other than <span class="code">1</span>), then the RHS must have just as many items as the number of items in the LHS slice. When the LHS slicing does not specify a stride, or explicitly specifies a stride of <span class="code">1</span>, the LHS slice and the RHS may each be of any length; assigning to such a slice of a list can make the list longer or shorter. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">10</code><code class="p">,</code><code> </code><code class="mi">20</code><code class="p">,</code><code> </code><code class="mi">30</code><code class="p">,</code><code> </code><code class="mi">40</code><code class="p">,</code><code> </code><code class="mi">50</code><code class="p">]</code><code>
</code><em><code class="c1"># replace items 1 and 2</code></em><code>
</code><code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="mi">3</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">22</code><code class="p">,</code><code> </code><code class="mi">33</code><code class="p">,</code><code> </code><code class="mi">44</code><code class="p">]</code><code>    </code><em><code class="c1"># x is now [10, 22, 33, 44, 40, 50]</code></em><code>
</code><em><code class="c1"># replace items 1-3</code></em><code>
</code><code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="mi">4</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">88</code><code class="p">,</code><code> </code><code class="mi">99</code><code class="p">]</code><code>        </code><em><code class="c1"># x is now [10, 88, 99, 40, 50]</code></em></pre>
<p>There are some important special cases of assignment to slices:</p>
<ul>
<li>
<p>Using the empty list <span class="code">[]</span> as the RHS expression removes the target slice from <span class="code"><em>L</em></span>. In other words, <span class="code"><em>L</em></span><span class="code">[<em>i</em>:<em>j</em>] = []</span> has the same effect as <span class="code"><strong>del</strong></span> <span class="code"><em>L</em></span><span class="code">[<em>i</em>:<em>j</em>]</span> (or the peculiar statement <span class="code"><em>L</em></span><span class="code">[<em>i</em>:<em>j</em>] *= 0</span>).</p>
</li>
<li>
<p>Using an empty slice of <span class="code"><em>L</em></span> as the LHS target inserts the items of the RHS at the appropriate spot in <span class="code"><em>L</em></span>. For example, <span class="code"><em>L</em></span><span class="code">[<em>i</em>:<em>i</em>] = ['a', 'b']</span> inserts <span class="code">'a'</span> and <span class="code">'b'</span> before the item that was at index <span class="code"><em>i</em></span> in <span class="code"><em>L</em></span> prior to the assignment.</p>
</li>
<li>
<p>Using a slice that covers the entire list object, <span class="code"><em>L</em></span><span class="code">[:]</span>, as the LHS target totally replaces the contents of <span class="code"><em>L</em></span>.</p>
</li>
</ul>
<p>You can delete an item or a slice from a list with <span class="code"><strong>del</strong></span>. For instance:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">]</code><code>
</code><strong><code class="k">del</code></strong><code> </code><code class="n">x</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code>                 </code><em><code class="c1"># x is now [1, 3, 4, 5]</code></em><code>
</code><strong><code class="k">del</code></strong><code> </code><code class="n">x</code><code class="p">[</code><code class="p">:</code><code class="p">:</code><code class="mi">2</code><code class="p">]</code><code>               </code><em><code class="c1"># x is now [3, 5]</code></em></pre>
</div></section>
<section data-pdf-bookmark="In-place operations on a list" data-type="sect3"><div class="sect3" id="in_place_operations_on_a_list">
<h3>In-place operations on a list</h3>
<p>List<a contenteditable="false" data-primary="lists" data-secondary="in-place operations on" data-type="indexterm" id="idm44924576406528"/> objects define in-place versions of the <span class="code">+</span> and <span class="code">*</span> operators, which you can use via augmented assignment statements. The augmented assignment statement <span class="code"><em>L</em></span> <span class="code">+=</span> <span class="code"><em>L1</em></span> has the effect of adding the items of the iterable <span class="code"><em>L1</em></span> to the end of <span class="code"><em>L</em></span>, just like <span class="code"><em>L</em></span><span class="code">.extend(<em>L1</em>)</span>. <span class="code"><em>L</em></span> <span class="code">*=</span> <span class="code"><em>n</em></span> has the effect of adding <span class="code"><em>n</em></span><span class="code">-1</span> copies of <span class="code"><em>L</em></span> to the end of <span class="code"><em>L</em></span>; if <span class="code"><em>n</em></span> <span class="code">&lt;= 0</span>, <span class="code"><em>L</em></span> <span class="code">*=</span> <span class="code"><em>n</em></span> makes <span class="code"><em>L</em></span> empty, like<a contenteditable="false" data-primary="[] (brackets)" data-primary-sortas="|[] brackets" data-secondary="in-place list operations" data-type="indexterm" id="idm44924576364400"/><a contenteditable="false" data-primary="brackets ([])" data-secondary="in-place list operations" data-type="indexterm" id="idm44924576362736"/> <span class="code"><em>L</em></span><span class="code">[:] = []</span> or <span class="code"><strong>del</strong></span> <span class="code"><em>L</em></span><span class="code">[:]</span>.</p>
</div></section>
<section data-pdf-bookmark="List methods" data-type="sect3"><div class="sect3" id="list_methods">
<h3>List methods</h3>
<p>List objects<a contenteditable="false" data-primary="lists" data-secondary="methods" data-type="indexterm" id="idm44924576355920"/> provide several methods, as shown in <a data-type="xref" href="#list_object_methods">Table 3-5</a>. Nonmutating methods return a result without altering the object to which they apply, while mutating methods may alter the object to which they apply. Many of a list’s mutating methods behave like assignments to appropriate slices of the list. In this table, <span class="code"><em>L</em></span> indicates any list object, <span class="code"><em>i</em></span> any valid index in <span class="code"><em>L</em></span>, <span class="code"><em>s</em></span> any iterable, and <span class="code"><em>x</em></span> any object.</p>
<table class="border" id="list_object_methods">
<caption><span class="label">Table 3-5. </span>List object methods</caption>
<tbody>
<tr>
<td><strong>Nonmutating</strong></td>
<td> </td>
</tr>
<tr>
<td><span class="code">count</span></td>
<td><span class="code"><em>L</em></span><span class="code">.count(<em>x</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="count method" data-secondary="list type" data-type="indexterm" id="idm44924576342416"/> the number of items of <span class="code"><em>L</em></span> that are equal to <span class="code"><em>x</em></span>.</td>
</tr>
<tr>
<td><span class="code">index</span></td>
<td><span class="code"><em>L</em></span><span class="code">.index(<em>x</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="index (list method)" data-type="indexterm" id="idm44924576335424"/> the index of the first occurrence of an item in <span class="code"><em>L</em></span> that is equal to <span class="code"><em>x</em></span>, or raises an exception if <span class="code"><em>L</em></span> has no such item.</td>
</tr>
<tr>
<td><strong>Mutating</strong></td>
<td> </td>
</tr>
<tr>
<td><span class="code">append</span></td>
<td><span class="code"><em>L.</em></span><span class="code">append(<em>x</em>)</span><br/>
			Appends<a contenteditable="false" data-primary="append method" data-secondary="list" data-type="indexterm" id="idm44924576326544"/> item <span class="code"><em>x</em></span> to the end of <span class="code"><em>L</em></span> ; like <span class="code"><em>L</em></span><span class="code">[len(<em>L</em>):] = [x]</span>.</td>
</tr>
<tr>
<td><span class="code">clear</span></td>
<td><span class="code"><em>L.</em></span><span class="code">clear()</span><br/>
			Removes<a contenteditable="false" data-primary="clear method" data-secondary="list type" data-type="indexterm" id="idm44924576318464"/> all items from <span class="code"><em>L</em></span>, leaving <span class="code"><em>L</em></span> empty.</td>
</tr>
<tr>
<td><span class="code">extend</span></td>
<td><span class="code"><em>L.</em></span><span class="code">extend(<em>s</em>)</span><br/>
			Appends<a contenteditable="false" data-primary="extend method" data-secondary="list" data-type="indexterm" id="idm44924576311264"/> all the items of iterable <span class="code"><em>s</em></span> to the end of <span class="code"><em>L</em></span>; like <span class="code"><em>L</em></span><span class="code">[len(<em>L</em>):] =</span> <span class="code"><em>s</em></span> or <span class="code"><em>L</em></span> <span class="code">+=</span> <span class="code"><em>s</em></span>.</td>
</tr>
<tr>
<td><span class="code">insert</span></td>
<td><span class="code"><em>L.</em></span><span class="code">insert(<em>i</em>,</span> <span class="code"><em>x</em></span><span class="code">)</span><br/>
			Inserts<a contenteditable="false" data-primary="insert (list method)" data-type="indexterm" id="idm44924576297952"/> item <span class="code"><em>x</em></span> in <span class="code"><em>L</em></span> before the item at index <span class="code"><em>i</em></span>, moving following items of <span class="code"><em>L</em></span> (if any) “rightward” to make space (increases <span class="code">len(<em>L</em>)</span> by one, does not replace any item, does not raise exceptions; acts just like <span class="code"><em>L</em></span><span class="code">[<em>i</em>:<em>i</em>]=[<em>x</em>]</span>).</td>
</tr>
<tr>
<td><span class="code">pop</span></td>
<td><span class="code"><em>L.</em></span><span class="code">pop(<em>i</em>=-1)</span><br/>
			Returns<a contenteditable="false" data-primary="pop method" data-secondary="list type" data-type="indexterm" id="idm44924576286192"/> the value of the item at index <span class="code"><em>i</em></span> and removes it from <span class="code"><em>L</em></span>; when you omit <span class="code"><em>i</em></span>, removes and returns the last item; raises an exception when <span class="code"><em>L</em></span> is empty or <span class="code"><em>i</em></span> is an invalid index in <span class="code"><em>L</em></span>.</td>
</tr>
<tr>
<td><span class="code">remove</span></td>
<td><span class="code"><em>L.</em></span><span class="code">remove(<em>x</em>)</span><br/>
			Removes<a contenteditable="false" data-primary="remove method" data-secondary="list type" data-type="indexterm" id="idm44924576276000"/> from <span class="code"><em>L</em></span> the first occurrence of an item in <span class="code"><em>L</em></span> that is equal to <span class="code"><em>x</em></span>, or raises an exception when <span class="code"><em>L</em></span> has no such item.</td>
</tr>
<tr>
<td><span class="code">reverse</span></td>
<td><span class="code"><em>L.</em></span><span class="code">reverse()</span><br/>
			Reverses,<a contenteditable="false" data-primary="reverse (list method)" data-type="indexterm" id="idm44924576268144"/> in place, the items of <span class="code"><em>L</em></span>.</td>
</tr>
<tr>
<td><span class="code">sort</span></td>
<td><span class="code"><em>L.</em></span><span class="code">sort<em>(</em>key<em>=</em><strong>None</strong></span><span class="code">,</span> <span class="code">reverse<em>=</em><strong>False</strong></span><span class="code">)</span><br/>
			Sorts,<a contenteditable="false" data-primary="sort (list method)" data-type="indexterm" id="idm44924588244320"/> in place, the items of <span class="code"><em>L</em></span> (in ascending order, by default; in descending order, if the argument <span class="code">reverse</span> is <span class="code"><strong>True</strong></span>). When the argument <span class="code">key</span><a contenteditable="false" data-primary="key argument" data-secondary="sorting" data-type="indexterm" id="idm44924588240144"/> is not <span class="code"><strong>None</strong></span>, what gets compared for each item <span class="code"><em>x</em></span> is <span class="code">key(<em>x</em>)</span>, not <span class="code"><em>x</em></span> itself. For more details, see the following section.</td>
</tr>
</tbody>
</table>
<p>All mutating methods of list objects, except <span class="code">pop</span>, return <span class="code"><strong>None</strong></span>.</p>
</div></section>
<section data-pdf-bookmark="Sorting a list" data-type="sect3"><div class="sect3" id="sorting_a_list">
<h3>Sorting a list</h3>
<p>A<a contenteditable="false" data-primary="lists" data-secondary="sorting" data-type="indexterm" id="idm44924588230800"/> list’s <span class="code">sort</span> method causes the list to be sorted in place (reordering items to place them in increasing order) in a way that is guaranteed to be stable (elements that compare equal are not exchanged). In practice, <span class="code">sort</span> is extremely fast—often <em>preternaturally</em> fast, as it can exploit any order or reverse order that may be present in any sublist (the advanced algorithm <span class="code">sort</span> uses, known as<a contenteditable="false" data-primary="timsort algorithm" data-type="indexterm" id="idm44924588226624"/> <em>timsort</em><sup><a data-type="noteref" href="ch03.xhtml#ch01fn36" id="ch01fn36-marker">17</a></sup> to honor its inventor, great Pythonista <a href="https://oreil.ly/Cbu-F">Tim Peters</a>, is a “non-recursive adaptive stable natural mergesort/binary insertion sort hybrid”—now <em>there’s</em> a mouthful for you!).</p>
<p>The <span class="code">sort</span> method takes two optional arguments, which may be passed with either positional or named-argument syntax. The argument <span class="code">key</span>, if not <span class="code"><strong>None</strong></span>, must be a function that can be called with any list item as its only argument. In this case, to compare any two items <span class="code"><em>x</em></span> and <span class="code"><em>y</em></span>, Python compares <span class="code">key(<em>x</em>)</span> and <span class="code">key(<em>y</em>)</span> rather than <span class="code"><em>x</em></span> and <span class="code"><em>y</em></span> (internally, Python implements this in the same way as the decorate–sort–undecorate idiom presented in <a data-type="xref" href="ch17.xhtml#searching_and_sorting">“Searching and sorting”</a>, but it’s much faster). The argument <span class="code">reverse</span>, if <span class="code"><strong>True</strong></span>, causes the result of each comparison to be reversed; this is not exactly the same thing as reversing <span class="code"><em>L</em></span> after sorting, because the sort is stable (elements that compare equal are never exchanged) whether the argument <span class="code">reverse</span> is <span class="code"><strong>True</strong></span> or <span class="code"><strong>False</strong></span>. In other words, Python sorts the list in ascending order by default, or in descending order if <span class="code">reverse</span> is <span class="code"><strong>True</strong></span>:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">mylist</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">alpha</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Beta</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">GAMMA</code><code class="s1">'</code><code class="p">]</code><code>
</code><code class="n">mylist</code><code class="o">.</code><code class="n">sort</code><code class="p">(</code><code class="p">)</code><code>                  </code><em><code class="c1"># ['Beta', 'GAMMA', 'alpha']</code></em><code>
</code><code class="n">mylist</code><code class="o">.</code><code class="n">sort</code><code class="p">(</code><code class="n">key</code><code class="o">=</code><code class="nb">str</code><code class="o">.</code><code class="n">lower</code><code class="p">)</code><code>     </code><em><code class="c1"># ['alpha', 'Beta', 'GAMMA']</code></em></pre>
<p>Python also provides the built-in function <span class="code">sorted</span> (covered in <a data-type="xref" href="ch08.xhtml#pythonapostrophes_core_built_in_functio">Table 8-2</a>) to produce a sorted list from any input iterable. <span class="code">sorted</span>, after the first argument (which is the iterable supplying the items), accepts the same two optional arguments as a list’s <span class="code">sort</span> method.</p>
<p>The standard library module <span class="code">operator</span> (covered in <a data-type="xref" href="ch16.xhtml#the_operator_module">“The operator Module”</a>) supplies higher-order functions <span class="code">attrgetter</span>, <span class="code">itemgetter</span>, and <span class="code">methodcaller</span>, which produce functions particularly suitable for the optional <span class="code">key</span> argument of the list’s <span class="code">sort</span> method and the built-in function <span class="code">sorted</span>. This optional argument also exists, with exactly the same meaning, for the built-in functions <span class="code">min</span> and <span class="code">max</span>, as well as for the functions <span class="code">nsmallest</span>, <span class="code">nlargest</span>, and <span class="code">merge</span> in the standard library module <span class="code">heapq</span> (covered in <a data-type="xref" href="ch08.xhtml#the_heapq_module">“The heapq Module”</a>) and the class <span class="code">groupby</span> in the standard library module <span class="code">itertools</span> (covered in <a data-type="xref" href="ch08.xhtml#the_itertools_module">“The itertools Module”</a>).<a contenteditable="false" data-primary="" data-startref="seqop03" data-type="indexterm" id="idm44924588129440"/><a contenteditable="false" data-primary="" data-startref="PLseq03" data-type="indexterm" id="idm44924588128032"/></p>
</div></section>
</div></section>
</div></section>
<section data-pdf-bookmark="Set Operations" data-type="sect1"><div class="sect1" id="set_operation">
<h1>Set Operations</h1>
<p>Python<a contenteditable="false" data-primary="Python language" data-secondary="set operations" data-type="indexterm" id="PLset03"/> provides a variety of operations applicable to sets (both plain and frozen). Since sets are containers, the built-in <span class="code">len</span> function can take a set as its single argument and return the number of items in the set. A set is iterable, so you can pass it to any function or method that takes an iterable argument. In this case, iteration yields the items of the set in some arbitrary order. For example, for any set <span class="code"><em>S</em></span>, <span class="code">min(<em>S</em>)</span> returns the smallest item in <span class="code"><em>S</em></span>, since <span class="code">min</span> with a single argument iterates on that argument (the order does not matter, because the implied comparisons are transitive).</p>
<section data-pdf-bookmark="Set Membership" data-type="sect2"><div class="sect2" id="set_membership">
<h2>Set Membership</h2>
<p>The <span class="code"><em>k</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em></span> operator checks<a contenteditable="false" data-primary="set operations" data-secondary="set membership" data-type="indexterm" id="idm44924588114112"/><a contenteditable="false" data-primary="in keyword" data-secondary="set membership" data-type="indexterm" id="idm44924588112736"/> whether the object <span class="code"><em>k</em></span> equals one of the items in the set <span class="code"><em>S</em></span>. It returns <span class="code"><strong>True</strong></span> when the set contains <span class="code"><em>k</em></span>, and <span class="code"><strong>False</strong></span> when it doesn’t. <span class="code"><em>k</em></span> <span class="code"><strong>not</strong></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em></span> is like <span class="code"><strong>not</strong></span> <span class="code">(<em>k</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>S</em>)</span>.</p>
</div></section>
<section data-pdf-bookmark="Set Methods" data-type="sect2"><div class="sect2" id="set_methods">
<h2>Set Methods</h2>
<p>Set objects<a contenteditable="false" data-primary="set operations" data-secondary="set methods" data-type="indexterm" id="idm44924588097664"/> provide several methods, as shown in <a data-type="xref" href="#set_object_methods">Table 3-6</a>. Nonmutating methods return a result without altering the object to which they apply, and can also be called on instances of <span class="code">frozenset</span>; mutating methods may alter the object to which they apply, and can be called only on instances of <span class="code">set</span>. In this table, <span class="code"><em>s</em></span> denotes any set object, <span class="code"><em>s1</em></span> any iterable with hashable items (often but not necessarily a <span class="code">set</span> or <span class="code">frozenset</span>), and <span class="code"><em>x</em></span> any hashable object.</p>
<table class="border" id="set_object_methods">
<caption><span class="label">Table 3-6. </span>Set object methods</caption>
<tbody>
<tr>
<td><strong>Nonmutating</strong></td>
<td> </td>
</tr>
<tr>
<td><span class="code">copy</span></td>
<td><span class="code"><em>s</em></span><span class="code">.copy()</span><br/>
			Returns<a contenteditable="false" data-primary="copy method" data-secondary="set type" data-type="indexterm" id="idm44924588083072"/> a shallow copy of <span class="code"><em>s</em></span> (a copy whose items are the same objects as <span class="code"><em>s</em></span>’s, not copies thereof); like <span class="code">set(<em>s</em>)</span></td>
</tr>
<tr>
<td><span class="code">difference</span></td>
<td><span class="code"><em>s</em></span><span class="code">.difference(<em>s1</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="difference (set method)" data-type="indexterm" id="idm44924588075168"/> the set of all items of <span class="code"><em>s</em></span> that aren’t in <span class="code"><em>s1</em></span>; can be written as <span class="code"><em>s</em></span> <span class="code">-</span> <span class="code"><em>s1</em></span></td>
</tr>
<tr>
<td><span class="code">intersection</span></td>
<td><span class="code"><em>s</em></span><span class="code">.intersection(<em>s1</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="intersection (set method)" data-type="indexterm" id="idm44924588066320"/> the set of all items of <span class="code"><em>s</em></span> that are also in <span class="code"><em>s1</em></span>; can be written as <span class="code"><em>s</em></span> <span class="code">&amp;</span> <span class="code"><em>s1</em></span></td>
</tr>
<tr>
<td><span class="code">isdisjoint</span></td>
<td><span class="code"><em>s</em></span><span class="code">.isdisjoint(<em>s1</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="isdisjoint (set method)" data-type="indexterm" id="idm44924588057504"/> <span class="code"><strong>True</strong></span> if the intersection of <span class="code"><em>s</em></span> and <span class="code"><em>s1</em></span> is the empty set (they have no items in common), and otherwise returns <span class="code"><strong>False</strong></span></td>
</tr>
<tr>
<td><span class="code">issubset</span></td>
<td><span class="code"><em>s</em></span><span class="code">.issubset(<em>s1</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="issubset (set method)" data-type="indexterm" id="idm44924588049408"/> <span class="code"><strong>True</strong></span> when all items of <span class="code"><em>s</em></span> are also in <span class="code"><em>s1</em></span>, and otherwise returns <span class="code"><strong>False</strong></span>; can be written as <span class="code"><em>s</em></span> <span class="code">&lt;=</span> <span class="code"><em>s1</em></span></td>
</tr>
<tr>
<td><span class="code">issuperset</span></td>
<td><span class="code"><em>s</em></span><span class="code">.issuperset(<em>s1</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="issuperset (set method)" data-type="indexterm" id="idm44924588038688"/> <span class="code"><strong>True</strong></span> when all items of <span class="code"><em>s1</em></span> are also in <span class="code"><em>s</em></span>, and otherwise returns <span class="code"><strong>False</strong></span> (like <span class="code"><em>s1</em></span><span class="code">.issubset(<em>s</em>)</span>); can be written as <span class="code"><em>s</em></span> <span class="code">&gt;=</span> <span class="code"><em>s1</em></span></td>
</tr>
<tr>
<td><span class="code">symmet⁠r⁠i⁠c⁠_​d⁠i⁠f⁠ference</span></td>
<td><span class="code"><em>s</em></span><span class="code">.symmetric_difference(<em>s1</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="symmetric_difference (set method)" data-type="indexterm" id="idm44924588026512"/> the set of all items that are in either <span class="code"><em>s</em></span> or <span class="code"><em>s1</em></span>, but not both; can be written <span class="code keep-together"><em>s ^ s1</em></span></td>
</tr>
<tr>
<td><span class="code">union</span></td>
<td><span class="code"><em>s</em></span><span class="code">.union(<em>s1</em>)</span><br/>
			Returns<a contenteditable="false" data-primary="union (set method)" data-type="indexterm" id="idm44924588019264"/> the set of all items that are in <span class="code"><em>s</em></span>, <span class="code"><em>s1</em></span>, or both; can be written as <span class="code"><em>s</em></span> <span class="code">|</span> <span class="code"><em>s1</em></span></td>
</tr>
<tr>
<td><strong>Mutating</strong></td>
<td> </td>
</tr>
<tr>
<td><span class="code">add</span></td>
<td><span class="code"><em>s</em></span><span class="code">.add(<em>x</em>)</span><br/>
			Adds<a contenteditable="false" data-primary="add (set method)" data-type="indexterm" id="idm44924588008976"/> <span class="code"><em>x</em></span> as an item to <span class="code"><em>s</em></span>; no effect if <span class="code"><em>x</em></span> was already an item in <span class="code"><em>s</em></span></td>
</tr>
<tr>
<td><span class="code">clear</span></td>
<td><span class="code"><em>s</em></span><span class="code">.clear()</span><br/>
			Removes<a contenteditable="false" data-primary="clear method" data-secondary="set type" data-type="indexterm" id="idm44924588001520"/> all items from <span class="code"><em>s</em></span>, leaving <span class="code"><em>s</em></span> empty</td>
</tr>
<tr>
<td><span class="code">discard</span></td>
<td><span class="code"><em>s</em></span><span class="code">.discard(<em>x</em>)</span><br/>
			Removes<a contenteditable="false" data-primary="discard (set method)" data-type="indexterm" id="idm44924587994528"/> <span class="code"><em>x</em></span> as an item of <span class="code"><em>s</em></span>; no effect when <span class="code"><em>x</em></span> was not an item of <span class="code"><em>s</em></span></td>
</tr>
<tr>
<td><span class="code">pop</span></td>
<td><span class="code"><em>s</em></span><span class="code">.pop()</span><br/>
			Removes<a contenteditable="false" data-primary="pop method" data-secondary="set type" data-type="indexterm" id="idm44924587987040"/> and returns an arbitrary item of <span class="code"><em>s</em></span></td>
</tr>
<tr>
<td><span class="code">remove</span></td>
<td><span class="code"><em>s</em></span><span class="code">.remove(<em>x</em>)</span><br/>
			Removes<a contenteditable="false" data-primary="remove method" data-secondary="set type" data-type="indexterm" id="idm44924587981056"/> <span class="code"><em>x</em></span> as an item of <span class="code"><em>s</em></span>; raises a <span class="code">KeyError</span> exception when <span class="code"><em>x</em></span> was not an item of <span class="code"><em>s</em></span></td>
</tr>
</tbody>
</table>
<p>All mutating methods of set objects, except <span class="code">pop</span>, return <span class="code"><strong>None</strong></span>.</p>
<p>The <span class="code">pop</span> method can be used for destructive iteration on a set, consuming little extra memory. The memory savings make <span class="code">pop</span> usable for a loop on a huge set, when what you want is to “consume” the set in the course of the loop. Besides saving memory, a potential advantage of a destructive loop such as this:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">while</code></strong><code> </code><code class="n">S</code><code class="p">:</code><code>
</code><code>    </code><code class="n">item</code><code> </code><code class="o">=</code><code> </code><code class="n">S</code><code class="o">.</code><code class="n">pop</code><code class="p">(</code><code class="p">)</code><code>
</code><em><code>    </code><code class="c1"># ...handle item...</code></em></pre>
<p>in comparison to a nondestructive loop such as this:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">item</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">S</code><code class="p">:</code><code>
</code><em><code>    </code><code class="c1"># ...handle item...</code></em></pre>
<p>is that in the body of the destructive loop you’re allowed to modify <span class="code"><em>S</em></span> (adding and/or removing items), which is not allowed in the nondestructive loop.</p>
<p>Sets also have mutating methods named <span class="code">difference_update</span>, <span class="code">intersection_update</span>, <span class="code">symmetric_difference_update</span>, and <span class="code">update</span> (corresponding to the nonmutating method <span class="code">union</span>). Each such mutating method performs the same operation as the corresponding nonmutating method, but it performs the operation in place, altering the set on which you call it, and returns <span class="code"><strong>None</strong></span>.</p>
<p>The four corresponding nonmutating methods are also accessible with operator syntax (where <span class="code"><em>S2</em></span> is a <span class="code">set</span> or <span class="code">frozenset</span>, respectively, <span class="code"><em>S</em></span> <span class="code">-</span> <span class="code"><em>S2</em></span>, <span class="code"><em>S</em></span> <span class="code">&amp;</span> <span class="code"><em>S2</em></span>, <span class="code"><em>S</em></span> <span class="code">^</span> <span class="code"><em>S2</em></span>, and <span class="code"><em>S</em></span> <span class="code">|</span> <span class="code"><em>S2</em></span>) and the mutating methods are accessible with augmented assignment syntax (respectively, <span class="code"><em>S</em></span> <span class="code">-=</span> <span class="code"><em>S2</em></span>, <span class="code"><em>S</em></span> <span class="code">&amp;=</span> <span class="code"><em>S2</em></span>, <span class="code"><em>S</em></span> <span class="code">^=</span> <span class="code"><em>S2</em></span>, and <span class="code"><em>S</em></span> <span class="code">|=</span> <span class="code"><em>S2</em></span>). In addition, <span class="code">set</span>s and <span class="code">frozenset</span>s also support comparison operators: <span class="code">==</span> (the sets have the same items; that is, they’re “equal” sets), <span class="code">!=</span> (the reverse of <span class="code">==</span>), <span class="code">&gt;=</span> (<span class="code">issuperset</span>), <span class="code">&lt;=</span> (<span class="code">issubset</span>), <span class="code">&lt;</span> (<span class="code">issubset</span> and not equal), and <span class="code">&gt;</span> (<span class="code">issuperset</span> and not equal).</p>
<p>When you use operator or augmented assignment syntax, both operands must be <span class="code">set</span>s or <span class="code">frozenset</span>s; however, when you call named methods, argument <span class="code"><em>S1</em></span> can be any iterable with hashable items, and it works just as if the argument you passed was <span class="code">set(<em>S1</em>)</span>.<a contenteditable="false" data-primary="" data-startref="PLset03" data-type="indexterm" id="idm44924587865152"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Dictionary Operations" data-type="sect1"><div class="sect1" id="dictionary_operation">
<h1>Dictionary Operations</h1>
<p>Python<a contenteditable="false" data-primary="Python language" data-secondary="dictionary operations" data-type="indexterm" id="PLdict03"/><a contenteditable="false" data-primary="dictionary operations" data-type="indexterm" id="dictop03"/> provides a variety of operations applicable to dictionaries. Since dictionaries are containers, the built-in <span class="code">len</span> function can take a dictionary as its argument and return the number of items (key/value pairs) in the dictionary. A dictionary is iterable, so you can pass it to any function that takes an iterable argument. In this case, iteration yields only the keys of the dictionary, in insertion order. For example, for any dictionary <span class="code"><em>D</em></span>, <span class="code">min(<em>D</em>)</span> returns the smallest key in <span class="code"><em>D</em></span> (the order of keys in the iteration doesn’t matter here).</p>
<section data-pdf-bookmark="Dictionary Membership" data-type="sect2"><div class="sect2" id="dictionary_membership">
<h2>Dictionary Membership</h2>
<p>The <span class="code"><em>k</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>D</em></span> operator<a contenteditable="false" data-primary="dictionary operations" data-secondary="dictionary membership" data-type="indexterm" id="idm44924587485376"/><a contenteditable="false" data-primary="in keyword" data-secondary="dict membership" data-type="indexterm" id="idm44924587484000"/> checks whether the object <span class="code"><em>k</em></span> is a key in the dictionary <span class="code"><em>D</em></span>. <span class="keep-together">It returns</span> <span class="code"><strong>True</strong></span> if the key is present, and <span class="code"><strong>False</strong></span> otherwise. <span class="code"><em>k</em></span> <span class="code"><strong>not in</strong></span> <span class="code"><em>D</em></span> is like <span class="code"><strong>not</strong></span> <span class="keep-together"><span class="code">(<em>k</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>D</em>)</span></span>.</p>
</div></section>
<section data-pdf-bookmark="Indexing a Dictionary" data-type="sect2"><div class="sect2" id="indexing_a_dictionary">
<h2>Indexing a Dictionary</h2>
<p>To<a contenteditable="false" data-primary="dictionary operations" data-secondary="indexing dictionaries" data-type="indexterm" id="idm44924587469728"/><a contenteditable="false" data-primary="indexing" data-secondary="dictionaries" data-type="indexterm" id="idm44924587468320"/> denote the value in a<a contenteditable="false" data-primary="[] (brackets)" data-primary-sortas="|[] brackets" data-secondary="indexing a dictionary" data-type="indexterm" id="idm44924587466816"/><a contenteditable="false" data-primary="brackets ([])" data-secondary="indexing a dictionary" data-type="indexterm" id="idm44924587465136"/> dictionary <span class="code"><em>D</em></span> currently associated with the key <span class="code"><em>k</em></span>, use an indexing: <span class="code"><em>D</em></span><span class="code">[<em>k</em>]</span>. Indexing with a key that is not present in the dictionary raises an exception. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">d</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">:</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">h</code><code class="s1">'</code><code class="p">:</code><code class="mf">3.14</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">z</code><code class="s1">'</code><code class="p">:</code><code class="mi">7</code><code class="p">}</code><code>
</code><code class="n">d</code><code class="p">[</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">]</code><code>                         </code><em><code class="c1"># 42</code></em><code>
</code><code class="n">d</code><code class="p">[</code><code class="s1">'</code><code class="s1">z</code><code class="s1">'</code><code class="p">]</code><code>                         </code><em><code class="c1"># 7</code></em><code>
</code><code class="n">d</code><code class="p">[</code><code class="s1">'</code><code class="s1">a</code><code class="s1">'</code><code class="p">]</code><code>                         </code><em><code class="c1"># raises KeyError exception</code></em></pre>
<p>Plain assignment to a dictionary indexed with a key that is not yet in the dictionary (e.g., <span class="code"><em>D</em></span><span class="code">[<em>newkey</em>]=</span><span class="code"><em>value</em></span>) is a valid operation and adds the key and value as a new item in the dictionary. For instance:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">d</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">x</code><code class="s1">'</code><code class="p">:</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">h</code><code class="s1">'</code><code class="p">:</code><code class="mf">3.14</code><code class="p">}</code><code>
</code><code class="n">d</code><code class="p">[</code><code class="s1">'</code><code class="s1">a</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="mi">16</code><code>                    </code><em><code class="c1"># d is now {'x':42, 'h':3.14, 'a':16}</code></em></pre>
<p>The <span class="code"><strong>del</strong></span> statement, in the form <span class="code"><strong>del</strong></span> <span class="code"><em>D</em></span><span class="code">[<em>k</em>]</span>, removes from the dictionary the item whose key is <span class="code"><em>k</em></span>. When <span class="code"><em>k</em></span> is not a key in dictionary <span class="code"><em>D</em></span>, <span class="code"><strong>del</strong></span> <span class="code"><em>D</em></span><span class="code">[<em>k</em>]</span> raises a <span class="code">KeyError</span> exception.​</p>
</div></section>
<section data-pdf-bookmark="Dictionary Methods" data-type="sect2"><div class="sect2" id="dictionary_methods">
<h2>Dictionary Methods</h2>
<p>Dictionary objects<a contenteditable="false" data-primary="dictionary operations" data-secondary="dictionary methods" data-type="indexterm" id="idm44924587325584"/> provide several methods, as shown in <a data-type="xref" href="#dictionary_object_methods">Table 3-7</a>. Nonmutating methods return a result without altering the object to which they apply, while mutating methods may alter the object to which they apply. In this table, <span class="code"><em>d</em></span> and <span class="code"><em>d1</em></span> indicate any dictionary objects, <span class="code"><em>k</em></span> any hashable object, and <span class="code"><em>x</em></span> any object.</p>
<table class="border" id="dictionary_object_methods">
<caption><span class="label">Table 3-7. </span>Dictionary object methods</caption>
<tbody>
<tr>
<td><strong>Nonmutating</strong></td>
<td> </td>
</tr>
<tr>
<td><span class="code">copy</span></td>
<td><span class="code"><em>d.</em></span><span class="code">copy()</span><br/>
			Returns<a contenteditable="false" data-primary="copy method" data-secondary="dict type" data-type="indexterm" id="idm44924587313168"/> a shallow copy of the dictionary (a copy whose items are the same objects as <span class="code"><em>D</em></span>’s, not copies thereof, just like <span class="code">dict(<em>d</em>)</span>)</td>
</tr>
<tr>
<td><span class="code">get</span></td>
<td><span class="code"><em>d.</em></span><span class="code">get(<em>k</em>[,</span> <span class="code"><em>x</em></span><span class="code">])</span><br/>
			Returns<a contenteditable="false" data-primary="get (dict method)" data-type="indexterm" id="idm44924587304304"/> <span class="code"><em>d</em></span><span class="code">[<em>k</em>]</span> when <span class="code"><em>k</em></span> is a key in <span class="code"><em>d</em></span>; otherwise, returns <span class="code"><em>x</em></span> (or <span class="code"><strong>None</strong></span>, when you don’t pass <span class="code"><em>x</em></span>)</td>
</tr>
<tr>
<td><span class="code">items</span></td>
<td><span class="code"><em>d</em></span><span class="code">.items()</span><br/>
			Returns<a contenteditable="false" data-primary="items (dict method)" data-type="indexterm" id="idm44924587294256"/> an iterable view object whose items are all current items (key/value pairs) in <span class="code"><em>d</em></span></td>
</tr>
<tr>
<td><span class="code">keys</span></td>
<td><span class="code"><em>d</em></span><span class="code">.keys()</span><br/>
			Returns<a contenteditable="false" data-primary="keys (dict method)" data-type="indexterm" id="idm44924587289216"/> an iterable view object whose items are all current keys in <span class="code"><em>d</em></span></td>
</tr>
<tr>
<td><span class="code">values</span></td>
<td><span class="code"><em>d</em></span><span class="code">.values()</span><br/>
			Returns<a contenteditable="false" data-primary="values (dict method)" data-type="indexterm" id="idm44924587284176"/> an iterable view object whose items are all current values in <span class="code"><em>d</em></span></td>
</tr>
<tr>
<td><strong>Mutating</strong></td>
<td> </td>
</tr>
<tr>
<td><span class="code">clear</span></td>
<td><span class="code"><em>d</em></span><span class="code">.clear()</span><br/>
			Removes<a contenteditable="false" data-primary="clear method" data-secondary="dict type" data-type="indexterm" id="idm44924587277664"/> all items from <span class="code"><em>d</em></span>, leaving <span class="code"><em>d</em></span> empty</td>
</tr>
<tr>
<td><span class="code">pop</span></td>
<td><span class="code"><em>d.</em></span><span class="code">pop(<em>k</em>[,</span> <span class="code"><em>x</em></span><span class="code">])</span><br/>
			Removes<a contenteditable="false" data-primary="pop method" data-secondary="dict type" data-type="indexterm" id="idm44924587269056"/> and returns <span class="code"><em>d</em></span><span class="code">[<em>k</em>]</span> when <span class="code"><em>k</em></span> is a key in <span class="code"><em>d</em></span>; otherwise, returns <span class="code"><em>x</em></span> (or raises a <span class="code">KeyError</span> exception when you don’t pass <span class="code"><em>x</em></span>)</td>
</tr>
<tr>
<td><span class="code">popitem</span></td>
<td><span class="code"><em>d</em></span><span class="code">.popitem()</span><br/>
			Removes<a contenteditable="false" data-primary="popitem (dict method)" data-type="indexterm" id="idm44924587258864"/> and returns the items from <span class="code"><em>d</em></span> in last-in, first-out order</td>
</tr>
<tr>
<td><span class="code">setdefault</span></td>
<td><span class="code"><em>d</em></span><span class="code">.setdefault(<em>k</em>,</span> <span class="code"><em>x</em></span><span class="code">)</span><br/>
			Returns<a contenteditable="false" data-primary="setdefault (dict method)" data-type="indexterm" id="idm44924587251344"/> <span class="code"><em>d</em></span><span class="code">[<em>k</em>]</span> when <span class="code"><em>k</em></span> is a key in <span class="code"><em>d</em></span>; otherwise, sets <span class="code"><em>d</em></span><span class="code">[<em>k</em>]</span> equal to <span class="code"><em>x</em></span> (or <span class="code"><strong>None</strong></span>, when you don’t pass <span class="code"><em>x</em></span>), then returns <span class="code"><em>d</em></span><span class="code">[<em>k</em>]</span></td>
</tr>
<tr>
<td><span class="code">update</span></td>
<td><span class="code"><em>d</em></span><span class="code">.update(<em>d1</em>)</span><br/>
			For<a contenteditable="false" data-primary="update (dict method)" data-type="indexterm" id="idm44924587237120"/> each <span class="code"><em>k</em></span> in mapping <span class="code"><em>d1</em></span>, sets <span class="code"><em>d</em></span><span class="code">[<em>k</em>]</span>equal to <span class="code"><em>d1</em></span><span class="code">[<em>k</em>]</span></td>
</tr>
</tbody>
</table>
<p>The <span class="code">items</span>, <span class="code">keys</span>, and <span class="code">values</span> methods return values known as<a contenteditable="false" data-primary="view objects" data-type="indexterm" id="idm44924587227808"/> <em>view objects</em>. If the underlying <span class="code">dict</span> changes, the retrieved view also changes; Python doesn’t allow you to alter the set of keys in the underlying <span class="code">dict</span> while using a <span class="code"><strong>for</strong></span> loop on any of its view objects.</p>
<p>Iterating on any of the view objects yields values in insertion order. In particular, when you call more than one of these methods without any intervening change to the <span class="code">dict</span>, the order of the results is the same for all of them.</p>
<p>Dictionaries also support the class method <span class="code">fromkeys(<em>seq</em>,</span> <span class="code"><em>value</em></span><span class="code">)</span>, which returns a dictionary containing all the keys of the given iterable <span class="code"><em>seq</em></span>, each identically initialized with <span class="code"><em>value</em></span>.</p>
<div data-type="warning" epub:type="warning">
<h1>Never Modify a dict’s Keys While Iterating on It</h1>
<p>Don’t ever modify the set of keys in a <span class="code">dict</span> (i.e., add or remove keys) while iterating over that <span class="code">dict</span> or any of the iterable views returned by its methods. If you need to avoid such constraints against mutation during iteration, iterate instead on a list explicitly built from the <span class="code">dict</span> or view (i.e., on list(<em>D</em>)). Iterating directly on a dict <em><span class="code">D</span></em> is exactly like iterating on <em><span class="code">D</span></em><span class="code">.keys()</span>.</p>
</div>
<p>The return values of the <span class="code">items</span> and <span class="code">keys</span> methods also implement set nonmutating methods and behave much like <span class="code">frozenset</span>s; the return value of the method <span class="code">values</span> doesn’t, since, in contrast to the others (and to <span class="code">set</span>s), it may contain duplicates.</p>
<p>The <span class="code">popitem</span> method can be used for destructive iteration on a dictionary. Both <span class="code">items</span> and <span class="code">popitem</span> return dictionary items as key/value pairs. <span class="code">popitem</span> is usable for a loop on a huge dictionary, when what you want is to “consume” the dictionary in the course of the loop.</p>
<p><span class="code"><em>D</em></span><span class="code">.setdefault(<em>k</em>,</span> <span class="code"><em>x</em></span><span class="code">)</span> returns the same result as <span class="code"><em>D</em></span><span class="code">.get(<em>k</em>,</span> <span class="code"><em>x</em></span><span class="code">)</span>; but, when <span class="code"><em>k</em></span> is not a key in <span class="code"><em>D</em></span>, <span class="code">setdefault</span> also has the side effect of binding <span class="code"><em>D</em></span><span class="code">[<em>k</em>]</span> to the value <span class="code"><em>x</em></span>. <span class="keep-together">(In modern</span> Python, <span class="code">setdefault</span> is not often used, since the type <span class="code">collections.defaultdict</span>, covered in <a data-type="xref" href="ch08.xhtml#defaultdict">“defaultdict”</a>, often offers similar, faster, clearer <span class="keep-together">functionality</span>.)</p>
<p>The <span class="code">pop</span> method returns the same result as <span class="code">get</span>, but when <span class="code"><em>k</em></span> is a key in <span class="code"><em>D</em></span>, <span class="code">pop</span> also has the side effect of removing <span class="code"><em>D</em></span><span class="code">[<em>k</em>]</span> (when <span class="code"><em>x</em></span> is not specified, and <span class="code"><em>k</em></span> is not a key in <span class="code"><em>D</em></span>, <span class="code">get</span> returns <span class="code"><strong>None</strong></span>, but <span class="code">pop</span> raises an exception). <span class="code"><em>d</em></span><span class="code">.pop(<em>key</em>,</span> <span class="code"><strong>None</strong></span><span class="code">)</span> is a useful shortcut for removing a key from a <span class="code">dict</span> without having to first check if the key is present, much like <span class="code"><em>s</em></span><span class="code">.discard(<em>x</em>)</span> (as opposed to <span class="code"><em>s</em></span><span class="code">.remove(<em>x</em>)</span>) when <span class="code"><em>s</em></span> is a set.</p>
<p><span class="version">3.9+</span> The <span class="code">update</span> method is accessible with augmented assignment syntax: where <span class="code"><em>D2</em></span> is a <span class="code">dict</span>, <span class="code"><em>D</em></span> <span class="code">|=</span> <span class="code"><em>D2</em></span> is the same as <span class="code"><em>D</em></span><span class="code">.update(<em>D2</em>)</span>. Operator syntax, <span class="code"><em>D</em></span> <span class="code">|</span> <span class="code"><em>D2</em></span>, mutates neither dictionary: rather, it returns a new dictionary result, such that <span class="code"><em>D3</em></span> <span class="code">=</span> <span class="code"><em>D</em></span> <span class="code">|</span> <span class="code"><em>D2</em></span> is equivalent to <span class="code"><em>D3</em></span> <span class="code">=</span> <span class="code"><em>D</em></span><span class="code">.copy();</span> <span class="code"><em>D3</em></span><span class="code">.update(<em>D2</em>)</span>.</p>
<p>The <span class="code">update</span> method (but not the <span class="code">|</span> and <span class="code">|=</span> operators) can also accept an iterable of key/value pairs as an alternative argument instead of a mapping, and can accept named arguments instead of—or in addition to—its positional argument; the semantics are the same as for passing such arguments when calling the built-in <span class="code">dict</span> type, as covered in <a data-type="xref" href="#dictionaries">“Dictionaries”</a>.<a contenteditable="false" data-primary="" data-startref="PLdict03" data-type="indexterm" id="idm44924587145392"/><a contenteditable="false" data-primary="" data-startref="dictop03" data-type="indexterm" id="idm44924587143984"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Control Flow Statements" data-type="sect1"><div class="sect1" id="control_flow_statements">
<h1>Control Flow Statements</h1>
<p>A<a contenteditable="false" data-primary="Python language" data-secondary="control flow statements" data-type="indexterm" id="PLconflo03"/><a contenteditable="false" data-primary="control flow statements" data-type="indexterm" id="conflo03"/> program’s <em>control flow</em> regulates the order in which the program’s code executes. The control flow of a Python program mostly depends on conditional statements, loops, and function calls. (This section covers the <span class="code"><strong>if</strong></span> and <span class="code"><strong>match</strong></span> conditional statements, and <span class="code"><strong>for</strong></span> and <span class="code"><strong>while</strong></span> loops; we cover functions in the following section.) Raising and handling exceptions also affects control flow (via the <span class="code"><strong>try</strong></span> and <span class="code"><strong>with</strong></span> statements); we cover exceptions in <a data-type="xref" href="ch06.xhtml#exceptions">Chapter 6</a>.</p>
<section data-pdf-bookmark="The if Statement" data-type="sect2"><div class="sect2" id="the_if_statement">
<h2>The if Statement</h2>
<p>Often, you’ll<a contenteditable="false" data-primary="control flow statements" data-secondary="if" data-type="indexterm" id="idm44924587128704"/><a contenteditable="false" data-primary="if statement" data-type="indexterm" id="idm44924587127296"/><a contenteditable="false" data-primary="elif clauses" data-type="indexterm" id="idm44924587126192"/><a contenteditable="false" data-primary="else clause" data-secondary="if/else" data-type="indexterm" id="idm44924587125088"/> need to execute some statements only when some condition holds, or choose statements to execute depending on mutually exclusive conditions. The compound statement <span class="code"><strong>if</strong></span>—comprising <span class="code"><strong>if</strong></span>, <span class="code"><strong>elif</strong></span>, and<a contenteditable="false" data-primary="control flow statements" data-secondary="else clause" data-type="indexterm" id="idm44924587121040"/> <span class="code"><strong>else</strong></span> clauses—lets you conditionally execute blocks of statements. The syntax for the <span class="code"><strong>if</strong></span> statement is:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">if</code></strong><code> </code><em><code class="n">expression</code><code class="p">:</code></em><code>
</code><code>    </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em><code>
</code><strong><code class="k">elif</code></strong><code> </code><em><code class="n">expression</code><code class="p">:</code></em><code>
</code><code>    </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em><code>
</code><strong><code class="k">elif</code></strong><code> </code><em><code class="n">expression</code><code class="p">:</code></em><code>
</code><code>    </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>
</code><strong><code class="k">else</code></strong><code class="p">:</code><code>
</code><code>    </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em></pre>
<p>The <span class="code"><strong>elif</strong></span> and <span class="code"><strong>else</strong></span> clauses are optional. Before the introduction of the <span class="code"><strong>match</strong></span> construct, which we’ll look at next, using <span class="code"><strong>if</strong></span>, <span class="code"><strong>elif</strong></span>, and <span class="code"><strong>else</strong></span> was the most common approach for all conditional processing (although at times a <span class="code">dict</span> with callables as values might provide a good alternative).</p>
<p>Here’s a typical <span class="code"><strong>if</strong></span> statement with all three kinds of clauses:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">if</code></strong><code> </code><code class="n">x</code><code> </code><code class="o">&lt;</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">x is negative</code><code class="s1">'</code><code class="p">)</code><code>
</code><strong><code class="k">elif</code></strong><code> </code><code class="n">x</code><code> </code><code class="o">%</code><code> </code><code class="mi">2</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">x is positive and odd</code><code class="s1">'</code><code class="p">)</code><code>
</code><strong><code class="k">else</code></strong><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">x is even and nonnegative</code><code class="s1">'</code><code class="p">)</code></pre>
<p>Each clause controls one or more statements<a contenteditable="false" data-primary="blocks" data-type="indexterm" id="idm44924588694912"/> (known as a block): place the block’s statements on separate logical lines after the line containing the clause’s keyword (known as the<a contenteditable="false" data-primary="header lines" data-type="indexterm" id="idm44924588662368"/> <em>header line</em> of the clause), indented four spaces past the header line. The block terminates when the indentation returns to the level of the clause header, or further left from there (this is the style mandated by <a href="https://oreil.ly/O3SO-">PEP 8</a>).</p>
<p>You can use any Python expression<sup><a data-type="noteref" href="ch03.xhtml#ch01fn37" id="ch01fn37-marker">18</a></sup> as the condition in an <span class="code"><strong>if</strong></span> or <span class="code"><strong>elif</strong></span> clause. Using an<a contenteditable="false" data-primary="expressions and operators" data-secondary="Boolean context of" data-type="indexterm" id="idm44924588656736"/> expression this way is known as using it <em>in a Boolean context</em>. In this context, any value is taken as being either true or false. As mentioned earlier, any nonzero number or nonempty container (string, tuple, list, dictionary, set, etc.) evaluates as true, while zero (<span class="code">0</span>, of any numeric type), <span class="code"><strong>None</strong></span>, and empty containers evaluate as false. To test a value <span class="code"><em>x</em></span> in a Boolean context, use the following coding style:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">if</code></strong><code> </code><em><code class="n">x</code></em><code class="p">:</code></pre>
<p>This is the clearest and most Pythonic form.</p>
<p class="pagebreak-before">Do <em>not</em> use any of the following:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="k">if</code><code> </code><em><code class="n">x</code></em><code> </code><code class="ow">is</code><code> </code><code class="kc">True</code><code class="p">:</code><code>
</code><strong><code class="k">if</code></strong><code> </code><em><code class="n">x</code></em><code> </code><code class="o">==</code><code> </code><strong><code class="kc">True</code></strong><code class="p">:</code><code>
</code><strong><code class="k">if</code></strong><code> </code><code class="nb">bool</code><code class="p">(</code><em><code class="n">x</code></em><code class="p">)</code><code class="p">:</code></pre>
<p>There is a crucial difference between saying that an expression <em>returns</em> <span class="code"><strong>True</strong></span> (meaning the expression returns the value <span class="code">1</span> with the <span class="code">bool</span> type) and saying that an expression <em>evaluates as</em> true (meaning the expression returns any result that is true in a Boolean context). When<a contenteditable="false" data-primary="expressions and operators" data-secondary="evaluation of versus returns from" data-type="indexterm" id="idm44924588579168"/> testing an expression, for example in an <span class="code"><strong>if</strong></span> clause, you only care about what it <em>evaluates as</em>, not what, precisely, it <em>returns</em>. As we previously mentioned, “evaluates as true” is often expressed informally as<a contenteditable="false" data-primary="True" data-type="indexterm" id="idm44924588575984"/> “is truthy,” and “evaluated as false” as<a contenteditable="false" data-primary="falsy" data-secondary="evaluates as versus returns" data-type="indexterm" id="idm44924588552224"/> “is falsy.”</p>
<p>When the <span class="code"><strong>if</strong></span> clause’s condition evaluates as true, the statements within the <span class="code"><strong>if</strong></span> clause execute, then the entire <span class="code"><strong>if</strong></span> statement ends. Otherwise, Python evaluates each <span class="code"><strong>elif</strong></span> clause’s condition, in order. The statements within the first <span class="code"><strong>elif</strong></span> clause whose condition evaluates as true, if any, execute, and the entire <span class="code"><strong>if</strong></span> statement ends. Otherwise, when an <span class="code"><strong>else</strong></span> clause exists, it executes. In any case, statements following the entire <span class="code"><strong>if</strong></span> construct, at the same level, execute next.</p>
</div></section>
<section data-pdf-bookmark="The match Statement" data-type="sect2"><div class="sect2" id="the_match_statement">
<h2>The match Statement</h2>
<p><strong><span class="version">3.10+</span></strong> The <span class="code"><strong>match</strong></span> statement<a contenteditable="false" data-primary="control flow statements" data-secondary="match" data-type="indexterm" id="idm44924588539776"/><a contenteditable="false" data-primary="match" data-secondary="pattern matching with" data-type="indexterm" id="idm44924588538400"/> brings<a contenteditable="false" data-primary="structural pattern matching" data-type="indexterm" id="idm44924588536896"/> <em>structural pattern matching</em> to the Python language. You might think of this as doing for other Python types something similar to what the <span class="code">re</span> module (see <a data-type="xref" href="ch10.xhtml#regular_expressions_and_the_re_module">“Regular Expressions and the re Module”</a>) does for strings: it allows easy testing of the structure and contents of Python objects.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn38" id="ch01fn38-marker">19</a></sup> Resist the temptation to use <span class="code"><strong>match</strong></span> unless there is a need to analyze the <em>structure</em> of an object.</p>
<p>The overall syntactic structure of the statement is the new<a contenteditable="false" data-primary="match" data-secodary="match (soft keyword)" data-type="indexterm" id="idm44924588527168"/> (soft) keyword <span class="code"><strong>match</strong></span> followed by an expression whose value becomes the <em>matching subject</em>. This is followed by one or more indented<a contenteditable="false" data-primary="case clauses" data-type="indexterm" id="idm44924588524368"/> <span class="code"><strong>case</strong></span> clauses, each of which controls the execution of the indented code block it contains:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">match</code></strong><code> </code><em><code class="n">expression</code></em><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">case</code></strong><code> </code><em><code class="n">pattern</code></em><code> </code><code class="p">[</code><strong><code class="k">if</code></strong><code> </code><em><code class="n">guard</code></em><code class="p">]</code><code class="p">:</code><code>
</code><code>        </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em><code>
</code><code>    </code><em><code class="c1"># ...</code></em></pre>
<p>In execution, Python first evaluates the <span class="code"><em>expression</em></span>, then tests the resulting subject value against the <span class="code"><em>pattern</em></span> in each <span class="code"><strong>case</strong></span> in turn, in order from first to last, until one matches: then, the block indented within the matching <span class="code"><strong>case</strong></span> clause evaluates. A pattern can do two things:</p>
<ul class="pagebreak-before">
<li>
<p>Verify that the subject is an object with a particular structure.</p>
</li>
<li>
<p>Bind matched components to names for further use (usually within the associated <span class="code"><strong>case</strong></span> clause).</p>
</li>
</ul>
<p>When a pattern matches the subject, the<a contenteditable="false" data-primary="guards" data-type="indexterm" id="idm44924588494256"/> <em>guard</em> allows a final check before selection of the case for execution. All the pattern’s name bindings have occurred, and you can use them in the guard. When there is no guard, or when the guard evaluates as true, the case’s indented code block executes, after which the <span class="code"><strong>match</strong></span> statement’s execution is complete and no further cases are checked.</p>
<p>The <span class="code"><strong>match</strong></span> statement, per se, provides no default action. If one is needed, the last <span class="code"><strong>case</strong></span> clause must specify a<a contenteditable="false" data-primary="wildcard patterns" data-type="indexterm" id="idm44924588467600"/> <em>wildcard</em> pattern—one whose syntax ensures it matches any subject value. It is a <span class="code">SyntaxError</span> to follow a <span class="code"><strong>case</strong></span> clause having such a wildcard pattern with any further <span class="code"><strong>case</strong></span> clauses.</p>
<p>Pattern elements cannot be created in advance, bound to variables, and (for example) reused in multiple places. Pattern syntax is only valid immediately following the<a contenteditable="false" data-primary="case soft keyword" data-type="indexterm" id="idm44924588463248"/> (soft) keyword <span class="code"><strong>case</strong></span>, so there is no way to perform such an assignment. For each execution of a <span class="code"><strong>match</strong></span> statement, the interpreter is free to cache pattern expressions that repeat inside the cases, but the cache starts empty for each new execution.</p>
<p>We’ll first describe the various types of pattern expressions, before discussing guards and providing some more complex examples.</p>
<div data-type="warning" epub:type="warning">
<h1>Pattern Expressions Have Their Own Semantics</h1>
<p>The syntax of<a contenteditable="false" data-primary="pattern expressions" data-seealso="match" data-type="indexterm" id="idm44924588458000"/> pattern expressions might seem familiar, but their <em>interpretation</em> is sometimes quite different from that of nonpattern expressions, which could mislead readers unaware of those differences. Specific syntactic forms are used in the <span class="code"><strong>case</strong></span> clause to indicate matching of particular structures. A complete summary of this syntax would require more than the simplified notation we use in this book;<sup><a data-type="noteref" href="ch03.xhtml#ch01fn39" id="ch01fn39-marker">20</a></sup> we therefore prefer to explain this new feature in plain language, with examples. For more detailed examples, refer to the Python <a href="https://oreil.ly/UlgQF">documentation</a>.</p>
</div>
<section data-pdf-bookmark="Building patterns" data-type="sect3"><div class="sect3" id="building_patterns">
<h3>Building patterns</h3>
<p>Patterns<a contenteditable="false" data-primary="match" data-secondary="building patterns" data-type="indexterm" id="idm44924588451728"/> are expressions, though with a syntax specific to the <span class="code"><strong>case</strong></span> clause, so familiar grammatical rules apply even though certain features are interpreted differently. They can be enclosed in parentheses to let elements of a pattern be treated as a single expression unit. Like other expressions, patterns have a recursive syntax and can be combined to form more complex patterns. Let’s start with the simplest patterns first.</p>
</div></section>
<section data-pdf-bookmark="Literal patterns" data-type="sect3"><div class="sect3" id="literal_patterns">
<h3>Literal patterns</h3>
<p>Most<a contenteditable="false" data-primary="match" data-secondary="literal patterns" data-type="indexterm" id="idm44924588447168"/> literal values are valid patterns. Integer, float, complex number, and string literals (but <em>not</em> formatted string literals) are all permissible,<sup><a data-type="noteref" href="ch03.xhtml#ch01fn40" id="ch01fn40-marker">21</a></sup> and all succeed in matching subjects of the same type and value:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><strong><code> </code><code class="k">for</code></strong><code> </code><code class="n">subject</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="p">(</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="mf">42.0</code><code class="p">,</code><code> </code><code class="mf">42.1</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="o">+</code><code class="mi">1j</code><code class="p">,</code><code> </code><code class="s1">b'</code><code class="s1">abc</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">abc</code><code class="s1">'</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><strong><code>    </code></strong><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">subject</code><code class="p">,</code><code> </code><code class="n">end</code><code class="o">=</code><code class="s1">'</code><code class="s1">: </code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><strong><code>     </code><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="mi">42</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">integer</code><code class="s1">'</code><code class="p">)</code><code>  </code><em><code class="c1"># note this matches 42.0, too!</code></em><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="mf">42.1</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">float</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="mi">1</code><code class="o">+</code><code class="mi">1j</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">complex</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="s1">b'</code><code class="s1">abc</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">bytestring</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="s1">'</code><code class="s1">abc</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">string</code><code class="s1">'</code><code class="p">)</code></pre>
<pre data-type="programlisting">
<strong>42: integer</strong>
<strong>42.0: integer</strong>
<strong>42.1: float</strong>
<strong>(1+1j): complex</strong>
<strong>b'abc': bytestring</strong>
<strong>abc: string</strong></pre>
<p>For most matches, the interpreter checks for equality without type checking, which is why <span class="code">42.0</span> matches integer <span class="code">42</span>. If the distinction is important, consider using class matching (see <a data-type="xref" href="#class_patterns">“Class patterns”</a>) rather than literal matching. <span class="code"><strong>True</strong></span>, <span class="code"><strong>False</strong></span>, and <span class="code"><strong>None</strong></span> being singleton objects, each matches itself.</p>
</div></section>
<section data-pdf-bookmark="The wildcard pattern" data-type="sect3"><div class="sect3" id="the_wildcard_pattern">
<h3>The wildcard pattern</h3>
<p>In<a contenteditable="false" data-primary="match" data-secondary="wildcard pattern" data-type="indexterm" id="idm44924588356736"/> pattern syntax, the<a contenteditable="false" data-primary="_ (underscore)" data-secondary="wildcard pattern" data-type="indexterm" id="idm44924588355200"/><a contenteditable="false" data-primary="underscore (_)" data-secondary="wildcard pattern" data-type="indexterm" id="idm44924588353792"/> underscore (<strong>_</strong>) plays the role of a wildcard expression. As the simplest wildcard pattern, <strong>_</strong> matches any value at all:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">subject</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="mi">42</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">string</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">tu</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ple</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">list</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="nb">object</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><strong><code class="n">_</code></strong><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">matched</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">subject</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>matched 42</strong>
<strong>matched string</strong>
<strong>matched ('tu', 'ple')</strong>
<strong>matched ['list']</strong>
<strong>matched &lt;class 'object'&gt;</strong></pre>
</div></section>
<section data-pdf-bookmark="Capture patterns" data-type="sect3"><div class="sect3" id="capture_patterns">
<h3>Capture patterns</h3>
<p>The<a contenteditable="false" data-primary="match" data-secondary="capture patterns" data-type="indexterm" id="idm44924588251872"/><a contenteditable="false" data-primary="capture patterns" data-type="indexterm" id="idm44924588295616"/> use of unqualified names (names with no dots in them) is so different in patterns that we feel it necessary to begin this section with a warning.</p>
<div data-type="warning" epub:type="warning">
<h1>Simple Names Bind to Matched Elements Inside Patterns</h1>
<p>Unqualified names—simple identifiers (e.g., <em>color</em>) rather than attribute references (e.g., <em>name.attr</em>)—do not necessarily have their usual meaning in pattern expressions. Some names, rather than being references to values, are instead bound to elements of the subject value during pattern matching.</p>
</div>
<p>Unqualified names, except <span class="code">_</span>, are <em>capture patterns</em>. They’re wildcards, matching anything, but with a side effect: the name, in the current local namespace, gets bound to the object matched by the pattern. Bindings created by matching remain after the statement has executed, allowing the statements in the <span class="code"><strong>case</strong></span> clause and subsequent code to process extracted portions of the subject value.</p>
<p>The following example is similar to the preceding one, except that the name <span class="code">x</span>, instead of the underscore, matches the subject. The absence of exceptions shows that the name captures the whole subject in each case:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">subject</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="mi">42</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">string</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">tu</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">ple</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">list</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="nb">object</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="n">x</code><code class="p">:</code><code> </code><strong><code class="k">assert</code></strong><code> </code><code class="n">x</code><code> </code><code class="o">==</code><code> </code><code class="n">subject</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
</div></section>
<section data-pdf-bookmark="Value patterns" data-type="sect3"><div class="sect3" id="value_patterns">
<h3>Value patterns</h3>
<p>This<a contenteditable="false" data-primary="match" data-secondary="value patterns" data-type="indexterm" id="idm44924595128592"/><a contenteditable="false" data-primary="value patterns" data-type="indexterm" id="idm44924595127280"/> section, too, begins with a reminder to readers that simple names can’t be used to inject their bindings into pattern values to be matched.</p>
<div data-type="tip">
<h1>Represent Variable Values in Patterns with Qualified Names</h1>
<p>Because simple names capture values during pattern matching, you <em>must</em> use attribute references (qualified names like <em>name.attr</em>) to express values that may change between different executions of the same <span class="code"><strong>match</strong></span> statement.</p>
</div>
<p>Though this feature is useful, it means you can’t reference values directly with simple names. Therefore, in patterns, values must be represented by qualified names, which are known as <em>value patterns</em>—they <em>represent</em> values, rather than <em>capturing</em> them as simple names do. While slightly inconvenient, to use qualified names you can just set attribute values on an otherwise empty class.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn41" id="ch01fn41-marker">22</a></sup> For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">class</code></strong><code> </code><code class="nc">m</code><code class="p">:</code><code> </code><code class="n">v1</code><code> </code><code class="o">=</code><code> </code><code class="s2">"</code><code class="s2">one</code><code class="s2">"</code><code class="p">;</code><code> </code><code class="n">v2</code><code> </code><code class="o">=</code><code> </code><code class="mi">2</code><code class="p">;</code><code> </code><code class="n">v3</code><code> </code><code class="o">=</code><code> </code><code class="mf">2.56</code><code>
</code><strong><code class="o">.</code><code class="o">.</code><code class="o">.</code></strong><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">one</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mf">2.56</code><code class="p">)</code><code class="p">:</code><code>
</code><strong><code class="o">.</code><code class="o">.</code><code class="o">.</code></strong><code>     </code><strong><code class="n">case</code></strong><code> </code><code class="p">(</code><code class="n">m</code><code class="o">.</code><code class="n">v1</code><code class="p">,</code><code> </code><code class="n">m</code><code class="o">.</code><code class="n">v2</code><code class="p">,</code><code> </code><code class="n">m</code><code class="o">.</code><code class="n">v3</code><code class="p">)</code><code class="p">:</code><code>  </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">matched</code><code class="s1">'</code><code class="p">)</code><code>
</code><strong><code class="o">.</code><code class="o">.</code><code class="o">.</code></strong></pre>
<pre data-type="programlisting">
<strong>matched</strong></pre>
<p>It is easy to give yourself access to the current module’s “global” namespace, like this:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;&gt;</code> <code class="kn">import</code> <code class="nn">sys</code>
<code class="o">&gt;&gt;&gt;</code> <code class="n">g</code> <code class="o">=</code> <code class="n">sys</code><code class="o">.</code><code class="n">modules</code><code class="p">[</code><code class="vm">__name__</code><code class="p">]</code>
<code class="o">&gt;&gt;&gt;</code> <code class="n">v1</code> <code class="o">=</code> <code class="s2">"one"</code><code class="p">;</code> <code class="n">v2</code> <code class="o">=</code> <code class="mi">2</code><code class="p">;</code> <code class="n">v3</code> <code class="o">=</code> <code class="mf">2.56</code>
<code class="o">&gt;&gt;&gt;</code> <code class="n">match</code> <code class="p">(</code><code class="s1">'one'</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mf">2.56</code><code class="p">):</code>
<code class="o">...</code>     <code class="n">case</code> <code class="p">(</code><code class="n">g</code><code class="o">.</code><code class="n">v1</code><code class="p">,</code> <code class="n">g</code><code class="o">.</code><code class="n">v2</code><code class="p">,</code> <code class="n">g</code><code class="o">.</code><code class="n">v3</code><code class="p">):</code>  <code class="nb">print</code><code class="p">(</code><code class="s1">'matched'</code><code class="p">)</code>
<code class="o">...</code></pre>
<pre data-type="programlisting">
<strong>matched</strong></pre>
</div></section>
<section data-pdf-bookmark="OR patterns" data-type="sect3"><div class="sect3" id="or_patterns">
<h3>OR patterns</h3>
<p>When<a contenteditable="false" data-primary="match" data-secondary="OR patterns" data-type="indexterm" id="idm44924594943936"/><a contenteditable="false" data-primary="OR patterns" data-type="indexterm" id="idm44924594942528"/> <span class="code"><em>P1</em></span> and <span class="code"><em>P2</em></span> are patterns, the expression <span class="code"><em>P1 | P2</em></span> is an <em>OR pattern</em>, matching anything that matches either <span class="code"><em>P1</em></span> or <span class="code"><em>P2</em></span>, as shown in the following example. Any number of alternate patterns can be used, and matches are attempted from left to right:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">subject</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="mi">1</code><code> </code><code class="o">|</code><code> </code><code class="mi">3</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">odd</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="mi">0</code><code> </code><code class="o">|</code><code> </code><code class="mi">2</code><code> </code><code class="o">|</code><code> </code><code class="mi">4</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">even</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>even</strong>
<strong>odd</strong>
<strong>even</strong>
<strong>odd</strong>
<strong>even</strong></pre>
<p>It is a syntax error to follow a wildcard pattern with further alternatives, however, since they can never be activated. While our initial examples are simple, remember that the syntax is recursive, so patterns of arbitrary complexity can replace any of the subpatterns in these examples.</p>
</div></section>
<section data-pdf-bookmark="Group patterns" data-type="sect3"><div class="sect3" id="group_patterns">
<h3>Group patterns</h3>
<p>If <a contenteditable="false" data-primary="match" data-secondary="group patterns" data-type="indexterm" id="idm44924594827616"/><a contenteditable="false" data-primary="group patterns" data-type="indexterm" id="idm44924594826208"/><span class="code"><em>P1</em></span> is a pattern, then <span class="code">(<em>P1</em>)</span> is also a pattern that matches the same values. This addition of “grouping” parentheses is useful when patterns become complicated, just as it is with standard expressions. Like in other expressions, take care to distinguish between <span class="code">(<em>P1</em>)</span>, a simple grouped pattern matching <span class="code"><em>P1</em></span>, and <span class="code">(<em>P1</em>,)</span>, a sequence pattern (described next) matching a sequence with a single element matching <span class="code"><em>P1</em></span>.</p>
</div></section>
<section data-pdf-bookmark="Sequence patterns" data-type="sect3"><div class="sect3" id="sequence_patterns">
<h3>Sequence patterns</h3>
<p>A<a contenteditable="false" data-primary="match" data-secondary="sequence patterns" data-type="indexterm" id="idm44924594788928"/><a contenteditable="false" data-primary="sequence patterns" data-type="indexterm" id="idm44924594787520"/> list or tuple of patterns, optionally with a single starred wildcard (<span class="code">*_</span>) or starred capture pattern (<span class="code"><em>*name</em></span>), is a <em>sequence pattern</em>. When the starred pattern is absent, the pattern matches a fixed-length sequence of values of the same length as the pattern. Elements of the sequence are matched one at a time, until all elements have matched (then matching succeeds) or an element fails to match (then matching fails).</p>
<p>When the sequence pattern includes a starred pattern, that subpattern matches a sequence of elements sufficiently long to allow the remaining unstarred patterns to match the final elements of the sequence. When the starred pattern is of the form <span class="code">*</span><span class="code"><em>name</em></span>, <span class="code"><em>name</em></span> is bound to the (possibly empty) list of the elements in the middle that don’t correspond to individual patterns at the beginning or end.</p>
<p>You can match a sequence with patterns that look like tuples or lists—it makes no difference to the matching process. The next example shows an unnecessarily complicated way to extract the first, middle, and last elements of a sequence:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">sequence</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="p">(</code><code class="p">[</code><code class="s2">"</code><code class="s2">one</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="s2">"</code><code class="s2">two</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="s2">"</code><code class="s2">three</code><code class="s2">"</code><code class="p">]</code><code class="p">,</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code class="p">,</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">6</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">match</code></strong><code> </code><code class="n">sequence</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code>  </code><code class="p">(</code><code class="n">first</code><code class="p">,</code><code> </code><code class="o">*</code><code class="nb">vars</code><code class="p">,</code><code> </code><code class="n">last</code><code class="p">)</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">first</code><code class="p">,</code><code> </code><code class="nb">vars</code><code class="p">,</code><code> </code><code class="n">last</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>one ['two'] three</strong>
<strong>0 [] 1</strong>
<strong>0 [1, 2, 3, 4] 5</strong></pre>
</div></section>
<section data-pdf-bookmark="as patterns" data-type="sect3"><div class="sect3" id="as_patterns">
<h3>as patterns</h3>
<p>You<a contenteditable="false" data-primary="match" data-secondary="as patterns" data-type="indexterm" id="idm44924594711680"/><a contenteditable="false" data-primary="as patterns" data-type="indexterm" id="idm44924594710272"/> can use so-called <strong><em><span class="code">as</span></em></strong> <em>patterns</em> to capture values matched by more complex patterns, or components of a pattern, that simple capture patterns (see <a data-type="xref" href="#capture_patterns">“Capture patterns”</a>) cannot.</p>
<p>When <span class="code"><em>P1</em></span> is a pattern, then <span class="code"><em>P1</em></span> <span class="code"><strong>as</strong></span> <span class="code"><em>name</em></span> is also a pattern; when <span class="code"><em>P1</em></span> succeeds, Python binds the matched value to the name <span class="code"><em>name</em></span> in the local namespace. The interpreter tries to ensure that, even with complicated patterns, the same bindings always take place when a match occurs. Therefore, each of the next two examples raises <span class="code">SyntaxError</span>, because the constraint cannot be guaranteed:<a contenteditable="false" data-primary="as (match statement)" data-type="indexterm" id="idm44924570608464"/></p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">case</code></strong><code> </code><code class="p">(</code><code class="p">(</code><code class="mi">0</code><code> </code><code class="o">|</code><code> </code><code class="mi">1</code><code class="p">)</code><code> </code><strong><code class="k">as</code></strong><code> </code><code class="n">x</code><code class="p">)</code><code> </code><code class="o">|</code><code> </code><code class="mi">2</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>SyntaxError: alternative patterns bind different names</strong></pre>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">case</code></strong><code> </code><code class="p">(</code><code class="mi">2</code><code> </code><code class="o">|</code><code> </code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>SyntaxError: alternative patterns bind different names</strong></pre>
<p>But this one works:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="mi">42</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">case</code></strong><code> </code><code class="p">(</code><code class="mi">1</code><code> </code><code class="o">|</code><code> </code><code class="mi">2</code><code> </code><code class="o">|</code><code> </code><code class="mi">42</code><code class="p">)</code><code> </code><strong><code class="k">as</code></strong><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>42</strong></pre>
</div></section>
<section data-pdf-bookmark="Mapping patterns" data-type="sect3"><div class="sect3" id="mapping_patterns">
<h3>Mapping patterns</h3>
<p><em>Mapping patterns</em> match<a contenteditable="false" data-primary="match" data-secondary="mapping patterns" data-type="indexterm" id="idm44924570469008"/><a contenteditable="false" data-primary="mapping patterns" data-type="indexterm" id="idm44924570467600"/><a contenteditable="false" data-primary="key: pattern pairs" data-type="indexterm" id="idm44924570466496"/> mapping objects, usually dictionaries, that associate keys with values. The syntax of mapping patterns uses <span class="code"><em>key</em></span><span class="code">:</span> <span class="code"><em>pattern</em></span> pairs. The keys must be either literal or value patterns.</p>
<p>The interpreter iterates over the keys in the mapping pattern, processing each as follows:</p>
<ul>
<li>
<p>Python looks up the key in the subject mapping; a lookup failure causes an immediate match failure.</p>
</li>
<li>
<p>Python then matches the extracted value against the pattern associated with the key; if the value fails to match the pattern, then the whole match fails.</p>
</li>
</ul>
<p>When all keys (and associated values) in the mapping pattern match, the whole match succeeds:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="p">{</code><code class="mi">1</code><code class="p">:</code><code> </code><code class="s2">"</code><code class="s2">two</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="s2">"</code><code class="s2">two</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">}</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code> </code><strong><code>    </code><code class="n">case</code></strong><code> </code><code class="p">{</code><code class="mi">1</code><code class="p">:</code><code> </code><code class="n">v1</code><code class="p">,</code><code> </code><code class="s2">"</code><code class="s2">two</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="n">v2</code><code class="p">}</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">v1</code><code class="p">,</code><code> </code><code class="n">v2</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>two 1</strong></pre>
<p>You can also use a mapping pattern together with an <span class="code"><strong>as</strong></span> clause:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="p">{</code><code class="mi">1</code><code class="p">:</code><code> </code><code class="s2">"</code><code class="s2">two</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="s2">"</code><code class="s2">two</code><code class="s2">"</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">}</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code> </code><strong><code>    </code><code class="n">case</code></strong><code> </code><code class="p">{</code><code class="mi">1</code><code class="p">:</code><code> </code><code class="n">v1</code><code class="p">}</code><code> </code><strong><code class="k">as</code></strong><code> </code><code class="n">v2</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">v1</code><code class="p">,</code><code> </code><code class="n">v2</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>two {1: 'two', 'two': 1}</strong></pre>
<p>The <span class="code"><strong>as</strong></span> pattern in the second example binds <span class="code"><em>v2</em></span> to the whole subject dictionary, not just the matched keys.</p>
<p>The<a contenteditable="false" data-primary="** (double star) operator" data-secondary="mapping pattern (structural pattern matching)" data-type="indexterm" id="idm44924570309456"/><a contenteditable="false" data-primary="double star (**) operator" data-secondary="mapping pattern (structural pattern matching)" data-type="indexterm" id="idm44924570308144"/> final element of the pattern may optionally be a double-starred capture pattern such as <span class="code">**<em>name</em></span>. When that is the case, Python binds <span class="code"><em>name</em></span> to a possibly empty dictionary whose items are the <span class="code">(</span><span class="code"><em>key</em>,</span> <span class="code"><em>value</em></span><span class="code">)</span> pairs from the subject mapping whose keys were <em>not</em> present in the pattern:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="p">{</code><code class="mi">1</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">one</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">two</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">three</code><code class="s1">'</code><code class="p">}</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">case</code></strong><code> </code><code class="p">{</code><code class="mi">2</code><code class="p">:</code><code> </code><code class="n">middle</code><code class="p">,</code><code> </code><code class="o">*</code><code class="o">*</code><code class="n">others</code><code class="p">}</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">middle</code><code class="p">,</code><code> </code><code class="n">others</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>two {1: 'one', 3: 'three'}</strong></pre>
</div></section>
<section data-pdf-bookmark="Class patterns" data-type="sect3"><div class="sect3" id="class_patterns">
<h3>Class patterns</h3>
<p>The<a contenteditable="false" data-primary="match" data-secondary="class patterns" data-type="indexterm" id="idm44924570219680"/><a contenteditable="false" data-primary="class patterns" data-type="indexterm" id="idm44924570218272"/> final and maybe the most versatile kind of pattern is the <em>class pattern</em>, offering the ability to match instances of particular classes and their attributes.</p>
<p>A class pattern is of the general form:</p>
<pre data-type="programlisting">
<em>name_or_attr</em>(<em>patterns</em>)</pre>
<p>where <span class="code"><em>name_or_attr</em></span> is a simple or qualified name bound to a class—specifically, an instance of the built-in type <span class="code">type</span> (or of a subclass thereof, but no super-fancy metaclasses need apply!)—and <span class="code"><em>patterns</em></span> is a (possibly empty) comma-separated list of pattern specifications. When no pattern specifications are present in a class pattern, the match succeeds whenever the subject is an instance of the given class, so for example the pattern <span class="code">int()</span> matches <em>any</em> integer.</p>
<p>Like function arguments and parameters, the pattern specifications can be positional (like <span class="code"><em>pattern</em></span>) or named (like <span class="code"><em>name</em></span><span class="code">=</span><span class="code"><em>pattern</em></span>). If a class pattern has positional pattern specifications, they must all precede the first named pattern specification. User-defined classes cannot use positional patterns without setting the class’s <span class="code"><em>__match_args__</em></span> attribute (see <a data-type="xref" href="#configuring_classes_for_positional_matc">“Configuring classes for positional matching”</a>).</p>
<p>The built-in types <span class="code">bool</span>, <span class="code">bytearray</span>, <span class="code">bytes</span>, <span class="code">dict</span>,<sup><a data-type="noteref" href="ch03.xhtml#ch01fn42" id="ch01fn42-marker">23</a></sup> <span class="code">float</span>, <span class="code">frozenset</span>, <span class="code">int</span>, <span class="code">list</span>, <span class="code">set</span>, <span class="code">str</span>, and <span class="code">tuple</span>, as well as any <span class="code">namedtuple</span> and any <span class="code">dataclass</span>, are all configured to take a single positional pattern, which is matched against the instance value. For example, the pattern <span class="code">str(<em>x</em>)</span> matches any string and binds its value to <span class="code"><em>x</em></span> by matching the string’s value against the capture pattern—as does <span class="code">str()</span> <span class="code"><strong>as</strong></span> <span class="code"><em>x</em></span>.</p>
<p>You may remember a literal pattern example we presented earlier, showing that literal matching could not discriminate between the integer <span class="code">42</span> and the float <span class="code">42.0</span> because <span class="code">42 == 42.0</span>. You can use class matching to overcome that issue:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">subject</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="mi">42</code><code class="p">,</code><code> </code><code class="mf">42.0</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="nb">int</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">integer</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="nb">float</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">float</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
integer 42
float 42.0</pre>
<p>Once the type of the subject value has matched, for each of the named patterns <span class="code"><em>name</em></span><span class="code">=</span><span class="code"><em>pattern</em></span>, Python retrieves the attribute <span class="code"><em>name</em></span> from the instance and matches its value against <span class="code"><em>pattern</em></span>. If all named pattern matches succeed, the whole match succeeds. Python handles positional patterns by converting them to named patterns, as you’ll see momentarily.</p>
</div></section>
<section data-pdf-bookmark="Guards" data-type="sect3"><div class="sect3" id="guards">
<h3>Guards</h3>
<p>When<a contenteditable="false" data-primary="match" data-secondary="guards" data-type="indexterm" id="idm44924570126848"/><a contenteditable="false" data-primary="guards" data-type="indexterm" id="idm44924570125440"/><a contenteditable="false" data-primary="case clauses" data-type="indexterm" id="idm44924570124336"/> a <span class="code"><strong>case</strong></span> clause’s pattern succeeds, it is often convenient to determine on the basis of values extracted from the match whether this <span class="code"><strong>case</strong></span> should execute. When a guard is present, it executes after a successful match. If the guard expression evaluates as false, Python abandons the current <span class="code"><strong>case</strong></span>, despite the match, and moves on to consider the next case. This example uses a guard to exclude odd integers by checking the value bound in the match:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">subject</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="nb">int</code><code class="p">(</code><code class="n">i</code><code class="p">)</code><code> </code><strong><code class="k">if</code></strong><code> </code><code class="n">i</code><code> </code><code class="o">%</code><code> </code><code class="mi">2</code><code> </code><code class="o">==</code><code> </code><code class="mi">0</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">i</code><code class="p">,</code><code> </code><code class="s2">"</code><strong><code class="s2">is</code></strong><code class="s2"> even</code><code class="s2">"</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>0 is even</strong>
<strong>2 is even</strong>
<strong>4 is even</strong></pre>
</div></section>
<section data-pdf-bookmark="Configuring classes for positional matching" data-type="sect3"><div class="sect3" id="configuring_classes_for_positional_matc">
<h3>Configuring classes for positional matching</h3>
<p>When<a contenteditable="false" data-primary="match" data-secondary="configuring classes for positional matching" data-type="indexterm" id="idm44924583608560"/><a contenteditable="false" data-primary="positional matching" data-type="indexterm" id="idm44924583607184"/><a contenteditable="false" data-primary="classes" data-secondary="configuring for positional matching" data-type="indexterm" id="idm44924583606080"/><a contenteditable="false" data-primary="classes" data-type="indexterm" id="idm44924583604736"/> you want your own classes to handle positional patterns in matching, you have to tell the interpreter which <em>attribute of the instance</em> (not which <em>argument to</em> <span class="code"><em>__init__</em></span>) each positional pattern corresponds to. You do this by setting the class’s <span class="code">__match_args__</span> attribute to a sequence of names. The interpreter raises a <span class="code">TypeError</span> exception if you attempt to use more positional patterns than you defined:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">class</code></strong><code> </code><code class="nc">Color</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><code class="n">__match_args__</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">red</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">green</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">blue</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="k">def</code></strong><code> </code><code class="fm">__init__</code><code class="p">(</code><code class="bp">self</code><code class="p">,</code><code> </code><code class="n">r</code><code class="p">,</code><code> </code><code class="n">g</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">name</code><code class="o">=</code><code class="s1">'</code><code class="s1">anonymous</code><code class="s1">'</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><code class="bp">self</code><code class="o">.</code><code class="n">name</code><code> </code><code class="o">=</code><code> </code><code class="n">name</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><code class="bp">self</code><code class="o">.</code><code class="n">red</code><code class="p">,</code><code> </code><code class="bp">self</code><code class="o">.</code><code class="n">green</code><code class="p">,</code><code> </code><code class="bp">self</code><code class="o">.</code><code class="n">blue</code><code> </code><code class="o">=</code><code> </code><code class="n">r</code><code class="p">,</code><code> </code><code class="n">g</code><code class="p">,</code><code> </code><code class="n">b</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">color_red</code><code> </code><code class="o">=</code><code> </code><code class="n">Color</code><code class="p">(</code><code class="mi">255</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">red</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">color_blue</code><code> </code><code class="o">=</code><code> </code><code class="n">Color</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">255</code><code class="p">)</code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">subject</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="p">(</code><code class="mf">42.0</code><code class="p">,</code><code> </code><code class="n">color_red</code><code class="p">,</code><code> </code><code class="n">color_blue</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">match</code></strong><code> </code><code class="n">subject</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="nb">float</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>             </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">float</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="n">Color</code><code class="p">(</code><code class="n">red</code><code class="p">,</code><code> </code><code class="n">green</code><code class="p">,</code><code> </code><code class="n">blue</code><code class="p">,</code><code> </code><code class="n">name</code><code class="o">=</code><code class="s1">'</code><code class="s1">red</code><code class="s1">'</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>             </code><code class="nb">print</code><code class="p">(</code><code class="nb">type</code><code class="p">(</code><code class="n">subject</code><code class="p">)</code><code class="o">.</code><code class="vm">__name__</code><code class="p">,</code><code> </code><code class="n">subject</code><code class="o">.</code><code class="n">name</code><code class="p">,</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>                   </code><code class="n">red</code><code class="p">,</code><code> </code><code class="n">green</code><code class="p">,</code><code> </code><code class="n">blue</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="n">Color</code><code class="p">(</code><code class="n">red</code><code class="p">,</code><code> </code><code class="n">green</code><code class="p">,</code><code> </code><code class="mi">255</code><code class="p">)</code><code> </code><strong><code class="k">as</code></strong><code> </code><code class="n">color</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>             </code><code class="nb">print</code><code class="p">(</code><code class="nb">type</code><code class="p">(</code><code class="n">subject</code><code class="p">)</code><code class="o">.</code><code class="vm">__name__</code><code class="p">,</code><code> </code><code class="n">color</code><code class="o">.</code><code class="n">name</code><code class="p">,</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>                   </code><code class="n">red</code><code class="p">,</code><code> </code><code class="n">green</code><code class="p">,</code><code> </code><code class="n">color</code><code class="o">.</code><code class="n">blue</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><strong><code class="n">case</code></strong><code> </code><code class="n">_</code><code class="p">:</code><code> </code><code class="nb">print</code><code class="p">(</code><code class="nb">type</code><code class="p">(</code><code class="n">subject</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">subject</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>float 42.0</strong>
<strong>Color red 255 0 0</strong>
<strong>Color anonymous 0 0 255</strong></pre>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="n">match</code></strong><code> </code><code class="n">color_red</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>     </code><strong><code class="n">case</code></strong><code> </code><code class="n">Color</code><code class="p">(</code><code class="n">red</code><code class="p">,</code><code> </code><code class="n">green</code><code class="p">,</code><code> </code><code class="n">blue</code><code class="p">,</code><code> </code><code class="n">name</code><code class="p">)</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>         </code><code class="nb">print</code><code class="p">(</code><code class="s2">"</code><code class="s2">matched</code><code class="s2">"</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>Traceback (most recent call last):</strong>
<strong>  File "&lt;stdin&gt;", line 2, in &lt;module&gt;</strong>
<strong>TypeError: Color() accepts 3 positional sub-patterns (4 given)</strong></pre>
</div></section>
</div></section>
<section data-pdf-bookmark="The while Statement" data-type="sect2"><div class="sect2" id="the_while_statement">
<h2>The while Statement</h2>
<p>The<a contenteditable="false" data-primary="control flow statements" data-secondary="while" data-type="indexterm" id="idm44924583198720"/><a contenteditable="false" data-primary="while statement" data-type="indexterm" id="idm44924583197312"/> <span class="code"><strong>while</strong></span> statement repeats execution of a statement or block of statements for as long as a conditional expression evaluates as true. Here’s the syntax of the <span class="code"><strong>while</strong></span> statement:</p>
<pre data-type="programlisting">
<strong>while</strong> <em>expression</em>:
    <em>statement(s)</em></pre>
<p>A <span class="code"><strong>while</strong></span> statement can also include an<a contenteditable="false" data-primary="control flow statements" data-secondary="else clause" data-type="indexterm" id="idm44924583162512"/> <span class="code"><strong>else</strong></span> clause and<a contenteditable="false" data-primary="break keyword" data-secondary="in while statements" data-secondary-sortas="while statements" data-type="indexterm" id="idm44924583160160"/> <span class="code"><strong>break</strong></span> and <span class="code"><strong>continue</strong></span> statements, all of which we’ll discuss after we look at the <span class="code"><strong>for</strong></span> statement.</p>
<p>Here’s a typical <span class="code"><strong>while</strong></span> statement:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">count</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code>
</code><strong><code class="k">while</code></strong><code> </code><code class="n">x</code><code> </code><code class="o">&gt;</code><code> </code><code class="mi">0</code><code class="p">:</code><code>
</code><code>    </code><code class="n">x</code><code> </code><code class="o">/</code><code class="o">/</code><code class="o">=</code><code> </code><code class="mi">2</code><code>            </code><em><code class="c1"># floor division</code></em><code>
</code><code>    </code><code class="n">count</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="mi">1</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">The approximate log2 is</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">count</code><code class="p">)</code></pre>
<p>First Python evaluates <span class="code"><em>expression</em></span>, which is known as the<a contenteditable="false" data-primary="loops" data-secondary="while statement" data-type="indexterm" id="idm44924575370448"/> <em>loop condition</em>, in a Boolean context. When the condition evaluates as false, the <span class="code"><strong>while</strong></span> statement ends. When the loop condition evaluates as true, the statement or block of statements that make up the <em>loop body</em> executes. Once the loop body finishes executing, Python evaluates the loop condition again, to check whether another iteration should execute. This process continues until the loop condition evaluates as false, at which point the <span class="code"><strong>while</strong></span> statement ends.</p>
<p>The loop body should contain code that eventually makes the loop condition false, since otherwise the loop never ends (unless the body raises an exception or executes a <span class="code"><strong>break</strong></span> statement). A loop within a function’s body also ends if the loop body executes a <span class="code"><strong>return</strong></span> statement, since in this case the whole function ends.</p>
</div></section>
<section data-pdf-bookmark="The for Statement" data-type="sect2"><div class="sect2" id="the_for_statement">
<h2>The for Statement</h2>
<p>The<a contenteditable="false" data-primary="control flow statements" data-secondary="for statement" data-type="indexterm" id="idm44924575335440"/><a contenteditable="false" data-primary="for statement" data-type="indexterm" id="forstate03"/><a contenteditable="false" data-primary="for statement" data-secondary="syntax of" data-type="indexterm" id="idm44924575332656"/> <span class="code"><strong>for</strong></span> statement repeats execution of a statement or block of statements controlled by an iterable expression. Here’s the syntax:</p>
<pre data-type="programlisting">
<strong>for</strong> <em>target</em> <strong>in</strong> <em>iterable</em>:
    <em>statement</em>(<em>s</em>)</pre>
<p>The<a contenteditable="false" data-primary="for statement" data-secondary="basics of" data-type="indexterm" id="idm44924575326144"/> <span class="code"><strong>in</strong></span> keyword<a contenteditable="false" data-primary="in keyword" data-secondary="in for statement" data-secondary-sortas="for statement" data-type="indexterm" id="idm44924575323840"/> is part of the syntax of the <span class="code"><strong>for</strong></span> statement; its purpose here is distinct from the <span class="code"><strong>in</strong></span> operator, which tests membership.</p>
<p class="pagebreak-before">Here’s a rather typical <span class="code"><strong>for</strong></span> statement:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">letter</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="s1">'</code><code class="s1">ciao</code><code class="s1">'</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="sa">f</code><code class="s1">'</code><code class="s1">give me a </code><code class="si">{</code><code class="n">letter</code><code class="si">}</code><code class="s1">...</code><code class="s1">'</code><code class="p">)</code></pre>
<p>A <span class="code"><strong>for</strong></span> statement can also include an <span class="code"><strong>else</strong></span> clause and<a contenteditable="false" data-primary="break keyword" data-secondary="in for statements" data-secondary-sortas="for statements" data-type="indexterm" id="idm44924575294000"/> <span class="code"><strong>break</strong></span> and <span class="code"><strong>continue</strong></span> statements; we’ll discuss all of these shortly, starting with <a data-type="xref" href="#the_else_clause_on_loop_statements">“The else Clause on Loop Statements”</a>. As mentioned previously, <span class="code"><em>iterable</em></span> may be any iterable Python expression. In particular, any sequence is iterable. The interpreter implicitly calls the built-in <span class="code">iter</span> on the iterable, producing an <em>iterator</em> (discussed in the following subsection), which it then iterates over.</p>
<p><span class="code"><em>target</em></span> is normally an identifier naming the <em>control variable</em> of the loop; the <span class="code"><strong>for</strong></span> statement successively rebinds this variable to each item of the iterator, in order. The statement or statements that make up the <em>loop body</em> execute once for each item in <span class="code"><em>iterable</em></span> (unless the loop ends because of an exception or a <span class="code"><strong>break</strong></span> or <span class="code"><strong>return</strong></span> statement). Since the loop body may terminate before the iterator is exhausted, this is one case in which you may use an <em>unbounded</em> iterable—one that, per se, would never cease yielding items.</p>
<p>You can also use a target with multiple identifiers, as in an unpacking assignment. In this case, the iterator’s items must themselves be iterables, each with exactly as many items as there are identifiers in the target. For example, when <span class="code"><em>d</em></span> is a dictionary, this is a typical way to loop on the items (key/value pairs) in <span class="code"><em>d</em></span>:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">key</code><code class="p">,</code><code> </code><code class="n">value</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">d</code><code class="o">.</code><code class="n">items</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">key</code><code> </code><strong><code class="ow">and</code></strong><code> </code><code class="n">value</code><code class="p">:</code><code>         </code><em><code class="c1"># print only truthy keys and values</code></em><code>
</code><code>        </code><code class="nb">print</code><code class="p">(</code><code class="n">key</code><code class="p">,</code><code> </code><code class="n">value</code><code class="p">)</code></pre>
<p>The <span class="code">items</span> method returns another kind of iterable (a <em>view</em>), whose items are key/value pairs; so, we use a <span class="code"><strong>for</strong></span> loop with two identifiers in the target to unpack each item into <span class="code">key</span> and <span class="code">value</span>.</p>
<p>Precisely <em>one</em> of the identifiers may be preceded by a star, in which case the starred identifier is bound to a list of all items not assigned to other targets. Although components of a target are commonly identifiers, values can be bound to any acceptable LHS expression, as covered in <a data-type="xref" href="#assignment_statements">“Assignment Statements”</a>—so, the following is correct, although not the most readable style:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">prototype</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">placeholder</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">]</code><code>
</code><strong><code class="k">for</code></strong><code> </code><code class="n">prototype</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="s1">'</code><code class="s1">xyz</code><code class="s1">'</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="n">prototype</code><code class="p">)</code><code>
</code><em><code class="c1"># prints</code></em><code class="c1"> </code><em><code class="c1">[1, 'x', 3]</code></em><em><code class="c1">,</code></em><code class="c1"> </code><em><code class="c1">then</code></em><code class="c1"> </code><em><code class="c1">[1, 'y', 3]</code></em><code class="c1">, </code><em><code class="c1">then</code></em><code class="c1"> </code><em><code class="c1">[1, 'z', 3]</code></em></pre>
<div data-type="warning" epub:type="warning">
<h1>Don’t Alter Mutable Objects While Looping on Them</h1>
<p>When<a contenteditable="false" data-primary="for statement" data-secondary="mutable objects and" data-type="indexterm" id="idm44924575193328"/> an iterator has a mutable underlying iterable, don’t alter that underlying object during the execution of a <strong><span class="code">for</span></strong> loop on the iterable. For example, the preceding key/value printing example cannot alter <em><span class="code">d</span></em>. The <span class="code">items</span> method returns a “view” iterable whose underlying object is <em><span class="code">d</span></em>, so the loop body cannot mutate the set of keys in <em><span class="code">d</span></em> (e.g., by executing <strong><span class="code">del</span></strong> <em><span class="code">d</span></em>[<em><span class="code">key</span></em>]). To ensure that <em><span class="code">d</span></em> is not the underlying object of the iterable, you may, for example, iterate over <span class="code">list(<em>d</em>.items())</span> to allow the loop body to mutate <em><span class="code">d</span></em>. Specifically:</p>
<ul>
<li>
<p>When looping on a list, do not insert, append, or delete items (rebinding an item at an existing index is OK).</p>
</li>
<li>
<p>When looping on a dictionary, do not add or delete items (rebinding the value for an existing key is OK).</p>
</li>
<li>
<p>When looping on a set, do not add or delete items (no alteration is permitted).</p>
</li>
</ul>
</div>
<p>The loop body may rebind the control target variable(s), but the next iteration of the loop always rebinds them again. If the iterator yields no items, the loop body does not execute at all. In this case, the <span class="code"><strong>for</strong></span> statement does not bind or rebind its control variable in any way. If the iterator yields at least one item, however, then when the loop statement ends, the control variable remains bound to the last value to which the loop statement bound it. The following code is therefore correct <em>only</em> when <span class="code">someseq</span> is not empty:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">someseq</code><code class="p">:</code><code>
</code><code>    </code><code class="n">process</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><em><code class="c1"># potential NameError if someseq is empty</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="sa">f</code><code class="s1">'</code><code class="s1">Last item processed was </code><code class="si">{</code><code class="n">x</code><code class="si">}</code><code class="s1">'</code><code class="p">)</code></pre>
<section data-pdf-bookmark="Iterators" data-type="sect3"><div class="sect3" id="iterators">
<h3>Iterators</h3>
<p>An<a contenteditable="false" data-primary="for statement" data-secondary="iterators" data-type="indexterm" id="idm44924575088352"/><a contenteditable="false" data-primary="iterators" data-type="indexterm" id="idm44924575086624"/> <em>iterator</em> is an object <span class="code"><em>i</em></span> such that you can call <span class="code">next(<em>i</em>)</span>, which returns the next item of iterator <span class="code"><em>i</em></span> or, when exhausted, raises a <span class="code">StopIteration</span> exception. Alternatively, you can call <span class="code">next(<em>i</em>,</span> <span class="code"><em>default</em></span><span class="code">)</span>, in which case, when iterator <span class="code"><em>i</em></span> has no more items, the call returns <span class="code"><em>default</em></span>.</p>
<p>When you write a class (see <a data-type="xref" href="ch04.xhtml#classes_and_instances">“Classes and Instances”</a>), you can let instances of the class be iterators by defining a special method <span class="code">__next__</span> that takes no argument except<a contenteditable="false" data-primary="self parameter" data-type="indexterm" id="idm44924575055440"/> <span class="code">self</span>, and returns the next item or raises <span class="code">StopIteration</span>. Most iterators are built by implicit or explicit calls to the built-in function <span class="code">iter</span>, covered in <a data-type="xref" href="ch08.xhtml#pythonapostrophes_core_built_in_functio">Table 8-2</a>. Calling a generator also returns an iterator, as we discuss in <a data-type="xref" href="#generators">“Generators”</a>.</p>
<p class="pagebreak-before">As pointed out previously, the <span class="code"><strong>for</strong></span> statement implicitly calls <span class="code">iter</span> on its iterable to get an iterator. The statement:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">c</code><code class="p">:</code><code>
</code><code>    </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em></pre>
<p>is exactly equivalent to:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="n">_temporary_iterator</code></em><code> </code><code class="o">=</code><code> </code><code class="nb">iter</code><code class="p">(</code><code class="n">c</code><code class="p">)</code><code>
</code><strong><code class="k">while</code><code> </code><code class="kc">True</code></strong><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">try</code></strong><code class="p">:</code><code>
</code><code>        </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="nb">next</code><code class="p">(</code><em><code class="n">_</code></em><em><code class="n">temporary_iterator</code></em><code class="p">)</code><code>
</code><strong><code>    </code><code class="k">except</code></strong><code> </code><code class="ne">StopIteration</code><strong><code class="p">:</code></strong><code>
</code><strong><code>        </code><code class="k">break</code></strong><code>
</code><code>    </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em></pre>
<p>where <span class="code"><em>_temporary_iterator</em></span> is an arbitrary name not used elsewhere in the current scope.</p>
<p>Thus, when<a contenteditable="false" data-primary="unbounded iterators" data-type="indexterm" id="idm44924574980096"/> <span class="code">iter(<em>c</em>)</span> returns an iterator <span class="code"><em>i</em></span> such that <span class="code">next(<em>i</em>)</span> never raises <span class="code">StopIteration</span> (an <em>unbounded iterator</em>), the loop <span class="code"><strong>for</strong></span> <span class="code"><em>x</em></span> <span class="code"><strong>in</strong></span> <span class="code"><em>c</em></span> continues indefinitely unless the loop body includes suitable <span class="code"><strong>break</strong></span> or <span class="code"><strong>return</strong></span> statements, or raises or propagates exceptions. <span class="code">iter(<em>c</em>)</span>, in turn, calls the special method <span class="code"><em>c</em></span><span class="code">.__iter__()</span> to obtain and return an iterator on <span class="code"><em>c</em></span>. We’ll talk more about <span class="code">__iter__</span> in the following subsection and in <a data-type="xref" href="ch04.xhtml#container_method">“Container methods”</a>.</p>
<p>Many of the best ways to build and manipulate iterators are found in the standard library module <span class="code">itertools</span>, covered in <a data-type="xref" href="ch08.xhtml#the_itertools_module">“The itertools Module”</a>.</p>
</div></section>
<section data-pdf-bookmark="Iterables versus iterators" data-type="sect3"><div class="sect3" id="iterables_versus_iterators">
<h3>Iterables versus iterators</h3>
<p>Python’s<a contenteditable="false" data-primary="for statement" data-secondary="iterables versus iterators" data-type="indexterm" id="idm44924574934720"/> built-in sequences, like all iterables, implement an <span class="code">__iter__</span> method, which the interpreter calls to produce an iterator over the iterable. Because each call to the built-in’s <span class="code">__iter__</span> method produces a new iterator, it is possible to nest multiple iterations over the same iterable:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">iterable</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">]</code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">i</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">iterable</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><em><code>    </code></em><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">j</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">iterable</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><em><code>        </code></em><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">j</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>1 1</strong>
<strong>1 2</strong>
<strong>2 1</strong>
<strong>2 2</strong></pre>
<p>Iterators also implement an <span class="code">__iter__</span> method, but it always returns <span class="code">self</span>, so nesting iterations over an iterator doesn’t work as you might expect:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">iterator</code><code> </code><code class="o">=</code><code> </code><code class="nb">iter</code><code class="p">(</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">]</code><code class="p">)</code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">i</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">iterator</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><em><code>    </code></em><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">j</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">iterator</code><code class="p">:</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><em><code>        </code></em><code> </code><code class="nb">print</code><code class="p">(</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">j</code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<pre data-type="programlisting">
<strong>1 2</strong></pre>
<p>Here, both the inner and outer loops are iterating over the same iterator. By the time the inner loop first gets control, the first value from the iterator has already been consumed. The first iteration of the inner loop then exhausts the iterator, making both loops end upon attempting the next iteration.</p>
</div></section>
<section data-pdf-bookmark="range" data-type="sect3"><div class="sect3" id="range">
<h3>range</h3>
<p>Looping<a contenteditable="false" data-primary="for statement" data-secondary="range function" data-type="indexterm" id="idm44924596383168"/><a contenteditable="false" data-primary="range (built-in function)" data-type="indexterm" id="idm44924596381760"/> over a sequence of integers is a common task, so Python provides the built-in function <span class="code">range</span> to generate an iterable over integers. The simplest way to loop <span class="code"><em>n</em></span> times in Python is:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">i</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><em><code class="n">n</code></em><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em></pre>
<p><span class="code">range(<em>x</em>)</span> generates the consecutive integers from <span class="code">0</span> (included) up to <span class="code"><em>x</em></span> (excluded). <span class="code">range(<em>x</em>,</span> <span class="code"><em>y</em></span><span class="code">)</span> generates a list whose items are consecutive integers from <span class="code"><em>x</em></span> (included) up to <span class="code"><em>y</em></span> (excluded). <span class="code">range(<em>x</em>,</span> <span class="code"><em>y</em></span><span class="code">,</span> <span class="code"><em>stride</em></span><span class="code">)</span> generates a list of integers from <span class="code"><em>x</em></span> (included) up to <span class="code"><em>y</em></span> (excluded), such that the difference between each two adjacent items is <span class="code"><em>stride</em></span>. If <span class="code"><em>stride</em></span> <span class="code">&lt; 0</span>, <span class="code">range</span> counts down from <span class="code"><em>x</em></span> to <span class="code"><em>y</em></span>.</p>
<p><span class="code">range</span> generates an empty iterator when <span class="code"><em>x</em></span> <span class="code">&gt;=</span> <span class="code"><em>y</em></span> and <span class="code"><em>stride</em></span> <span class="code">&gt;0</span>, or when <span class="code"><em>x</em></span> <span class="code">&lt;=</span> <span class="code"><em>y</em></span> and <span class="code"><em>stride</em></span> <span class="code">&lt;0</span>. When <span class="code"><em>stride</em></span> <span class="code">==0</span>, <span class="code">range</span> raises an exception.</p>
<p><span class="code">range</span> returns a special-purpose object, intended just for use in iterations like the <span class="code"><strong>for</strong></span> statement shown previously. Note that <span class="code">range</span> returns an iterable, not an iterator; you can easily obtain such an iterator, should you need one, by calling <span class="code">iter(range(...))</span>. The special-purpose object returned by <span class="code">range</span> consumes less memory (for wide ranges, <em>much</em> less memory) than the equivalent <span class="code">list</span> object would. If you really need a <span class="code">list</span> that’s an arithmetic progression of <span class="code">int</span>s, call <span class="code">list(range(...))</span>. You will most often find that you don’t, in fact, need such a complete list to be fully built in memory.</p>
</div></section>
<section data-pdf-bookmark="List comprehensions" data-type="sect3"><div class="sect3" id="list_comprehensions">
<h3>List comprehensions</h3>
<p>A<a contenteditable="false" data-primary="for statement" data-secondary="list comprehensions (listcomps)" data-type="indexterm" id="idm44924596274160"/><a contenteditable="false" data-primary="list comprehensions (listcomps)" data-type="indexterm" id="listcomp03"/> common use of a <span class="code"><strong>for</strong></span> loop is to inspect each item in an iterable and build a new list by appending the results of an expression computed on some or all of the items. The expression form known as a <em>list comprehension</em> or <em>listcomp</em> lets you code this common idiom concisely and directly. Since a list comprehension is an expression (rather than a block of statements), you can use it wherever you need an expression (e.g., as an argument in a function call, in a <span class="code"><strong>return</strong></span> statement, or as a subexpression of some other expression).</p>
<p>A list comprehension has the following syntax:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">[</code><code> </code><em><code class="n">expression</code></em><code> </code><strong><code class="k">for</code></strong><code> </code><em><code class="n">target</code></em><code> </code><strong><code class="ow">in</code></strong><code> </code><em><code class="n">iterable</code><code> </code><code class="n">lc</code><code class="o">-</code><code class="n">clauses</code></em><code> </code><code class="p">]</code></pre>
<p><span class="code"><em>target</em></span> and <span class="code"><em>iterable</em></span> in each <span class="code"><strong>for</strong></span> clause of a list comprehension have the same syntax and meaning as those in a regular <span class="code"><strong>for</strong></span> statement, and the <span class="code"><em>expression</em></span> in each <span class="code"><strong>if</strong></span> clause of a list comprehension has the same syntax and meaning as the <span class="code"><em>expression</em></span> in a regular <span class="code"><strong>if</strong></span> statement. When <span class="code"><em>expression</em></span> denotes a tuple, you must enclose it in parentheses.</p>
<p><span class="code"><em>lc-clauses<a contenteditable="false" data-primary="lc-clauses (in list comprehensions)" data-type="indexterm" id="idm44924596224144"> </a></em></span> is a series of zero or more clauses, each with either this form:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><em><code class="n">target</code></em><code> </code><strong><code class="ow">in</code></strong><code> </code><em><code class="n">iterable</code></em></pre>
<p>or this form:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">if</code></strong><code> </code><em><code class="n">expression</code></em></pre>
<p>A list comprehension is equivalent to a <span class="code"><strong>for</strong></span> loop that builds the same list by repeated calls to the resulting list’s <span class="code">append</span> method.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn43" id="ch01fn43-marker">24</a></sup> For example (assigning the list comprehension result to a variable for clarity), this:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">result</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">x</code><code class="o">+</code><code class="mi">1</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">some_sequence</code><code class="p">]</code></pre>
<p>is just the same as the <span class="code"><strong>for</strong></span> loop:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">result</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>
</code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">some_sequence</code><code class="p">:</code><code>
</code><code>    </code><code class="n">result</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">x</code><code class="o">+</code><code class="mi">1</code><code class="p">)</code></pre>
<div data-type="tip">
<h1>Don’t Build a List Unless You Need To</h1>
<p>If<a contenteditable="false" data-primary="lists" data-secondary="versus generator expressions" data-secondary-sortas="generator expressions (genexps)" data-type="indexterm" id="idm44924596115344"/><a contenteditable="false" data-primary="generator expressions (genexps)" data-type="indexterm" id="idm44924596113856"/> you are just going to loop once over the items, you don’t need an actual indexable list: use a generator expression instead (covered in <a data-type="xref" href="#generator_expressions">“Generator expressions”</a>). This avoids list creation and uses less memory. In particular, resist the temptation to use a list comprehension as a not particularly readable<a contenteditable="false" data-primary="single-line loops" data-type="indexterm" id="idm44924596111536"/> “single-line loop,” like this:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="p">[</code><code class="n">fn</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">seq</code><code class="p">]</code></pre>
<p>and then ignore the resulting list—just use a normal <strong>for</strong> loop instead!</p>
</div>
<p>Here’s a list comprehension that uses an <span class="code"><strong>if</strong></span> clause:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">result</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">x</code><code class="o">+</code><code class="mi">1</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">some_sequence</code><code> </code><strong><code class="k">if</code></strong><code> </code><code class="n">x</code><code class="o">&gt;</code><code class="mi">23</code><code class="p">]</code></pre>
<p>This list comprehension is the same as a <span class="code"><strong>for</strong></span> loop that contains an <span class="code"><strong>if</strong></span> statement:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">result</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>
</code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">some_sequence</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">x</code><code class="o">&gt;</code><code class="mi">23</code><code class="p">:</code><code>
</code><code>        </code><code class="n">result</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">x</code><code class="o">+</code><code class="mi">1</code><code class="p">)</code></pre>
<p>Here’s a list comprehension using a nested <span class="code"><strong>for</strong></span> clause to flatten a “list of lists” into a single list of items:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">result</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">x</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">sublist</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">listoflists</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">sublist</code><code class="p">]</code></pre>
<p>This is the same as a <span class="code"><strong>for</strong></span> loop with another <span class="code"><strong>for</strong></span> loop nested inside:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">result</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>
</code><strong><code class="k">for</code></strong><code> </code><code class="n">sublist</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">listoflists</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">sublist</code><code class="p">:</code><code>
</code><code>        </code><code class="n">result</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="n">I</code></pre>
<p>As these examples show, the order of <span class="code"><strong>for</strong></span> and <span class="code"><strong>if</strong></span> in a list comprehension, is the same as in the equivalent loop, but, in the list comprehension the nesting remains implicit. If you remember “order <span class="code"><strong>for</strong></span> clauses as in a nested loop,” that can help you get the ordering of the list comprehension’s clauses right.</p>
<div data-type="note" epub:type="note">
<h1>List Comprehensions and Variable Scope</h1>
<p>A<a contenteditable="false" data-primary="scope" data-secondary="variable scope" data-type="indexterm" id="idm44924595890528"/><a contenteditable="false" data-primary="variable scope" data-type="indexterm" id="idm44924595889120"/> list comprehension expression evaluates in its own scope (as do set and dictionary comprehensions, described in the following sections, and generator expressions, discussed toward the end of this chapter). When a <em><span class="code">target</span></em> component in the <strong>for</strong> statement is a name, the name is defined solely within the expression scope and is not available outside it.<a contenteditable="false" data-primary="" data-startref="listcomp03" data-type="indexterm" id="idm44924595862816"/></p>
</div>
</div></section>
<section data-pdf-bookmark="Set comprehensions" data-type="sect3"><div class="sect3" id="set_comprehensions">
<h3>Set comprehensions</h3>
<p>A<a contenteditable="false" data-primary="for statement" data-secondary="set comprehensions" data-type="indexterm" id="idm44924595859664"/><a contenteditable="false" data-primary="set comprehensions" data-type="indexterm" id="idm44924595858256"/> <em>set comprehension</em> has exactly the same syntax and semantics as a list comprehension, except that you enclose it in braces (<span class="code">{}</span>) rather than in brackets (<span class="code">[]</span>). The result is a <span class="code">set</span>; for example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">s</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="n">n</code><code class="o">/</code><code class="o">/</code><code class="mi">2</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">n</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code class="p">}</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="nb">sorted</code><code class="p">(</code><code class="n">s</code><code class="p">)</code><code class="p">)</code><code>  </code><em><code class="c1"># prints: [0, 1, 2, 3, 4]</code></em></pre>
<p>A similar list comprehension would have each item repeated twice, but building a <span class="code">set</span> removes duplicates.</p>
</div></section>
<section data-pdf-bookmark="Dictionary comprehensions" data-type="sect3"><div class="sect3" id="dictionary_comprehensions">
<h3>Dictionary comprehensions</h3>
<p>A<a contenteditable="false" data-primary="for statement" data-secondary="dictionary comprehensions" data-type="indexterm" id="idm44924595826896"/><a contenteditable="false" data-primary="dictionary comprehensions" data-type="indexterm" id="idm44924595825520"/> <em>dictionary comprehension</em> has the same syntax as a set comprehension, except that instead of a single expression before the <span class="code"><strong>for</strong></span> clause, you use two expressions with a colon (<span class="code">:</span>) between them: <span class="code"><em>key</em></span><span class="code">:</span><span class="code"><em>value</em></span>. The result is a <span class="code">dict</span>, which retains insertion<a contenteditable="false" data-primary="" data-startref="forstate03" data-type="indexterm" id="idm44924595794912"/> order. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">d</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="n">s</code><code class="p">:</code><code> </code><code class="n">i</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="p">(</code><code class="n">i</code><code class="p">,</code><code> </code><code class="n">s</code><code class="p">)</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">enumerate</code><code class="p">(</code><code class="p">[</code><code class="s1">'</code><code class="s1">zero</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">one</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">two</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code class="p">}</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">d</code><code class="p">)</code><code>          </code><em><code class="c1"># prints: {'zero': 0, 'one': 1, 'two': 2}</code></em></pre>
</div></section>
</div></section>
<section data-pdf-bookmark="The break Statement" data-type="sect2"><div class="sect2" id="the_break_statement">
<h2>The break Statement</h2>
<p>You<a contenteditable="false" data-primary="control flow statements" data-secondary="break" data-type="indexterm" id="idm44924595767408"/><a contenteditable="false" data-primary="break keyword" data-secondary="break statement" data-type="indexterm" id="idm44924595765664"/> can use a <span class="code"><strong>break</strong></span> statement <em>only</em> within a loop body. When <span class="code"><strong>break</strong></span> executes, the loop terminates <em>without executing any</em> <strong><em><span class="code">else</span></em></strong> <em>clause on the loop</em>. When loops are nested, a <span class="code"><strong>break</strong></span> terminates only the innermost nested loop. In practice, a <span class="code"><strong>break</strong></span> is typically within a clause of an <span class="code"><strong>if</strong></span> (or, occasionally, <span class="code"><strong>match</strong></span>) statement in the loop body, so that <span class="code"><strong>break</strong></span> executes conditionally.</p>
<p>One common use of <span class="code"><strong>break</strong></span> is to implement a loop that decides whether it should keep looping only in the middle of each loop iteration (what Donald Knuth called the “loop and a half” structure in his great 1974 paper <a href="https://oreil.ly/8aebY">“Structured Programming with go to Statements”</a><sup><a data-type="noteref" href="ch03.xhtml#ch01fn44" id="ch01fn44-marker">25</a></sup>). For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">while</code><code> </code><code class="kc">True</code></strong><code class="p">:</code><code>          </code><em><code class="c1"># this loop can never terminate "naturally"</code></em><code>
</code><code>    </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="n">get_next</code><code class="p">(</code><code class="p">)</code><code>
</code><code>    </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="n">preprocess</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">if</code><code> </code><code class="ow">not</code></strong><code> </code><code class="n">keep_looping</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">break</code></strong><code>
</code><code>    </code><code class="n">process</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">)</code></pre>
</div></section>
<section data-pdf-bookmark="The continue Statement" data-type="sect2"><div class="sect2" id="the_continue_statement">
<h2>The continue Statement</h2>
<p>Like<a contenteditable="false" data-primary="control flow statements" data-secondary="continue" data-type="indexterm" id="idm44924592264496"/><a contenteditable="false" data-primary="continue statements" data-type="indexterm" id="idm44924592263088"/> <span class="code"><strong>break</strong></span>, the <span class="code"><strong>continue</strong></span> statement can exist only within a loop body. It causes the current iteration of the loop body to terminate, and execution continues with the next iteration of the loop. In practice, a <span class="code"><strong>continue</strong></span> is usually within a clause of an <span class="code"><strong>if</strong></span> (or, occasionally, a <span class="code"><strong>match</strong></span>) statement in the loop body, so that <span class="code"><strong>continue</strong></span> executes conditionally.</p>
<p>Sometimes, a <span class="code"><strong>continue</strong></span> statement can take the place of nested <span class="code"><strong>if</strong></span> statements within a loop. For example, here each <span class="code">x</span> has to pass multiple tests before being completely processed:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">some_container</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">seems_ok</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><code class="n">lowbound</code><code class="p">,</code><code> </code><code class="n">highbound</code><code> </code><code class="o">=</code><code> </code><code class="n">bounds_to_test</code><code class="p">(</code><code class="p">)</code><code>
</code><code>        </code><strong><code class="k">if</code></strong><code> </code><code class="n">lowbound</code><code> </code><code class="o">&lt;</code><code class="o">=</code><code> </code><code class="n">x</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">highbound</code><code class="p">:</code><code>
</code><code>            </code><code class="n">pre_process</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code>            </code><strong><code class="k">if</code></strong><code> </code><code class="n">final_check</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>                </code><code class="n">do_processing</code><code class="p">(</code><code class="n">x</code><code class="p">)</code></pre>
<p>Nesting increases with the number of conditions. Equivalent code with <span class="code"><strong>continue</strong></span> “flattens” the logic:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">some_container</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><strong><code class="ow">not</code></strong><code> </code><code class="n">seems_ok</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">continue</code></strong><code>
</code><code>    </code><code class="n">lowbound</code><code class="p">,</code><code> </code><code class="n">highbound</code><code> </code><code class="o">=</code><code> </code><code class="n">bounds_to_test</code><code class="p">(</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">x</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">lowbound</code><code> </code><strong><code class="ow">or</code></strong><code> </code><code class="n">x</code><code> </code><code class="o">&gt;</code><code class="o">=</code><code> </code><code class="n">highbound</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">continue</code></strong><code>
</code><code>    </code><code class="n">pre_process</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">final_check</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><code class="n">do_processing</code><code class="p">(</code><code class="n">x</code><code class="p">)</code></pre>
<div data-type="tip">
<h1>Flat Is Better Than Nested</h1>
<p>Both versions work the same way, so which one you use is a matter of personal preference and style. One of the principles of <a href="https://oreil.ly/luTv7">The Zen of Python</a> (which you can see at any time by typing <strong><span class="code">import this</span></strong> at an interactive Python interpreter prompt) is “Flat is better than nested.” The <strong><span class="code">continue</span></strong> statement is just one way Python helps you move toward the goal of a less-nested structure in a loop, when you choose to follow this tip.</p>
</div>
</div></section>
<section data-pdf-bookmark="The else Clause on Loop Statements" data-type="sect2"><div class="sect2" id="the_else_clause_on_loop_statements">
<h2>The else Clause on Loop Statements</h2>
<p><span class="code"><strong>while</strong></span> and <span class="code"><strong>for</strong></span> statements<a contenteditable="false" data-primary="control flow statements" data-secondary="else clause" data-type="indexterm" id="idm44924592087984"/><a contenteditable="false" data-primary="else clause" data-secondary="on while and for loops" data-secondary-sortas="while and for loops" data-type="indexterm" id="idm44924592086608"/><a contenteditable="false" data-primary="loops" data-secondary="else clause" data-type="indexterm" id="idm44924592054304"/> may optionally have a trailing <span class="code"><strong>else</strong></span> clause. The statement or block under that clause executes when the loop terminates <em>naturally</em> (at the end of the <span class="code"><strong>for</strong></span> iterator, or when the <span class="code"><strong>while</strong></span> loop condition becomes false), but not when the<a contenteditable="false" data-primary="break keyword" data-secondary="in else clauses" data-secondary-sortas="else clauses" data-type="indexterm" id="idm44924592049840"/> loop terminates <em>prematurely</em> (via <span class="code"><strong>break</strong></span>, <span class="code"><strong>return</strong></span>, or an exception). When a loop contains one or more <span class="code"><strong>break</strong></span> statements, you’ll often want to check whether it terminates naturally or prematurely. You can use an <span class="code"><strong>else</strong></span> clause on the loop for this purpose:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">some_container</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">is_ok</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">break</code></strong><code>  </code><em><code class="c1"># item x is satisfactory, terminate loop</code></em><code>
</code><strong><code class="k">else</code></strong><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">Beware: no satisfactory item was found in container</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>    </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><strong><code class="kc">None</code></strong></pre>
</div></section>
<section data-pdf-bookmark="The pass Statement" data-type="sect2"><div class="sect2" id="the_pass_statement">
<h2>The pass Statement</h2>
<p>The<a contenteditable="false" data-primary="control flow statements" data-secondary="pass" data-type="indexterm" id="idm44924592008768"/><a contenteditable="false" data-primary="pass statement" data-type="indexterm" id="idm44924592007520"/> body of a Python compound statement cannot be empty; it must always contain at least one statement. You can use a <span class="code"><strong>pass</strong></span> statement, which performs no action, as an explicit placeholder when a statement is syntactically required but you have nothing to do. Here’s an example of using <span class="code"><strong>pass</strong></span> in a conditional statement as a part of some rather convoluted logic to test mutually exclusive conditions:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">if</code></strong><code> </code><code class="n">condition1</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">process1</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><strong><code class="k">elif</code></strong><code> </code><code class="n">x</code><code class="o">&gt;</code><code class="mi">23</code><code> </code><strong><code class="ow">or</code></strong><code> </code><code class="p">(</code><code class="n">x</code><code class="o">&lt;</code><code class="mi">5</code><code> </code><strong><code class="ow">and</code></strong><code> </code><code class="n">condition2</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">pass</code></strong><code>       </code><em><code class="c1"># nothing to be done in this case</code></em><code>
</code><strong><code class="k">elif</code></strong><code> </code><code class="n">condition3</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">process3</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><strong><code class="k">else</code></strong><code class="p">:</code><code>
</code><code>    </code><code class="n">process_default</code><code class="p">(</code><code class="n">x</code><code class="p">)</code></pre>
<div data-type="tip">
<h1>Empty def or class Statements: Use a Docstring, Not pass</h1>
<p>You can also use a docstring, covered in <a data-type="xref" href="#docstrings">“Docstrings”</a>, as the body of an otherwise empty <strong><span class="code">def</span></strong> or <strong><span class="code">class</span></strong> statement. When you do this, you do not need to also add a <strong><span class="code">pass</span></strong> statement (you can do so if you wish, but it’s not optimal Python style).</p>
</div>
</div></section>
<section data-pdf-bookmark="The try and raise Statements" data-type="sect2"><div class="sect2" id="the_try_and_raise_statements">
<h2>The try and raise Statements</h2>
<p>Python<a contenteditable="false" data-primary="control flow statements" data-secondary="try and raise" data-type="indexterm" id="idm44924591923936"/><a contenteditable="false" data-primary="try statement" data-type="indexterm" id="idm44924591922208"/><a contenteditable="false" data-primary="raise statement" data-type="indexterm" id="idm44924591921104"/> supports<a contenteditable="false" data-primary="exception handling" data-type="indexterm" id="idm44924591892512"/> exception handling with the <span class="code"><strong>try</strong></span> statement, which includes <span class="code"><strong>try</strong></span>, <span class="code"><strong>except</strong></span>, <span class="code"><strong>finally</strong></span>, and <span class="code"><strong>else</strong></span> clauses. Your code can also explicitly raise an exception with the <span class="code"><strong>raise</strong></span> statement. When code raises an exception, normal control flow of the program stops and Python looks for a suitable exception handler. We discuss all of this in detail in <a data-type="xref" href="ch06.xhtml#exception_propagation">“Exception Propagation”</a>.</p>
</div></section>
<section data-pdf-bookmark="The with Statement" data-type="sect2"><div class="sect2" id="the_with_statement">
<h2>The with Statement</h2>
<p>A<a contenteditable="false" data-primary="control flow statements" data-secondary="with" data-type="indexterm" id="idm44924591883440"/><a contenteditable="false" data-primary="with statement" data-type="indexterm" id="idm44924591882032"/> <span class="code"><strong>with</strong></span> statement can often be a more readable, useful alternative to the <span class="code"><strong>try</strong></span><span class="code">/</span><span class="code"><strong>finally</strong></span> statement. We discuss it in detail in <a data-type="xref" href="ch06.xhtml#the_with_statement_and_context_managers">“The with Statement and Context Managers”</a>. A good grasp of context managers can often help you structure your code more clearly without compromising efficiency.<a contenteditable="false" data-primary="" data-startref="PLconflo03" data-type="indexterm" id="idm44924591876832"/><a contenteditable="false" data-primary="" data-startref="conflo03" data-type="indexterm" id="idm44924591875488"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Functions" data-type="sect1"><div class="sect1" id="function">
<h1>Functions</h1>
<p>Most<a contenteditable="false" data-primary="Python language" data-secondary="functions" data-type="indexterm" id="PLfunc03"/> statements in a typical Python program are part of some function. Code in a function body may be faster than at a module’s top level, as covered in <a data-type="xref" href="ch17.xhtml#avoid_exec_and_from_dotdotdot_import_as">“Avoid exec and from ... import *”</a>, so there are excellent practical reasons to put most of your code into functions—and there are no disadvantages: clarity, readability and code reusability all improve when you avoid having any substantial chunks of module-level code.</p>
<p>A<a contenteditable="false" data-primary="functions" data-secondary="definition of term" data-type="indexterm" id="idm44924591868640"/> <em>function</em> is a group of statements that execute upon request. Python provides many built-in functions and lets programmers define their own functions. A request to execute a function is known as a<a contenteditable="false" data-primary="function calls" data-type="indexterm" id="idm44924591866656"/> <em>function call</em>. When you call a function, you can pass arguments that specify data upon which the function performs its computation. In Python, a function always returns a result: either <span class="code"><strong>None</strong></span> or a value, the result of the computation. Functions defined within <span class="code"><strong>class</strong></span> statements are also known<a contenteditable="false" data-primary="methods" data-secondary="definition of term" data-type="indexterm" id="idm44924591863312"/> as <em>methods</em>. We cover issues specific to methods in <a data-type="xref" href="ch04.xhtml#bound_and_unbound_methods">“Bound and Unbound Methods”</a>; the general coverage of functions in this section, however, also applies to methods.</p>
<p>Python is somewhat unusual in the flexibility it affords the programmer in defining and calling functions. This flexibility does mean that some constraints are not adequately expressed solely by the syntax. In Python, functions are objects (values), handled just like other objects. Thus, you can pass a function as an argument in a call to another function, and a function can return another function as the result of a call. A function, just like any other object, can be bound to a variable, can be an item in a container, and can be an attribute of an object. Functions can also be keys in a dictionary. The fact that functions are ordinary objects in Python is often expressed by saying that functions are<a contenteditable="false" data-primary="objects" data-secondary="first-class objects" data-type="indexterm" id="idm44924591860208"/><a contenteditable="false" data-primary="first-class objects" data-type="indexterm" id="idm44924591858832"/> <em>first-class</em> objects.</p>
<p>For example, given a <span class="code">dict</span> keyed by functions, with the values being each function’s inverse, you could make the dictionary bidirectional by adding the inverse values as keys, with their corresponding keys as values. Here’s a small example of this idea, using some functions from the module <span class="code">math</span> (covered in <a data-type="xref" href="ch16.xhtml#the_math_and_cmath_modules">“The math and cmath Modules”</a>), that takes a one-way mapping of inverse pairs and then adds the inverse of each entry to complete the mapping:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">add_inverses</code><code class="p">(</code><code class="n">i_dict</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">for</code></strong><code> </code><code class="n">f</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">list</code><code class="p">(</code><code class="n">i_dict</code><code class="p">)</code><code class="p">:</code><code>  </code><em><code class="c1"># iterates over keys while mutating i_dict</code></em><code class="c1"> </code><code>
</code><code>        </code><code class="n">i_dict</code><code class="p">[</code><code class="n">i_dict</code><code class="p">[</code><code class="n">f</code><code class="p">]</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">f</code><code>
</code><code class="n">math_map</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="n">sin</code><code class="p">:</code><code class="n">asin</code><code class="p">,</code><code> </code><code class="n">cos</code><code class="p">:</code><code class="n">acos</code><code class="p">,</code><code> </code><code class="n">tan</code><code class="p">:</code><code class="n">atan</code><code class="p">,</code><code> </code><code class="n">log</code><code class="p">:</code><code class="n">exp</code><code class="p">}</code><code>
</code><code class="n">add_inverses</code><code class="p">(</code><code class="n">math_map</code><code class="p">)</code></pre>
<p>Note that in this case the function mutates its argument (whence its need to use a <span class="code">list</span> call for looping). In Python, the usual convention is for such functions not to return a value (see <a data-type="xref" href="#the_return_statement">“The return Statement”</a>).</p>
<section data-pdf-bookmark="Defining Functions: The def Statement" data-type="sect2"><div class="sect2" id="defining_functions_the_def_statement">
<h2>Defining Functions: The def Statement</h2>
<p>The<a contenteditable="false" data-primary="functions" data-secondary="defining with def statement" data-type="indexterm" id="idm44924591795296"/><a contenteditable="false" data-primary="def statement" data-type="indexterm" id="idm44924591793824"/> <span class="code"><strong>def</strong></span> statement is the usual way to create a function. <span class="code"><strong>def</strong></span> is a single-clause compound statement with the following syntax:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><em><code class="nf">function_name</code></em><code class="p">(</code><em><code class="n">parameters</code></em><code class="p">)</code><code class="p">:</code><code>
</code><code>   </code><em><code class="n">statement</code><code class="p">(</code><code class="n">s</code><code class="p">)</code></em></pre>
<p><span class="code"><em>function_name</em></span> is an identifier, and the nonempty indented <span class="code"><em>statement(s)</em></span> are the <em>function body</em>. When the interpreter encounters a <span class="code"><strong>def</strong></span> statement, it compiles the function body, creating a function object, and binds (or rebinds, if there was an existing binding) <span class="code"><em>function_name</em></span> to the compiled function object in the containing namespace (typically the module namespace, or a class namespace when defining methods).</p>
<p><span class="code"><em>parameters</em></span> is an optional list specifying the identifiers that will be bound to values that each function call provides. We distinguish between those identifiers, and the values provided for them in calls, as usual in computer science by referring to the former as <em>parameters</em> and the latter as<a contenteditable="false" data-primary="arguments" data-type="indexterm" id="idm44924591741008"/> <em>arguments</em>.</p>
<p>In the simplest case, a function defines no parameters, meaning the function won’t accept any arguments when you call it. In this case, the <span class="code"><strong>def</strong></span> statement has empty parentheses after <span class="code"><em>function_name</em></span>, as must all calls. Otherwise, <span class="code"><em>parameters</em></span> will be a list of specifications (see <a data-type="xref" href="#parameters">“Parameters”</a>). The function body does not execute when the <span class="code"><strong>def</strong></span> statement executes; rather, Python compiles it into bytecode, saves it as the function object’s <span class="code">__code__</span> attribute, and executes it later on each call to the function. The function body can contain zero or more occurrences of the <span class="code"><strong>return</strong></span> statement, as we’ll discuss shortly.</p>
<p>Each call to the function supplies argument expressions corresponding to parameters in the function definition. The interpreter evaluates the argument expressions from left to right and creates a new namespace in which it binds the argument values to the parameter names as local variables of the function call (as we discuss in <a data-type="xref" href="#calling_functions">“Calling Functions”</a>). Then Python executes the function body, with the function call namespace as the local namespace.</p>
<p>Here’s a simple function that returns a value that is twice the value passed to it each time it’s called:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">twice</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">x</code><code class="o">*</code><code class="mi">2</code></pre>
<p>The argument can be anything that you can multiply by two, so you could call the function with a number, string, list, or tuple as an argument. Each call returns a new value of the same type as the argument: <span class="code">twice('ciao')</span>, for example, returns <span class="code">'ciaociao'</span>.</p>
<p>The number of parameters of a function, together with the parameters’ names, the number of mandatory parameters, and the information on whether and where unmatched arguments should be collected, are a specification known as the function’s <em>signature</em>. A signature defines how you can call the function.</p>
</div></section>
<section data-pdf-bookmark="Parameters" data-type="sect2"><div class="sect2" id="parameters">
<h2>Parameters</h2>
<p>Parameters<a contenteditable="false" data-primary="functions" data-secondary="parameters" data-type="indexterm" id="idm44924591697024"/><a contenteditable="false" data-primary="parameters" data-type="indexterm" id="param03"/><a contenteditable="false" data-primary="formal parameters" data-type="indexterm" id="idm44924591694240"/> (pedantically, <em>formal parameters</em>) name the values passed into a function call, and may specify default values for them. Each time you call the function, the call binds each parameter name to the corresponding argument value in a new local namespace, which Python later destroys on function exit.</p>
<p>Besides letting you name individual arguments, Python also lets you collect argument values not matched by individual parameters, and lets you specifically require that some arguments be positional, or be named.</p>
<section data-pdf-bookmark="Positional parameters" data-type="sect3"><div class="sect3" id="positional_parameters">
<h3>Positional parameters</h3>
<p>A<a contenteditable="false" data-primary="positional parameters" data-type="indexterm" id="idm44924570082192"/> positional parameter is an identifier, <span class="code"><em>name</em></span>, which names the parameter. You use these names inside the function body to access the argument values to the call. Callers can normally provide values for these parameters with either positional or named arguments (see <a data-type="xref" href="#matching_arguments_to_parameters">“Matching arguments to parameters”</a>).</p>
</div></section>
<section data-pdf-bookmark="Named parameters" data-type="sect3"><div class="sect3" id="named_parameters">
<h3>Named parameters</h3>
<p>Named parameters<a contenteditable="false" data-primary="named parameters" data-type="indexterm" id="idm44924570077152"/><a contenteditable="false" data-primary="default parameters" data-type="indexterm" id="idm44924570075696"/><a contenteditable="false" data-primary="optional parameters" data-type="indexterm" id="idm44924570074592"/><a contenteditable="false" data-primary="keyword parameters" data-type="indexterm" id="idm44924570073488"/> normally take the form <span class="code"><em>name</em></span><span class="code">=<em>expression</em></span> (<span class="version">3.8+</span> or come after a positional argument collector, often just <span class="code">*</span>, as discussed shortly). They are also often known (when written in the traditional <span class="code"><em>name</em>=</span><span class="code"><em>expression</em></span> form) as <em>default</em>, <em>optional</em>, and even—confusingly, since they do not involve any Python keywords—<em>keyword</em> parameters. When it executes a <span class="code"><strong>def</strong></span> statement, the interpreter evaluates each such <span class="code"><em>expression</em></span> and saves the resulting value, known as the<a contenteditable="false" data-primary="default values" data-type="indexterm" id="idm44924570064544"/> <em>default value</em> for the parameter, among the attributes of the function object. A function call thus need not provide an argument value for a named parameter written in the traditional form: the call uses the default value given as the <span class="code"><em>expression</em></span>. You may provide positional arguments as values for some named parameters (<span class="version">3.8+</span> except for parameters that are identified as named ones by appearing after a positional argument collector; see also <a data-type="xref" href="#matching_arguments_to_parameters">“Matching arguments to parameters”</a>).</p>
<p>Python computes each default value <em>exactly once</em>, when the <span class="code"><strong>def</strong></span> statement executes, <em>not</em> each time you call the resulting function. In particular, this means that Python binds exactly the <em>same</em> object, the default value, to the named parameter whenever the caller does not supply a corresponding argument.</p>
<div data-type="warning" epub:type="warning">
<h1>Avoid Mutable Default Values</h1>
<p>A function can alter a mutable default value, such as a list, each time you call the function without an argument corresponding to the respective parameter. This is usually not the behavior you want; for details, see <a data-type="xref" href="#mutable_default_parameter_values">“Mutable default parameter values”</a>.</p>
</div>
</div></section>
<section data-pdf-bookmark="Positional-only marker" data-type="sect3"><div class="sect3" id="positional_only_marker">
<h3>Positional-only marker</h3>
<p><span class="version">3.8+</span> A<a contenteditable="false" data-primary="function signatures" data-secondary="positional-only marker (/)" data-type="indexterm" id="idm44924570052192"/> function’s signature may contain<a contenteditable="false" data-primary="positional-only marker (/)" data-type="indexterm" id="idm44924570050640"/><a contenteditable="false" data-primary="/ (positional-only marker)" data-type="indexterm" id="idm44924570049472"/> a single <em>positional-only marker</em> (<span class="code">/</span>) as a dummy parameter. The parameters preceding the marker are known as<a contenteditable="false" data-primary="positional parameters" data-secondary="positional-only parameters" data-type="indexterm" id="idm44924570047056"/> <em>positional-only parameters</em>, and <em>must</em> be provided as positional arguments, <em>not</em> named arguments, when calling the function; using named arguments for these parameters raises a <span class="code">TypeError</span> exception.</p>
<p>The built-in <span class="code">int</span> type, for example, has the following signature:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="nb">int</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="o">/</code><code class="p">,</code> <code class="n">base</code><code class="o">=</code><code class="mi">10</code><code class="p">)</code></pre>
<p>When calling <span class="code">int</span>, you must pass a value for x and you must pass it positionally. <span class="code">base</span> (used when <span class="code">x</span> is a string to be converted to <span class="code">int</span>) is optional, and you may pass it either positionally or as a named argument (it’s an error to pass <span class="code">x</span> as a number and also pass <span class="code">base</span>, but the notation cannot capture that quirk).</p>
</div></section>
<section data-pdf-bookmark="Positional argument collector" data-type="sect3"><div class="sect3" id="positional_argument_collector">
<h3>Positional argument collector</h3>
<p>The<a contenteditable="false" data-primary="positional argument collector" data-type="indexterm" id="idm44924570017520"/> positional argument collector can take one of two forms, either <span class="code">*</span><span class="code"><em>name</em></span> or <span class="version">3.8+</span> just <span class="code">*</span>. In the former case, <span class="code"><em>name</em></span> is bound at call time to a tuple of unmatched positional arguments (when all positional arguments are matched, the tuple is empty). In the latter case (the <span class="code">*</span> is a dummy parameter), a call with unmatched positional arguments raises a <span class="code">TypeError</span> exception.</p>
<p>When<a contenteditable="false" data-primary="function signatures" data-secondary="positional argument collector (*)" data-type="indexterm" id="idm44924570010800"/> a function’s signature has either kind of positional argument collector, no call can provide a positional argument for a named parameter coming after the collector: the collector prohibits (in the <span class="code">*</span> form) or gives a destination for (in the <span class="code"><em>*name</em></span> form) positional arguments that do not correspond to parameters coming before it.</p>
<p>For example, consider this function from the <span class="code">random</span> module:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">sample</code><code class="p">(</code><code class="n">population</code><code class="p">,</code><code> </code><code class="n">k</code><code class="p">,</code><code> </code><code class="o">*</code><code class="p">,</code><code> </code><code class="n">counts</code><code class="o">=</code><strong><code class="kc">None</code></strong><code class="p">)</code><code class="p">:</code></pre>
<p>When calling <span class="code">sample</span>, values for <span class="code">population</span> and <span class="code">k</span> are required, and may be passed positionally or by name. <span class="code">counts</span> is optional; if you do pass it, you must pass it as a named argument.</p>
</div></section>
<section data-pdf-bookmark="Named argument collector" data-type="sect3"><div class="sect3" id="named_argument_collector">
<h3>Named argument collector</h3>
<p>This<a contenteditable="false" data-primary="named argument collector" data-type="indexterm" id="idm44924569968976"/><a contenteditable="false" data-primary="** (double star) operator" data-secondary="named argument collector" data-type="indexterm" id="dstarname03"/><a contenteditable="false" data-primary="double star (**) operator" data-secondary="named argument collector" data-type="indexterm" id="DSOname03"/> final, optional parameter specification has the form <span class="code">**<em>name</em></span>. When the function is called, <span class="code"><em>name</em></span> is bound to a dictionary whose items are the <span class="code">(</span><span class="code"><em>key</em>,</span> <span class="code"><em>value</em></span><span class="code">)</span> pairs of any unmatched named arguments, or an empty dictionary if there are no such arguments.</p>
</div></section>
<section data-pdf-bookmark="Parameter sequence" data-type="sect3"><div class="sect3" id="parameter_sequence">
<h3>Parameter sequence</h3>
<p>Generally speaking, positional parameters are followed by named parameters, with the positional and named argument collectors (if present) last. The positional-only marker, however, may appear at any position in the list of parameters.</p>
</div></section>
<section data-pdf-bookmark="Mutable default parameter values" data-type="sect3"><div class="sect3" id="mutable_default_parameter_values">
<h3>Mutable default parameter values</h3>
<p>When<a contenteditable="false" data-primary="default values" data-type="indexterm" id="idm44924569937024"/> a named parameter’s default value is a mutable object, and the function body alters the parameter, things get tricky. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="o">=</code><code class="p">[</code><code class="p">]</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">y</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="nb">id</code><code class="p">(</code><code class="n">y</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">y</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">f</code><code class="p">(</code><code class="mi">23</code><code class="p">)</code><code class="p">)</code><code>             </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">(4302354376, [23])</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">f</code><code class="p">(</code><code class="mi">42</code><code class="p">)</code><code class="p">)</code><code>             </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">(4302354376, [23, 42])</code></em></pre>
<p>The second <span class="code">print</span> prints <span class="code">[23, 42]</span> because the first call to <span class="code">f</span> altered the default value of <span class="code">y</span>, originally an empty list <span class="code">[]</span>, by appending <span class="code">23</span> to it. The <span class="code">id</span> values (always equal to each other, although otherwise arbitrary) confirm that both calls return the same object. If you want <span class="code">y</span> to be a new, empty list object, each time you call <span class="code">f</span> with a single argument (a far more frequent need!), use the following idiom instead:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="o">=</code><strong><code class="kc">None</code></strong><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">y</code><code> </code><strong><code class="ow">is</code><code> </code><code class="kc">None</code></strong><code class="p">:</code><code>
</code><code>        </code><code class="n">y</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="p">]</code><code>
</code><code>    </code><code class="n">y</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="nb">id</code><code class="p">(</code><code class="n">y</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">y</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">f</code><code class="p">(</code><code class="mi">23</code><code class="p">)</code><code class="p">)</code><code>             </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">(4302354376, [23])</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">f</code><code class="p">(</code><code class="mi">42</code><code class="p">)</code><code class="p">)</code><code>             </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">(4302180040, [42])</code></em></pre>
<p>There may be cases in which you explicitly want a mutable default parameter value that is preserved across multiple function calls, most often for caching purposes, as in the following example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">cached_compute</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">_cache</code><code class="o">=</code><code class="p">{</code><code class="p">}</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">if</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">not</code><code> </code><code class="ow">in</code></strong><code> </code><code class="n">_cache</code><code class="p">:</code><code>
</code><code>        </code><code class="n">_cache</code><code class="p">[</code><code class="n">x</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">costly_computation</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">_cache</code><code class="p">[</code><code class="n">x</code><code class="p">]</code></pre>
<p>Such caching behavior (also known as <em>memoization</em>) is usually best obtained by decorating the underlying <span class="code">costly_computation</span> function with <span class="code">functools.lru_cache</span>, covered in <a data-type="xref" href="ch08.xhtml#functions_and_attributes_of_the_functoo">Table 8-7</a> and discussed in detail in <a data-type="xref" href="ch17.xhtml#testingcomma_debuggingcomma_and_optimiz">Chapter 17</a>.</p>
</div></section>
<section data-pdf-bookmark="Argument collector parameters" data-type="sect3"><div class="sect3" id="argument_collector_parameters">
<h3>Argument collector parameters</h3>
<p>The<a contenteditable="false" data-primary="argument collector parameters" data-type="indexterm" id="idm44924569725344"/><a contenteditable="false" data-primary="function signatures" data-secondary="argument collector parameters" data-type="indexterm" id="idm44924569723856"/> presence of argument collectors (the special forms <span class="code">*</span>, <span class="code">*</span><span class="code"><em>name</em></span>, or <span class="code">**</span><span class="code"><em>name</em></span>) in a function’s signature allows a function to prohibit (<span class="code">*</span>) or collect positional (<span class="code">*</span><span class="code"><em>name</em></span>) or named (<span class="code">**</span><span class="code"><em>name</em></span>) arguments that do not match any parameters (see <a data-type="xref" href="#matching_arguments_to_parameters">“Matching arguments to parameters”</a>). There is no requirement to use specific names—you can use any identifier you want in each special form. <span class="code">*args</span> and <span class="code">**kwds</span> or<a contenteditable="false" data-primary="** (double star) operator" data-secondary="kwargs" data-type="indexterm" id="idm44924569684672"/><a contenteditable="false" data-primary="double star (**) operator" data-secondary="kwargs" data-type="indexterm" id="idm44924569683296"/> <span class="code">**kwargs</span>, as well as <span class="code">*a</span> and <span class="code">**k</span>, are popular choices.</p>
<p>The<a contenteditable="false" data-primary="asterisk (*)" data-secondary="argument collector parameters" data-type="indexterm" id="idm44924569679456"/><a contenteditable="false" data-primary="* (asterisk)" data-secondary="argument collector parameters" data-type="indexterm" id="idm44924569678080"/> presence of the special form <span class="code">*</span> causes calls with unmatched positional arguments to raise a <span class="code">TypeError</span> exception.</p>
<p><span class="code">*args</span><a contenteditable="false" data-primary="*args" data-type="indexterm" id="idm44924569674304"/><a contenteditable="false" data-primary="function signatures" data-secondary="*args and **kwds in" data-type="indexterm" id="idm44924569673200"/> specifies that any extra positional arguments to a call (i.e., positional arguments not matching positional parameters in the function signature) get collected into a (possibly empty) tuple, bound in the call’s local namespace to the name <span class="code">args</span>. Without a positional argument collector, unmatched positional arguments raise a <span class="code">TypeError</span> exception.</p>
<p>For example, here’s a function that accepts any number of positional arguments and returns their sum (and demonstrates the use of an identifier other than <span class="code">*args</span>):</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">sum_sequence</code><code class="p">(</code><code class="o">*</code><code class="n">numbers</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="nb">sum</code><code class="p">(</code><code class="n">numbers</code><code class="p">)</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">sum_sequence</code><code class="p">(</code><code class="mi">23</code><code class="p">,</code><code> </code><code class="mi">42</code><code class="p">)</code><code class="p">)</code><code>        </code><em><code class="c1"># prints: 65</code></em></pre>
<p>Similarly, <span class="code">**</span><span class="code"><em>kwds<a contenteditable="false" data-primary="double star (**) operator" data-secondary="kwds" data-type="indexterm" id="idm44924569640176"> </a><a contenteditable="false" data-primary="** (double star) operator" data-secondary="kwds" data-type="indexterm" id="idm44924569638864"> </a></em></span> specifies that any extra named arguments (i.e., those named arguments not explicitly specified in the signature) get collected into a (possibly empty) dictionary whose items are the names and values of those arguments, bound to the name <span class="code"><em>kwds</em></span> in the function call namespace.</p>
<p>For example, the following function takes a dictionary whose keys are strings and whose values are numeric, and adds given amounts to certain values:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">inc_dict</code><code class="p">(</code><code class="n">d</code><code class="p">,</code><code> </code><code class="o">*</code><code class="o">*</code><code class="n">values</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">for</code></strong><code> </code><code class="n">key</code><code class="p">,</code><code> </code><code class="n">value</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">values</code><code class="o">.</code><code class="n">items</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><strong><code>        </code><code class="k">if</code></strong><code> </code><code class="n">key</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">d</code><code class="p">:</code><code>
</code><strong><code>           </code></strong><code> </code><code class="n">d</code><code class="p">[</code><code class="n">key</code><code class="p">]</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="n">value</code><code>
</code><strong><code>        </code><code class="k">else</code></strong><code class="p">:</code><code>
</code><code>            </code><code class="n">d</code><code class="p">[</code><code class="n">key</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">value</code><code>
</code><code>
</code><code class="n">my_dict</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">one</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">two</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">}</code><code>
</code><code>
</code><code class="n">inc_dict</code><code class="p">(</code><code class="n">my_dict</code><code class="p">,</code><code> </code><code class="n">one</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">new</code><code class="o">=</code><code class="mi">42</code><code class="p">)</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">my_dict</code><code class="p">)</code><code>                </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">{'one': 4, 'two': 2, 'new':42}</code></em></pre>
<p>Without a named argument collector, unmatched named arguments raise a <span class="code">T⁠y⁠p⁠e​E⁠r⁠r⁠o⁠r</span> exception.<a contenteditable="false" data-primary="" data-startref="param03" data-type="indexterm" id="idm44924569512560"/><a contenteditable="false" data-primary="" data-startref="DSOname03" data-type="indexterm" id="idm44924569511312"/><a contenteditable="false" data-primary="" data-startref="dstarname03" data-type="indexterm" id="idm44924569527984"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Attributes of Function Objects" data-type="sect2"><div class="sect2" id="attributes_of_function_objects">
<h2>Attributes of Function Objects</h2>
<p>The<a contenteditable="false" data-primary="functions" data-secondary="attributes of function objects" data-type="indexterm" id="idm44924569525024"/> <span class="code"><strong>def</strong></span> statement sets some attributes of a function object <span class="code"><em>f</em></span>. The string attribute <span class="code"><em>f</em></span><span class="code">.__name__</span> is the identifier that <span class="code"><strong>def</strong></span> uses as the function’s name. You may rebind <span class="code">__name__</span> to any string value, but trying to unbind it raises a <span class="code">TypeError</span> exception. <span class="code"><em>f</em></span><span class="code">.__defaults__</span>, which you may freely rebind or unbind, is the tuple of default values for named parameters (empty, if the function has no named parameters).</p>
<section data-pdf-bookmark="Docstrings" data-type="sect3"><div class="sect3" id="docstrings">
<h3>Docstrings</h3>
<p>Another<a contenteditable="false" data-primary="documentation strings (docstrings)" data-type="indexterm" id="idm44924569475536"/><a contenteditable="false" data-primary="docstrings (documentation strings)" data-type="indexterm" id="idm44924569474432"/> function attribute is the <em>documentation string</em>, or <em>docstring</em>. You may use or rebind a function <span class="code"><em>f</em></span>’s docstring attribute as <span class="code"><em>f</em></span><span class="code">.__doc__</span>. When the first statement in the function body is a string literal, the compiler binds that string as the function’s docstring attribute. A similar rule applies to classes and modules (see <a data-type="xref" href="ch04.xhtml#class_documentation_strings">“Class documentation strings”</a> and <a data-type="xref" href="ch07.xhtml#module_documentation_strings">“Module documentation strings”</a>). Docstrings can span multiple physical lines, so it’s best to specify them in triple-quoted string literal form. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">sum_sequence</code><code class="p">(</code><code class="o">*</code><code class="n">numbers</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><em><code class="sd">"""Return the sum of multiple numerical arguments.</code></em><code class="sd">

       </code><em><code class="sd">The arguments are zero or more numbers.</code></em><code class="sd">
       </code><em><code class="sd">The result is their sum.</code></em><code class="sd">
    </code><em><code class="sd">"""</code></em><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="nb">sum</code><code class="p">(</code><code class="n">numbers</code><code class="p">)</code></pre>
<p>Documentation strings should be part of any Python code you write. They play a role similar to that of comments, but they are even more useful, since they remain available at runtime (unless you run your program with <span class="code"><strong>python -OO</strong></span>, as covered in <a data-type="xref" href="ch02.xhtml#command_line_syntax_and_options">“Command-Line Syntax and Options”</a>). Python’s <span class="code">help</span> function (see <a data-type="xref" href="ch02.xhtml#interactive_sessions">“Interactive Sessions”</a>), development environments, and other tools can use the docstrings from function, class, and module objects to remind the programmer how to use those objects. The <span class="code">doctest</span> module (covered in <a data-type="xref" href="ch17.xhtml#the_doctest_module">“The doctest Module”</a>) makes it easy to check that sample code present in docstrings, if any, is accurate and correct, and remains so as the code and docs get edited and maintained.</p>
<p>To make your docstrings as useful as possible, respect a few simple conventions, as detailed in <a href="https://oreil.ly/CVF7t">PEP 257</a>. The first line of a docstring should be a concise summary of the function’s purpose, starting with an uppercase letter and ending with a period. It should not mention the function’s name, unless the name happens to be a natural-language word that comes naturally as part of a good, concise summary of the function’s operation. Use imperative rather than descriptive form: e.g., say “Return xyz…” rather than “Returns xyz…” If the docstring is multiline, the second line should be empty, and the following lines should form one or more paragraphs, separated by empty lines, describing the function’s parameters, preconditions, return value, and side effects (if any). Further explanations, bibliographical references, and usage examples—which you should always check with <span class="code">doctest</span>—can optionally (and often very usefully!) follow toward the end of the docstring.</p>
</div></section>
<section data-pdf-bookmark="Other attributes of function objects" data-type="sect3"><div class="sect3" id="other_attributes_of_function_objects">
<h3>Other attributes of function objects</h3>
<p>In addition to its predefined attributes, a function object may have other arbitrary attributes. To create an attribute of a function object, bind a value to the appropriate attribute reference in an assignment statement after the <span class="code"><strong>def</strong></span> statement executes. For example, a function could count how many times it gets called:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">counter</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">counter</code><code class="o">.</code><code class="n">count</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="mi">1</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">counter</code><code class="o">.</code><code class="n">count</code><code>
</code><code class="n">counter</code><code class="o">.</code><code class="n">count</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code></pre>
<p>Note that this is <em>not</em> common usage. More often, when you want to group together some state (data) and some behavior (code), you should use the object-oriented mechanisms covered in <a data-type="xref" href="ch04.xhtml#object_oriented_python">Chapter 4</a>. However, the ability to associate arbitrary attributes with a function can sometimes come in handy.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Function Annotations" data-type="sect2"><div class="sect2" id="function_annotations">
<h2>Function Annotations</h2>
<p>Every<a contenteditable="false" data-primary="functions" data-secondary="function annotations" data-type="indexterm" id="idm44924569385856"/> parameter in a <span class="code"><strong>def</strong></span> clause can be <em>annotated</em> with an arbitrary expression—that is, wherever within the <span class="code"><strong>def</strong></span>’s parameter list you can use an identifier, you can alternatively use the form <span class="code"><em>identifier</em></span><span class="code">:</span><span class="code"><em>expression</em></span>, and the expression’s value becomes the<a contenteditable="false" data-primary="annotations" data-type="indexterm" id="idm44924569355696"/> <em>annotation</em> for that parameter.</p>
<p>You can also annotate the return value of the function, using the form <span class="code"><em>-&gt;expression</em></span> between the <span class="code">)</span> of the <span class="code"><strong>def</strong></span> clause and the <span class="code">:</span> that ends the <span class="code"><strong>def</strong></span> clause; the expression’s value becomes the annotation for the name <span class="code">'return'</span>. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">a</code><code class="p">:</code><code class="s1">'</code><code class="s1">foo</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">)</code><code class="o">-</code><code class="o">&gt;</code><code class="s1">'</code><code class="s1">bar</code><code class="s1">'</code><code class="p">:</code><code> </code><strong><code class="k">pass</code></strong><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>
</code><code class="o">&gt;&gt;</code><code class="o">&gt;</code><code> </code><code class="n">f</code><code class="o">.</code><code class="vm">__annotations__</code></pre>
<pre data-type="programlisting">
<strong>{'a': 'foo', 'return': 'bar'}</strong></pre>
<p>As shown in this example, the <span class="code">__annotations__</span> attribute of the function object is a <span class="code">dict</span> mapping each annotated identifier to the respective annotation.</p>
<p>You can currently, in theory, use annotations for whatever purpose you wish: Python itself does nothing with them, except construct the <span class="code">__annotations__</span> attribute. For detailed information about annotations used for type hinting, which is now normally considered their key use, see <a data-type="xref" href="ch05.xhtml#type_annotations">Chapter 5</a>.</p>
</div></section>
<section data-pdf-bookmark="The return Statement" data-type="sect2"><div class="sect2" id="the_return_statement">
<h2>The return Statement</h2>
<p>You<a contenteditable="false" data-primary="functions" data-secondary="return statement" data-type="indexterm" id="idm44924569310512"/><a contenteditable="false" data-primary="return statement" data-type="indexterm" id="idm44924569309104"/> can use the <span class="code"><strong>return</strong></span> keyword in Python only inside a function body, and you can optionally follow it with an expression. When <span class="code"><strong>return</strong></span> executes, the function terminates, and the value of the expression is the function’s result. A function returns <span class="code"><strong>None</strong></span> when it terminates by reaching the end of its body, or by executing a <span class="code"><strong>return</strong></span> statement with no expression (or by explicitly executing <span class="code"><strong>return</strong></span> <span class="code"><strong>None</strong></span>).</p>
<div data-type="tip">
<h1>Good Style in return Statements</h1>
<p>As a matter of good style, when some <span class="code"><strong>return</strong></span> statements in a function have an expression, then <em>all</em> <span class="code"><strong>return</strong></span> statements <span class="keep-together">in the</span> function should have an expression. <span class="code"><strong>return</strong></span> <span class="code"><strong>None</strong></span> should only ever be written explicitly to meet this style requirement. <em>Never</em> write a <span class="code"><strong>return</strong></span> statement without an expression at the end of a function body. Python does not enforce these stylistic conventions, but your code is clearer and more readable when you follow them.</p>
</div>
</div></section>
<section data-pdf-bookmark="Calling Functions" data-type="sect2"><div class="sect2" id="calling_functions">
<h2>Calling Functions</h2>
<p>A<a contenteditable="false" data-primary="functions" data-secondary="calling functions" data-type="indexterm" id="idm44924569271520"/> function call is an expression with the following syntax:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="n">function_object</code></em><code class="p">(</code><em><code class="n">arguments</code></em><code class="p">)</code></pre>
<p><span class="code"><em>function_object</em></span> may be any reference to a function (or other callable) object; most often, it’s just the function’s name. The parentheses denote the function call operation itself. <span class="code"><em>arguments</em></span>, in the simplest case, is a series of zero or more expressions separated by commas (<span class="code">,</span>), giving values for the function’s corresponding parameters. When the function call executes, the parameters are bound to the argument values in a new namespace, the function body executes, and the value of the function call expression is whatever the function returns. Objects created inside and returned by the function are liable to garbage collection unless the caller retains a reference to them.</p>
<div data-type="warning" epub:type="warning">
<h1>Don’t Forget the Trailing () to Call a Function</h1>
<p>Just<a contenteditable="false" data-primary="() (parentheses)" data-secondary="function calls" data-type="indexterm" id="idm44924569236496"/><a contenteditable="false" data-primary="parentheses (())" data-secondary="function calls" data-type="indexterm" id="idm44924569235088"/> <em>mentioning</em> a function (or other callable object) does <em>not</em>, per se, call it. To <em>call</em> a function (or other object) without arguments, you <em>must</em> use <span class="code">()</span> after the function’s name (or other reference to the callable object).</p>
</div>
<section data-pdf-bookmark="Positional and named arguments" data-type="sect3"><div class="sect3" id="positional_and_named_arguments">
<h3>Positional and named arguments</h3>
<p>Arguments<a contenteditable="false" data-primary="positional arguments" data-type="indexterm" id="idm44924569259600"/><a contenteditable="false" data-primary="named arguments" data-type="indexterm" id="idm44924569258464"/><a contenteditable="false" data-primary="arguments" data-type="indexterm" id="arg03"/><a contenteditable="false" data-primary="functions" data-secondary="positional and named arguments" data-type="indexterm" id="FSpnarg03"/> can be of two types. <em>Positional</em> arguments are simple expressions; <em>named</em> (also known, alas, as <em>keyword</em><sup><a data-type="noteref" href="ch03.xhtml#ch01fn45" id="ch01fn45-marker">26</a></sup>) arguments take the form:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="n">identifier</code></em><code class="o">=</code><em><code class="n">expression</code></em></pre>
<p>It is a syntax error for named arguments to precede positional ones in a function call. Zero or more positional arguments may be followed by zero or more named arguments. Each positional argument supplies the value for the parameter that corresponds to it by position (order) in the function definition. There is no requirement for positional arguments to match positional parameters, or vice versa—if there are more positional arguments than positional parameters, the additional arguments are bound by position to named parameters, if any, for all parameters preceding an argument collector in the signature. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">c</code><code class="o">=</code><code class="mi">23</code><code class="p">,</code><code> </code><code class="n">d</code><code class="o">=</code><code class="mi">42</code><code class="p">,</code><code> </code><code class="o">*</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">c</code><code class="p">,</code><code> </code><code class="n">d</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">)</code><code>
</code><code class="n">f</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">)</code><code>  </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">1 2 3 4 (5, 6)</code></em></pre>
<p>Note that it matters where in the function signature the argument collector appears (see <a data-type="xref" href="#matching_arguments_to_parameters">“Matching arguments to parameters”</a> for all the gory details):</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="o">*</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">c</code><code class="o">=</code><code class="mi">23</code><code class="p">,</code><code> </code><code class="n">d</code><code class="o">=</code><code class="mi">42</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">c</code><code class="p">,</code><code> </code><code class="n">d</code><code class="p">)</code><code>
</code><code class="n">f</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code class="mi">2</code><code class="p">,</code><code class="mi">3</code><code class="p">,</code><code class="mi">4</code><code class="p">,</code><code class="mi">5</code><code class="p">,</code><code class="mi">6</code><code class="p">)</code><code>  </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">1 2 (3, 4, 5, 6) 23 42</code></em></pre>
<p>In the absence of any named argument collector (<span class="code">**</span><span class="code"><em>name</em></span>) parameter, each argument’s name must be one of the parameter names used in the function’s signature.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn46" id="ch01fn46-marker">27</a></sup> The <span class="code"><em>expression</em></span> supplies the value for the parameter of that name. Many built-in functions do not accept named arguments: you must call such functions with positional arguments only. However, functions coded in Python usually accept named as well as positional arguments, so you may call them in different ways. Positional parameters can be matched by named arguments, in the absence of matching positional arguments.</p>
<p>A function call must supply, via a positional or a named argument, exactly one value for each mandatory parameter, and zero or one value for each optional parameter.<sup><a data-type="noteref" href="ch03.xhtml#ch01fn47" id="ch01fn47-marker">28</a></sup> For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">divide</code><code class="p">(</code><code class="n">divisor</code><code class="p">,</code><code> </code><code class="n">dividend</code><code class="o">=</code><code class="mi">94</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">dividend</code><code> </code><code class="o">/</code><code class="o">/</code><code> </code><code class="n">divisor</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">divide</code><code class="p">(</code><code class="mi">12</code><code class="p">)</code><code class="p">)</code><code>                          </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">7</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">divide</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code><code> </code><code class="mi">94</code><code class="p">)</code><code class="p">)</code><code>                      </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">7</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">divide</code><code class="p">(</code><code class="n">dividend</code><code class="o">=</code><code class="mi">94</code><code class="p">,</code><code> </code><code class="n">divisor</code><code class="o">=</code><code class="mi">12</code><code class="p">)</code><code class="p">)</code><code>     </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">7</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">divide</code><code class="p">(</code><code class="n">divisor</code><code class="o">=</code><code class="mi">12</code><code class="p">)</code><code class="p">)</code><code>                  </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">7</code></em></pre>
<p>As you can see, the four calls to <span class="code">divide</span> here are equivalent. You can pass named arguments for readability purposes whenever you think that identifying the role of each argument and controlling the order of arguments enhances your code’s clarity.</p>
<p>A common use of named arguments is to bind some optional parameters to specific values, while letting other optional parameters take default values:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">middle</code><code class="p">,</code><code> </code><code class="n">begin</code><code class="o">=</code><code class="s1">'</code><code class="s1">init</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">end</code><code class="o">=</code><code class="s1">'</code><code class="s1">finis</code><code class="s1">'</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">begin</code><code class="o">+</code><code class="n">middle</code><code class="o">+</code><code class="n">end</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">f</code><code class="p">(</code><code class="s1">'</code><code class="s1">tini</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">end</code><code class="o">=</code><code class="s1">'</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>                   </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">inittini</code></em></pre>
<p>With the named argument <span class="code">end=''</span>, the caller specifies a value (the empty string <span class="code">''</span>) for <span class="code">f</span>’s third parameter, <span class="code">end</span>, and still lets <span class="code"><em>f</em></span>’s second parameter, <span class="code">begin</span>, use its default value, the string <span class="code">'init'</span>. You may pass the arguments as positional even when parameters are named; for example, with the preceding function:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="nb">print</code><code class="p">(</code><code class="n">f</code><code class="p">(</code><code class="s1">'</code><code class="s1">a</code><code class="s1">'</code><code class="p">,</code><code class="s1">'</code><code class="s1">c</code><code class="s1">'</code><code class="p">,</code><code class="s1">'</code><code class="s1">t</code><code class="s1">'</code><code class="p">)</code><code class="p">)</code><code>                      </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">cat</code></em></pre>
<p>At the end of the arguments in a function call, you may optionally use either or both of the special forms<a contenteditable="false" data-primary="*seq" data-type="indexterm" id="idm44924575873952"/> <span class="code">*</span><span class="code"><em>seq</em></span> and <span class="code">**</span><span class="code"><em>dct</em></span>. If both forms are present, the form with two asterisks must be last. <span class="code">*</span><span class="code"><em>seq</em></span> passes the items of iterable <span class="code"><em>seq</em></span> to the function as positional arguments (after the normal positional arguments, if any, that the call gives with the usual syntax). <span class="code"><em>seq</em></span> may be any iterable. <span class="code">**</span><span class="code"><em>dct</em></span> passes the items of <span class="code"><em>dct</em></span> to the function as named arguments, where <span class="code"><em>dct</em></span> must be a mapping whose keys are all strings. Each item’s key is a parameter name, and the item’s value is the argument’s value.</p>
<p>You may want to pass an argument of the form <span class="code">*</span><span class="code"><em>seq</em></span> or <span class="code">**</span><span class="code"><em>dct</em></span> when the parameters use similar forms, as discussed in <a data-type="xref" href="#parameters">“Parameters”</a>. For example, using the function <span class="code">sum_sequence</span> defined in that section (and shown again here), you may want to print the sum of all the values in the dictionary <span class="code"><em>d</em></span>. This is easy with <span class="code">*</span><span class="code"><em>seq</em></span>:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">sum_sequence</code><code class="p">(</code><code class="o">*</code><code class="n">numbers</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="nb">sum</code><code class="p">(</code><code class="n">numbers</code><code class="p">)</code><code>
</code><code>
</code><code class="n">d</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">a</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">b</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">100</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">c</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1000</code><code class="p">}</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">sum_sequence</code><code class="p">(</code><code class="o">*</code><code class="n">d</code><code class="o">.</code><code class="n">values</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code class="p">)</code></pre>
<p>(Of course, <span class="code">print(sum(d.values())</span>) would be simpler and more direct.)</p>
<p>A function call may have zero or more occurrences of <span class="code">*</span><span class="code"><em>seq</em></span> and/or <span class="code">**</span><span class="code"><em>dct</em></span>, as specified in <a href="https://oreil.ly/6lHq_">PEP 448</a>. You may even pass <span class="code">*</span><span class="code"><em>seq</em></span> or <span class="code">**</span><span class="code"><em>dct</em></span> when calling a function that does not use the corresponding form in its signature. In that case, you must ensure that the iterable <span class="code"><em>seq</em></span> has the right number of items, or that the dictionary <span class="code"><em>dct</em></span> uses the right identifier strings as keys; otherwise, the call raises an exception. As noted in the following section, a positional argument <em>cannot</em> match a “keyword-only” parameter; only a named argument, explicit or passed<a contenteditable="false" data-primary="** (double star) operator" data-secondary="kwargs" data-type="indexterm" id="idm44924575751184"/><a contenteditable="false" data-primary="double star (**) operator" data-secondary="kwargs" data-type="indexterm" id="idm44924575749840"/> via <span class="code">**</span><span class="code"><em>kwargs</em></span>, can do that.<a contenteditable="false" data-primary="" data-startref="FSpnarg03" data-type="indexterm" id="idm44924575746928"/></p>
</div></section>
<section data-pdf-bookmark="“Keyword-only” parameters" data-type="sect3"><div class="sect3" id="quotation_markkeyword_onlyquotation_mar">
<h3>“Keyword-only” parameters</h3>
<p>Parameters<a contenteditable="false" data-primary="keyword-only parameters" data-type="indexterm" id="idm44924575744496"/><a contenteditable="false" data-primary="parameters" data-type="indexterm" id="parameter03"/><a contenteditable="false" data-primary="function signatures" data-secondary="keyword-only parameters" data-type="indexterm" id="idm44924575741984"/> after a positional argument collector (<span class="code">*</span><span class="code"><em>name</em></span> or <span class="version">3.8+</span> <span class="code">*</span>) in the function’s signature are known as <em>keyword-only parameters</em>: the corresponding arguments, if any, <em>must</em> be named arguments. In the absence of any match by name, such a parameter is bound to its default value, as set at function definition time.</p>
<p>Keyword-only parameters can be either positional or named. However, you <em>must</em> pass them as named arguments, not as positional ones. It’s more usual and readable to have simple identifiers, if any, at the start of the keyword-only parameter specifications, and <span class="code"><em>identifier</em></span><span class="code">=</span><span class="code"><em>default</em></span> forms, if any, following them, though this is not a requirement of the Python language.</p>
<p>Functions requiring keyword-only parameter specifications <em>without</em> collecting “surplus” positional arguments indicate the start of the keyword-only parameter specifications with a dummy parameter consisting solely of an asterisk (<span class="code">*</span>), to which no argument corresponds. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="o">*</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">c</code><code class="o">=</code><code class="mi">56</code><code class="p">)</code><code class="p">:</code><code>  </code><em><code class="c1"># b and c are keyword only</code></em><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">c</code><code>
</code><code class="n">f</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code><code> </code><code class="n">b</code><code class="o">=</code><code class="mi">34</code><code class="p">)</code><code>  </code><em><code class="c1"># Returns (12, 34, 56) c is optional, it has a default</code></em><code>
</code><code class="n">f</code><code class="p">(</code><code class="mi">12</code><code class="p">)</code><code>        </code><em><code class="c1"># Raises a TypeError exception, since you didn't pass b</code></em><code>
</code><em><code class="c1"># Error message is: missing 1 required keyword-only argument: 'b'</code></em></pre>
<p><a contenteditable="false" data-primary="** (double star) operator" data-secondary="kwds" data-type="indexterm" id="idm44924575725504"/><a contenteditable="false" data-primary="double star (**) operator" data-secondary="kwds" data-type="indexterm" id="idm44924575724288"/>If you also specify the special form <span class="code">**</span><span class="code"><em>kwds</em></span>, it must come at the end of the parameter list (after the keyword-only parameter specifications, if any). For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">g</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="o">*</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="o">=</code><code class="mi">23</code><code class="p">,</code><code> </code><code class="o">*</code><code class="o">*</code><code class="n">k</code><code class="p">)</code><code class="p">:</code><code>  </code><em><code class="c1"># b is keyword only</code></em><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">k</code><code>
</code><code class="n">g</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="n">c</code><code class="o">=</code><code class="mi">99</code><code class="p">)</code><code>          </code><em><code class="c1"># Returns (1, (2, 3), 23, {'c': 99})</code></em></pre>
</div></section>
<section data-pdf-bookmark="Matching arguments to parameters" data-type="sect3"><div class="sect3" id="matching_arguments_to_parameters">
<h3>Matching arguments to parameters</h3>
<p>A call <em>must</em> provide an argument for all positional parameters, and <em>may</em> do so for named parameters that are not keyword only.</p>
<p>The matching proceeds as follows:</p>
<ol>
<li>
<p>Arguments of the form <span class="code">*</span><span class="code"><em>expression</em></span> are internally replaced by a sequence of positional arguments obtained by iterating over <span class="code"><em>expression</em></span>.</p>
</li>
<li>
<p>Arguments of the form <span class="code">**</span><span class="code"><em>expression</em></span> are internally replaced by a sequence of keyword arguments whose names and values are obtained by iterating over <span class="code"><em>expression</em></span>’s <span class="code">items()</span>.</p>
</li>
<li>
<p>Say that the function has <em>N</em> positional parameters and the call has <em>M</em> positional arguments:</p>
<ul>
<li>
<p>When <em>M</em>≤<em>N</em>, bind all the positional arguments to the first <em>M</em> positional parameter names; the remaining positional parameters, if any, <em>must</em> be matched by named arguments.</p>
</li>
<li>
<p>When <em>M</em>&gt;<em>N</em>, bind the remaining<a contenteditable="false" data-primary="function signatures" data-secondary="matching arguments to parameters" data-type="indexterm" id="idm44924575571536"/> positional arguments to named parameters <em>in the order in which they appear in the signature</em>. This process terminates in one of three ways:</p>
<ol type="a">
<li>
<p>All positional arguments have been bound.</p>
</li>
<li>
<p>The next item in the signature is a <span class="code">*</span> argument collector: the interpreter raises a <span class="code">TypeError</span> exception.</p>
</li>
<li>
<p>The next item in the signature is a <span class="code">*</span><span class="code"><em>name</em></span> argument collector: the remaining positional arguments are collected in a tuple that is then bound to <span class="code"><em>name</em></span> in the function call namespace.</p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p>The named arguments are then matched, in the order of the arguments’ occurrences in the call, by name with the parameters—both positional and named. Attempts to rebind an already bound parameter name raise a <span class="code">TypeError</span> <span class="keep-together">exception</span>.</p>
</li>
<li>
<p>If unmatched named arguments remain at this stage:</p>
<ul>
<li>
<p>When the function signature includes a <span class="code">**<em>name</em></span> collector, the interpreter creates a dictionary with key/value pairs <span class="code">(</span><span class="code"><em>argument's_name, argument's_value</em>)</span>, and binds it to <span class="code"><em>name</em></span> in the function call namespace.</p>
</li>
<li>
<p>In the absence of such an argument collector, Python raises a <span class="code">TypeError</span> exception.</p>
</li>
</ul>
</li>
<li>
<p>Any remaining unmatched named parameters are bound to their default <span class="keep-together">values</span>.</p>
</li>
</ol>
<p>At this point, the function call namespace is fully populated, and the interpreter executes the function’s body using that “call namespace” as the local namespace for the function.<a contenteditable="false" data-primary="" data-startref="parameter03" data-type="indexterm" id="idm44924575550512"/></p>
</div></section>
<section data-pdf-bookmark="The semantics of argument passing" data-type="sect3"><div class="sect3" id="the_semantics_of_argument_passing">
<h3>The semantics of argument passing</h3>
<p>In traditional terms, all argument passing in Python is <em>by value</em> (although, in modern terminology, to say that argument passing is <em>by object reference</em> is more precise and accurate; check out the synonym <a href="https://oreil.ly/kst2h"><em>call by sharing</em></a>). When you pass a variable as an argument, Python passes to the function the object (value) to which the variable currently refers (not “the variable itself”!), binding this object to the parameter name in the function call namespace. Thus, a function <em>cannot</em> rebind the caller’s variables. Passing a mutable object as an argument, however, allows the function to make changes to that object, because Python passes a reference to the object itself, not a copy. Rebinding a variable and mutating an object are totally disjoint concepts. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">f</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">x</code><code> </code><code class="o">=</code><code> </code><code class="mi">23</code><code>
</code><code>    </code><code class="n">y</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="mi">42</code><code class="p">)</code><code>
</code><code class="n">a</code><code> </code><code class="o">=</code><code> </code><code class="mi">77</code><code>
</code><code class="n">b</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">99</code><code class="p">]</code><code>
</code><code class="n">f</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">)</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">)</code><code>             </code><em><code class="c1"># prints: 77</code></em><code class="c1"> </code><em><code class="c1">[99, 42]</code></em></pre>
<p><span class="code">print</span> shows that <span class="code">a</span> is still bound to <span class="code">77</span>. Function <span class="code">f</span>’s rebinding of its parameter <span class="code">x</span> to <span class="code">23</span> has no effect on <span class="code">f</span>’s caller, nor, in particular, on the binding of the caller’s variable that happened to be used to pass <span class="code">77</span> as the parameter’s value. However, <span class="code">print</span> also shows that <span class="code">b</span> is now bound to <span class="code">[99, 42]</span>. <span class="code">b</span> is still bound to the same list object as before the call, but <span class="code">f</span> has appended <span class="code">42</span> to that list object, mutating it. In neither case has <span class="code">f</span> altered the caller’s bindings, nor can <span class="code">f</span> alter the number <span class="code">77</span>, since numbers are immutable. <span class="code">f</span> can alter a list object, though, since list objects are mutable.<a contenteditable="false" data-primary="" data-startref="arg03" data-type="indexterm" id="idm44924575457056"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Namespaces" data-type="sect2"><div class="sect2" id="namespaces">
<h2>Namespaces</h2>
<p>A<a contenteditable="false" data-primary="functions" data-secondary="namespaces" data-type="indexterm" id="idm44924575454112"/><a contenteditable="false" data-primary="namespaces" data-type="indexterm" id="namepsp03"/> function’s parameters, plus any names that are bound (by assignment or by other binding statements, such as <span class="code"><strong>def</strong></span>) in the function body, make up the<a contenteditable="false" data-primary="local namespace/scope" data-type="indexterm" id="idm44924575450224"/> function’s <em>local namespace</em>, also known as its<a contenteditable="false" data-primary="local scope" data-type="indexterm" id="idm44924575448576"/> <em>local scope</em>. Each of these variables is known as a <em>local variable</em> of the function.</p>
<p>Variables that are not local are known as<a contenteditable="false" data-primary="global variables" data-type="indexterm" id="idm44924575446128"/><a contenteditable="false" data-primary="variables and other references" data-secondary="global variables" data-type="indexterm" id="idm44924575445024"/> <em>global variables</em> (in the absence of nested function definitions, which we’ll discuss shortly). Global variables are attributes of the module object, as covered in <a data-type="xref" href="ch07.xhtml#attributes_of_module_objects">“Attributes of module objects”</a>. Whenever a function’s local variable has the same name as a global variable, that name, within the function body, refers to the local variable, not the global one. We express this by saying that the local variable <em>hides</em> the global variable of the same name throughout the function body.</p>
<section data-pdf-bookmark="The global statement" data-type="sect3"><div class="sect3" id="the_global_statement">
<h3>The global statement</h3>
<p>By default, any variable bound in a function body is local to the function. If a function needs to bind or rebind some global variables (<em>not</em> best practice!), the first statement of the function’s body must be:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">global</code></strong><code> </code><em><code class="n">identifiers</code></em></pre>
<p>where <span class="code"><em>identifiers</em></span> is one or more identifiers separated by<a contenteditable="false" data-primary="comma (,)" data-secondary="in global statements" data-secondary-sortas="global statements" data-type="indexterm" id="idm44924575398064"/><a contenteditable="false" data-primary=", (comma)" data-secondary="in global statements" data-secondary-sortas="global statements" data-type="indexterm" id="idm44924575436816"/> commas (<span class="code">,</span>). The identifiers listed in a <span class="code"><strong>global</strong></span> statement refer to the global variables (i.e., attributes of the module object) that the function needs to bind or rebind. For example, the function <span class="code">counter</span> that we saw in <a data-type="xref" href="#other_attributes_of_function_objects">“Other attributes of function objects”</a> could be implemented using <span class="code"><strong>global</strong></span> and a global variable, rather than an attribute of the function object:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">_count</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code>
</code><strong><code class="k">def</code></strong><code> </code><code class="nf">counter</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">global</code></strong><code> </code><code class="n">_count</code><code>
</code><code>    </code><code class="n">_count</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="mi">1</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">_count</code></pre>
<p>Without the <span class="code"><strong>global</strong></span> statement, the <span class="code">counter</span> function would raise an <span class="code">UnboundLocalError</span> exception when called, because <span class="code">_count</span> would then be an uninitialized (unbound) local variable. While the <span class="code"><strong>global</strong></span> statement enables this kind of programming, this style is inelegant and ill-advised. As we mentioned earlier, when you want to group together some state and some behavior, the object-oriented mechanisms covered in <a data-type="xref" href="ch04.xhtml#object_oriented_python">Chapter 4</a> are usually best.</p>
<div data-type="tip">
<h1>Eschew global</h1>
<p>Never use <span class="code"><strong>global</strong></span> if the function body just <em>uses</em> a global variable (including mutating the object bound to that variable, when the object is mutable). Use a <span class="code"><strong>global</strong></span> statement only if the function body <em>rebinds</em> a global variable (generally by assigning to the variable’s name). As a matter of style, don’t use <span class="code"><strong>global</strong></span> unless it’s strictly necessary, as its presence causes readers of your program to assume the statement is there for some useful purpose. Never use <span class="code"><strong>global</strong></span> except as the first statement in a function body.</p>
</div>
</div></section>
<section data-pdf-bookmark="Nested functions and nested scopes" data-type="sect3"><div class="sect3" id="nested_functions_and_nested_scopes">
<h3>Nested functions and nested scopes</h3>
<p>A <span class="code"><strong>def</strong></span> statement within a function body defines a<a contenteditable="false" data-primary="nested functions" data-type="indexterm" id="idm44924583101040"/><a contenteditable="false" data-primary="functions" data-secondary="nested functions" data-type="indexterm" id="idm44924583099968"/><a contenteditable="false" data-primary="scope" data-secondary="nested scope" data-type="indexterm" id="idm44924583098592"/><a contenteditable="false" data-primary="nested scopes" data-type="indexterm" id="idm44924583097216"/> <em>nested function</em>, and the function whose body includes the <span class="code"><strong>def</strong></span> is known as an<a contenteditable="false" data-primary="outer functions" data-type="indexterm" id="idm44924583094688"/> <em>outer function</em> to the nested one. Code in a nested function’s body may access (but <em>not</em> rebind) local variables of an outer function, also known as<a contenteditable="false" data-primary="variables and other references" data-secondary="free variables" data-type="indexterm" id="idm44924583092592"/><a contenteditable="false" data-primary="free variables" data-type="indexterm" id="idm44924583091200"/> <em>free variables</em> of the nested function.</p>
<p>The simplest way to let a nested function access a value is often not to rely on nested scopes, but rather to pass that value explicitly as one of the function’s arguments. If need be, you can bind the argument’s value at nested-function <span class="code"><strong>def</strong></span> time: just use the value as the default for an optional argument. For example:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">percent1</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">c</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">def</code></strong><code> </code><code class="nf">pc</code><code class="p">(</code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">total</code><code class="o">=</code><code class="n">a</code><code class="o">+</code><code class="n">b</code><code class="o">+</code><code class="n">c</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">return</code></strong><code> </code><code class="p">(</code><code class="n">x</code><code class="o">*</code><code class="mf">100.0</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="n">total</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">Percentages are:</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">pc</code><code class="p">(</code><code class="n">a</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">pc</code><code class="p">(</code><code class="n">b</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">pc</code><code class="p">(</code><code class="n">c</code><code class="p">)</code><code class="p">)</code></pre>
<p>Here’s the same functionality using nested scopes:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">percent2</code><code class="p">(</code><code class="n">a</code><code class="p">,</code><code> </code><code class="n">b</code><code class="p">,</code><code> </code><code class="n">c</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">def</code></strong><code> </code><code class="nf">pc</code><code class="p">(</code><code class="n">x</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">return</code></strong><code> </code><code class="p">(</code><code class="n">x</code><code class="o">*</code><code class="mf">100.0</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="p">(</code><code class="n">a</code><code class="o">+</code><code class="n">b</code><code class="o">+</code><code class="n">c</code><code class="p">)</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="s1">'</code><code class="s1">Percentages are:</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">pc</code><code class="p">(</code><code class="n">a</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">pc</code><code class="p">(</code><code class="n">b</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">pc</code><code class="p">(</code><code class="n">c</code><code class="p">)</code><code class="p">)</code></pre>
<p>In this specific case, <span class="code">percent1</span> has one tiny advantage: the computation of <span class="code">a+b+c</span> happens only once, while <span class="code">percent2</span>’s inner function <span class="code">pc</span> repeats the computation three times. However, when the outer function rebinds local variables between calls to the nested function, repeating the computation can be necessary: be aware of both approaches, and choose the appropriate one on a case-by-case basis.</p>
<p>A nested function that accesses values from local variables of “outer” (containing) functions is also known as a<a contenteditable="false" data-primary="closures" data-type="indexterm" id="idm44924582948400"/> <em>closure</em>. The following example shows how to build a closure:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">make_adder</code><code class="p">(</code><code class="n">augend</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">def</code></strong><code> </code><code class="nf">add</code><code class="p">(</code><code class="n">addend</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">return</code></strong><code> </code><code class="n">addend</code><code class="o">+</code><code class="n">augend</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">add</code><code>
</code><code class="n">add5</code><code> </code><code class="o">=</code><code> </code><code class="n">make_adder</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code>
</code><code class="n">add9</code><code> </code><code class="o">=</code><code> </code><code class="n">make_adder</code><code class="p">(</code><code class="mi">9</code><code class="p">)</code><code>
</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">add5</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="p">)</code><code>   </code><em><code class="c1"># prints: 105</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">add9</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code><code class="p">)</code><code>   </code><em><code class="c1"># prints: 109</code></em></pre>
<p>Closures are sometimes an exception to the general rule that the object-oriented mechanisms covered in the next chapter are the best way to bundle together data and code. When you specifically need to construct callable objects, with some parameters fixed at object construction time, closures can be simpler and more direct than classes. For example, the result of <span class="code">make_adder(7)</span> is a function that accepts a single argument and returns <span class="code">7</span> plus that argument. An outer function that returns a closure is a “factory” for members of a family of functions distinguished by some parameters, such as the value of the argument <span class="code">augend</span> in the previous example, which may often help you avoid code duplication.</p>
<p>The<a contenteditable="false" data-primary="nonlocal keyword" data-type="indexterm" id="idm44924582856048"/> <span class="code"><strong>nonlocal</strong></span> keyword acts similarly to <span class="code"><strong>global</strong></span>, but it refers to a name in the namespace of some lexically surrounding function. When it occurs in a function definition nested several levels deep (a rarely needed structure!), the compiler searches the namespace of the most deeply nested containing function, then the function containing that one, and so on, until the name is found or there are no further containing functions, in which case the compiler raises an error (a global name, if any, does not match).</p>
<p>Here’s a nested functions approach to the “counter” functionality we implemented in previous sections using a function attribute, then a global variable:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">make_counter</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">count</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code>
</code><code>    </code><strong><code class="k">def</code></strong><code> </code><code class="nf">counter</code><code class="p">(</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">nonlocal</code></strong><code> </code><code class="n">count</code><code>
</code><code>        </code><code class="n">count</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="mi">1</code><code>
</code><code>        </code><strong><code class="k">return</code></strong><code> </code><code class="n">count</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">counter</code><code>
</code><code>
</code><code class="n">c1</code><code> </code><code class="o">=</code><code> </code><code class="n">make_counter</code><code class="p">(</code><code class="p">)</code><code>
</code><code class="n">c2</code><code> </code><code class="o">=</code><code> </code><code class="n">make_counter</code><code class="p">(</code><code class="p">)</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">c1</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">c1</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">c1</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code>     </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">1 2 3</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">c2</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">c2</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code>           </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">1 2</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">c1</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">c2</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">c1</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code>     </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">4 3 5</code></em></pre>
<p>A key advantage of this approach versus the previous ones is that these two nested functions, just like an object-oriented approach would, let you make independent counters—here <span class="code">c1</span> and <span class="code">c2</span>. Each closure keeps its own state and doesn’t interfere with the other one.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="lambda Expressions" data-type="sect2"><div class="sect2" id="lambda_expressions">
<h2>lambda Expressions</h2>
<p>If<a contenteditable="false" data-primary="lambda" data-type="indexterm" id="idm44924582730832"/> a function body is a single <span class="code"><strong>return</strong></span> <span class="code"><em>expression</em></span> statement, you may (<em>very</em> optionally!) choose to replace the function with the special <span class="code"><strong>lambda</strong></span> expression form:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">lambda</code></strong><code> </code><em><code class="n">parameters</code></em><code class="p">:</code><code> </code><em><code class="n">expression</code></em></pre>
<p>A <span class="code"><strong>lambda</strong></span> expression is the anonymous equivalent of a normal function whose body is a single <span class="code"><strong>return</strong></span> statement. The <span class="code"><strong>lambda</strong></span> syntax does not use the <span class="code"><strong>return</strong></span> keyword. You can use a <span class="code"><strong>lambda</strong></span> expression wherever you could use a reference to a function. <span class="code"><strong>lambda</strong></span> can sometimes be handy when you want to use an <em>extremely simple</em> function as an argument or return value.</p>
<p>Here’s an example that uses a <span class="code"><strong>lambda</strong></span> expression as an argument to the built-in <span class="code">sorted</span> function (covered in <a data-type="xref" href="ch08.xhtml#pythonapostrophes_core_built_in_functio">Table 8-2</a>):</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">a_list</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">]</code><code>
</code><code class="nb">sorted</code><code class="p">(</code><code class="n">a_list</code><code class="p">,</code><code> </code><code class="n">key</code><code class="o">=</code><strong><code class="k">lambda</code></strong><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">x</code><code> </code><code class="o">*</code><code> </code><code class="n">x</code><code class="p">)</code><code>  </code><em><code class="c1"># returns: [0, -1, 1, -2, 2]</code></em></pre>
<p>Alternatively, you can always use a local <span class="code"><strong>def</strong></span> statement to give the function object a name, then use this name as an argument or return value. Here’s the same <span class="code">sorted</span> example using a local <span class="code"><strong>def</strong></span> statement:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">a_list</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">]</code><code>
</code><strong><code class="k">def</code></strong><code> </code><code class="nf">square</code><code class="p">(</code><code class="n">value</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">return</code></strong><code> </code><code class="n">value</code><code> </code><code class="o">*</code><code> </code><code class="n">value</code><code>
</code><code class="nb">sorted</code><code class="p">(</code><code class="n">a_list</code><code class="p">,</code><code> </code><code class="n">key</code><code class="o">=</code><code class="n">square</code><code class="p">)</code><code>           </code><em><code class="c1"># returns: [0, -1, 1, -2, 2]</code></em></pre>
<p>While <span class="code"><strong>lambda</strong></span> can at times be handy, <span class="code"><strong>def</strong></span> is usually better: it’s more general and helps you make your code more readable, since you can choose a clear name for the function.<a contenteditable="false" data-primary="" data-startref="namepsp03" data-type="indexterm" id="idm44924582554400"/></p>
</div></section>
<section data-pdf-bookmark="Generators" data-type="sect2"><div class="sect2" id="generators">
<h2>Generators</h2>
<p>When<a contenteditable="false" data-primary="functions" data-secondary="generators" data-type="indexterm" id="idm44924582550976"/><a contenteditable="false" data-primary="generators" data-type="indexterm" id="gene03"/> the body of a function contains one or more occurrences of the keyword <span class="code"><strong>yield</strong></span>, the function is known as a <em>generator</em>, or more precisely a<a contenteditable="false" data-primary="generator functions" data-type="indexterm" id="idm44924582546832"/> <em>generator function</em>. When you call a generator, the function body does not execute. Instead, the generator function returns a special iterator object, known as a<a contenteditable="false" data-primary="generator objects" data-type="indexterm" id="idm44924582516688"/> <em>generator object</em> (sometimes, quite confusingly, also called just “a generator”), wrapping the function body, its local variables (including parameters), and the current point of execution (initially, the start of the function).</p>
<p>When you (implicitly or explicitly) call <span class="code">next</span> on a generator object, the function body executes from the current point up to the next <span class="code"><strong>yield</strong></span>, which takes the form:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">yield</code></strong><code> </code><em><code class="n">expression</code></em></pre>
<p>A bare <span class="code"><strong>yield</strong></span> without the expression is also legal, and equivalent to <span class="code"><strong>yield</strong></span> <span class="code"><strong>None</strong></span>. When <span class="code"><strong>yield</strong></span> executes, the function execution is “frozen,” preserving the current point of execution and local variables, and the expression following <span class="code"><strong>yield</strong></span> becomes the result of <span class="code">next</span>. When you call <span class="code">next</span> again, execution of the function body resumes where it left off, again up to the next <span class="code"><strong>yield</strong></span>. When the function body ends, or executes a <span class="code"><strong>return</strong></span> statement, the iterator raises a <span class="code">StopIteration</span> exception to indicate that the iteration is finished. The expression after <span class="code"><strong>return</strong></span>, if any, is the argument to the <span class="code">StopIteration</span> exception.</p>
<p><span class="code"><strong>yield</strong></span> is an expression, not a statement. When you call <span class="code"><em>g</em></span><span class="code">.send(<em>value</em>)</span> on a generator object <span class="code"><em>g</em></span>, the value of <span class="code"><strong>yield</strong></span> is <span class="code"><em>value</em></span>; when you call <span class="code">next(<em>g</em>)</span>, the value of <span class="code"><strong>yield</strong></span> is <span class="code"><strong>None</strong></span>. We’ll talk more about this shortly: it’s an elementary building block for implementing <a href="https://oreil.ly/KI68p">coroutines</a> in Python.</p>
<p>A generator function is often a handy way to build an iterator. Since the most common way to use an iterator is to loop on it with a <span class="code"><strong>for</strong></span> statement, you typically call a generator like this (with the call to <span class="code">next</span> being implicit in the <span class="code"><strong>for</strong></span> statement):</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">for</code></strong><code> </code><em><code class="n">avariable</code></em><code> </code><strong><code class="ow">in</code></strong><code> </code><em><code class="n">somegenerator</code></em><code class="p">(</code><em><code class="n">arguments</code></em><code class="p">)</code><code class="p">:</code></pre>
<p>For example, say that you want a sequence of numbers counting up from <span class="code">1</span> to <span class="code"><em>N</em></span> and then down to <span class="code">1</span> again. A generator can help:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">updown</code><code class="p">(</code><code class="n">N</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">N</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">yield</code></strong><code> </code><code class="n">x</code><code>
</code><code>    </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="n">N</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">yield</code></strong><code> </code><code class="n">x</code><code>
</code><strong><code class="k">for</code></strong><code> </code><code class="n">i</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">updown</code><code class="p">(</code><code class="mi">3</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="n">i</code><code class="p">)</code><code>              </code><em><code class="c1"># prints:</code></em><code class="c1"> </code><em><code class="c1">1 2 3 2 1</code></em></pre>
<p>Here is a generator that works somewhat like built-in <span class="code">range</span>, but returns an iterator on floating-point values rather than on integers:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">frange</code><code class="p">(</code><code class="n">start</code><code class="p">,</code><code> </code><code class="n">stop</code><code class="p">,</code><code> </code><code class="n">stride</code><code class="o">=</code><code class="mf">1.0</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">start</code><code> </code><code class="o">=</code><code> </code><code class="nb">float</code><code class="p">(</code><code class="n">start</code><code class="p">)</code><code>  </code><em><code class="c1"># force all yielded values to be floats</code></em><code>
</code><code>    </code><strong><code class="k">while</code></strong><code> </code><code class="n">start</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">stop</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">yield</code></strong><code> </code><code class="n">start</code><code>
</code><code>        </code><code class="n">start</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="n">stride</code></pre>
<p>This example is only <em>somewhat</em> like <span class="code">range</span> because, for simplicity, it makes the arguments <span class="code">start</span> and <span class="code">stop</span> mandatory, and assumes that <span class="code">stride</span> is positive.</p>
<p>Generator functions are more flexible than functions that return lists. A generator function may return an unbounded iterator, meaning one that yields an infinite stream of results (to use only in loops that terminate by other means, e.g., via a conditionally executed<a contenteditable="false" data-primary="break keyword" data-secondary="in generators" data-secondary-sortas="generators" data-type="indexterm" id="idm44924582306960"/> <span class="code"><strong>break</strong></span> statement). Further, a generator object iterator performs<a contenteditable="false" data-primary="lazy evaluation" data-type="indexterm" id="idm44924582304304"/> <em>lazy evaluation</em>: the iterator can compute each successive item only when and if needed, “just in time,” while the equivalent function does all computations in advance and may require large amounts of memory to hold the results list. Therefore, if all you need is the ability to iterate on a computed sequence, it is usually best to compute the sequence in a generator object, rather than in a function returning a list. If the caller needs a list of all the items produced by some bounded generator object built by <span class="code"><em>g</em></span><span class="code">(<em>arguments</em>)</span>, the caller can simply use the following code to explicitly request that Python build a list:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="n">resulting_list</code></em><code> </code><code class="o">=</code><code> </code><code class="nb">list</code><code class="p">(</code><em><code class="n">g</code></em><code class="p">(</code><em><code class="n">arguments</code></em><code class="p">)</code><code class="p">)</code></pre>
<section data-pdf-bookmark="yield from" data-type="sect3"><div class="sect3" id="yield_from">
<h3>yield from</h3>
<p>To<a contenteditable="false" data-primary="yield from expression" data-type="indexterm" id="idm44924582206400"/> improve execution efficiency and clarity when multiple levels of iteration are yielding values, you can use the form <span class="code"><strong>yield from</strong></span> <span class="code"><em>expression</em></span>, where <span class="code"><em>expression</em></span> is iterable. This yields the values from <span class="code"><em>expression</em></span> one at a time into the calling environment, avoiding the need to <span class="code"><strong>yield</strong></span> repeatedly. We can thus simplify the <span class="code">updown</span> generator we defined earlier:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">updown</code><code class="p">(</code><code class="n">N</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">yield from</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="n">N</code><code class="p">)</code><code>
</code><code>    </code><strong><code class="k">yield from</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="n">N</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code>
</code><strong><code class="k">for</code></strong><code> </code><code class="n">i</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="n">updown</code><code class="p">(</code><code class="mi">3</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="nb">print</code><code class="p">(</code><code class="n">i</code><code class="p">)</code><code>              </code><em><code class="c1"># prints: 1 2 3 2 1</code></em></pre>
<p>Moreover, using <span class="code"><strong>yield from</strong></span> lets you use generators as <em>coroutines</em>, discussed next.</p>
</div></section>
<section data-pdf-bookmark="Generators as near-coroutines" data-type="sect3"><div class="sect3" id="generators_as_near_coroutines">
<h3>Generators as near-coroutines</h3>
<p>Generators<a contenteditable="false" data-primary="coroutines" data-type="indexterm" id="idm44924572296208"/> are further enhanced with the possibility of receiving a value (or an exception) back from the caller as each <span class="code"><strong>yield</strong></span> executes. This lets generators implement <a href="https://oreil.ly/KI68p">coroutines</a>, as explained in <a href="https://oreil.ly/ih77Z">PEP 342</a>. When a generator object resumes (i.e., you call <span class="code">next</span> on it), the corresponding <span class="code"><strong>yield</strong></span>’s value is <span class="code"><strong>None</strong></span>. To pass a value <span class="code"><em>x</em></span> into some generator object <span class="code"><em>g</em></span> (so that <span class="code"><em>g</em></span> receives <span class="code"><em>x</em></span> as the value of the <span class="code"><strong>yield</strong></span> on which it’s suspended), instead of calling <span class="code">next(<em>g</em>)</span>, call <span class="code"><em>g</em></span><span class="code">.send(<em>x</em>)</span> <span class="code">(<em>g</em>.send(<strong>None</strong>)</span> is just like <span class="code">next(<em>g</em>)</span>).</p>
<p>Other enhancements to generators regard exceptions: we cover them in <a data-type="xref" href="ch06.xhtml#generators_and_exceptions">“Generators and Exceptions”</a>.</p>
</div></section>
<section data-pdf-bookmark="Generator expressions" data-type="sect3"><div class="sect3" id="generator_expressions">
<h3>Generator expressions</h3>
<p>Python<a contenteditable="false" data-primary=" generator expressions (genexps)" data-type="indexterm" id="idm44924572247808"/> offers an even simpler way to code particularly simple generators: <em>generator expressions</em>, commonly known as <em>genexps</em>. The syntax of a genexp is just like that of a list comprehension (as covered in <a data-type="xref" href="#list_comprehensions">“List comprehensions”</a>), except that a genexp is within<a contenteditable="false" data-primary="parentheses (())" data-secondary="in generator expressions" data-secondary-sortas="generator expressions" data-type="indexterm" id="idm44924572244368"/><a contenteditable="false" data-primary="() (parentheses)" data-secondary="in generator expressions" data-secondary-sortas="generator expressions" data-type="indexterm" id="idm44924572242752"/> parentheses (<span class="code">()</span>) instead of brackets (<span class="code">[]</span>). The semantics of a genexp are the same as those of the corresponding list comprehension, except that a genexp produces an iterator yielding one item at a time, while a list comprehension produces a list of all results in memory (therefore, using a genexp, when appropriate, saves memory). For example, to sum the squares of all single-digit integers, you could code <span class="code">sum([x*x</span> <span class="code"><strong>for</strong></span> <span class="code">x</span> <span class="code"><strong>in</strong></span> <span class="code">range(10)]</span>), but you can express this better as <span class="code">sum(x*x</span> <span class="code"><strong>for</strong></span> <span class="code">x</span> <span class="code"><strong>in</strong></span> <span class="code">range(10))</span> (just the same, but omitting the brackets): you get the same result but consume less memory. The parentheses that indicate the function call also do “double duty” and enclose the genexp. Parentheses are, however, required when the genexp is not the sole argument. Additional parentheses don’t hurt, but are usually best omitted, for<a contenteditable="false" data-primary="" data-startref="gene03" data-type="indexterm" id="idm44924572231872"/> clarity.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="warning_donapostrophet_iterate_over_a_g">
<h5>Warning: Don’t Iterate over a Generator Multiple Times</h5>
<p>A limitation of generators and generator expressions is that you can iterate over them only once. Calling <span class="code">next</span> on a generator that has been consumed will just raise <span class="code">StopIteration</span> again, which most functions will take as an indication that the generator returns no values. If your code is not careful about reusing a consumed generator, this can introduce bugs:</p>
<pre data-code-language="python" data-type="programlisting">
<em><code class="c1"># create a generator and list its items and their sum</code></em><code>
</code><code class="n">squares</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="n">x</code><code class="o">*</code><code class="n">x</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="nb">list</code><code class="p">(</code><code class="n">squares</code><code class="p">)</code><code class="p">)</code><code>  </code><em><code class="c1"># prints [0, 1, 4, 9, 16]</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="nb">sum</code><code class="p">(</code><code class="n">squares</code><code class="p">)</code><code class="p">)</code><code>   </code><em><code class="c1"># Bug! Prints 0</code></em></pre>
<p>You can write code to guard against accidentally iterating over a consumed generator by using a class to wrap the generator, like the following:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">class</code></strong><code> </code><code class="nc">ConsumedGeneratorError</code><code class="p">(</code><code class="ne">Exception</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><em><code class="sd">"""Raised if a generator is accessed after</code></em><code class="sd"> 
</code><em><code class="sd">       already consumed.</code></em><code class="sd">
</code><em><code class="sd">    """</code></em><code>
</code><code>
</code><strong><code class="k">class</code></strong><code> </code><code class="nc">StrictGenerator</code><code class="p">:</code><code>
</code><code>    </code><em><code class="sd">"""Wrapper for generator that will only permit it</code></em><code class="sd"> 
</code><em><code class="sd">       to be consumed once. Additional accesses will</code></em><code class="sd"> 
</code><em><code class="sd">       raise ConsumedGeneratorError.</code></em><code class="sd">
</code><em><code class="sd">    """</code></em><code>
</code><code>    </code><strong><code class="k">def</code></strong><code> </code><code class="fm">__init__</code><code class="p">(</code><code class="bp">self</code><code class="p">,</code><code> </code><code class="n">gen</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><code class="bp">self</code><code class="o">.</code><code class="n">_gen</code><code> </code><code class="o">=</code><code> </code><code class="n">gen</code><code>
</code><code>        </code><code class="bp">self</code><code class="o">.</code><code class="n">_gen_consumed</code><code> </code><code class="o">=</code><code> </code><strong><code class="kc">False</code></strong><code>
</code><code>    </code><strong><code class="k">def</code></strong><code> </code><code class="fm">__iter__</code><code class="p">(</code><code class="bp">self</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">return</code></strong><code> </code><code class="bp">self</code><code>
</code><code>    </code><strong><code class="k">def</code></strong><code> </code><code class="fm">__next__</code><code class="p">(</code><code class="bp">self</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">try</code></strong><code class="p">:</code><code>
</code><code>            </code><strong><code class="k">return</code></strong><code> </code><code class="nb">next</code><code class="p">(</code><code class="bp">self</code><code class="o">.</code><code class="n">_gen</code><code class="p">)</code><code>
</code><code>        </code><strong><code class="k">except</code></strong><code> </code><code class="ne">StopIteration</code><code class="p">:</code><code>
</code><code>            </code><strong><code class="k">if</code></strong><code> </code><code class="bp">self</code><code class="o">.</code><code class="n">_gen_consumed</code><code class="p">:</code><code>
</code><code>                </code><strong><code class="k">raise</code></strong><code> </code><code class="n">ConsumedGeneratorError</code><code class="p">(</code><code class="p">)</code><code> </code><strong><code class="kn">from</code></strong><code> </code><strong><code class="bp">None</code></strong><code>
</code><code>            </code><code class="bp">self</code><code class="o">.</code><code class="n">_gen_consumed</code><code> </code><code class="o">=</code><code> </code><strong><code class="kc">True</code></strong><code>
</code><code>            </code><strong><code class="k">raise</code></strong></pre>
<p>Now an erroneous reuse of a generator will raise an exception:</p>
<pre data-code-language="python" data-type="programlisting">
<code class="n">squares</code><code> </code><code class="o">=</code><code> </code><code class="n">StrictGenerator</code><code class="p">(</code><code class="n">x</code><code class="o">*</code><code class="n">x</code><code> </code><strong><code class="k">for</code></strong><code> </code><code class="n">x</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code class="p">)</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="nb">list</code><code class="p">(</code><code class="n">squares</code><code class="p">)</code><code class="p">)</code><code>  </code><em><code class="c1"># prints: [0, 1, 4, 9, 16]</code></em><code>
</code><code class="nb">print</code><code class="p">(</code><code class="nb">sum</code><code class="p">(</code><code class="n">squares</code><code class="p">)</code><code class="p">)</code><code>   </code><em><code class="c1"># raises ConsumedGeneratorError</code></em></pre>
</div></aside>
</div></section>
</div></section>
<section data-pdf-bookmark="Recursion" data-type="sect2"><div class="sect2" id="recursion">
<h2>Recursion</h2>
<p>Python<a contenteditable="false" data-primary="functions" data-secondary="recursion" data-type="indexterm" id="idm44924571990272"/><a contenteditable="false" data-primary="recursion" data-type="indexterm" id="recur03"/> supports recursion (i.e., a Python function can call itself, directly or indirectly), but there is a limit to how deep the recursion can go. By default, Python interrupts recursion and raises a <span class="code">RecursionLimitExceeded</span> exception (covered in <a data-type="xref" href="ch06.xhtml#standard_exception_classe">“Standard Exception Classes”</a>) when it detects that recursion has exceeded a depth of 1,000. You can change this default recursion limit by calling the<a contenteditable="false" data-primary="setrecursionlimit (sys module)" data-type="indexterm" id="idm44924571985808"/> <span class="code">setrecursionlimit</span> function in the module <span class="code">sys</span>, covered in <a data-type="xref" href="ch08.xhtml#functions_and_attributes_of_the_sys_mod">Table 8-3</a>.</p>
<p>Note that changing the recursion limit does not give you unlimited recursion. The absolute maximum limit depends on the platform on which your program is running, and particularly on the underlying operating system and C runtime library, but it’s typically a few thousand levels. If recursive calls get too deep, your program crashes. Such runaway recursion, after a call to <span class="code">setrecursionlimit</span> that exceeds the platform’s capabilities, is one of the few things that can cause a Python program to crash—really crash, hard, without the usual safety net of Python’s exception mechanism. Therefore, beware of “fixing” a program that is getting <span class="code">RecursionLimitExceeded</span> exceptions by raising the recursion limit with <span class="code">setrecursionlimit</span>. While this <em>is</em> a valid technique, most often you’re better advised to look for ways to remove the recursion unless you are confident you’ve been able to limit the depth of recursion that your program needs.</p>
<p>Readers who are familiar with Lisp, Scheme, or functional programming languages must in particular be aware that Python does <em>not</em> implement the optimization of<a contenteditable="false" data-primary="tail-call elimination" data-type="indexterm" id="idm44924571950928"/> <em>tail-call elimination</em>, which is so crucial in those languages. In Python, any call, recursive or not, has the same “cost” in terms of both time and memory space, dependent only on the number of arguments: the cost does not change, whether the call is a “tail call” (meaning that it’s the last operation that the caller executes) or not. This makes recursion removal even more important.</p>
<p>For example, consider a classic use for recursion: walking a binary tree. Suppose you represent a binary tree structure as nodes, where each node is a three-item tuple <span class="code">(payload, left, right)</span>, and <span class="code">left</span> and <span class="code">right</span> are either similar tuples or <span class="code"><strong>None</strong></span>, representing the left-side and right-side descendants. A simple example might be <span class="code">(23, (42, (5,</span> <span class="code"><strong>None</strong></span><span class="code">,</span> <span class="code"><strong>None</strong></span><span class="code">), (55,</span> <span class="code"><strong>None</strong></span><span class="code">,</span> <span class="code"><strong>None</strong></span><span class="code">)), (94,</span> <span class="code"><strong>None</strong></span><span class="code">,</span> <span class="code"><strong>None</strong></span><span class="code">))</span> to represent the tree shown in <a data-type="xref" href="#an_example_of_a_binary_tree">Figure 3-1</a>.</p>
<figure><div class="figure" id="an_example_of_a_binary_tree"><img alt="An example of a binary tree" height="445" src="assets/pns4_0301.png" width="542"/>
<h6><span class="label">Figure 3-1. </span>An example of a binary tree</h6>
</div></figure>
<p>To write a generator function that, given the root of such a tree, “walks” the tree, yielding each payload in top-down order, the simplest approach is recursion:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">rec</code><code class="p">(</code><code class="n">t</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><strong><code class="k">yield</code></strong><code> </code><code class="n">t</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code>
</code><code>    </code><strong><code class="k">for</code></strong><code> </code><code class="n">i</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><strong><code class="k">if</code></strong><code> </code><code class="n">t</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code> </code><strong><code class="ow">is</code><code> </code><code class="ow">not</code><code> </code><code class="kc">None</code><code class="p">:</code></strong><code>
</code><strong><code>            </code><code class="k">yield from</code></strong><code> </code><code class="n">rec</code><code class="p">(</code><code class="n">t</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="p">)</code></pre>
<p>But if a tree is very deep, recursion can become a problem. To remove recursion, we can handle our own stack—a list used in<a contenteditable="false" data-primary="last-in, first-out (LIFO)" data-type="indexterm" id="idm44924571926288"/><a contenteditable="false" data-primary="LIFO (last-in, first-out)" data-type="indexterm" id="idm44924571925424"/> last-in, first-out (LIFO) fashion, thanks to its <span class="code">append</span> and <span class="code">pop</span> methods. To wit:</p>
<pre data-code-language="python" data-type="programlisting">
<strong><code class="k">def</code></strong><code> </code><code class="nf">norec</code><code class="p">(</code><code class="n">t</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="n">stack</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">t</code><code class="p">]</code><code>
</code><code>    </code><strong><code class="k">while</code></strong><code> </code><code class="n">stack</code><code class="p">:</code><code>
</code><code>        </code><code class="n">t</code><code> </code><code class="o">=</code><code> </code><code class="n">stack</code><code class="o">.</code><code class="n">pop</code><code class="p">(</code><code class="p">)</code><code>
</code><code>        </code><strong><code class="k">yield</code></strong><code> </code><code class="n">t</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code>
</code><code>        </code><strong><code class="k">for</code></strong><code> </code><code class="n">i</code><code> </code><strong><code class="ow">in</code></strong><code> </code><code class="p">(</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">:</code><code>
</code><code>            </code><strong><code class="k">if</code></strong><code> </code><code class="n">t</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code> </code><strong><code class="ow">is</code><code> </code><code class="ow">not</code><code> </code><code class="kc">None</code></strong><code class="p">:</code><code>
</code><code>                </code><code class="n">stack</code><code class="o">.</code><code class="n">append</code><code class="p">(</code><code class="n">t</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="p">)</code></pre>
<p>The only small issue to be careful about, to keep exactly the same order of <span class="code"><strong>yield</strong></span>s as <span class="code">rec</span>, is switching the <span class="code">(</span><span class="code">1, 2</span><span class="code">)</span> index order in which to examine descendants to (<span class="code">2, 1</span>), adjusting to the “reversed” (last-in, first-out) behavior of <span class="code">stack</span>.<a contenteditable="false" data-primary="" data-startref="PLfunc03" data-type="indexterm" id="idm44924571786400"/><a contenteditable="false" data-primary="" data-startref="recur03" data-type="indexterm" id="idm44924571784992"/></p>
</div></section>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="ch01fn20"><sup><a href="ch03.xhtml#ch01fn20-marker">1</a></sup> Identifiers referring to constants are all uppercase, by convention.</p><p data-type="footnote" id="ch01fn21"><sup><a href="ch03.xhtml#ch01fn21-marker">2</a></sup> Control characters include nonprinting characters such as <span class="code">\t</span> (tab) and <span class="code">\n</span> (newline), both of which count as whitespace, and others such as <span class="code">\a</span> (alarm, aka “beep”) and <span class="code">\b</span> (backspace), which are not whitespace.</p><p data-type="footnote" id="ch01fn22"><sup><a href="ch03.xhtml#ch01fn22-marker">3</a></sup> “Container displays,” per the <a href="https://oreil.ly/mN_gv">online docs</a> (e.g., <span class="code">list_display</span>), but specifically ones with literal items.</p><p data-type="footnote" id="ch01fn23"><sup><a href="ch03.xhtml#ch01fn23-marker">4</a></sup> There’s also a <span class="code">bytearray</span> object, covered shortly, which is a <span class="code">bytes</span>-like “string” that <em>is</em> mutable.</p><p data-type="footnote" id="ch01fn24"><sup><a href="ch03.xhtml#ch01fn24-marker">5</a></sup> This syntax is sometimes called a “tuple display.”</p><p data-type="footnote" id="ch01fn25"><sup><a href="ch03.xhtml#ch01fn25-marker">6</a></sup> This syntax is sometimes called a “list display.”</p><p data-type="footnote" id="ch01fn26"><sup><a href="ch03.xhtml#ch01fn26-marker">7</a></sup> This syntax is sometimes called a “set display.”</p><p data-type="footnote" id="ch01fn27"><sup><a href="ch03.xhtml#ch01fn27-marker">8</a></sup> Each specific mapping type may put some constraints on the type of keys it accepts: in particular, dictionaries only accept hashable keys.</p><p data-type="footnote" id="ch01fn28"><sup><a href="ch03.xhtml#ch01fn28-marker">9</a></sup> This syntax is sometimes called a “dictionary display.”</p><p data-type="footnote" id="ch01fn29"><sup><a href="ch03.xhtml#ch01fn29-marker">10</a></sup> See <a data-type="xref" href="ch16.xhtml#shapecomma_indexingcomma_and_slicing">“Shape, indexing, and slicing”</a>.</p><p data-type="footnote" id="ch01fn30"><sup><a href="ch03.xhtml#ch01fn30-marker">11</a></sup> Strictly speaking, <em>almost</em> any: NumPy arrays, covered in <a data-type="xref" href="ch16.xhtml#numeric_processing">Chapter 16</a>, are an exception.</p><p data-type="footnote" id="ch01fn31"><sup><a href="ch03.xhtml#ch01fn31-marker">12</a></sup> With exactly the same exception of NumPy arrays.</p><p data-type="footnote" id="ch01fn32"><sup><a href="ch03.xhtml#ch01fn32-marker">13</a></sup> Sometimes referred to as the <em>ternary</em> operator, as it is so called in C (Python’s original implementation language).</p><p data-type="footnote" id="ch01fn33"><sup><a href="ch03.xhtml#ch01fn33-marker">14</a></sup> This is not, strictly speaking, the “coercion” you observe in other languages; however, among built-in numeric types, it produces pretty much the same effect.</p><p data-type="footnote" id="ch01fn34"><sup><a href="ch03.xhtml#ch01fn34-marker">15</a></sup> Hence the upper limit of 36 for the radix: 10 numeric digits plus 26 alphabetic characters.</p><p data-type="footnote" id="ch01fn35"><sup><a href="ch03.xhtml#ch01fn35-marker">16</a></sup> The second item of <span class="code">divmod</span>’s result, just like the result of <span class="code">%</span>, is the <em>remainder</em>, not the <em>modulo</em>, despite the function’s misleading name. The difference matters when the divisor is negative. In some other languages, such as C# and JavaScript, the result of a <span class="code">%</span> operator is, in fact, the modulo; in others yet, such as C and C++, it is machine-dependent whether the result is the modulo or the remainder when either operand is negative. In Python, it’s the remainder.</p><p data-type="footnote" id="ch01fn36"><sup><a href="ch03.xhtml#ch01fn36-marker">17</a></sup> Timsort has the distinction of being the only sorting algorithm mentioned by the US Supreme Court, specifically in the case of <a href="https://oreil.ly/m-2JQ">Oracle v. Google</a>.</p><p data-type="footnote" id="ch01fn37"><sup><a href="ch03.xhtml#ch01fn37-marker">18</a></sup> Except, as already noted, a NumPy array with more than one element.</p><p data-type="footnote" id="ch01fn38"><sup><a href="ch03.xhtml#ch01fn38-marker">19</a></sup> It is notable that the <span class="code"><strong>match</strong></span> statement specifically excludes matching values of type <span class="code">str</span>, <span class="code">bytes</span>, and <span class="code">bytearray</span> with <em>sequence</em> patterns.</p><p data-type="footnote" id="ch01fn39"><sup><a href="ch03.xhtml#ch01fn39-marker">20</a></sup> Indeed, the syntax notation used in the Python online documentation required, and got, updates to concisely describe some of Python’s more recent syntax additions.</p><p data-type="footnote" id="ch01fn40"><sup><a href="ch03.xhtml#ch01fn40-marker">21</a></sup> Although comparing <span class="code">float</span> or <span class="code">complex</span> numbers for exact equality is often dubious practice.</p><p data-type="footnote" id="ch01fn41"><sup><a href="ch03.xhtml#ch01fn41-marker">22</a></sup> For this unique use case, it’s common to break the normal style conventions about starting class names with an uppercase letter and avoiding using semicolons to stash multiple assignments within one line; however, the authors haven’t yet found a style guide that blesses this peculiar, rather new usage.</p><p data-type="footnote" id="ch01fn42"><sup><a href="ch03.xhtml#ch01fn42-marker">23</a></sup> And its subclasses, for example, <span class="code">collections.defaultdict</span>.</p><p data-type="footnote" id="ch01fn43"><sup><a href="ch03.xhtml#ch01fn43-marker">24</a></sup> Except that the loop variables’ scope is within the comprehension only, different from the way scoping works in a <strong><span class="code">for</span></strong> statement.</p><p data-type="footnote" id="ch01fn44"><sup><a href="ch03.xhtml#ch01fn44-marker">25</a></sup> In that paper, Knuth also first proposed using “devices like indentation, rather than delimiters” to express program structure—just as Python does!</p><p data-type="footnote" id="ch01fn45"><sup><a href="ch03.xhtml#ch01fn45-marker">26</a></sup> “Alas” because they have nothing to do with Python keywords, so the terminology is confusing; if you use an actual Python keyword to name a named parameter, that raises <span class="code">SyntaxError</span>.</p><p data-type="footnote" id="ch01fn46"><sup><a href="ch03.xhtml#ch01fn46-marker">27</a></sup> Python developers introduced positional-only arguments when they realized that parameters to many built-in functions effectively had no valid names as far as the interpreter was concerned.</p><p data-type="footnote" id="ch01fn47"><sup><a href="ch03.xhtml#ch01fn47-marker">28</a></sup> An “optional parameter” being one for which the function’s signature supplies a default value.</p></div></div></section></div></body></html>