<html><head></head><body><section data-pdf-bookmark="Chapter 14. Files and Directories" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch_files">&#13;
<h1><span class="label">Chapter 14. </span>Files and Directories</h1>&#13;
&#13;
<blockquote>&#13;
<p><a data-primary="file handling" data-seealso="directory operations; pathnames" data-type="indexterm" id="ix_ch14-files-asciidoc0"/>I have files, I have computer files and, you know, files on paper.&#13;
But most of it is really in my head.&#13;
So God help me if anything ever happens to my head!</p>&#13;
<p data-type="attribution">George R. R. Martin</p>&#13;
</blockquote>&#13;
&#13;
<p>When you first start programming,&#13;
you hear some words over and over&#13;
but aren’t sure whether they have a specific technical meaning&#13;
or are just handwaving.&#13;
The terms <em>file</em> and <em>directory</em> are such words,&#13;
and they do have actual technical meanings.&#13;
<a data-primary="file, defined" data-type="indexterm" id="idm45794985368200"/>A <em>file</em> is a sequence of bytes,&#13;
stored in some <em>filesystem</em>,&#13;
and accessed by a <em>filename</em>.&#13;
<a data-primary="directory, defined" data-type="indexterm" id="idm45794985366024"/>A <em>directory</em> is a collection of files,&#13;
and possibly other directories.&#13;
<a data-primary="folder, defined" data-type="indexterm" id="idm45794985364744"/>The term <em>folder</em> is a synonym for directory.&#13;
It turned up when computers gained graphical user interfaces,&#13;
and mimicked office concepts to make things seem more familiar.</p>&#13;
&#13;
<p>Many filesystems are hierarchical,&#13;
and often referred to as being like a tree.&#13;
Real offices don’t tend to have trees in them,&#13;
and the folder analogy only works&#13;
if you visualize subfolders all the way down.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="File Input and Output" data-type="sect1"><div class="sect1" id="file_io">&#13;
<h1>File Input and Output</h1>&#13;
&#13;
<p><a data-primary="file input/output" data-type="indexterm" id="ix_ch14-files-asciidoc1"/>The simplest kind of persistence is a plain old file,&#13;
sometimes called a <a data-primary="flat file" data-type="indexterm" id="idm45794985359928"/><em>flat file</em>.&#13;
You <em>read</em> from a file into memory and <em>write</em> from&#13;
memory to a file.&#13;
Python makes these jobs easy.&#13;
As with many languages,&#13;
its file operations were largely modeled on the familiar&#13;
and popular Unix equivalents.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Create or Open with open()" data-type="sect2"><div class="sect2" id="file_open">&#13;
<h2>Create or Open with open()</h2>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="creating/opening files" data-type="indexterm" id="idm45794985450792"/><a data-primary="open() function" data-type="indexterm" id="idm45794985355240"/>You need to call the <code>open</code> function before you do the following:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Read an existing file</p>&#13;
</li>&#13;
<li>&#13;
<p>Write to a new file</p>&#13;
</li>&#13;
<li>&#13;
<p>Append to an existing file</p>&#13;
</li>&#13;
<li>&#13;
<p>Overwrite an existing file</p>&#13;
</li>&#13;
</ul>&#13;
<pre><em><code>fileobj</code></em> = open( <em><code>filename</code></em>, <em><code>mode</code></em> )</pre>&#13;
&#13;
<p>Here’s a brief explanation of the pieces of this call:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><em><code>fileobj</code></em> is the file object returned by <code>open()</code></p>&#13;
</li>&#13;
<li>&#13;
<p><em><code>filename</code></em> is the string name of the file</p>&#13;
</li>&#13;
<li>&#13;
<p><em><code>mode</code></em> is a string indicating the file’s type and what you want to do with it</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>The first letter of <em><code>mode</code></em> indicates&#13;
the <em>operation</em>:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>r</code> means read.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>w</code> means write. If the file doesn’t exist, it’s created.&#13;
If the file does exist, it’s overwritten.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>x</code> means write, but only if the file does <em>not</em> already exist.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>a</code> means append (write after the end) if the file exists.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>The second letter of <em><code>mode</code></em> is the file’s <em>type</em>:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>t</code> (or nothing) means text.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>b</code> means binary.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>After opening the file,&#13;
you call functions to read or write data;&#13;
these will be shown in the examples that follow.</p>&#13;
&#13;
<p>Last, you need to <em>close</em> the file to ensure that&#13;
any writes complete, and that memory is freed.&#13;
Later, you’ll see how to use <code>with</code> to automate this for you.</p>&#13;
&#13;
<p>This program opens a file called <em>oops.txt</em> and closes&#13;
it without writing anything.&#13;
This would create an empty file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Write a Text File with print()" data-type="sect2"><div class="sect2" id="print">&#13;
<h2>Write a Text File with print()</h2>&#13;
&#13;
<p><a data-primary="file input/output" data-secondary="writing text file with print()" data-type="indexterm" id="idm45794985315736"/><a data-primary="print() function" data-secondary="writing text file with" data-type="indexterm" id="idm45794985308984"/>Let’s re-create <em>oops.txt</em>,&#13;
but now write a line to it and then close it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="s">'Oops, I created a file.'</code><code class="p">,</code> <code class="nb">file</code><code class="o">=</code><code class="n">fout</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
&#13;
<p>We created an empty <em>oops.txt</em> file in the previous&#13;
section, so this just overwrites it.</p>&#13;
&#13;
<p>We used the <code>file</code> argument to <code>print</code>.&#13;
Without it, <code>print</code> writes to <em>standard output</em>,&#13;
which is your terminal&#13;
(unless you’ve told your shell program to&#13;
redirect output to a file with <code>&gt;</code>&#13;
or piped it to another program with <code>|</code>).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Write a Text File with write()" data-type="sect2"><div class="sect2" id="text_write">&#13;
<h2>Write a Text File with write()</h2>&#13;
&#13;
<p><a data-primary="file input/output" data-secondary="writing text file with write()" data-type="indexterm" id="idm45794985262840"/><a data-primary="write() function" data-secondary="writing text file with" data-type="indexterm" id="idm45794985261896"/>We just used <code>print</code> to write a line to a file.&#13;
We can also use <code>write</code>.</p>&#13;
&#13;
<p>For our multiline data source,&#13;
let’s use this&#13;
limerick about special relativity:<sup><a data-type="noteref" href="ch14.html#idm45794985259544" id="idm45794985259544-marker">1</a></sup></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">poem</code> <code class="o">=</code> <code class="s">'''There was a young lady named Bright,</code>&#13;
<code class="gp">... </code><code class="s">Whose speed was far faster than light;</code>&#13;
<code class="gp">... </code><code class="s">She started one day</code>&#13;
<code class="gp">... </code><code class="s">In a relative way,</code>&#13;
<code class="gp">... </code><code class="s">And returned on the previous night.'''</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="go">150</code></pre>&#13;
&#13;
<p>The following code writes the entire poem to the file&#13;
<code>'relativity'</code>&#13;
in one call:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="go">150</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
&#13;
<p>The <code>write</code> function returns the number of bytes written.&#13;
It does not add any spaces or newlines, as <code>print</code> does.&#13;
As before, you can also <code>print</code> a multiline string&#13;
to a text file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="n">poem</code><code class="p">,</code> <code class="nb">file</code><code class="o">=</code><code class="n">fout</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
&#13;
<p id="print_options"><a data-primary="print() function" data-secondary="write() versus" data-type="indexterm" id="idm45794985148376"/><a data-primary="write() function" data-secondary="print() versus" data-type="indexterm" id="idm45794985147528"/>So, should you use <code>write</code> or <code>print</code>?&#13;
As you’ve seen, by default&#13;
<code>print</code> adds a space after each argument and&#13;
a newline at the end.&#13;
In the previous example,&#13;
it appended a newline to the <code>relativity</code> file.&#13;
To make <code>print</code> work like <code>write</code>,&#13;
pass it the following two arguments:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>sep</code> (separator, which defaults to a space, <code>' '</code>)</p>&#13;
</li>&#13;
<li>&#13;
<p><code>end</code> (end string, which defaults to a newline, <code>'\n'</code>)</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p class="pagebreak-before">We’ll use empty strings to replace these defaults:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="n">poem</code><code class="p">,</code> <code class="nb">file</code><code class="o">=</code><code class="n">fout</code><code class="p">,</code> <code class="n">sep</code><code class="o">=</code><code class="s">''</code><code class="p">,</code> <code class="n">end</code><code class="o">=</code><code class="s">''</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
&#13;
<p>If you have a large source string,&#13;
you can also write chunks (using slices) until&#13;
the source is done:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">size</code> <code class="o">=</code> <code class="nb">len</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">offset</code> <code class="o">=</code> <code class="mi">0</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">chunk</code> <code class="o">=</code> <code class="mi">100</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">while</code> <code class="bp">True</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="n">offset</code> <code class="o">&gt;</code> <code class="n">size</code><code class="p">:</code>&#13;
<code class="gp">... </code>         <code class="k">break</code>&#13;
<code class="gp">... </code>    <code class="n">fout</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="n">poem</code><code class="p">[</code><code class="n">offset</code><code class="p">:</code><code class="n">offset</code><code class="o">+</code><code class="n">chunk</code><code class="p">])</code>&#13;
<code class="gp">... </code>    <code class="n">offset</code> <code class="o">+=</code> <code class="n">chunk</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">100</code>&#13;
<code class="go">50</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
&#13;
<p>This wrote 100 characters on the first try&#13;
and the last 50 characters on the next.&#13;
Slices allow you to “go over the end” without&#13;
raising an exception.</p>&#13;
&#13;
<p>If the <code>relativity</code> file is precious to us,&#13;
let’s see whether using mode <code>x</code>&#13;
really protects us from overwriting it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'xt'</code><code class="p">)</code>&#13;
<code class="gt">Traceback (most recent call last):</code>&#13;
  File <code class="nb">"&lt;stdin&gt;"</code>, line <code class="m">1</code>, in <code class="n">&lt;module&gt;</code>&#13;
<code class="gr">FileExistsError</code>: <code class="n">[Errno 17] File exists: 'relativity'</code></pre>&#13;
&#13;
<p>You can use this with an exception handler:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">try</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'xt'</code><code class="p">)]</code>&#13;
<code class="gp">... </code>    <code class="n">fout</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="s">'stomp stomp stomp'</code><code class="p">)</code>&#13;
<code class="gp">... </code><code class="k">except</code> <code class="n">FileExistsError</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="s">'relativity already exists!. That was a close one.'</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">relativity already exists!. That was a close one.</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Read a Text File with read(), readline(), or readlines()" data-type="sect2"><div class="sect2" id="text_read">&#13;
<h2>Read a Text File with read(), readline(), or readlines()</h2>&#13;
&#13;
<p><a data-primary="file input/output" data-secondary="writing text file with read()" data-type="indexterm" id="idm45794984848264"/><a data-primary="read() function" data-type="indexterm" id="idm45794984847320"/>You can call <code>read()</code> with no arguments to&#13;
slurp up the entire file at once,&#13;
as shown in the example that follows (be careful when doing this with large files;&#13;
a gigabyte file will consume a gigabyte of memory):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'rt'</code> <code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">poem</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">read</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">close</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="go">150</code></pre>&#13;
&#13;
<p>You can provide a maximum character count to limit&#13;
how much <code>read()</code> returns at one time.&#13;
Let’s read 100 characters at a time&#13;
and append each chunk to a <code>poem</code>&#13;
string to rebuild the original:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">poem</code> <code class="o">=</code> <code class="s">''</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'rt'</code> <code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">chunk</code> <code class="o">=</code> <code class="mi">100</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">while</code> <code class="bp">True</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="n">fragment</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">read</code><code class="p">(</code><code class="n">chunk</code><code class="p">)</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="ow">not</code> <code class="n">fragment</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">break</code>&#13;
<code class="gp">... </code>    <code class="n">poem</code> <code class="o">+=</code> <code class="n">fragment</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">close</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="go">150</code></pre>&#13;
&#13;
<p>After you’ve read all the way to the end,&#13;
further calls to <code>read()</code> will return&#13;
an empty string (<code>''</code>), which is treated as&#13;
<code>False</code> in <code>if not fragment</code>.&#13;
This breaks out of the <code>while True</code> loop.</p>&#13;
&#13;
<p><a data-primary="readline() function" data-type="indexterm" id="idm45794984706840"/>You can also read the file a line at a time&#13;
by using <code>readline()</code>.&#13;
In this next example, we append each line to the <code>poem</code>&#13;
string to rebuild the original:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">poem</code> <code class="o">=</code> <code class="s">''</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'rt'</code> <code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">while</code> <code class="bp">True</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="n">line</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">readline</code><code class="p">()</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="ow">not</code> <code class="n">line</code><code class="p">:</code>&#13;
<code class="gp">... </code>        <code class="k">break</code>&#13;
<code class="gp">... </code>    <code class="n">poem</code> <code class="o">+=</code> <code class="n">line</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">close</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="go">150</code></pre>&#13;
&#13;
<p>For a text file, even a blank line has a length of one&#13;
(the newline character), and is evaluated as <code>True</code>.&#13;
When the file has been read,&#13;
<code>readline()</code> (like <code>read()</code>) also returns an empty&#13;
string, which is also evaluated as <code>False</code>.</p>&#13;
&#13;
<p>The easiest way to read a text file is by using an <em>iterator</em>.&#13;
This returns one line at a time.&#13;
It’s similar to the previous example&#13;
but with less code:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">poem</code> <code class="o">=</code> <code class="s">''</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'rt'</code> <code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">for</code> <code class="n">line</code> <code class="ow">in</code> <code class="n">fin</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="n">poem</code> <code class="o">+=</code> <code class="n">line</code>&#13;
<code class="gp">...</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">close</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="go">150</code></pre>&#13;
&#13;
<p><a data-primary="readlines() function" data-type="indexterm" id="idm45794984618648"/>All of the preceding examples eventually&#13;
built the single string <code>poem</code>.&#13;
The <code>readlines()</code> call reads a line at a time,&#13;
and returns a list of one-line strings:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'rt'</code> <code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">lines</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">readlines</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">close</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">lines</code><code class="p">),</code> <code class="s">'lines read'</code><code class="p">)</code>&#13;
<code class="go">5 lines read</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">for</code> <code class="n">line</code> <code class="ow">in</code> <code class="n">lines</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">print</code><code class="p">(</code><code class="n">line</code><code class="p">,</code> <code class="n">end</code><code class="o">=</code><code class="s">''</code><code class="p">)</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">There was a young lady named Bright,</code>&#13;
<code class="go">Whose speed was far faster than light;</code>&#13;
<code class="go">She started one day</code>&#13;
<code class="go">In a relative way,</code>&#13;
<code class="go">And returned on the previous night.&gt;&gt;&gt;</code></pre>&#13;
&#13;
<p>We told <code>print()</code> to suppress the automatic newlines&#13;
because the first four lines already had them.&#13;
The last line did not, causing the interactive prompt <code>&gt;&gt;&gt;</code>&#13;
to occur right after the last line.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Write a Binary File with write()" data-type="sect2"><div class="sect2" id="binary_write">&#13;
<h2>Write a Binary File with write()</h2>&#13;
&#13;
<p><a data-primary="binary data" data-secondary="writing binary files" data-type="indexterm" id="idm45794984474056"/><a data-primary="file input/output" data-secondary="writing binary file with write()" data-type="indexterm" id="idm45794984473080"/><a data-primary="write() function" data-secondary="writing binary file with" data-type="indexterm" id="idm45794984472120"/>If you include a <code>'b'</code> in the <em>mode</em> string,&#13;
the file is opened in binary mode.&#13;
In this case, you read and write <code>bytes</code> instead of a string.</p>&#13;
&#13;
<p>We don’t have a binary poem lying around,&#13;
so we’ll just generate the 256 byte values from 0 to 255:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code> <code class="o">=</code> <code class="nb">bytes</code><code class="p">(</code><code class="nb">range</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">256</code><code class="p">))</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">bdata</code><code class="p">)</code>&#13;
<code class="go">256</code></pre>&#13;
&#13;
<p>Open the file for writing in binary mode&#13;
and write all the data at once:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'bfile'</code><code class="p">,</code> <code class="s">'wb'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="n">bdata</code><code class="p">)</code>&#13;
<code class="go">256</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
&#13;
<p>Again, <code>write()</code> returns the number of bytes written.</p>&#13;
&#13;
<p>As with text, you can write binary data in chunks:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'bfile'</code><code class="p">,</code> <code class="s">'wb'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">size</code> <code class="o">=</code> <code class="nb">len</code><code class="p">(</code><code class="n">bdata</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">offset</code> <code class="o">=</code> <code class="mi">0</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">chunk</code> <code class="o">=</code> <code class="mi">100</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">while</code> <code class="bp">True</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="k">if</code> <code class="n">offset</code> <code class="o">&gt;</code> <code class="n">size</code><code class="p">:</code>&#13;
<code class="gp">... </code>         <code class="k">break</code>&#13;
<code class="gp">... </code>    <code class="n">fout</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="n">bdata</code><code class="p">[</code><code class="n">offset</code><code class="p">:</code><code class="n">offset</code><code class="o">+</code><code class="n">chunk</code><code class="p">])</code>&#13;
<code class="gp">... </code>    <code class="n">offset</code> <code class="o">+=</code> <code class="n">chunk</code>&#13;
<code class="gp">...</code>&#13;
<code class="go">100</code>&#13;
<code class="go">100</code>&#13;
<code class="go">56</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Read a Binary File with read()" data-type="sect2"><div class="sect2" id="binary_read">&#13;
<h2>Read a Binary File with read()</h2>&#13;
&#13;
<p><a data-primary="binary data" data-secondary="reading binary files" data-type="indexterm" id="idm45794984292520"/><a data-primary="file input/output" data-secondary="reading binary file with read()" data-type="indexterm" id="idm45794984257048"/><a data-primary="read() function" data-type="indexterm" id="idm45794984256136"/>This one is simple; all you need to do is just open with <code>'rb'</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'bfile'</code><code class="p">,</code> <code class="s">'rb'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">read</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">bdata</code><code class="p">)</code>&#13;
<code class="go">256</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Close Files Automatically by Using with" data-type="sect2"><div class="sect2" id="with">&#13;
<h2>Close Files Automatically by Using with</h2>&#13;
&#13;
<p><a data-primary="file input/output" data-secondary="closing files automatically" data-type="indexterm" id="idm45794984230520"/>If you forget to close a file that you’ve opened,&#13;
it will be closed by Python after it’s no longer referenced.&#13;
This means that if you open a file within a function and&#13;
don’t close it explicitly,&#13;
it will be closed automatically when the function ends.&#13;
But you might have opened the file in a long-running&#13;
function or the main section of the program.&#13;
The file should be closed to force any remaining&#13;
writes to be completed.</p>&#13;
&#13;
<p>Python has <em>context managers</em>&#13;
to clean up things such as open files.&#13;
You use the form <code>with</code> <em><code>expression</code></em> <code>as</code> <em><code>variable</code></em>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="k">with</code> <code class="nb">open</code><code class="p">(</code><code class="s">'relativity'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code> <code class="k">as</code> <code class="n">fout</code><code class="p">:</code>&#13;
<code class="gp">... </code>    <code class="n">fout</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="n">poem</code><code class="p">)</code>&#13;
<code class="gp">...</code></pre>&#13;
&#13;
<p>That’s it.&#13;
After the block of code under the context manager&#13;
(in this case, one line) completes&#13;
(normally <em>or</em> by a raised exception),&#13;
the file is closed automatically.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Change Position with seek()" data-type="sect2"><div class="sect2" id="file_seek">&#13;
<h2>Change Position with seek()</h2>&#13;
&#13;
<p><a data-primary="file input/output" data-secondary="changing position within a file" data-type="indexterm" id="ix_ch14-files-asciidoc2"/><a data-primary="offset" data-secondary="seek() function and" data-type="indexterm" id="ix_ch14-files-asciidoc3"/><a data-primary="seek() function" data-type="indexterm" id="ix_ch14-files-asciidoc4"/>As you read and write,&#13;
Python keeps track of where you are in the file.&#13;
<a data-primary="offset" data-secondary="tell() function" data-type="indexterm" id="idm45794984149768"/><a data-primary="tell() function" data-type="indexterm" id="idm45794984148824"/>The <code>tell()</code> function returns your current offset&#13;
from the beginning of the file, in bytes.&#13;
The <code>seek()</code> function lets you jump to another&#13;
byte offset in the file.&#13;
This means that you don’t have to read every byte&#13;
in a file to read&#13;
the last one; you can <code>seek()</code> to the last one&#13;
and just read one byte.</p>&#13;
&#13;
<p>For this example, use the 256-byte binary file&#13;
<code>'bfile'</code> that you wrote earlier:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'bfile'</code><code class="p">,</code> <code class="s">'rb'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">tell</code><code class="p">()</code>&#13;
<code class="go">0</code></pre>&#13;
&#13;
<p>Use <code>seek()</code> to jump to one byte before the end of the file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">seek</code><code class="p">(</code><code class="mi">255</code><code class="p">)</code>&#13;
<code class="go">255</code></pre>&#13;
&#13;
<p>Read until the end of the file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">read</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">bdata</code><code class="p">)</code>&#13;
<code class="go">1</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code>&#13;
<code class="go">255</code></pre>&#13;
&#13;
<p><code>seek()</code> also returns the current offset.</p>&#13;
&#13;
<p>You can call <code>seek()</code> with a second argument:&#13;
<code>seek(<em><code>offset</code></em>, <em><code>origin</code></em>)</code>:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>If <code>origin</code> is <code>0</code> (the default), go&#13;
<em><code>offset</code></em> bytes from the start</p>&#13;
</li>&#13;
<li>&#13;
<p>If <code>origin</code> is <code>1</code>, go&#13;
<em><code>offset</code></em> bytes from the current position</p>&#13;
</li>&#13;
<li>&#13;
<p>If <code>origin</code> is <code>2</code>, go&#13;
<em><code>offset</code></em> bytes relative to the end</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>These values are also defined in the standard <code>os</code> module:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">os</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">SEEK_SET</code>&#13;
<code class="go">0</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">SEEK_CUR</code>&#13;
<code class="go">1</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">SEEK_END</code>&#13;
<code class="go">2</code></pre>&#13;
&#13;
<p>So, we could have read the last byte in different ways:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'bfile'</code><code class="p">,</code> <code class="s">'rb'</code><code class="p">)</code></pre>&#13;
&#13;
<p>One byte before the end of the file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">seek</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code>&#13;
<code class="go">255</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">tell</code><code class="p">()</code>&#13;
<code class="go">255</code></pre>&#13;
&#13;
<p>Read until the end of the file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">read</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">bdata</code><code class="p">)</code>&#13;
<code class="go">1</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code>&#13;
<code class="go">255</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>You don’t need to call <code>tell()</code> for <code>seek()</code> to work.&#13;
I just wanted to show that they both report the same offset.</p>&#13;
</div>&#13;
&#13;
<p>Here’s an example of seeking from the&#13;
current position in the file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'bfile'</code><code class="p">,</code> <code class="s">'rb'</code><code class="p">)</code></pre>&#13;
&#13;
<p>This next example ends up two bytes before the end of the file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">seek</code><code class="p">(</code><code class="mi">254</code><code class="p">,</code> <code class="mi">0</code><code class="p">)</code>&#13;
<code class="go">254</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">tell</code><code class="p">()</code>&#13;
<code class="go">254</code></pre>&#13;
&#13;
<p>Now go forward one byte:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">seek</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code>&#13;
<code class="go">255</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fin</code><code class="o">.</code><code class="n">tell</code><code class="p">()</code>&#13;
<code class="go">255</code></pre>&#13;
&#13;
<p>Finally, read until the end of the file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code> <code class="o">=</code> <code class="n">fin</code><code class="o">.</code><code class="n">read</code><code class="p">()</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="nb">len</code><code class="p">(</code><code class="n">bdata</code><code class="p">)</code>&#13;
<code class="go">1</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">bdata</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code>&#13;
<code class="go">255</code></pre>&#13;
&#13;
<p>These functions are most useful for binary files.&#13;
You can use them with text files,&#13;
but unless the file is ASCII (one byte per character),&#13;
you would have a hard time calculating offsets.&#13;
These would depend on the text encoding,&#13;
and the most popular encoding (UTF-8)&#13;
uses varying numbers of bytes per character<a data-startref="ix_ch14-files-asciidoc4" data-type="indexterm" id="idm45794983749048"/><a data-startref="ix_ch14-files-asciidoc3" data-type="indexterm" id="idm45794983748552"/><a data-startref="ix_ch14-files-asciidoc2" data-type="indexterm" id="idm45794983747944"/>.<a data-startref="ix_ch14-files-asciidoc1" data-type="indexterm" id="idm45794983747144"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Memory Mapping" data-type="sect1"><div class="sect1" id="mmap">&#13;
<h1>Memory Mapping</h1>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="memory mapping" data-type="indexterm" id="idm45794983713928"/><a data-primary="memory mapping" data-type="indexterm" id="idm45794983712728"/>An alternative to reading and writing a file&#13;
is to <em>memory-map</em> it with the standard <code>mmap</code> module.&#13;
This makes the contents of a file&#13;
look like a <code>bytearray</code> in memory.&#13;
See the&#13;
<a href="https://oreil.ly/GEzkf">documentation</a>&#13;
and some&#13;
<a href="https://oreil.ly/GUtdx">examples</a>&#13;
for more details.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="File Operations" data-type="sect1"><div class="sect1" id="file_ops">&#13;
<h1>File Operations</h1>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="file operations" data-type="indexterm" id="ix_ch14-files-asciidoc5"/><a data-primary="Unix" data-secondary="file operations" data-type="indexterm" id="ix_ch14-files-asciidoc6"/>Python, like many other languages,&#13;
patterned its file operations after Unix.&#13;
Some functions, such as <code>chown()</code> and <code>chmod()</code>,&#13;
have the same names,&#13;
but there are a few new ones.</p>&#13;
&#13;
<p>I’ll first show how Python handles these tasks&#13;
with functions from the <code>os.path</code> module and&#13;
then with the newer <code>pathlib</code> module.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Check Existence with exists()" data-type="sect2"><div class="sect2" id="exists">&#13;
<h2>Check Existence with exists()</h2>&#13;
&#13;
<p><a data-primary="exists() function" data-type="indexterm" id="idm45794983700696"/><a data-primary="file handling" data-secondary="checking for existence of files" data-type="indexterm" id="idm45794983699992"/>To verify whether the file or directory&#13;
is really there or you just imagined it,&#13;
you can provide <code>exists()</code>,&#13;
with a relative or absolute pathname,&#13;
as demonstrated here:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">os</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">)</code>&#13;
<code class="go">True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'./oops.txt'</code><code class="p">)</code>&#13;
<code class="go">True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'waffles'</code><code class="p">)</code>&#13;
<code class="go">False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'.'</code><code class="p">)</code>&#13;
<code class="go">True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'..'</code><code class="p">)</code>&#13;
<code class="go">True</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Check Type with isfile()" data-type="sect2"><div class="sect2" id="isfile">&#13;
<h2>Check Type with isfile()</h2>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="checking type of" data-type="indexterm" id="idm45794983621880"/><a data-primary="isfile() function" data-type="indexterm" id="idm45794983620904"/>The functions in this section check whether a name refers to&#13;
a file, directory, or symbolic link&#13;
(see the examples that follow for a discussion of links).</p>&#13;
&#13;
<p>The first function we’ll look at, <code>isfile</code>,&#13;
asks a simple question: is it a plain old law-abiding file?</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">name</code> <code class="o">=</code> <code class="s">'oops.txt'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">isfile</code><code class="p">(</code><code class="n">name</code><code class="p">)</code>&#13;
<code class="go">True</code></pre>&#13;
&#13;
<p>Here’s how you determine a directory:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">isdir</code><code class="p">(</code><code class="n">name</code><code class="p">)</code>&#13;
<code class="go">False</code></pre>&#13;
&#13;
<p><a data-primary=". (directory)" data-type="indexterm" id="idm45794983603000"/><a data-primary=".. (parent directory)" data-type="indexterm" id="idm45794983602504"/>A single dot (<code>.</code>) is shorthand for the current directory,&#13;
and two dots (<code>..</code>) stands for the parent directory.&#13;
These always&#13;
exist, so a statement such as the following will&#13;
always report <code>True</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">isdir</code><code class="p">(</code><code class="s">'.'</code><code class="p">)</code>&#13;
<code class="go">True</code></pre>&#13;
&#13;
<p><a data-primary="os module" data-type="indexterm" id="idm45794983527080"/><a data-primary="pathnames" data-type="indexterm" id="idm45794983526360"/>The <code>os</code> module contains many functions dealing with <em>pathnames</em>&#13;
(fully qualified filenames, starting with <code>/</code> and including all parents).&#13;
<a data-primary="isabs() function" data-type="indexterm" id="idm45794983524344"/>One such function, <code>isabs()</code>, determines whether its argument&#13;
is an absolute pathname. The argument doesn’t need to be the name of&#13;
a real file:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">isabs</code><code class="p">(</code><code class="n">name</code><code class="p">)</code>&#13;
<code class="go">False</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">isabs</code><code class="p">(</code><code class="s">'/big/fake/name'</code><code class="p">)</code>&#13;
<code class="go">True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">isabs</code><code class="p">(</code><code class="s">'big/fake/name/without/a/leading/slash'</code><code class="p">)</code>&#13;
<code class="go">False</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Copy with copy()" data-type="sect2"><div class="sect2" id="file_copy">&#13;
<h2>Copy with copy()</h2>&#13;
&#13;
<p><a data-primary="copy() function" data-secondary="copying files with" data-type="indexterm" id="idm45794983454312"/><a data-primary="file handling" data-secondary="copying files" data-type="indexterm" id="idm45794983453176"/>The <code>copy()</code> function comes from another module, <code>shutil</code>.&#13;
This example copies the file <em>oops.txt</em> to the file <em>ohno.txt</em>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">shutil</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">shutil</code><code class="o">.</code><code class="n">copy</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">,</code> <code class="s">'ohno.txt'</code><code class="p">)</code></pre>&#13;
&#13;
<p>The <code>shutil.move()</code> function copies a file&#13;
and then removes the original.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Change Name with rename()" data-type="sect2"><div class="sect2" id="file_rename">&#13;
<h2>Change Name with rename()</h2>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="changing file names" data-type="indexterm" id="idm45794983438744"/><a data-primary="file handling" data-secondary="renaming files" data-type="indexterm" id="idm45794983396392"/><a data-primary="rename() function" data-type="indexterm" id="idm45794983395448"/>This function does exactly what it says.&#13;
In the example here,&#13;
it renames <em>ohno.txt</em> to <em>ohwell.txt</em>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">os</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">rename</code><code class="p">(</code><code class="s">'ohno.txt'</code><code class="p">,</code> <code class="s">'ohwell.txt'</code><code class="p">)</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Link with link() or symlink()" data-type="sect2"><div class="sect2" id="file_link">&#13;
<h2>Link with link() or symlink()</h2>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="linking files" data-type="indexterm" id="idm45794983432312"/><a data-primary="link() function" data-type="indexterm" id="idm45794983430936"/><a data-primary="links" data-type="indexterm" id="idm45794983430264"/><a data-primary="symlink() function" data-type="indexterm" id="idm45794983429592"/>In Unix, a file exists in one place,&#13;
but it can have multiple names, called <em>links</em>.&#13;
<a data-primary="hard links" data-type="indexterm" id="idm45794983362888"/>In low-level <em>hard links</em>,&#13;
it’s not easy to find all the names for a given file.&#13;
<a data-primary="symbolic link" data-type="indexterm" id="idm45794983361608"/>A <em>symbolic link</em> is an alternative method&#13;
that stores the new name as its own file,&#13;
making it possible for you to get both&#13;
the original and new names at once.&#13;
The <code>link()</code> call creates a hard link,&#13;
and <code>symlink()</code> makes a symbolic link.&#13;
<a data-primary="islink() function" data-type="indexterm" id="idm45794983359368"/>The <code>islink()</code> function checks whether the file&#13;
is a symbolic link.</p>&#13;
&#13;
<p>Here’s how to make a hard link to the existing file <em>oops.txt</em>&#13;
from the new file <em>yikes.txt</em>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">link</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">,</code> <code class="s">'yikes.txt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">isfile</code><code class="p">(</code><code class="s">'yikes.txt'</code><code class="p">)</code>&#13;
<code class="go">True</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">islink</code><code class="p">(</code><code class="s">'yikes.txt'</code><code class="p">)</code>&#13;
<code class="go">False</code></pre>&#13;
&#13;
<p>To create a symbolic link to the existing file <em>oops.txt</em>&#13;
from the new file <em>jeepers.txt</em>, use the following:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">symlink</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">,</code> <code class="s">'jeepers.txt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">islink</code><code class="p">(</code><code class="s">'jeepers.txt'</code><code class="p">)</code>&#13;
<code class="go">True</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Change Permissions with chmod()" data-type="sect2"><div class="sect2" id="file_chmod">&#13;
<h2>Change Permissions with chmod()</h2>&#13;
&#13;
<p><a data-primary="chmod() function" data-type="indexterm" id="idm45794983303256"/><a data-primary="chown() function" data-type="indexterm" id="idm45794983302552"/><a data-primary="file handling" data-secondary="changing permissions" data-type="indexterm" id="idm45794983301880"/><a data-primary="permissions" data-type="indexterm" id="idm45794983300936"/>On a Unix system, <code>chmod()</code> changes file permissions.&#13;
There are read,&#13;
write, and execute permissions for the user&#13;
(that’s usually you, if you&#13;
created the file),&#13;
the main group that the user is in,&#13;
and the rest of&#13;
the world.&#13;
The command takes an intensely compressed octal (base 8)&#13;
value that combines user, group, and other permissions.&#13;
For instance,&#13;
to make <em>oops.txt</em> readable only by its owner,&#13;
type the following:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">chmod</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">,</code> <code class="mi">0</code><code class="n">o400</code><code class="p">)</code></pre>&#13;
&#13;
<p>If you don’t want to deal with cryptic&#13;
octal values and would rather&#13;
deal with (slightly less) obscure cryptic symbols,&#13;
you can import some&#13;
constants from the <code>stat</code> module and use a statement&#13;
such as the following:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">stat</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">chmod</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">,</code> <code class="n">stat</code><code class="o">.</code><code class="n">S_IRUSR</code><code class="p">)</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Change Ownership with chown()" data-type="sect2"><div class="sect2" id="file_chown">&#13;
<h2>Change Ownership with chown()</h2>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="changing ownership" data-type="indexterm" id="idm45794983202040"/>This function is also Unix/Linux/Mac–specific.&#13;
You can change the owner and/or group ownership of a file&#13;
by specifying the numeric user ID (<em>uid</em>)&#13;
and group ID (<em>gid</em>):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">uid</code> <code class="o">=</code> <code class="mi">5</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">gid</code> <code class="o">=</code> <code class="mi">22</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">chown</code><code class="p">(</code><code class="s">'oops'</code><code class="p">,</code> <code class="n">uid</code><code class="p">,</code> <code class="n">gid</code><code class="p">)</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Delete a File with remove()" data-type="sect2"><div class="sect2" id="file_remove">&#13;
<h2>Delete a File with remove()</h2>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="deleting files" data-type="indexterm" id="idm45794983174024"/><a data-primary="remove() function" data-secondary="deleting file with" data-type="indexterm" id="idm45794983173048"/>In this snippet, we use the <code>remove()</code>&#13;
function and say farewell to <em>oops.txt</em><a data-startref="ix_ch14-files-asciidoc6" data-type="indexterm" id="idm45794983171304"/><a data-startref="ix_ch14-files-asciidoc5" data-type="indexterm" id="idm45794983170600"/>:<a data-startref="ix_ch14-files-asciidoc0" data-type="indexterm" id="idm45794983145560"/></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">remove</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">)</code>&#13;
<code class="go">False</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Directory Operations" data-type="sect1"><div class="sect1" id="directory_ops">&#13;
<h1>Directory Operations</h1>&#13;
&#13;
<p><a data-primary="directory operations" data-seealso="pathnames" data-type="indexterm" id="ix_ch14-files-asciidoc7"/>In <a data-primary="directory operations" data-secondary="definition of" data-type="indexterm" id="idm45794983092888"/>most operating systems,&#13;
files exist in a hierarchy of <em>directories</em>&#13;
(often called <em>folders</em>).&#13;
<a data-primary="file system, defined" data-type="indexterm" id="idm45794983090952"/>The container of all of these files and directories&#13;
is a <em>filesystem</em> (sometimes called a <em>volume</em>).&#13;
The standard <code>os</code> module deals with operating specifics&#13;
such as these and provides the following functions&#13;
with which you can manipulate them.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Create with mkdir()" data-type="sect2"><div class="sect2" id="mkdir">&#13;
<h2>Create with mkdir()</h2>&#13;
&#13;
<p><a data-primary="directory operations" data-secondary="creating" data-type="indexterm" id="idm45794983087192"/><a data-primary="mkdir() function" data-type="indexterm" id="idm45794983086216"/>This example shows how to create a directory&#13;
called <code>poems</code> to store&#13;
that precious verse:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">mkdir</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code>&#13;
<code class="go">True</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Delete with rmdir()" data-type="sect2"><div class="sect2" id="rmdir">&#13;
<h2>Delete with rmdir()</h2>&#13;
&#13;
<p><a data-primary="directory operations" data-secondary="deleting" data-type="indexterm" id="idm45794983044088"/><a data-primary="rmdir() function" data-type="indexterm" id="idm45794983043112"/>Upon second thought,<sup><a data-type="noteref" href="ch14.html#idm45794983042312" id="idm45794983042312-marker">2</a></sup>&#13;
you decide you don’t need that directory after all.&#13;
Here’s how to delete it:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">rmdir</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">exists</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code>&#13;
<code class="go">False</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="List Contents with listdir()" data-type="sect2"><div class="sect2" id="listdir">&#13;
<h2>List Contents with listdir()</h2>&#13;
&#13;
<p><a data-primary="directory operations" data-secondary="listing contents of" data-type="indexterm" id="idm45794983029048"/><a data-primary="listdir() function" data-type="indexterm" id="idm45794983028072"/>OK, take two; let’s make <code>poems</code> again, with some contents:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">mkdir</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code></pre>&#13;
&#13;
<p>Now get a list of its contents (none so far):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">listdir</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code>&#13;
<code class="go">[]</code></pre>&#13;
&#13;
<p><a data-primary="directory operations" data-secondary="creating subdirectories" data-type="indexterm" id="idm45794982999752"/><a data-primary="subdirectories, creating" data-type="indexterm" id="idm45794982999016"/>Next, make a subdirectory:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">mkdir</code><code class="p">(</code><code class="s">'poems/mcintyre'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">listdir</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code>&#13;
<code class="go">['mcintyre']</code></pre>&#13;
&#13;
<p>Create a file in this subdirectory&#13;
(don’t type all these lines unless you&#13;
really feel poetic; just make sure you begin and end&#13;
with matching quotes, either single&#13;
or tripled):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s">'poems/mcintyre/the_good_man'</code><code class="p">,</code> <code class="s">'wt'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="s">'''Cheerful and happy was his mood,</code>&#13;
<code class="gp">... </code><code class="s">He to the poor was kind and good,</code>&#13;
<code class="gp">... </code><code class="s">And he oft' times did find them food,</code>&#13;
<code class="gp">... </code><code class="s">Also supplies of coal and wood,</code>&#13;
<code class="gp">... </code><code class="s">He never spake a word was rude,</code>&#13;
<code class="gp">... </code><code class="s">And cheer'd those did o'er sorrows brood,</code>&#13;
<code class="gp">... </code><code class="s">He passed away not understood,</code>&#13;
<code class="gp">... </code><code class="s">Because no poet in his lays</code>&#13;
<code class="gp">... </code><code class="s">Had penned a sonnet in his praise,</code>&#13;
<code class="gp">... </code><code class="s">'Tis sad, but such is world's ways.</code>&#13;
<code class="gp">... </code><code class="s">'''</code><code class="p">)</code>&#13;
<code class="go">344</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">fout</code><code class="o">.</code><code class="n">close</code><code class="p">()</code></pre>&#13;
&#13;
<p>Finally, let’s see what we have. It had better be there:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">listdir</code><code class="p">(</code><code class="s">'poems/mcintyre'</code><code class="p">)</code>&#13;
<code class="go">['the_good_man']</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Change Current Directory with chdir()" data-type="sect2"><div class="sect2" id="chdir">&#13;
<h2>Change Current Directory with chdir()</h2>&#13;
&#13;
<p><a data-primary="chdir() function" data-type="indexterm" id="idm45794982836856"/><a data-primary="directory operations" data-secondary="changing current" data-type="indexterm" id="idm45794982836152"/>With this function, you can go from one directory to another.&#13;
Let’s leave the current directory&#13;
and spend a little time in <code>poems</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">os</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">chdir</code><code class="p">(</code><code class="s">'poems'</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">listdir</code><code class="p">(</code><code class="s">'.'</code><code class="p">)</code>&#13;
<code class="go">['mcintyre']</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="List Matching Files with glob()" data-type="sect2"><div class="sect2" id="file_glob">&#13;
<h2>List Matching Files with glob()</h2>&#13;
&#13;
<p><a data-primary="directory operations" data-secondary="listing matching files" data-type="indexterm" id="idm45794982760936"/><a data-primary="glob() function" data-type="indexterm" id="idm45794982760072"/>The <code>glob()</code> function matches file or directory names&#13;
by using Unix shell rules&#13;
rather than the more complete regular expression syntax.&#13;
Here are those rules:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>*</code> matches everything (<code>re</code> would expect <code>.*</code>)</p>&#13;
</li>&#13;
<li>&#13;
<p><code>?</code> matches a single character</p>&#13;
</li>&#13;
<li>&#13;
<p><code>[abc]</code> matches character <code>a</code>, <code>b</code>, or <code>c</code></p>&#13;
</li>&#13;
<li>&#13;
<p><code>[!abc]</code> matches any character <em>except</em> <code>a</code>, <code>b</code>, or <code>c</code></p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Try getting all files or directories that begin with <code>m</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">glob</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">glob</code><code class="o">.</code><code class="n">glob</code><code class="p">(</code><code class="s">'m*'</code><code class="p">)</code>&#13;
<code class="go">['mcintyre']</code></pre>&#13;
&#13;
<p>How about any two-letter files or directories?</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">glob</code><code class="o">.</code><code class="n">glob</code><code class="p">(</code><code class="s">'??'</code><code class="p">)</code>&#13;
<code class="go">[]</code></pre>&#13;
&#13;
<p>I’m thinking of an eight-letter word that&#13;
begins with <code>m</code> and ends with <code>e</code>:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">glob</code><code class="o">.</code><code class="n">glob</code><code class="p">(</code><code class="s">'m??????e'</code><code class="p">)</code>&#13;
<code class="go">['mcintyre']</code></pre>&#13;
&#13;
<p>What about anything that begins with a&#13;
<code>k</code>, <code>l</code>, or <code>m</code>, and ends with <code>e</code>?<a data-startref="ix_ch14-files-asciidoc7" data-type="indexterm" id="idm45794982704040"/></p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">glob</code><code class="o">.</code><code class="n">glob</code><code class="p">(</code><code class="s">'[klm]*e'</code><code class="p">)</code>&#13;
<code class="go">['mcintyre']</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Pathnames" data-type="sect1"><div class="sect1" id="pathnames">&#13;
<h1>Pathnames</h1>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="pathnames" data-type="indexterm" id="ix_ch14-files-asciidoc8"/><a data-primary="pathnames" data-type="indexterm" id="ix_ch14-files-asciidoc9"/>Almost all of our computers use hierarchical filesystems,&#13;
with directories (“folders”)&#13;
containing files and other directories,&#13;
down to various levels.&#13;
When you want to refer to a specific file or directory,&#13;
you need its <em>pathname</em>:&#13;
the sequence of directories needed&#13;
to get there,&#13;
either <em>absolute</em> from the top (the <em>root</em>),&#13;
or <em>relative</em> to your current directory.</p>&#13;
&#13;
<p><a data-primary="/ (slash)" data-type="indexterm" id="idm45794982668200"/><a data-primary="\ (backslash)" data-type="indexterm" id="idm45794982615528"/><a data-primary="backslash (\)" data-type="indexterm" id="idm45794982614856"/><a data-primary="slash (/)" data-type="indexterm" id="idm45794982614184"/>You’ll often hear people confusing&#13;
a forward <em>slash</em> (<code>'/'</code>, not the Guns N’ Roses guy)&#13;
and <em>backslash</em> (<code>'\'</code>).<sup><a data-type="noteref" href="ch14.html#idm45794982611688" id="idm45794982611688-marker">3</a></sup>&#13;
<a data-primary="macOS" data-secondary="path separators" data-type="indexterm" id="idm45794982610104"/><a data-primary="path separators" data-type="indexterm" id="idm45794982609096"/><a data-primary="Unix" data-secondary="path separators" data-type="indexterm" id="idm45794982608424"/>Unix and Macs (and web URLs)&#13;
use slash as the <em>path separator</em>,&#13;
and <a data-primary="Windows" data-secondary="path separators" data-type="indexterm" id="idm45794982606904"/>Windows uses backslash.<sup><a data-type="noteref" href="ch14.html#idm45794982605768" id="idm45794982605768-marker">4</a></sup></p>&#13;
&#13;
<p>Python lets you use slash as the path separator&#13;
when you’re specifying names.&#13;
On Windows, you can use backslash,&#13;
but you know that backslash is a ubiquitous escape character&#13;
in Python,&#13;
so you have to double it everywhere,&#13;
or use Python’s raw strings:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">win_file</code> <code class="o">=</code> <code class="s">'eek</code><code class="se">\\</code><code class="s">urk</code><code class="se">\\</code><code class="s">snort.txt'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">win_file2</code> <code class="o">=</code> <code class="s">r'eek\urk\snort.txt'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">win_file</code>&#13;
<code class="go">'eek\\urk\\snort.txt'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">win_file2</code>&#13;
<code class="go">'eek\\urk\\snort.txt'</code></pre>&#13;
&#13;
<p>When you’re building a pathname,&#13;
you can do the following:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Use the appropriate path separation character&#13;
(<code>'/'</code> or <code>'\'</code>)</p>&#13;
</li>&#13;
<li>&#13;
<p>Build a pathname (see <a data-type="xref" href="#os_path_join">“Build a Pathname with os.path.join()”</a>)</p>&#13;
</li>&#13;
<li>&#13;
<p>Use pathlib (see <a data-type="xref" href="#pathlib">“Use pathlib”</a>)</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Get a Pathname with abspath()" data-type="sect2"><div class="sect2" id="abspath">&#13;
<h2>Get a Pathname with abspath()</h2>&#13;
&#13;
<p><a data-primary="abspath() function" data-type="indexterm" id="idm45794982564104"/><a data-primary="file handling" data-secondary="getting pathnames" data-type="indexterm" id="idm45794982563400"/><a data-primary="pathnames" data-secondary="getting" data-type="indexterm" id="idm45794982562456"/>This function expands a relative name&#13;
to an absolute one.&#13;
If your current directory is <em>/usr/gaberlunzie</em>&#13;
and the file <em>oops.txt</em> is there,&#13;
you can type the following:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">abspath</code><code class="p">(</code><code class="s">'oops.txt'</code><code class="p">)</code>&#13;
<code class="go">'/usr/gaberlunzie/oops.txt'</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Get a symlink Pathname with realpath()" data-type="sect2"><div class="sect2" id="realpath">&#13;
<h2>Get a symlink Pathname with realpath()</h2>&#13;
&#13;
<p><a data-primary="file handling" data-secondary="getting symlink pathnames" data-type="indexterm" id="idm45794982553864"/><a data-primary="pathnames" data-secondary="getting symlink pathnames" data-type="indexterm" id="idm45794982552696"/><a data-primary="realpath() function" data-type="indexterm" id="idm45794982551784"/>In one of the earlier sections, we made a symbolic&#13;
link to <em>oops.txt</em> from the new file <em>jeepers.txt</em>.&#13;
In circumstances such as this,&#13;
you can get the name of <em>oops.txt</em> from <em>jeepers.txt</em>&#13;
by using the <code>realpath()</code> function, as shown here:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">realpath</code><code class="p">(</code><code class="s">'jeepers.txt'</code><code class="p">)</code>&#13;
<code class="go">'/usr/gaberlunzie/oops.txt'</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Build a Pathname with os.path.join()" data-type="sect2"><div class="sect2" id="os_path_join">&#13;
<h2>Build a Pathname with os.path.join()</h2>&#13;
&#13;
<p><a data-primary="os.path.join() function" data-type="indexterm" id="idm45794982508632"/><a data-primary="pathnames" data-secondary="building" data-type="indexterm" id="idm45794982507928"/>When you’re constructing a multipart pathname,&#13;
you can call <code>os.path.join()</code> to combine them pairwise&#13;
with the proper path separation&#13;
character for your operating system:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">import</code> <code class="nn">os</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">win_file</code> <code class="o">=</code> <code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">join</code><code class="p">(</code><code class="s">"eek"</code><code class="p">,</code> <code class="s">"urk"</code><code class="p">)</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">win_file</code> <code class="o">=</code> <code class="n">os</code><code class="o">.</code><code class="n">path</code><code class="o">.</code><code class="n">join</code><code class="p">(</code><code class="n">win_file</code><code class="p">,</code> <code class="s">"snort.txt"</code><code class="p">)</code></pre>&#13;
&#13;
<p>If I run this on a Mac or Linux box,&#13;
I get this:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">win_file</code>&#13;
<code class="go">'eek/urk/snort.txt'</code></pre>&#13;
&#13;
<p>Running on Windows would produce this:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">win_file</code>&#13;
<code class="go">'eek\\urk\\snort.txt'</code></pre>&#13;
&#13;
<p>But if the same code produces different result depending on&#13;
where it’s run,&#13;
that could be a problem.&#13;
The new <code>pathlib</code> module is a portable solution to this.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Use pathlib" data-type="sect2"><div class="sect2" id="pathlib">&#13;
<h2>Use pathlib</h2>&#13;
&#13;
<p><a data-primary="pathlib module" data-type="indexterm" id="idm45794982412984"/><a data-primary="pathnames" data-secondary="pathlib module" data-type="indexterm" id="idm45794982412280"/>Python added the <code>pathlib</code> module in version 3.4.&#13;
It’s an alternative to&#13;
the <code>os.path</code> modules that I just described.&#13;
But why do we need another module?</p>&#13;
&#13;
<p>Rather that treating filesystem pathnames as strings,&#13;
it introduces the <code>Path</code> object to treat them at a little&#13;
higher level.&#13;
Create a <code>Path</code> with the <code>Path()</code> class, and&#13;
then knit your path together with bare slashes&#13;
(not <code>'/'</code> characters):</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">pathlib</code> <code class="kn">import</code> <code class="n">Path</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">file_path</code> <code class="o">=</code> <code class="n">Path</code><code class="p">(</code><code class="s">'eek'</code><code class="p">)</code> <code class="o">/</code> <code class="s">'urk'</code> <code class="o">/</code> <code class="s">'snort.txt'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">file_path</code>&#13;
<code class="go">PosixPath('eek/urk/snort.txt')</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="n">file_path</code><code class="p">)</code>&#13;
<code class="go">eek/urk/snort.txt</code></pre>&#13;
&#13;
<p>This slash trick took advantage of Python’s&#13;
<a data-type="xref" href="ch10.html#magic_methods">“Magic Methods”</a>.&#13;
A <code>Path</code> can tell you a bit about itself:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="n">file_path</code><code class="o">.</code><code class="n">name</code>&#13;
<code class="go">'snort.txt'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">file_path</code><code class="o">.</code><code class="n">suffix</code>&#13;
<code class="go">'.txt'</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">file_path</code><code class="o">.</code><code class="n">stem</code>&#13;
<code class="go">'snort'</code></pre>&#13;
&#13;
<p>You can feed <code>file_path</code> to <code>open()</code> as you would&#13;
any filename or pathname string.</p>&#13;
&#13;
<p>You can also see what would happen if you ran this program&#13;
on another system&#13;
or if you needed to generate foreign pathnames&#13;
on your computer:</p>&#13;
&#13;
<pre data-code-language="pycon" data-type="programlisting"><code class="gp">&gt;&gt;&gt; </code><code class="kn">from</code> <code class="nn">pathlib</code> <code class="kn">import</code> <code class="n">PureWindowsPath</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="n">PureWindowsPath</code><code class="p">(</code><code class="n">file_path</code><code class="p">)</code>&#13;
<code class="go">PureWindowsPath('eek/urk/snort.txt')</code>&#13;
<code class="gp">&gt;&gt;&gt; </code><code class="k">print</code><code class="p">(</code><code class="n">PureWindowsPath</code><code class="p">(</code><code class="n">file_path</code><code class="p">))</code>&#13;
<code class="go">eek\urk\snort.txt</code></pre>&#13;
&#13;
<p>See the&#13;
<a href="https://oreil.ly/yN87f">docs</a>&#13;
for all the details.<a data-startref="ix_ch14-files-asciidoc9" data-type="indexterm" id="idm45794982319752"/><a data-startref="ix_ch14-files-asciidoc8" data-type="indexterm" id="idm45794982319080"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="BytesIO and StringIO" data-type="sect1"><div class="sect1" id="idm45794982642504">&#13;
<h1>BytesIO and StringIO</h1>&#13;
&#13;
<p><a data-primary="BytesIO" data-type="indexterm" id="ix_ch14-files-asciidoc10"/><a data-primary="StringIO" data-type="indexterm" id="ix_ch14-files-asciidoc11"/>You’ve seen how to modify data in memory&#13;
and how to get data in and out of files.&#13;
What do you do if you have in-memory data,&#13;
but want to call a function that expects a file&#13;
(or the reverse)?&#13;
You’d want to modify the data and&#13;
pass those bytes or characters around,&#13;
without reading and writing temporary files.</p>&#13;
&#13;
<p>You can use <code>io.BytesIO</code> for binary data (<code>bytes</code>)&#13;
and <code>io.StringIO</code> for text data (<code>str</code>).&#13;
<a data-primary="file-like object" data-type="indexterm" id="idm45794982233416"/>Using either of these wraps data as a <em>file-like object</em>,&#13;
suitable to use with all the file functions you’ve seen&#13;
in this chapter.</p>&#13;
&#13;
<p>One use case for this is data format conversion.&#13;
Let’s apply this to the PIL library (details coming in <a data-type="xref" href="ch20.html#pil">“PIL and Pillow”</a>),&#13;
which reads and writes image data.&#13;
The first argument to its <code>Image</code> object’s&#13;
<code>open()</code> and <code>save()</code> methods&#13;
is a filename <em>or a file-like object</em>.&#13;
The code in <a data-type="xref" href="#ex1401">Example 14-1</a> uses <code>BytesIO</code> to read <em>and</em>&#13;
write in-memory data.&#13;
It reads one or more image files from&#13;
the command line,&#13;
converts its image data to three different formats,&#13;
and prints the length and first 10 bytes of these outputs.</p>&#13;
<div data-type="example" id="ex1401">&#13;
<h5><span class="label">Example 14-1. </span>convert_image.py</h5>&#13;
&#13;
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code> <code class="nn">io</code> <code class="kn">import</code> <code class="n">BytesIO</code>&#13;
<code class="kn">from</code> <code class="nn">PIL</code> <code class="kn">import</code> <code class="n">Image</code>&#13;
<code class="kn">import</code> <code class="nn">sys</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">data_to_img</code><code class="p">(</code><code class="n">data</code><code class="p">):</code>&#13;
    <code class="sd">"""Return PIL Image object, with data from in-memory &lt;data&gt;"""</code>&#13;
    <code class="n">fp</code> <code class="o">=</code> <code class="n">BytesIO</code><code class="p">(</code><code class="n">data</code><code class="p">)</code>&#13;
    <code class="k">return</code> <code class="n">Image</code><code class="o">.</code><code class="n">open</code><code class="p">(</code><code class="n">fp</code><code class="p">)</code>    <code class="c1"># reads from memory</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">img_to_data</code><code class="p">(</code><code class="n">img</code><code class="p">,</code> <code class="n">fmt</code><code class="o">=</code><code class="bp">None</code><code class="p">):</code>&#13;
    <code class="sd">"""Return image data from PIL Image &lt;img&gt;, in &lt;fmt&gt; format"""</code>&#13;
    <code class="n">fp</code> <code class="o">=</code> <code class="n">BytesIO</code><code class="p">()</code>&#13;
    <code class="k">if</code> <code class="ow">not</code> <code class="n">fmt</code><code class="p">:</code>&#13;
        <code class="n">fmt</code> <code class="o">=</code> <code class="n">img</code><code class="o">.</code><code class="n">format</code>     <code class="c1"># keeps the original format</code>&#13;
    <code class="n">img</code><code class="o">.</code><code class="n">save</code><code class="p">(</code><code class="n">fp</code><code class="p">,</code> <code class="n">fmt</code><code class="p">)</code>        <code class="c1"># writes to memory</code>&#13;
    <code class="k">return</code> <code class="n">fp</code><code class="o">.</code><code class="n">getvalue</code><code class="p">()</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">convert_image</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">fmt</code><code class="o">=</code><code class="bp">None</code><code class="p">):</code>&#13;
    <code class="sd">"""Convert image &lt;data&gt; to PIL &lt;fmt&gt; image data"""</code>&#13;
    <code class="n">img</code> <code class="o">=</code> <code class="n">data_to_img</code><code class="p">(</code><code class="n">data</code><code class="p">)</code>&#13;
    <code class="k">return</code> <code class="n">img_to_data</code><code class="p">(</code><code class="n">img</code><code class="p">,</code> <code class="n">fmt</code><code class="p">)</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">get_file_data</code><code class="p">(</code><code class="n">name</code><code class="p">):</code>&#13;
    <code class="sd">"""Return PIL Image object for image file &lt;name&gt;"""</code>&#13;
    <code class="n">img</code> <code class="o">=</code> <code class="n">Image</code><code class="o">.</code><code class="n">open</code><code class="p">(</code><code class="n">name</code><code class="p">)</code>&#13;
    <code class="k">print</code><code class="p">(</code><code class="s2">"img"</code><code class="p">,</code> <code class="n">img</code><code class="p">,</code> <code class="n">img</code><code class="o">.</code><code class="n">format</code><code class="p">)</code>&#13;
    <code class="k">return</code> <code class="n">img_to_data</code><code class="p">(</code><code class="n">img</code><code class="p">)</code>&#13;
&#13;
<code class="k">if</code> <code class="nv-Magic">__name__</code> <code class="o">==</code> <code class="s2">"__main__"</code><code class="p">:</code>&#13;
    <code class="k">for</code> <code class="n">name</code> <code class="ow">in</code> <code class="n">sys</code><code class="o">.</code><code class="n">argv</code><code class="p">[</code><code class="mi">1</code><code class="p">:]:</code>&#13;
        <code class="n">data</code> <code class="o">=</code> <code class="n">get_file_data</code><code class="p">(</code><code class="n">name</code><code class="p">)</code>&#13;
        <code class="k">print</code><code class="p">(</code><code class="s2">"in"</code><code class="p">,</code> <code class="nb">len</code><code class="p">(</code><code class="n">data</code><code class="p">),</code> <code class="n">data</code><code class="p">[:</code><code class="mi">10</code><code class="p">])</code>&#13;
        <code class="k">for</code> <code class="n">fmt</code> <code class="ow">in</code> <code class="p">(</code><code class="s2">"gif"</code><code class="p">,</code> <code class="s2">"png"</code><code class="p">,</code> <code class="s2">"jpeg"</code><code class="p">):</code>&#13;
            <code class="n">out_data</code> <code class="o">=</code> <code class="n">convert_image</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">fmt</code><code class="p">)</code>&#13;
            <code class="k">print</code><code class="p">(</code><code class="s2">"out"</code><code class="p">,</code> <code class="nb">len</code><code class="p">(</code><code class="n">out_data</code><code class="p">),</code> <code class="n">out_data</code><code class="p">[:</code><code class="mi">10</code><code class="p">])</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Because it acts like a file, you can <code>seek()</code>, <code>read()</code>,&#13;
and <code>write()</code> a <code>BytesIO</code> object just like a normal file;&#13;
if you did a <code>seek()</code> followed by a <code>read()</code>,&#13;
you would get only the bytes from that seek position to the end.&#13;
That <code>getvalue()</code> returns all the bytes in the <code>BytesIO</code> object.</p>&#13;
</div>&#13;
&#13;
<p>Here’s the output,&#13;
using an input image file that you’ll see in <a data-type="xref" href="ch20.html#ch_art">Chapter 20</a>:<a data-startref="ix_ch14-files-asciidoc11" data-type="indexterm" id="idm45794982017592"/><a data-startref="ix_ch14-files-asciidoc10" data-type="indexterm" id="idm45794982016872"/></p>&#13;
<pre class="c_less_space">$ <strong>python convert_image.py ch20_critter.png</strong>&#13;
img &lt;PIL.PngImagePlugin.PngImageFile image mode=RGB size=154x141 at 0x10340CF28&gt; PNG&#13;
in 24941 b'\\x89PNG\\r\\n\\x1a\\n\\x00\\x00'&#13;
out 14751 b'GIF87a\\x9a\\x00\\x8d\\x00'&#13;
out 24941 b'\\x89PNG\\r\\n\\x1a\\n\\x00\\x00'&#13;
out 5914 b'\\xff\xd8\\xff\\xe0\\x00\\x10JFIF'&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Coming Up" data-type="sect1"><div class="sect1" id="idm45794982014616">&#13;
<h1>Coming Up</h1>&#13;
&#13;
<p>The next chapter is a bit more complex.&#13;
It deals with <em>concurrency</em>&#13;
(ways of doing multiple things at about the same time)&#13;
and <em>processes</em>&#13;
(running programs).</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Things to Do" data-type="sect1"><div class="sect1" id="idm45794982012168">&#13;
<h1>Things to Do</h1>&#13;
&#13;
<p>14.1&#13;
<a data-primary="file handling" data-secondary="practice exercises" data-type="indexterm" id="idm45794982010568"/>List the files in your current directory.</p>&#13;
&#13;
<p>14.2&#13;
List the files in your parent directory.</p>&#13;
&#13;
<p>14.3&#13;
Assign the string&#13;
<code>'This is a test of the emergency text system'</code>&#13;
to the variable <code>test1</code>,&#13;
and write <code>test1</code> to a file called <em>test.txt</em>.</p>&#13;
&#13;
<p>14.4&#13;
Open the file <em>test.txt</em> and read its contents&#13;
into the string <code>test2</code>. Are <code>test1</code> and <code>test2</code> the same?</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45794985259544"><sup><a href="ch14.html#idm45794985259544-marker">1</a></sup> In the first manuscript of this book, I said <em>general</em> relativity, and was kindly corrected by a physicist reviewer.</p><p data-type="footnote" id="idm45794983042312"><sup><a href="ch14.html#idm45794983042312-marker">2</a></sup> Why is it never first?</p><p data-type="footnote" id="idm45794982611688"><sup><a href="ch14.html#idm45794982611688-marker">3</a></sup> One way to remember: forward slash tilts <em>forward</em>, backslash tilts <em>back</em>.</p><p data-type="footnote" id="idm45794982605768"><sup><a href="ch14.html#idm45794982605768-marker">4</a></sup> QDOS was the operating system that Bill Gates bought for $50,000 to have “MS-DOS” when IBM came calling about their first PC. It mimicked CP/M, which used slashes for command-line arguments. When MS-DOS later added folders, it had to use backslashes.</p></div></div></section></body></html>