# 前言

Python 编程语言调和了许多表面上的矛盾：优雅而实用，简单而强大，非常高级却在您需要处理位和字节时不会阻碍您，适合初学者也适合专家。

本书面向有一定 Python 经验的程序员，以及从其他语言首次接触 Python 的经验丰富的程序员。它提供了对 Python 本身、其庞大标准库中最常用部分的快速参考，以及一些最受欢迎和有用的第三方模块和包。Python 生态系统在丰富性、范围和复杂性方面已经发展得很多，一个单一的卷不能合理地希望成为百科全书。尽管如此，本书涵盖了广泛的应用领域，包括 Web 和网络编程、XML 处理、数据库交互和高速数值计算。它还探讨了 Python 的跨平台能力以及扩展 Python 和将其嵌入其他应用程序的基础知识。

# 如何使用本书

虽然您可以从头线性阅读这本书，但我们也希望它能成为工作程序员的有用参考资料。您可以使用索引查找感兴趣的项目，或者阅读特定章节以涵盖特定主题。无论您如何使用它，我们真诚地希望您享受阅读这本书，它代表了团队一年辛勤工作的成果的最佳部分。

本书共有五个部分，如下所示。

## 第一部分，Python 入门

第一章，“Python 简介”

涵盖了 Python 语言的一般特性、其实现、获取帮助和信息的途径、如何参与 Python 社区以及如何在计算机上获取和安装 Python 或在浏览器中运行 Python。

第二章，“Python 解释器”

讲解了 Python 解释器程序、其命令行选项以及如何使用它来运行 Python 程序和在交互会话中使用。本章提到了用于编辑 Python 程序的文本编辑器和用于检查 Python 源代码的辅助程序，还介绍了一些完整的集成开发环境，包括标准 Python 免费提供的 IDLE。本章还涵盖了从命令行运行 Python 程序的内容。

## 第二部分，核心 Python 语言和内置功能

第三章，“Python 语言”

涵盖了 Python 语法、内置数据类型、表达式、语句、控制流以及如何编写和调用函数。

第四章，“面向对象的 Python”

涵盖了 Python 中的面向对象编程。

第五章，“类型注解”

讲述了如何向 Python 代码添加类型信息，以获取现代代码编辑器中的类型提示和自动补全帮助，并支持类型检查器和代码分析工具的静态类型检查。

第六章，“异常”

讲述了如何使用异常处理错误和特殊情况，日志记录，以及如何编写在异常发生时自动清理的代码。

第七章，“模块和包”

讲述了 Python 如何将代码分组为模块和包，如何定义和导入模块，以及如何安装第三方 Python 包。本章还涵盖了使用虚拟环境来隔离项目依赖项。

第八章，“核心内置和标准库模块”

讲述了内置数据类型和函数，以及 Python 标准库中一些最基本的模块（大致上来说，提供了在其他一些语言中作为语言本身一部分的功能的模块集合）。

第九章，“字符串与相关”

讲述了 Python 处理字符串的功能，包括 Unicode 字符串、字节串和字符串字面值。

第十章，“正则表达式”

讲述了 Python 对正则表达式的支持。

## 第三部分，Python 库和扩展模块

第十一章，“文件和文本操作”

讲述了使用 Python 标准库中的许多模块以及丰富文本 I/O 的平台特定扩展处理文件和文本。本章还涵盖了国际化和本地化相关问题。

第十二章，“持久化和数据库”

讲述了 Python 的序列化和持久化机制以及其与 DBM 数据库和关系（基于 SQL）数据库的接口，特别是便捷的 Python 标准库中提供的 SQLite。

第十三章，“时间操作”

讲述了如何处理 Python 中的时间和日期，使用标准库和第三方扩展。

第十四章，“自定义执行”

讲述了如何在 Python 中实现高级执行控制，包括执行动态生成的代码和控制垃圾回收。本章还涵盖了一些 Python 内部类型，以及在程序终止时注册“清理”函数的具体问题。

第十五章，“并发：线程和进程”

讲述了 Python 的并发执行功能，通过多个线程在一个进程内运行以及通过多个进程在单台计算机上运行。¹ 本章还涵盖了如何访问进程环境以及如何通过内存映射机制访问文件。

第十六章，“数值处理”

讲解了 Python 在标准库模块和第三方扩展包中进行数值计算的功能，特别是如何使用十进制数或分数代替默认的二进制浮点数。本章还讲解了如何获取和使用伪随机和真随机数，以及如何快速处理整个数组（和矩阵）中的数字。

第十七章，“测试、调试和优化”

涵盖了帮助您确保程序正确（即它们执行预期功能）的 Python 工具和方法，找出并修复程序中的错误，以及检查和提升程序性能。本章还涵盖了警告的概念以及处理它们的 Python 库模块。

## 第四部分，“网络和 Web 编程”

第十八章，“网络基础”

讲解了 Python 网络编程的基础知识。

第十九章，“客户端网络协议模块”

涵盖了 Python 标准库中用于编写网络客户端程序的模块，特别是用于处理各种客户端网络协议、发送和接收电子邮件以及处理 URL 的模块。

第二十章，“提供 HTTP 服务”

讲解了如何在 Python 中为 Web 应用程序提供 HTTP 服务，使用流行的第三方轻量级 Python 框架，并利用 Python 的 WSGI 标准接口与 Web 服务器交互。

第二十一章，“电子邮件、MIME 和其他网络编码”

讲解了如何在 Python 中处理电子邮件消息和其他网络结构化和编码文档。

第二十二章，“结构化文本：HTML”

讲解了流行的第三方 Python 扩展模块如何处理、修改和生成 HTML 文档。

第二十三章，“结构化文本：XML”

讲解了 Python 库模块和流行扩展如何处理、修改和生成 XML 文档。

## 第五部分，“扩展、分发和版本升级与迁移”

第二十四章和第二十五章的内容以摘要形式包含在本书的印刷版中。您可以在支持的在线存储库中找到这些章节的完整内容，详情请参阅“如何联系我们”章节。

第二十四章，“打包程序和扩展”

讲解了打包和分享 Python 模块和应用程序的工具和模块。

第二十五章，“扩展和嵌入经典 Python”

讲解了如何使用 Python 的 C API、Cython 和其他工具编写 Python 扩展模块。

第二十六章，“v3.7 到 v3.n 迁移”

讨论了计划和部署 Python 版本升级的主题和最佳实践，适用于从个人到库维护者再到企业级部署和支持人员的 Python 用户。

附录，“Python 3.7 至 3.11 中的新功能和更改”

提供 Python 语言语法和标准库的功能和更改的详细列表。

# 本书中使用的约定

本书始终使用以下约定。

## 参考约定

在函数/方法参考条目中，如果可行，每个可选参数都会使用 Python 语法*name=value*显示其默认值。内置函数可能不接受命名参数，因此参数名称可能不重要。有些可选参数最好通过其是否存在来解释，而不是通过默认值。在这种情况下，我们用方括号([])表示参数是可选的。当有多个参数是可选时，方括号可以嵌套。

## 版本约定

本书涵盖 Python 版本 3.7 至 3.11 中的更改和功能。

Python 3.7 是所有表格和代码示例的基础版本，除非另有说明。² 您将看到这些注释以指示在覆盖的版本范围内添加和删除的更改或功能：

+   3.x+标记的功能是在版本 3.x 中引入的，不适用于之前的版本。

+   -3.x 标记的功能是在版本 3.x 中删除的，仅在之前版本中可用。

## 排版约定

请注意，出于显示原因，我们的代码片段和示例有时可能与[PEP 8](https://oreil.ly/u0RLL)不同。我们不建议在您的代码中采用这种自由风格。相反，请使用类似[black](https://oreil.ly/BM68x)的工具来采用规范的布局风格。

本书中使用以下排版约定：

*斜体*

用于文件和目录名称、程序名称、URL 以及引入新术语。

固定宽度

用于命令行输出和代码示例，以及出现在文本中的代码元素，包括方法、函数、类和模块。

*常量宽度斜体*

用于显示在代码示例和命令中应替换为用户提供的值的文本。

**常量宽度粗体**

用于在系统命令行中键入的命令，并在 Python 解释器会话示例中指示代码输出。也用于 Python 关键字。

###### 提示

此元素表示提示或建议。

###### 注意

此元素表示一般注释。

###### 警告

此元素表示警告或注意事项。

# 使用代码示例

本书旨在帮助您完成工作。一般来说，如果本书提供了示例代码，您可以在您的程序和文档中使用它。除非您复制了代码的大部分，否则无需联系我们请求许可。例如，编写一个使用本书多个代码片段的程序并不需要许可。出售或分发 O’Reilly 书籍中的示例代码则需要许可。引用本书并引用示例代码来回答问题则不需要许可。将本书大量示例代码合并到您产品的文档中则需要许可。

我们感谢您的赞赏，但不需要署名。署名通常包括标题、作者、出版商和 ISBN 号。例如：“*Python in a Nutshell*，第四版，作者 Alex Martelli、Anna Martelli Ravenscroft、Steve Holden 和 Paul McGuire。版权所有 2023，978-1-098-11355-1。”

如果您觉得您使用的代码示例超出了合理使用范围或上述许可，请随时与我们联系：permissions@oreilly.com。

# [O’Reilly Online Learning](https://oreilly.com)

###### 注意

超过 40 年来，[*O’Reilly Media*](https://oreilly.com) 一直提供技术和商业培训、知识和见解，帮助公司取得成功。

我们独特的专家和创新者网络通过书籍、文章和我们的在线学习平台分享他们的知识和专业知识。O’Reilly 的在线学习平台为您提供按需访问的实时培训课程、深度学习路径、交互式编码环境以及来自 O’Reilly 和其他 200 多家出版商的大量文本和视频。更多信息，请访问 [*https://oreilly.com*](https://oreilly.com)。

# 如何联系我们

请将有关本书的评论和问题发送至出版商：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大）

+   707-829-0515（国际或本地）

+   707-829-0104（传真）

该书有其自己的 GitHub 仓库，我们在那里列出勘误、示例和任何额外信息。该仓库还包含第 24 和第二十五章的完整内容，因为印刷版空间不足。您可以在 [*https://github.com/pynutshell/pynut4*](https://github.com/pynutshell/pynut4) 找到它。

我们尽力测试和验证了本书中的信息，但您可能会发现功能已更改（甚至我们犯了错误！）。请向出版商报告您发现的任何错误，以及对未来版本的建议。

O’Reilly 为本书设有网页，列出勘误、示例和任何额外信息。您可以访问此页面：[*https://oreil.ly/python-nutshell-4e*](https://oreil.ly/python-nutshell-4e)。

欲对本书发表评论或提出技术问题，请发送电子邮件至 pynut4@gmail.com。

欲了解关于我们书籍和课程的新闻和信息，请访问[*https://oreilly.com*](https://oreilly.com)。

在 LinkedIn 上找到我们：[*https://linkedin.com/company/oreilly-media*](https://linkedin.com/company/oreilly-media)。

在 Twitter 上关注我们：[*https://twitter.com/oreillymedia*](https://twitter.com/oreillymedia)。

在 YouTube 上观看我们：[*https://www.youtube.com/oreillymedia*](https://www.youtube.com/oreillymedia)。

# 致谢

特别感谢 O’Reilly 的编辑和工作人员 Amanda Quinn、Brian Guerin、Zan McQuade 和 Kristen Brown。特别感谢我们的编辑 Angela Rufino，在确保我们按时完成这本书的过程中做了大量的工作！还要感谢我们优秀的文字编辑 Rachel Head，帮助我们看起来比我们实际更博学；以及我们的制作编辑 Christopher Faucher，帮助确保书籍在印刷和电子格式中都看起来最好。

特别感谢我们辛勤工作的技术审阅者 David Mertz、Mark Summerfield 和 Pankaj Gaijar，他们仔细阅读了书稿中的每一条解释和例子。没有他们，这本书就不会如此准确。³ 所有尚存的错误完全属于我们自己。

特别感谢 Luciano Ramalho、整个 PyPy 团队、Sebastián Ramírez、Fabio Pliger、Miguel Grinberg 和 Python 打包管理团队在本书的部分章节中提供的帮助，以及 Google 提供的实用的 Workspace 在线协作工具。没有这些工具，我们跨越不同洲际的密集沟通和协作将远没有现在这么方便和高效。

最后但同样重要的是，本书的作者和所有读者深深感谢 Python 语言核心开发者的巨大贡献，没有他们的英勇努力，就不会有这本书的需求。

¹ 本版不再包含第三版中有关异步编程的单独章节，而是推荐在第十五章中的参考资料中找到更详尽的覆盖。

² 例如，为了适应 Python 3.9 和 3.10 中广泛的类型注解变化，第五章的大部分内容使用 Python 3.10 作为特性和示例的基础版本。

³ 也不会有这么多脚注！
